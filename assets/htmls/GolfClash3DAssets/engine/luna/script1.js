!function(t){var e=pc.noise={};function i(t,e,i){this.x=t,this.y=e,this.z=i}i.prototype.dot2=function(t,e){return this.x*t+this.y*e},i.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i};var n=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],s=new Array(512),o=new Array(512);e.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var i;i=1&e?r[e]^255&t:r[e]^t>>8&255,s[e]=s[e+256]=i,o[e]=o[e+256]=n[i%12]}},e.seed(0);var a=.5*(Math.sqrt(3)-1),u=(3-Math.sqrt(3))/6;function c(t){return t*t*t*(t*(6*t-15)+10)}function h(t,e,i){return(1-i)*t+i*e}e.simplex2=function(t,e){var i,n,r=(t+e)*a,c=Math.floor(t+r),h=Math.floor(e+r),l=(c+h)*u,p=t-c+l,d=e-h+l;p>d?(i=1,n=0):(i=0,n=1);var f=p-i+u,y=d-n+u,m=p-1+2*u,_=d-1+2*u,g=o[(c&=255)+s[h&=255]],v=o[c+i+s[h+n]],A=o[c+1+s[h+1]],E=.5-p*p-d*d,b=.5-f*f-y*y,S=.5-m*m-_*_;return 70*((E<0?0:(E*=E)*E*g.dot2(p,d))+(b<0?0:(b*=b)*b*v.dot2(f,y))+(S<0?0:(S*=S)*S*A.dot2(m,_)))},e.perlin2=function(t,e){var i=Math.floor(t),n=Math.floor(e);t-=i,e-=n;var r=o[(i&=255)+s[n&=255]].dot2(t,e),a=o[i+s[n+1]].dot2(t,e-1),u=o[i+1+s[n]].dot2(t-1,e),l=o[i+1+s[n+1]].dot2(t-1,e-1),p=c(t);return h(h(r,u,p),h(a,l,p),c(e))}}(),pc.extend(pc.math,{rayCastAABB:function(t,e,i,n){var r=t.clone().add(e),s=t.clone().sub(e),o=(n=n.normalize(),new pc.Vec3(1/n.x,1/n.y,1/n.z)),a=(s.x-i.x)*o.x,u=(r.x-i.x)*o.x,c=Math.min(a,u),h=Math.max(a,u),l=(s.y-i.y)*o.y,p=(r.y-i.y)*o.y;c=Math.max(c,Math.min(l,p)),h=Math.min(h,Math.max(l,p));var d=(s.z-i.z)*o.z,f=(r.z-i.z)*o.z;return c=Math.max(c,Math.min(d,f)),(h=Math.min(h,Math.max(d,f)))>=c?c:null},rayCastBox:function(t,e,i,n,r){var s=(i=i.clone().invert()).transformPoint(n),o=i.transformVector(r);return pc.math.rayCastAABB(t,e,s,o)}}),pc.extend(pc,function(){var t=3;const e={x:0,y:1,z:2,w:3};var i=0,n=1,r=2,s=3;const o={r:0,g:1,b:2,a:3};var a=function(t,e){this.id=t.keyId,this.curve=t,this.value=null,this.target=e,this.idx=null,this.interoplateType=i};a.prototype={set:function(t){this.dirty=this.dirty||t!=this._value,this._value=t,this.value=t}};var u=function(){this.keys={},this.keyArray=[],this.eventsMemo={},this.events=[],this.aQuat=new pc.Quat,this.bQuat=new pc.Quat,this.resultQuat=new pc.Quat,this.copiedFrom={},this.id=pc.guid.create()};u.prototype={putKey:function(t){this.keys[t.id]=t,this.keyArray.push(t)},pushEvent:function(t){t.id=t.id||pc.guid.create(),this.eventsMemo[t.id]||(this.eventsMemo[t.id]=!0,this.events.push(t))},popEvents:function(){var t=this.events;return this.events=[],t},recycleEvents:function(){for(var t=-1,e=0;e<this.events.length;e++)t=Math.max(t,this.events.time);return this.events=[],this.eventsMemo={},t},copyKeysFromSampler:function(t){for(var e=0;e<t.keyArray.length;e++){var i=t.keyArray[e];this.keys[i.id]||this.putKey(new a(i.curve,i.target))}this.copiedFrom[t.id]=!0,this.targetObjectsSet=!1},blendSamplers:function(t,e,o,a){this.copiedFrom[t.id]||this.copyKeysFromSampler(t),this.copiedFrom[o.id]||this.copyKeysFromSampler(o);var u=a/(e+a);if(!isNaN(u))for(var c=0;c<this.keyArray.length;c++){var h=this.keyArray[c];if(t.keys[h.id])if(o.keys[h.id]){h.curve.targetObject;switch(h.interoplateType==i&&(h.interoplateType=h.curve.figureInterpolateType(h.curve,h)),h.interoplateType){case n:var l=this.keyArray[c+0],p=this.keyArray[c+1],d=this.keyArray[c+2],f=this.keyArray[c+3];null==this.aQuat?this.resultQuat=this.bQuat:null==this.bQuat?this.resultQuat=this.aQuat:(this.aQuat.x=t.keys[l.id].value,this.aQuat.y=t.keys[p.id].value,this.aQuat.z=t.keys[d.id].value,this.aQuat.w=t.keys[f.id].value,this.bQuat.x=o.keys[l.id].value,this.bQuat.y=o.keys[p.id].value,this.bQuat.z=o.keys[d.id].value,this.bQuat.w=o.keys[f.id].value,this.resultQuat=this.resultQuat.slerp(this.aQuat,this.bQuat,u)),l.set(this.resultQuat.x),p.set(this.resultQuat.y),d.set(this.resultQuat.z),f.set(this.resultQuat.w),c+=3;break;case s:h.set(t.keys[h.id].value);break;case r:var y=(1-u)*t.keys[h.id].value+u*o.keys[h.id].value;-0===y&&(y=0),h.set(y);break;case i:console.log("Undefined")}}else h.set(t.keys[h.id].value);else h.set(o.keys[h.id].value)}},ensureTargetObjects:function(t){t.__defaults__=t.__defaults__||{};for(var e=0;e<this.keyArray.length;e++){var i=this.keyArray[e];if(null==i.target&&(i.target=i.curve.findTargetObject(t.handle),i.interoplateType=i.curve.figureInterpolateType(i.curve,i)),i.target&&!t.__defaults__.hasOwnProperty(i.id)){var n=new a(i.curve,i.target);if(i.curve.targetObject){if(!i.target[i.curve.targetObject])continue;n.value=i.target[i.curve.targetObject][i.curve.targetProperty]}else n.value=i.target[i.curve.targetProperty];t.__defaults__[n.id]=n}}this.targetObjectsSet=!0},applyKey:function(t){if(t.target){var e=t.target[t.curve.targetObject];if(e){var i=t.curve.targetProperty;t.curve.isMaterialPropertyCurve?(e=t.target[t.curve.targetObject].handle.parameters,t.curve.isVectorProperty?(e[i].data[t.curve.vectorPropertyIndex]=t.value,e[i].scopeId&&e[i].scopeId.versionObject.increment()):e[i].data=t.value):e[t.curve.targetProperty]=t.value}else t.target[t.curve.targetProperty]=t.value}},writeDefaults:function(t){if(t.__defaults__)for(var e in t.__defaults__){var i=t.__defaults__[e];this.applyKey(i)}},apply:function(t){this.targetObjectsSet||this.ensureTargetObjects(t);for(var e={},i=!1,n=0;n<this.keyArray.length;n++){var r=this.keyArray[n];r.dirty&&(r.dirty=!1,i=!0,r.target&&r.curve.targetObject&&!r.target[r.curve.targetObject]||(r.target&&r.target.OnDidApplyAnimationProperties&&(r.target._animatorGuid=r.target._animatorGuid||pc.guid.create(),e[r.target._animatorGuid]=r.target),this.applyKey(r)))}if(i)for(var s in e)e.hasOwnProperty(s)&&e[s].OnDidApplyAnimationProperties()}};var c=function(e,i,n,r,s,o,a){return this.time=e,this.value=i,this.inTangent=n,this.outTangent=r,this.leftConstant=o==t||7==s||71==s||103==s,this.rightConstant=a==t||97==s||101==s||103==s,this},h=function(t){this.id=pc.guid.create(),this.path=t.path,this.componentType=t.componentType,this.property=t.property,this.componentType&&0!=this.componentType.indexOf("UnityEngine.")&&(this.property=this.property.substring(0,1).toLowerCase()+this.property.substring(1));var i=this.property?this.property.split("."):[];if(this.property&&i.length>1?(this.targetObject=i[0],this.targetProperty=i[1]):(this.targetProperty=this.property,this.targetObject=null),this.keyId=this.path+":"+this.componentType+"."+this.property,this.componentType){this.isMaterialPropertyCurve=this.componentType.indexOf("Renderer")>=0&&"material"===this.targetObject;var n=this.property.split(".");this.isVectorProperty=n.length>2,this.isVectorProperty?(this.vectorPropertyIndex=o[n[n.length-1]],void 0===this.vectorPropertyIndex&&(this.vectorPropertyIndex=e[n[n.length-1]])):this.vectorPropertyIndex=null}if(t.keyframes)this.keys=t.keyframes;else if(t.keys_flow){var r=t.keys_flow;this.keys=[];for(var s=0;s<r.length;s+=7)this.keys.push(new c(r[s],r[s+1],r[s+2],r[s+3],r[s+4],r[s+5],r[s+6]))}else{if(this.keys=[],t.keys)for(s=0;s<t.keys.length;s++){r=t.keys[s];this.keys.push(new c(r[0],r[1],r[2],r[3],r[4],r[5],r[6]))}if(t.objectReferenceKeys)for(s=0;s<t.objectReferenceKeys.length;s++){r=t.objectReferenceKeys[s];this.keys.push(new c(r[0],r[1],r[2],r[3],r[4],r[5],r[6]))}this.objectCurve=!!t.objectReferenceKeys}};h.createLinear=function(t,e,i,n){return new h({keys:[[t,e,0,0],[i,n,0,0]]})},h.createEaseInOut=function(t,e,i,n){return new h(t==i?{keys:[[t,e,0,0]]}:{keys:[[t,e,0,0],[i,n,0,0]]})},pc.extend(h.prototype,{setValue:function(t,e){if(0==this.keys.length)return-1;t>=this.keys.length?this.keys[this.keys.length-1].value=e:this.keys[t].value=e},getValue:function(t){return 0==this.keys.length?-1:t>=this.keys.length?this.keys[this.keys.length-1].value:this.keys[t].value},findTargetObject:function(t){for(var e=this.path.split("/"),i=0;i<e.length&&null!=t;i++)e[i].length>0&&(t=t.findByNameImmediate(e[i]));if(null==t)return null;if("UnityEngine.GameObject"==this.componentType)return UnityEngine.Object.FromHandle(UnityEngine.GameObject,t);var n=Bridge._getTypeByName(this.componentType);return UnityEngine.Object.FromHandle(UnityEngine.GameObject,t).GetComponent(n)},figureInterpolateType:function(t,e){var i=e.curve.targetObject;return e.target&&null!=e.target[i]&&e.target[i].constructor===pc.Quat||"m_LocalRotation"==i?n:t.objectCurve?s:r},findKeyIndexAt:function(t){if(t<=this.keys[0].time)return 0;if(t>=this.keys[this.keys.length-1].time)return this.keys.length-2;for(var e=0;e<this.keys.length-1;e++)if(this.keys[e+1].time-t>1e-5)return e},sample:function(t,e){var i=t.keys[this.keyId];i||(i=new a(this,void 0),t.putKey(i)),i.set(this.value(e,i))},value:function(t,e){if(0==this.keys.length)return 0;if(1==this.keys.length)return this.keys[0].value;if(this.keys[this.keys.length-1].time-t<=1e-5)return e&&(e.idx=0),this.keys[this.keys.length-1].value;if(2==this.keys.length)keyframe0=this.keys[0],keyframe1=this.keys[1];else{e&&null!=e.idx&&(keyframe0=this.keys[e.idx],keyframe1=this.keys[e.idx+1],(keyframe0.time>t||keyframe1.time<t)&&(e.idx=null));var i=null;e?(null==e.idx&&(e.idx=this.findKeyIndexAt(t)),i=e.idx):i=this.findKeyIndexAt(t),keyframe0=this.keys[i],keyframe1=this.keys[i+1]}if(keyframe1.time-t<=1e-5)return e&&this.keys.length>e.idx&&e.idx++,keyframe1.value;if(null==keyframe0.outTangent||null==keyframe1.inTangent||t<keyframe0.time)return keyframe0.value;if(t>=keyframe1.time)return keyframe1.value;if(keyframe0.rightConstant||keyframe1.leftConstant||keyframe0.outTangent==1/0||keyframe1.inTangent==1/0)return keyframe0.value;var n=keyframe1.time-keyframe0.time,r=(t-keyframe0.time)/n;if(this.objectCurve)return r<keyframe1.value?keyframe0.value:keyframe1.value;var s=keyframe0.outTangent*n,o=keyframe1.inTangent*n,a=r*r,u=a*r,c=u-2*a+r,h=u-a,l=-2*u+3*a;return(2*u-3*a+1)*keyframe0.value+c*s+h*o+l*keyframe1.value},quantize:function(t){t=Math.max(t,2);for(var e=new Float32Array(t),i=1/(t-1),n=0;n<t;n++){var r=this.value(i*n);e[n]=r}return e},clone:function(){var t=new pc.AnimationCurve({path:this.path,componentType:this.componentType,property:this.property,keyframes:[]});return t.keys=pc.extend(t.keys,this.keys),t},_keysAt:function(t){if(1==this.keys.length)return this.keys;if(t>=this.keys[this.keys.length-1].time)return[this.keys[this.keys.length-1]];if(t<=this.keys[0].time)return[this.keys[0]];for(var e=0;e<this.keys.length;e++)if(this.keys[e].time>t)return[this.keys[e-1],this.keys[e]]}});var l=function(t,e,i,n,r){return this.curve1=t,this.curve2=e,this.a=i,this.b=n,this.c=r,this};pc.extend(l.prototype,{value:function(t){return null==this.curve1&&null==this.curve2?this.c:null==this.curve2?this.curve1.value(t)*this.a+this.c:null==this.curve1?this.curve2.value(t)*this.b+this.c:this.curve1.value(t)*this.a+this.curve2.value(t)*this.b+this.c},clone:function(){return new pc.AnimationCurveBlend(this.curve1,this.curve2,this.a,this.b,this.c)},quantize:function(t){t=Math.max(t,2);for(var e=new Float32Array(t),i=1/(t-1),n=0;n<t;n++){var r=this.value(i*n);e[n]=r}return e}});var p=function(t,e,i,n,r){return this.curve1=t,this.curve2=e,this.a=i,this.b=n,this.c=r,this};return pc.extend(p.prototype,{value:function(t){return null==this.curve1&&null==this.curve2?this.c:null==this.curve2?this.curve1.value(t)*this.a+this.c:null==this.curve1?this.curve2.value(t)*this.b+this.c:this.curve1.value(t)*this.a*this.curve2.value(t)*this.b+this.c},clone:function(){return new pc.AnimationCurveMultipliedBlend(this.curve1,this.curve2,this.a,this.b,this.c)},quantize:function(t){t=Math.max(t,2);for(var e=new Float32Array(t),i=1/(t-1),n=0;n<t;n++){var r=this.value(i*n);e[n]=r}return e}}),{AnimationCurve:h,AnimationCurveBlend:l,AnimationCurveMultipliedBlend:p,Keyframe:c,CurveSampler:u}}()),pc.extend(pc,function(){var t=["ALWAYS","FORWARDBASE","FORWARDADD","SHADOWCASTER","GRABPASS","Vertex","VertexLM"],e=["Background","Opaque","Transparent"],i=["zTest","zWrite","culling","blending","alphaBlending","colorWriteMask","offsetUnits","offsetFactor","stencilRef","stencilReadMask","stencilWriteMask","stencilOp","stencilOpFront","stencilOpBack"],n={vertex_position:pc.SEMANTIC_POSITION,vertex_normal:pc.SEMANTIC_NORMAL,vertex_tangent:pc.SEMANTIC_TANGENT,vertex_texCoord0:pc.SEMANTIC_TEXCOORD0,vertex_texCoord1:pc.SEMANTIC_TEXCOORD1,vertex_color:pc.SEMANTIC_COLOR,vertex_boneWeights:pc.SEMANTIC_BLENDWEIGHT,vertex_boneIndices:pc.SEMANTIC_BLENDINDICES,instancing_translation:pc.SEMANTIC_TEXCOORD5,instancing_rotation:pc.SEMANTIC_TEXCOORD6,instancing_scale:pc.SEMANTIC_TEXCOORD7,instancing_color:pc.SEMANTIC_ATTR0,instancing_st:pc.SEMANTIC_ATTR1,_glesVertex:pc.SEMANTIC_POSITION,_glesNormal:pc.SEMANTIC_NORMAL,_glesTangent:pc.SEMANTIC_TANGENT,_glesMultiTexCoord0:pc.SEMANTIC_TEXCOORD0,_glesMultiTexCoord1:pc.SEMANTIC_TEXCOORD1,_glesMultiTexCoord2:pc.SEMANTIC_TEXCOORD2,_glesMultiTexCoord3:pc.SEMANTIC_TEXCOORD3,_glesColor:pc.SEMANTIC_COLOR,_glesTANGENT:pc.SEMANTIC_TANGENT,in_POSITION0:pc.SEMANTIC_POSITION,in_NORMAL0:pc.SEMANTIC_NORMAL,in_TANGENT0:pc.SEMANTIC_TANGENT,in_TEXCOORD0:pc.SEMANTIC_TEXCOORD0,in_TEXCOORD1:pc.SEMANTIC_TEXCOORD1,in_TEXCOORD2:pc.SEMANTIC_TEXCOORD2,in_TEXCOORD3:pc.SEMANTIC_TEXCOORD3,in_COLOR0:pc.SEMANTIC_COLOR,_patched_POSITION:pc.SEMANTIC_POSITION,_patched_COLOR:pc.SEMANTIC_COLOR,_patched_NORMAL:pc.SEMANTIC_NORMAL,_patched_TANGENT:pc.SEMANTIC_TANGENT,_patched_TEXCOORD0:pc.SEMANTIC_TEXCOORD0},r=new pc.KeywordSet,s=function(t,e,i,n,r){this.graphicsDevice=t,this.keywords=new pc.KeywordSet,this.shader=null,this._particlesShader=null,this._skinnedShader=null,this._sourceShader=r,this.setupKeywords(e),this.setupShader(i,n)};pc.extend(s.prototype,{getShader:function(t){return t&pc.SHADERDEF_PARTICLES_INSTANCING?this.getParticlesShader():t&pc.SHADERDEF_SKIN?this.getSkinnedShader():this.shader},applyMissingShader:function(t){var e;e=t&pc.SHADERDEF_PARTICLES_INSTANCING?"_particlesShader":t&pc.SHADERDEF_SKIN?"_skinnedShader":"shader";var i=pc._createMissingShader(this._sourceShader.name,this._sourceShader.$id);return this[e]=i,i},getParticlesShader:function(){return null===this._particlesShader&&(this._particlesShader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:pc.ShaderPatches.patchParticlesVertexShader(this.shader.definition.vshader,n),fshader:this.shader.definition.fshader})),this._particlesShader},getSkinnedShader:function(){return null===this._skinnedShader&&(this._skinnedShader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:pc.ShaderPatches.patchSkinningVertexShader(this.shader.definition.vshader,n),fshader:this.shader.definition.fshader})),this._skinnedShader},setupKeywords:function(t){this.keywords.setEnabledKeywords(t)},setupShader:function(t,e){2===UnityEngine.LightmapSettings.lightmapEncodingQuality&&(e=pc.ShaderPatches.patchTexture2DLightmap(e)),this.shader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:t,fshader:e})}});var o=function(){this.lightMode=0,this.renderType=1,this.grabPassTextureName=null,this.graphicsDevice=null,this.shaders=[],this.boundParameters=[],this.sourceShader=null,this.passType=null,this.zTest=null,this.zWrite=null,this.culling=null,this.blending=null,this.alphaBlending=null,this.colorWriteMask=null,this.offsetUnits=null,this.offsetFactor=null,this.stencilRef=null,this.stencilReadMask=null,this.stencilWriteMask=null,this.stencilOp=null,this.stencilOpFrontstencilOpBack=null,this.tags=null,this.variants=null};pc.extend(o.prototype,{setupTags:function(){for(var t=0;t<this.tags.length;t++){var e=this.tags[t];"LIGHTMODE"===e.name&&("FORWARDBASE"===e.value&&(this.lightMode=1),"FORWARDADD"===e.value&&(this.lightMode=2),"SHADOWCASTER"===e.value&&(this.lightMode=3),"Vertex"===e.value&&(this.lightMode=5),"VertexLM"===e.value&&(this.lightMode=6)),"GRABPASS"===e.name&&(this.lightMode=4),"GRABPASS_TEXTURE_NAME"===e.name&&(this.grabPassTextureName=e.value),"RENDERTYPE"===e.name&&"Background"===e.value&&(this.renderType=0)}},getVariant:function(t){for(var e=null,i=0;i<this.variants.length;i++){var n=this.variants[i];pc.KeywordSet.intersection(t,n.keywords,r),r.cardinality===n.keywords.cardinality&&(null===e||e.keywords.cardinality<r.cardinality)&&(e=n)}return e},setupVariants:function(){for(var t=new Array(this.variants.length),e=0;e<this.variants.length;e++){var i=this.variants[e],n=ShaderProgramsLibrary[i.vertexProgram],r=ShaderProgramsLibrary[i.fragmentProgram];t[e]=new s(this.graphicsDevice,i.keywords,n,r,this.sourceShader)}this.variants=t},updateRenderState:function(t){for(var e=0;e<this.boundParameters.length;e++){var i=t.parameters[this.boundParameters[e].name];i&&i.data?this.boundParameters[e].val=i.data:this.boundParameters[e].val=0}},setupRenderSettings:function(){for(var t=0;t<i.length;t++)this._collectBoundParameters(this[i[t]],this.boundParameters)},_collectBoundParameters:function(t,e){if(t)if("Luna.Unity.DTO.UnityEngine.Assets.Shader.Pass+Value"===t.$$fullname&&t.name)e.push(t);else for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];n&&n.$$fullname&&this._collectBoundParameters(n,e)}},applyMissingVariant:function(t){var e=pc.Application.getApplication().graphicsDevice,i=pc._createMissingShader(this.sourceShader.name,this.sourceShader.$id),n=new s(e,t,i.definition.vshader,i.definition.fshader,this.sourceShader);return n.shader=i,this.variants.push(n),n}});var a=function(t){this.graphicsDevice=t,this.name=null,this.passes=[],this.defaultParameterValues=[],this.defaultParameters={},this.lightModes=[[],[],[],[],[],[],[]],this.supportedKeywords=new pc.KeywordSet};a.globalKeywords=new pc.KeywordSet,a.globalUniforms={};var u=function(){this.value=null,this.scopeId=null};return a.setGlobalUniform=function(t,e){this.globalUniforms[t]=this.globalUniforms[t]||new u,this.globalUniforms[t].value=e},a.enableKeyword=function(t){this.globalKeywords.enableKeyword(t)},a.disableKeyword=function(t){this.globalKeywords.disableKeyword(t)},a.getEnabledKeywords=function(){return this.globalKeywords.getEnabledKeywords()},pc.extend(a.prototype,{setup:function(){this.setupPasses(),this.setupDefaultParameters()},setupPasses:function(){for(var t=0;t<this.passes.length;t++){var e=this.passes[t];e.graphicsDevice=this.graphicsDevice,e.sourceShader=this,e.setupTags(),e.setupVariants(),e.setupRenderSettings(),this.lightModes[e.lightMode].push(e);for(var i=0;i<e.variants.length;i++){var n=e.variants[i];this.supportedKeywords.merge(n.keywords)}}},setupDefaultParameters:function(){this.defaultParameterNames={};for(var t=0;t<this.defaultParameterValues.length;t++){var e=this.defaultParameterValues[t];switch(this.defaultParameterNames[e.name]=!0,e.type){case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Vector:case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Color:this.defaultParameters[e.name]=e.value.data;break;case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Scalar:this.defaultParameters[e.name]=e.value.x;break;case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Texture:var i=UnityEngine.Texture2D[e.textureValue+"Texture"];this.defaultParameters[e.name]=i?i.handle:null}}},supportsKeyword:function(t){return this.supportedKeywords.isKeywordEnabled(t)}}),{UnityShader:a,UnityShaderPass:o,LIGHT_MODE_NAMES:t,SHADER_PASS_ALWAYS:0,SHADER_PASS_FORWARD_BASE:1,SHADER_PASS_FORWARD_ADD:2,SHADER_PASS_SHADOW_CASTER:3,SHADER_PASS_GRAB_PASS:4,SHADER_PASS_VERTEX:5,SHADER_PASS_VERTEX_LM:6,RENDER_TYPE_BACKGROUND:0,RENDER_TYPE_OPAQUE:1,RENDER_TYPE_TRANSPARENT:2,RENDER_TYPE_NAMES:e}}()),pc.extend(pc,function(){var t=function(){pc.Material.prototype.constructor.apply(this),this.keywords=new pc.KeywordSet,this.drawOrder=0,this.renderQueue=0,this.enableInstancing=!1};return pc.extend(t.prototype,{getPass:function(t,e){if((e=e||[]).length=0,!this._shader)return e;for(var i=0;i<this._shader.passes.length;i++){var n=this._shader.passes[i];n.lightMode===t&&e.push(n)}return e},setPass:function(t){if(this._shader){var e=this._shader.passes.length;if(t<0||t>e)console.log("Shader pass out of range setup attempt.");else{var i=this._shader.passes[t];UnityEngine.GL.SetPassMaterial=this["__UnityEngine.Material"],pc.Application.getApplication().renderer.setPass(this,i)}}else console.log("Missing shader.")},setParametersFromShaderDefaults:function(){if(this.shader){var t=this.shader.defaultParameters;for(var e in t)this.setParameter(e,this.cloneParameterData(t[e])),t[e]instanceof pc.Texture&&this.setParameter(e+"_ST",this.cloneParameterData([1,1,0,0]))}},setup:function(){for(var t=0;t<this.floatParameters.length;t++)this.setParameter(this.floatParameters[t].name,this.floatParameters[t].value);for(t=0;t<this.colorParameters.length;t++)this.setParameter(this.colorParameters[t].name,this.colorParameters[t].value.data);for(t=0;t<this.vectorParameters.length;t++)this.setParameter(this.vectorParameters[t].name,this.vectorParameters[t].value.data);for(t=0;t<this.textureParameters.length;t++){var e=this.textureParameters[t].value;this.setParameter(this.textureParameters[t].name,e?e.handle:null)}var i=[];for(t=0;t<this.materialFlags.length;t++){var n=this.materialFlags[t];n.enabled&&i.push(n.name)}this.shaderKeywords=i},deleteParameter:function(t){pc.Material.prototype.deleteParameter.call(this,t);var e=this._shader.defaultParameters[t];e&&this.setParameter(t,e)},setParameter:function(t,e){if(pc.Material.prototype.setParameter.call(this,t,e),null===e&&this._shader){var i=this._shader.defaultParameters[t];i&&this.setParameter(t,i)}else e instanceof pc.Texture&&!e.device.webgl2&&(e._pot||0!==e._addressU||0!==e._addressV||console.warn("Material's '"+this.name+"' texture '"+e.name+"' wrap mode is set to 'Repeat', but it's resolution NOT POWER OF TWO (NPOT)\nOnly textures with Power Of Two (POT) resolution can be used with WrapMode=Repeat"))},getParameter:function(t){return pc.Material.prototype.getParameter.call(this,t)},getMainTexture:function(){var t=this.getParameter("_MainTex");return t?t.data:null},setMainTexture:function(t){this.setParameter("_MainTex",t)},clone:function(){var t=new pc.UnityMaterial;return t.name=this.name,t._shader=this._shader,t.copyPropertiesFromMaterial(this),t},hasProperty:function(t){return this.parameters.hasOwnProperty(t)||this.shader.defaultParameterNames.hasOwnProperty(t)},copyPropertiesFromMaterial:function(t){for(var e in this.renderQueue=t.renderQueue,this.enableInstancing=t.enableInstancing,this.keywords.copy(t.keywords),this.$id=t.$id,t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))},cloneParameterData:function(t){return t instanceof Float32Array||t instanceof Array?new Float32Array(t):t}}),Object.defineProperty(t.prototype,"shaderKeywords",{get:function(){return this.keywords.getEnabledKeywords()},set:function(t){this.keywords.setEnabledKeywords(t)}}),Object.defineProperty(t.prototype,"passCount",{get:function(){return this._shader.passes.length}}),Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},set:function(t){this._shader&&this._shader._refCount--,this._shader=t,t&&t._refCount++}}),{UnityMaterial:t}}()),pc.extend(pc,function(){var t=function(){this.parameters={},this.parametersCount=0};return pc.extend(t.prototype,{copyFromMeshInstance:function(t){for(var e in t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))},applyToMeshInstance:function(t){for(var e in t.parameters={},this.parameters)t.setParameter(e,this.cloneParameterData(this.parameters[e].data))},getParameter:function(t){var e=this.parameters[t];return e?this.cloneAsPlainArray(e.data):null},setParameter:function(t,e){this.parameters.hasOwnProperty(t)||this.parametersCount++,pc.Material.prototype.setParameter.call(this,t,this.cloneParameterData(e))},clear:function(){this.parameters={},this.parametersCount=0},cloneParameterData:function(t){return t instanceof Float32Array||t instanceof Array?new Float32Array(t):t},cloneAsPlainArray:function(t){return t instanceof Float32Array?Array.prototype.slice.call(t):t}}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.parametersCount}}),{UnityMaterialPropertyBlock:t}}()),Bridge.assembly("LunaUnity",(function(t,e){"use strict";var i={};Bridge.define("LunaUnity.Objects.Bundle",{statics:{configure:function(t,e){this.objectSpace=t.objectSpace,this.network=t.network,this.bundles=e,this.handlers={game_object:new LunaUnity.Objects.Handlers.GameObject(t),audio_mixer:new LunaUnity.Objects.Handlers.AudioMixer(t),audio_mixer_snapshot:new LunaUnity.Objects.Handlers.AudioMixerSnapshot(t),project_settings:new LunaUnity.Objects.Handlers.ProjectSettings(t),material:new LunaUnity.Objects.Handlers.Material(t),physic_material:new LunaUnity.Objects.Handlers.PhysicMaterial(t),physics_material_2d:new LunaUnity.Objects.Handlers.PhysicsMaterial2D(t),mesh:new LunaUnity.Objects.Handlers.Mesh(t),scene:new LunaUnity.Objects.Handlers.Scene(t),shader:new LunaUnity.Objects.Handlers.Shader(t),video:new LunaUnity.Objects.Handlers.Video(t),sound:new LunaUnity.Objects.Handlers.Sound(t),sprite:new LunaUnity.Objects.Handlers.Sprite(t),texture:new LunaUnity.Objects.Handlers.Texture(t),cubemap:new LunaUnity.Objects.Handlers.Cubemap(t),animation_clip:new LunaUnity.Objects.Handlers.AnimationClip(t),blend_tree:new LunaUnity.Objects.Handlers.BlendTree(t),animator_controller:new LunaUnity.Objects.Handlers.AnimatorController(t),font:new LunaUnity.Objects.Handlers.Font(t),resources:new LunaUnity.Objects.Handlers.Resources(t),scriptable_object:new LunaUnity.Objects.Handlers.ScriptableObject(t),text_asset:new LunaUnity.Objects.Handlers.TextAsset(t),prefab_component:new LunaUnity.Objects.Handlers.PrefabComponent(t)}},tickResource:function(){this._resources=this._resources||0,this._resources++},loadAsync:function(t){return this.new(t)._loadAsync()},loadByNameAsync:function(t){for(var e=Object.keys(this.bundles),i=0;i<e.length;i++){if(this.bundles[e[i]].name===t)return this.loadAsync(e[i])}throw new System.FileNotFoundException},releaseByNameAsync:function(t){for(var e=Object.keys(this.bundles),i=0;i<e.length;i++){var n=this.bundles[e[i]];if(n.name===t){var r=this._bundles[n.id];return r&&r._releaseBundleAndDependencies(),!0}}return!1},new:function(t){var e=this.bundles[t];return this._bundles=this._bundles||{},this._bundles[t]=this._bundles[t]||new LunaUnity.Objects.Bundle({manifest:e,objectSpace:this.objectSpace,network:this.network}),this._bundles[t]}},ctor:function(t){this.$initialize(),this.objectSpace=t.objectSpace,this.manifest=t.manifest,this.network=t.network,this.namesToId=i,this.refCount=0},_collectDependencies:function(t,e){var i=[];if(!t[e]){t[e]=!0,i.push(e);for(var n=LunaUnity.Objects.Bundle.bundles[e].dependencies,r=0;r<n.length;r++)i=i.concat(this._collectDependencies(t,n[r]))}return i},_retain:function(){this.refCount++},_release:function(){if(this.refCount--,!(this.refCount>0)){LunaUnity.Objects.Bundle._bundles[this.manifest.id]=null,console.log("Bundle "+this.manifest.name+" got refcount reduced to 0 and is about to free resources");var t=[{handler:"project_settings",json:"project-settings"},{handler:"texture",json:"textures"},{handler:"shader",json:"shaders"},{handler:"mesh",json:"meshes"},{handler:"video",json:"videos"},{handler:"sound",json:"sounds"},{handler:"animation_clip",json:"animation-clips"},{handler:"blend_tree",json:"blend-trees"},{handler:"text_asset",json:"text-assets"},{handler:"audio_mixer",json:"audio-mixers"},{handler:"physic_material",json:"physic-materials"},{handler:"physics_material_2d",json:"physics-materials-2d"},{handler:"audio_mixer_snapshot",json:"audio-mixer-snapshots"},{handler:"cubemap",json:"cubemaps"},{handler:"material",json:"materials"},{handler:"sprite",json:"sprites"},{handler:"font",json:"fonts"},{handler:"animator_controller",json:"animator-controllers"},{handler:"resources",json:"resources"},{handler:"scene",json:"scenes"},{handler:"scriptable_object",json:"scriptable-objects"},{handler:"game_object",json:"prefabs"}],e=this.json["scriptable-objects"];if(e)for(let t=0;t<e.length;t++){let i=this.objectSpace.registry.Get(e[t].id);i.CallOnDisable(),i.CallOnDestroy()}for(var i=0;i<t.length;i++){var n=LunaUnity.Objects.Bundle.handlers[t[i].handler],r=this.json[t[i].json];if(r)for(var s=0;s<r.length;s++)n.unloadAsync(r[s])}this.json=null}},_retainBundleAndDependencies:function(){for(var t=this._collectDependencies({},this.manifest.id),e=0;e<t.length;e++){LunaUnity.Objects.Bundle.new(t[e])._retain()}},_releaseBundleAndDependencies:function(){for(var t=this._collectDependencies({},this.manifest.id),e=0;e<t.length;e++){LunaUnity.Objects.Bundle.new(t[e])._release()}},_loadAsync:function(){if(this._retainBundleAndDependencies(),this.loadCompletionSource)return this.loadCompletionSource.task;this.loadCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.loadCompletionSource.task.setSynchronous(!0);for(var t=this._collectDependencies({},this.manifest.id),e=[],i=[],n=new LunaUnity.Objects.Request,r=0;r<t.length;r++){var s=LunaUnity.Objects.Bundle.new(t[r]);i.push(s),e.push(s._downloadBundleDataAsync(),s._downloadBlobDataAsync())}return System.Threading.Tasks.Task.whenAll(e).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cBundle chain loaded successfully","background-color: black; color: white; padding: 1em;"),this._loadSimpleAssetsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cSimple assets loaded successfully","background-color: black; color: white; padding: 1em;"),this._loadComplexAssetsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cComplex assets loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this._loadPrefabsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cPrefabs loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this._loadScenesAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cScenes loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this.loadCompletionSource.setResult(this)})))})))})))})))}))),this.loadCompletionSource.task},_downloadBlobDataAsync:function(){return this.downloadBlobCompletionSource?this.downloadBlobCompletionSource.task:(this.downloadBlobCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.network.GetBlobAsync("assets/bundles/"+this.manifest.id+"/data.blob").continueWith(Bridge.fn.bind(this,(function(t){this.blob=t.result,this.downloadBlobCompletionSource.setResult(this),LunaUnity.Objects.Bundle.tickResource()}))),this.downloadBlobCompletionSource.task)},_downloadBundleDataAsync:function(t){return this.downloadCompletionSource?this.downloadCompletionSource.task:(this.downloadCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.network.GetJsonAsync("assets/bundles/"+this.manifest.id+"/bundle.json").continueWith(Bridge.fn.bind(this,(function(t){this.json=t.result,this.downloadCompletionSource.setResult(this),LunaUnity.Objects.Bundle.tickResource()}))),this.downloadCompletionSource.task)},_loadSimpleAssetsAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"project_settings",json:"project-settings"},{handler:"texture",json:"textures"},{handler:"shader",json:"shaders"},{handler:"mesh",json:"meshes"},{handler:"video",json:"videos"},{handler:"sound",json:"sounds"},{handler:"animation_clip",json:"animation-clips"},{handler:"blend_tree",json:"blend-trees"},{handler:"text_asset",json:"text-assets"},{handler:"audio_mixer",json:"audio-mixers"},{handler:"physic_material",json:"physic-materials"},{handler:"physics_material_2d",json:"physics-materials-2d"},{handler:"audio_mixer_snapshot",json:"audio-mixer-snapshots"}])},_loadComplexAssetsAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"cubemap",json:"cubemaps"},{handler:"material",json:"materials"},{handler:"sprite",json:"sprites"},{handler:"font",json:"fonts"},{handler:"animator_controller",json:"animator-controllers"}])},_loadPrefabsAsync:function(t,e){for(var i=[],n=[],r={},s=0;s<e.length;s++){var o=e[s];r[o.manifest.id]=o,o._guardAssetType("prefabs",(function(){i=i.concat(o.json.prefabs||[])})),o._guardAssetType("scriptable-objects",(function(){n=n.concat(o.json["scriptable-objects"]||[])}))}var a=LunaUnity.Objects.Bundle.handlers.game_object,u=LunaUnity.Objects.Bundle.handlers.scriptable_object,c=LunaUnity.Objects.Bundle.handlers.project_settings,h=LunaUnity.Application.Instance.app.systems.list;for(s=0;s<h.length;s++){h[s].creatingPrefabs=!0}for(s=0;s<i.length;s++)a.loadAsync(t,i[s],e,c.autoInstantiatePrefabs).result;for(s=0;s<h.length;s++){h[s].creatingPrefabs=!1}let l=[];for(s=0;s<n.length;s++){var p=u.loadAsync(t,n[s]).result;l.push(p)}for(s=0;s<l.length;s++){var d=l[s];d.CallAwake&&d.CallAwake(),d.CallOnEnable&&d.CallOnEnable()}return System.Threading.Tasks.Task.fromResult(!0)},_loadScenesAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"resources",json:"resources"},{handler:"scene",json:"scenes"}],!0)},_loadAssetsFromBundlesAsync:function(t,e,i,n){for(var r=[],s={},o=0;o<i.length;o++){for(var a=i[o].handler,u=i[o].json,c=LunaUnity.Objects.Bundle.handlers[a],h=[],l=0;l<e.length;l++){var p=e[l];s[p.manifest.id]=p,p._guardAssetType(u,(function(){h=h.concat(p.json[u]||[])}))}for(var d=0;d<h.length;d++){var f=h[d];window.playgroundBundlesOverrides&&(f=window.playgroundBundlesOverrides[f.id]||f);var y=c.loadAsync(t,f,e);"texture"!==a&&"sound"!==a&&"video"!==a||(r.push(y),y.continueWith((function(){LunaUnity.Objects.Bundle.tickResource()}))),s[f.assetBundleId].namesToId[(f.name||"").toLowerCase()]=h[d].id||f.$id}}return System.Threading.Tasks.Task.whenAll(r)},_remove:function(){console.warn("Requested removal of asset bundle id = "+this.manifest.id+" - this is no-op for now")},_guardAssetType:function(t,e){this._guardAssetTypes=this._guardAssetTypes||{},this._guardAssetTypes[t]||e(),this._guardAssetTypes[t]=!0}})})),pc.extend(pc,function(){var t=new Uint8Array([0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1]),e=new pc.Vec3(1,1,-1),i=new pc.Vec3(1,-1,-1),n=(new Uint8Array(4),null),r=null,s=function(t){this.app=t,this.indirectSpecular=new pc.Color(.4465786,.4964123,.5748172,1),this.meshInstances=[]};return pc.extend(s.prototype,{install:function(e){var i=new pc.GraphNode;i.cullingLayer=-1;var n=pc.createSphere(UnityEngine.Graphics.graphicsDevice,{radius:1,latitudeBands:64,longitudeBands:32}),r=new pc.MeshInstance(i,n,new pc.Material);r.cull=!1,r._noDepthDrawGl1=!0,r._shaderDefs=pc.SHADERDEF_RENDERTYPE_BACKGROUND,(new pc.Model).meshInstances=[r],i._sync(),this.meshInstance=r,this.meshInstances.push(r),this.matrix_projection=new pc.Mat4,this.matrix_view=new pc.Mat4,this.matrix_viewProjection=new pc.Mat4,this.sunPosition=new pc.Vec3,this.blackCube=new pc.Texture(UnityEngine.Graphics.graphicsDevice,{cubemap:!0,rgbm:!1,width:2,height:2}),this.blackCube._levels[0]=[t,t,t,t,t,t],this.environmentCubemap=this.blackCube,e.addRenderer(this)},getMeshInstancesForRender:function(){return this.meshInstances},setSkyboxEnabled:function(t){this.meshInstance.cull=!t},update:function(){var t=UnityEngine.RenderSettings._skybox;if(!t||!t.handle)return this.indirectSpecular.set(0,0,0,1),void(this.meshInstance.visible=!1);this.meshInstance.material=t.handle,this.meshInstance.visible=!0,this.app.systems.reflectionprobe.scheduleProbeUpdate(),this.app.scene.root&&this.app.scene.root._dirtifyWorld()},updateSkyDrawCall:function(t,n){this.matrix_view.setTRS(pc.Vec3.ZERO,t._node.getRotation(),n?i:e).invert(),t._projection===pc.PROJECTION_PERSPECTIVE?this.matrix_projection.setPerspective(t._fov,t._aspect,.01,1,t._horizontalFov):this.matrix_projection.setPerspective(90,t._aspect,.01,1,t._horizontalFov),this.matrix_viewProjection.mul2(this.matrix_projection,this.matrix_view),this.meshInstance.setParameter(this.app.renderer.unityIds.viewProjId.name,this.matrix_viewProjection.data);var r=UnityEngine.RenderSettings.sun;if(r)r=r.handle;else for(var s=this.app.systems.light.store,o=Object.keys(s),a=0;a<o.length;a++){var u=s[o[a]];if(u.data.enabled&&u.entity.enabled&&"directional"===u.data.type){r=u.data.light;break}}var c=r?r._node?r._node:r.entity:null;r&&c&&c.enabled?(this.meshInstance.setParameter("_LightColor0",r._color.data),this.sunPosition.set(0,0,-1),c.getWorldTransform().transformVector(this.sunPosition,this.sunPosition),this.meshInstance.setParameter("_WorldSpaceLightPos0",[this.sunPosition.x,this.sunPosition.y,this.sunPosition.z,0])):(this.meshInstance.setParameter("_LightColor0",[0,0,0,0]),this.meshInstance.setParameter("_WorldSpaceLightPos0",[0,0,0,0]))},getSkyDrawCall:function(t){return this.meshInstance},bakeEnvironmentReflections:function(){var t=UnityEngine.RenderSettings._defaultReflectionResolution||128;switch(UnityEngine.RenderSettings.defaultReflectionMode){case UnityEngine.Rendering.DefaultReflectionMode.Skybox:this.environmentCubemap=this.bakeToCubemap(t,this._environmentCubemap);break;case UnityEngine.Rendering.DefaultReflectionMode.Custom:var e=UnityEngine.RenderSettings.customReflection;this.environmentCubemap=(e?e.handle:null)||this.blackCube}this.updateReflectionIntensity(),this.computeIndirectSpecular(),UnityEngine.RenderSettings._defaultReflectionMode===UnityEngine.Rendering.DefaultReflectionMode.Skybox&&(UnityEngine.LightmapSettings.reflectionProbes.environmentProbe.cubemap=this.environmentCubemap)},updateReflectionIntensity:function(){this.environmentCubemap.intensity=UnityEngine.RenderSettings._reflectionIntensity},computeIndirectSpecular:function(){if(this.environmentCubemap&&this.environmentCubemap!==this.blackCube){this.indirectSpecular.set(0,0,0,1);var t=this.app.graphicsDevice,e=(t.gl,Math.log(this.environmentCubemap.width)/Math.log(2)|0),i=t.activeFramebuffer;if(!n){var s=new pc.Texture(t,{mipmaps:!1,width:1,height:1,format:pc.PIXELFORMAT_R8_G8_B8_A8});n=new pc.RenderTarget(t,s,{depth:!1})}r||(r=pc.shaderChunks.createShaderFromCode(t,pc.shaderChunks.convolveLastMipOfCubemapVS,pc.shaderChunks.convolveLastMipOfCubemapPS,"convolveLastMipOfCubemap")),t.scope.resolve("_Cubemap_").setValue(this.environmentCubemap),t.scope.resolve("_Level_").setValue(e),pc.drawQuadWithShader(t,n,r);var o=n._colorBuffer.toBuffer();this.indirectSpecular.set(o[0],o[1],o[2],255).scale(1/255),t.setFramebuffer(i)}},bakeEnvironmentLighting:function(){UnityEngine.RenderSettings.ambientMode===UnityEngine.Rendering.AmbientMode.Skybox&&(this.update(),this.meshInstance.visible?(this.lightingCubemap=this.bakeToCubemap(8,null),this.lightingCubemap.sync(0)):this.lightingCubemap=null)},bakeToCubemap:function(t,e){var i=this.app.graphicsDevice,n=new pc.Entity,r=n.addComponent("camera",{projection:pc.PROJECTION_ORTHOGRAPHIC,aspectRatio:1,orthoHeight:1});UnityEngine.RenderTexture.Create(t,t,8,0);if((e=e||new pc.Texture(i,{cubemap:!0,rgbm:!1}))._width=e._height=t,!this.meshInstance.visible)return e;for(var s=[[0,90,0],[0,-90,0],[-90,0,0],[90,0,0],[0,0,0],[0,180,0]],o=0;o<6;o++)n.setLocalEulerAngles.apply(n,s[o]),n._sync(),this.updateSkyDrawCall(r.camera,!0),r.renderTarget=new pc.RenderTarget({colorBuffer:e,face:o,depth:!1}),this.app.renderer.setCamera(r.camera,r.renderTarget,!0),this.app.renderer.renderMeshInstance(new pc.KeywordSet,null,r.camera,this.meshInstance,[[],[],[]]);return i.gl.generateMipmap(e._glTarget),e.markUploaded(),e}}),{Skybox:s}}()),pc.extend(pc,function(){var t={x:0,y:0,width:1,height:1},e=new pc.KeywordSet,i=new pc.Mat4,n=new pc.GraphNode;n.name="CommandBufferDrawCall";var r=null;return{Graphics:{executeCommandBuffer:function(s){if(s){var o=pc.Application.getApplication().renderer,a=o.device,u=s.renderTargetIdentifier.target["__UnityEngine.RenderTexture"].renderTarget;a.setRenderTarget(u),a.updateBegin(),a.setColorWrite(!0,!0,!0,!0),a.setDepthWrite(!0),o.setupViewport(t,u.width,u.height),s.view&&s.proj?i.mul2(s.proj,s.view):i.copy(UnityEngine.GL.matrix),o.viewProjId.setValue(i.data),o.unityIds.viewProjId.setValue(i.data);var c=s.clearCommand;c&&u&&o.clearTarget(u,c);for(var h=0;h<s.commands.length;h++)for(var l=s.commands[h],p=l.mesh,d=-1===l.submeshIndex?p.subMeshes:[p.subMeshes[l.submeshIndex]],f=0;f<d.length;f++){var y=d[f];n.worldTransform=l.matrix,r?(r.node=n,r.mesh=y,r.materiall=l.material):r=new pc.MeshInstance(n,y,l.material);var m=l.materialPropertyBlock;m&&m.applyToMeshInstance(r),o.renderMeshInstance(e,null,null,r,null)}}}}}}()),pc.extend(pc,function(){var t=function(t,e,i,n,r,s){this.mesh=t,this.matrix=e,this.material=i,this.submeshIndex=n,this.shaderPass=r,this.materialPropertyBlock=s},e=function(){this.device=pc.Application.getApplication().graphicsDevice,this._name="",this.commands=[],this.renderTargetIdentifier=null,this.clearCommand=null,this.view=null,this.proj=null};return pc.extend(e.prototype,{clear:function(){this.commands.length=0,this.renderTargetIdentifier=null,this.clearCommand=null},clearRenderTarget:function(t,e,i){var n=0;t&&(n|=pc.CLEARFLAG_DEPTH),e&&(n|=pc.CLEARFLAG_COLOR),this.clearCommand={color:i.data,depth:1,flags:n}},setRenderTarget:function(t){this.renderTargetIdentifier=t},drawMesh:function(e,i,n,r,s,o){var a=new t(e||null,i||pc.Mat4.IDENTITY.clone(),n||null,r||-1,s||-1,o||null);this.commands.push(a)},setViewMatrix:function(t){this.view=t},setProjectionMatrix:function(t){this.proj=t}}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t}}),{CommandBuffer:e}}()),pc.extend(pc,function(){var t=function(){this._name=""};return pc.extend(t.prototype,{copyFromMeshInstance:function(t){for(var e in t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))}}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t}}),{RenderTargetIdentifier:t}}()),Bridge.assembly("LunaUnity",(function(t,e){"use strict";Bridge.define("LunaUnity.Objects.Scene",{ctor:function(){this.$initialize(),this.isLoaded=!1,this.index=-1,this.name=null,this.template=null,this.root=null,this.lightmapsOffset=-1},initializeAsTemplate:function(t){return this.rootJsons=t.rootJsons,this.renderSettings=t.renderSettings,this.name=t.name,this.index=t.index,this.lightmaps=t.lightmaps,this},_createRoot:function(){this.root=new pc.Entity,this.root.scene=this,this.root.name="SceneRoot: "+this.name,this.application.app.root.addChild(this.root)},initializeAsDontDestroyOnLoad:function(){this.name="DontDestroyOnLoad",this.application=window.$application,this.isLoaded=!0,this._createRoot()},isValid:function(){return!0},_load:function(t){return this.application=t,this.isLoaded=!0,this._createRoot(),UnityEngine.LightmapSettings.reflectionProbes||(UnityEngine.LightmapSettings.reflectionProbes=new UnityEngine.ReflectionProbes),this._installLightProbes(),this._installLightmaps(),1===UnityEngine.SceneManagement.SceneManager.sceneCount&&(window.$scene=this,this._applyRenderSettings(),this._updateEnvironmentLighting()),this.disableCallbacks(),this._loadObjects(),this.invokeCallbacks(this.root),this.root.syncHierarchy(),System.Threading.Tasks.Task.fromResult(!0)},loadAsync:function(){return this._load(window.$application)},unload:function(){this._unload()},_unload:function(){let t=this.root.children.slice();for(let e=0;e<t.length;e++)new pc.DestroyEntityTask(t[e],0).execute();this.root.destroy(),this.root=null,this.isLoaded=!1,this._uninstallLightProbes()},findChild:function(t,e){if(e.id==t)return e;var i=null;for(let n=0;n<e.children.length&&!(i=this.findChild(t,e.children[n]));n++);return i},_instantiate:function(t,e,i,n){this.application.app;var r,s=LunaUnity.Objects.Bundle.handlers.game_object.fork(),o=new LunaUnity.Objects.Request;o.root=n||this.root;var a=pc.Vec3.ONE,u=!0;if(t.handle&&!t.handle.isPrefab){var c=t.gameObject.handle.$id;e.handle.$id==c?r=e.handle.objectJson:(e=e.handle.objectJson,r=this.findChild(c,e)),a=(e=t.handle).localScale}else if(e.isPrefabProxy)r=e.prefab||s.registry.Get(e.prefabId).prefab;else if(r=(e=e.handle).objectJson,a=e.localScale,u=e._enabled,!r)throw new Error("Unable to instantiate a non-prefab object");this.disableCallbacks();var h=s.loadAsync(o,r).result;h.isPrefab=!1,h.name=(e.name||h.name)+"(Clone)",h.enabled=u,o.resolveReferences(s.registry),i&&(h.setLocalTransform(i),h.setLocalScale(a)),this.invokeCallbacks(h);var l=s.registry.Get(e.isPrefabProxy?e.componentId||r.id:t.handle.$id);if(l.code)return l.code;if(e.isPrefabProxy)return UnityEngine.Object.FromHandle(t,l);if(Bridge.Reflection.isAssignableFrom(UnityEngine.Transform,Bridge.getType(t)))return UnityEngine.Object.FromHandle(UnityEngine.GameObject,l).gettransform();if("GameObject"==Bridge.Reflection.getTypeName(Bridge.getType(t)))return UnityEngine.Object.FromHandle(UnityEngine.GameObject,l);throw new Error("Don't know what should be instantiated")},_locatePrefabAsync:function(t,e){var i=LunaUnity.Objects.Bundle.loadByNameAsync(t),n=new System.Threading.Tasks.TaskCompletionSource;return i.continueWith(Bridge.fn.bind(this,(function(t){var i=t.result.json.prefabs.find(t=>t.data[0]===e).id,r=LunaUnity.Objects.Bundle.handlers.game_object.objectSpace.registry,s=UnityEngine.Object.FromHandle(UnityEngine.GameObject,r.Get(i));n.setResult(s)}))),n.task},_releaseBundleAsync:function(t){LunaUnity.Objects.Bundle.releaseByNameAsync(t)},_applyRenderSettings:function(){var t=this.application.app,e=this.application.objectSpace.getRegistry(),i=UnityEngine.RenderSettings,n=this.renderSettings;t.scene.ambientLight=(new pc.Color).copy(n.ambientLight),i._ambientMode=n.ambientMode,i._pixelLightCount=n.pixelLightCount,i._ambientLight=n.ambientLight.clone(),i._ambientSkyColor=n.ambientSkyColor.clone(),i._ambientEquatorColor=n.ambientEquatorColor.clone(),i._ambientGroundColor=n.ambientGroundColor.clone(),i._ambientIntensity=n.ambientIntensity,i._reflectionIntensity=n.reflectionIntensity,i._defaultReflectionMode=n.defaultReflectionMode,i._defaultReflectionResolution=n.defaultReflectionResolution,i._sun=UnityEngine.Object.FromHandle(UnityEngine.Light,e.TryGet(n.sunLightObjectId)),i._skybox=n.skybox,i.fogDensity=n.fogDensity,i.fogColor=n.fogColor.clone(),i.fogStart=n.fogStart,i.fogEnd=n.fogEnd,i.fogMode=n.fogMode,i.fog=n.fog,i.hasLightDataAsset=n.hasLightDataAsset,i.hasManualGenerate=n.hasManualGenerate,i.ambientProbe.clear(),this._installSkybox(),i._customReflection=n.customReflection},_updateEnvironmentLighting:function(){var t=UnityEngine.RenderSettings,e=this.application.app;e.scene.skyboxHelper.update(),e.scene.skyboxHelper.environmentCubemap||t.defaultReflectionMode!==UnityEngine.Rendering.DefaultReflectionMode.Skybox&&t.defaultReflectionMode!==UnityEngine.Rendering.DefaultReflectionMode.Custom?(e.scene.skyboxHelper.computeIndirectSpecular(),e.scene.skyboxHelper.updateReflectionIntensity()):UnityEngine.DynamicGI.BakeReflectionsCubemap();var i=1!==t._ambientIntensity||t._ambientMode!==UnityEngine.Rendering.AmbientMode.Skybox||!t.skybox;t._ambientMode===UnityEngine.Rendering.AmbientMode.Skybox&&!t.hasLightDataAsset&&t.hasManualGenerate||(i?(UnityEngine.DynamicGI.BakeLightingCubemap(),UnityEngine.DynamicGI.UpdateEnvironmentLighting()):(UnityEngine.DynamicGI.UpdateEnvironmentLighting(!1),t.ambientProbe.copy(this.renderSettings.ambientProbe)))},_installSkybox:function(){var t=this.application.app;t.scene.skyboxHelper||(t.scene.skyboxHelper=new pc.Skybox(t),t.scene.skyboxHelper.install(t.scene),t.scene.skyboxHelper.environmentCubemap=this.renderSettings.defaultReflection?this.renderSettings.defaultReflection.handle:null)},_installLightmaps:function(){this.renderSettings.lightmaps&&0!==this.renderSettings.lightmaps.length&&(UnityEngine.LightmapSettings.lightmapsMode=this.renderSettings.lightmapsMode,UnityEngine.LightmapSettings.environmentLightingMode=this.renderSettings.environmentLightingMode,UnityEngine.LightmapSettings.manager.loadSceneLightmaps(this.index,this.renderSettings.lightmaps))},_installLightProbes:function(){if(UnityEngine.LightmapSettings.lightProbes||(UnityEngine.LightmapSettings.lightProbes=this.renderSettings.lightProbes),this.renderSettings.lightProbes&&this.renderSettings.lightProbes.HasProbes){var t=UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider;t&&t.index===this.index?UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider=this:(UnityEngine.LightmapSettings.lightProbes&&UnityEngine.LightmapSettings.lightProbes.HasProbes&&console.warn("Another scene with light probes was loaded. Previous light probes were unloaded."),UnityEngine.LightmapSettings.lightProbes=this.renderSettings.lightProbes,UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider=this)}},_uninstallLightProbes:function(){if(UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider===this){var t=this.getClosestLoadedSceneMatch((function(t){return t._containsLightProbes()}));t&&t._installLightProbes()}},getClosestLoadedSceneMatch:function(t){let e=UnityEngine.SceneManagement.SceneManager,i=e.GetSceneIndex(this);if(i<0)return null;let n=e.loadedScenes._items,r=e.loadedScenes.Count;for(let e=i-1;e>=0;e--){let i=n[e];if(i&&i.isLoaded&&(!t||t(i)))return i}for(let e=i+1;e<r;e++){let i=n[e];if(i&&i.isLoaded&&(!t||t(i)))return i}return null},_containsLightProbes:function(){return this.renderSettings.lightProbes&&this.renderSettings.lightProbes.HasProbes},_loadObjects:function(){var t=LunaUnity.Objects.Bundle.handlers.game_object.fork(),e=new LunaUnity.Objects.Request;e.root=this.root;for(let i=0;i<this.rootJsons.length;i++)t.loadAsync(e,this.rootJsons[i]).result;e.resolveReferences(t.registry)},invokeCallbacks:function(t){this.application.app.systems.unitymanager.invokeCallbacks(t)},disableCallbacks:function(t){this.application.app.systems.unitymanager.disableCallbacks()},getRootGameObjects:function(){if(!this.root)return System.Array.init([],UnityEngine.GameObject);let t=this.root.children,e=t.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=UnityEngine.Object.FromHandle(UnityEngine.GameObject,t[n]);return System.Array.init(i,UnityEngine.GameObject)},createInstance:function(){var t=new LunaUnity.Objects.Scene;return t.template=this,t.index=this.index,t.name=this.name,t.rootJsons=this.rootJsons,t.renderSettings=this.renderSettings,t.lightmaps=this.lightmaps,t},setActive:function(t){t&&(this._applyRenderSettings(),this._updateEnvironmentLighting(),window.$scene=this)},addGameObjectToRoot:function(t){let e=t.handle;if(null!=e.parent){e.parent.scene}let i=e.getWorldTransform();e.reparent(this.root,-1),e.setLocalTransform(i)}})})),Bridge.assembly("LunaUnity",(function(t,e){"use strict";Bridge.define("LunaUnity.Objects.LightmapManager",{ctor:function(t){this.$initialize(),this.lightmaps=[]},getLightmap:function(t,e){let i=this.lightmaps[t];return i?i.lightmaps[e]:null},loadSceneLightmaps:function(t,e){this.lightmaps[t]=this.lightmaps[t]||{},this.lightmaps[t].lightmaps=e,this.lightmaps[t].custom=!1},setManagedLightmaps:function(t){let e=UnityEngine.SceneManagement.SceneManager.loadedScenes._items,i=0,n=UnityEngine.SceneManagement.SceneManager.loadedScenes.Count;for(let r=0;r<n;r++){let s=e[r],o=this.lightmaps[s.index];if(o){let s=[],a=o.lightmaps.length,u=!0;for(let t=r+1;t<n;t++)if(this.lightmaps[e[t]]){u=!1;break}u&&(a=t.length-i);for(let e=0;e<a;e++)s.push(new UnityEngine.LightmapData.$ctor1(t[i])),i++;o.custom=!0,o.lightmaps=s}}},getManagedLightmaps:function(){if(0===this.lightmaps.length)return System.Array.init([],UnityEngine.LightmapData);let t=[],e=UnityEngine.SceneManagement.SceneManager.loadedScenes._items,i=UnityEngine.SceneManagement.SceneManager.loadedScenes.Count;for(let n=0;n<i;n++){let i=e[n],r=this.lightmaps[i.index];if(r){let e=r.lightmaps;for(let i=0;i<e.length;i++)t.push(new UnityEngine.LightmapData.$ctor1(e[i]))}}return System.Array.init(t,UnityEngine.LightmapData)}})})),function(){var _mouseMovementDelta=null,unityAttenuationTextureBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAABCAYAAABADtw1AAAA+ElEQVRYCc1RSRLDIAxr///jbqlVqhkNJW4IZtEh8oYsyHUz3L64GxCCgYeBjJh4GhArIyZehjxGDUA9Rb9feNGq5ozBAOaUP0WpM1fmGa1dDJqX4nzGy7VXir0aey3sndWexrgzcqAl9s7X9PJZ5IB6O5KXZmpqEbN7GqgD+Z1SNX3P9v7pRvSPaKRb+HfkTI1e7eyI+TM7cIbw/jVn9rjlLDUjNKAVpRPti3o9PKr2CH3ui35r6no8Y6f6mb1fvTBe0RO9gWf6i9i9igbfNMIPtXr8n2h/9NpLt8cb0DO5p/eRO7gLPOJOM/etsps+Rr8395Y4yssbZyWMID2grNAAAAAASUVORK5CYII=",unitySpotTextureBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAA3NCSVQICAjb4U/gAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAEHRSTlMAESIzRFVmd4iZqrvM3e7/dpUBFQAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAO9SURBVGiB3VnredpAEEQdGHdg0wGiA4tUgKggiFSASAMB3EAQFQTRgeUO7HRg3IHtDkxm9+70AFk6sfoSf9k/2D9mNDO7iHt0Op+6nC7XhQh9LkcBfgYFY67T4n+bPp6APRfVNxTWIhwFJ7DrefyhKCwZgL8k+MBL64YoriwZGN8juO/74yCY4IMo+pYMjIf0IYGDEBUQyQhWrBgUfuABPg3D+RK1CMMZKCDChkHhhz7gQEdcxDEL/JFisMKPA8CjaBNzbcGxCIOJBYOj8dMQ8DjeJVx3cQyKcKYZqkyg/z3C4/FxnCT3j1wPSQKK5YIY+tdVEmBA4VcR4ID+3qOe8AcoorViqDDBBjwf+E2MpzNa1RNUxFsw+F6VCTbgB8DvEoa/6mKK5A4MgV9hwlEGQuD58a+5YhFgCJWJcgkQ4Hrj6ZLwBv52OLwbCmJYziYwUS6BBSAA5Kfxh7Q0A5JEDB9JIAHD8Xxl8G+HXL0bhvViMiqXoAXAAPwXHp+KQA5k4gMJLCCYR7t7wr8d41nE/unhLloE5RJIwHi62sBAKV4xPCbb9WxCEk4dsAAY2D+f6jcuXvYwoSQce1AJrGI2UI4nBpiI1yqF0wjRAhLwMZ4ZSMJkdBIjHAyGLOC5PAATwwtLGN0ce+AI0YJqAVpCtDiJkSPEDNQI0BIwC8cxkgNEWCtAS6AYiwRw4CHCpE6AkpAgRq/ooXvpcoS1AlgCx+jmCXIOagSQhBIPqgccYR0eEijGoz7QFCkHtQJYAnsoElAEu0cbASSBPORDoAh0D+wIuA+5EJyuisDKgfLAIaQEKgKrHmgC9pCFoCOwdMAeiiGoCNBEKwGQoBt53S1kaBtBFoJJMcvQDg8PxRQdnaFtBOkk9K8u8k2wzjBN0bSBm4Axso2AQsAoZW1ommE+xVYIsi7a4tM2qD5yF783aYJqw0/TRxB4zZpg2uBpAtNF6wh4mLNBaI3Avgk8CBkBD+LtfVOCh19mFJlg05xgmxG4w2+N5khP0g89y0TQbBDNKB4T2OP1KKYEgy/nEXy9+X8IxCG20EbhIIlHWfhlEn+dP8EbSfxSlb/WhT8s//63sYWfd+kCQ7zEkS+ypMs88UKzhaWudLEtXu6LNxziLU8bmy7htk+88RRvfeWbb/H2X3wAIT4CkR/CiI+BxAdR8qMw8WGc/DhQfCApPhKVH8qKj4XlB9Pio3H54bz4ekB+QSG/IhFf0sivieQXVeKrMvllnfy6UH5hKb8y7YgvbY2IFm+eZZffZ6L/Vv0BqFspPs/Tph4AAAAASUVORK5CYII=",unityNHxRoughnessBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAMAAADCg1mMAAAAA3NCSVQICAjb4U/gAAABEVBMVEX+/v7v7+/S0tKysrKfn5+ampqHh4d5eXltbW1mZmZkZGRjY2NiYmJeXl5bW1taWlpZWVlTU1NPT09OTk5MTExJSUlISEhHR0dGRkZFRUVERERCQkJBQUE+Pj49PT07Ozs6Ojo5OTk4ODg3Nzc2NjY1NTU0NDQzMzMyMjIxMTEwMDAvLy8uLi4tLS0sLCwrKysqKiopKSkoKCgnJycmJiYlJSUkJCQjIyMiIiIhISEgICAfHx8eHh4dHR0cHBwbGxsaGhoZGRkYGBgXFxcWFhYVFRUUFBQTExMSEhIREREQEBAPDw8ODg4NDQ0MDAwLCwsKCgoJCQkICAgHBwcGBgYFBQUEBAQDAwMCAgIBAQEAAAAUqg0sAAAACXBIWXMAAAsSAAALEgHS3X78AAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAABDdJREFUeJzl1wlf2jAcxnF334fbnHNz3hvoB9SqxYJSDkUF5RKGW9//C1n+SZsmpWlTWq72eQe/L2laFgzD+Cfe3/HuYfpbMAxvgsgZpl3sGAHwN4hCYYJZA+lRABmDUApTzZQDGCfC7BT7AEgiBFaYcvUf4dwAxoIwyXJxrjyALIK8wnjbgzST9cm8AKI+CtHXB+8dmi9ApAiR5YdqDg4QoUL4/rDZPX7yALIKIQlGjg8QHQIgGoTRAIK3C5rv2Y0AIKkwIkHAfPnye5d1u91RAcIrBBOQrZcJ77ILBSDHENRAEsA/3jO82yGLAEBGIZiBDIB3vEd5h19UACEUpAgC5Iva2ew2XaQAEgqyBkEABPWu7XZ5u4UXPYA/w0gGYgDXfK/2lrUm2rgARlKQJ3DtF9cPtTfpxgrgp+BvIBLw6hfUO9rvzI0fwIfBz8BPwNnvyOfq+fZbvEkBBFQQGYgF+H5hPdvegE0UwFNB0mBIwA2A6WfqmXjc3qijTR7Ai8EDYZiAFxjqd82n9dBev0GbFoC0gpuBg4ARcOvn6ukvD/HXaFMFEDOIENwJHAIUgPv12d/erL9CmwEAPD8EkQEjwAGw/Uy+WX9N6mtoswKA56PgNHASsAIMgNnP5ZP6S7SZAsDzRHAYMAT0ENhHwD4AtB/O/o1dP5MAZBIIjAF3COgRoAfAuvys/Ksr3F6FzSoAnhCBM+AIOIF223oBkPd+45rM/PErsJkGwBMpOI8Bcwjwy9D+/Cfffbfk7qP9OF/XZx8Azx3BxYC8ES0BmPnlj7986vj8X+CVYcXinADgiREcBOZnMSfg6Cf1xfkCwHNB4AysU2D+K7KfAXwDwpu/BndfCe0cLT93AHhDCNSAvBjNP0j4kxB/CtIr0Hr6dV0/Q9O0+QSAuSLYxwBGzwA9AvbvD79+Pp/LzS8AnsBgMHARsAGs/lwudzznADAewTQw/yxZd6F5DZIrEF9/hcLp6cnJyWEMAPCcCObfBesmINcAuQPgAkCPP/Qryn5cAGDOg4BmPQjkKUDPAAXQNOjPZuMEAGMQGANMgAXgDoAbQNNUVVEymXTcAGD8l5J5FeCLAG4BuAMAAH7/vVQqjgAwDsEiIALVqq4XCqp6iPp3NuMKAGMMCAE8BugerFTQO0A9Osikf22uxRkAZr0dyBsBDgG6BsrlM01V9vd+b639iDuAQQ0wQacDAtXSeV5Vsrs766vLCQAwGANE0GwiAb2QO8qmt36ufEkGgDX0Vuz1Wq2bWqWoHWdTG6tLi8kCIASdZr1WPlMPUuvfP39IGgAQ9PutRq2UV3bXvy2+TR4A2qDXua3pambj68eXiQRAp+D+rnaubC+9e5FMAETQb15q6eU3z5MKgJ6D9sXR6qtnyQUwHjql7ddPEgxgGJ3c+8eJBjBaKwvJBjD0RwkHMJ4mHeBT0gGM/4ecz/SdIIT+AAAAAElFTkSuQmCC",_onMouseUp=function(t){var e={x:t.x,y:this.graphicsDevice._height-t.y};window.UnityEngine.Input.mouseButtonsUp[t.button]=!0,window.UnityEngine.Input.mouseButtons[t.button]=!1,window.UnityEngine.Input.mouseButtonsDown[t.button]=!1,window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onMouseMove=function(t){var e={x:t.x,y:this.graphicsDevice._height-t.y};_mouseMovementDelta?_mouseMovementDelta.set(e.x-window.UnityEngine.Input.mousePosition.x,-e.y+window.UnityEngine.Input.mousePosition.y):_mouseMovementDelta=new pc.Vec2,window.UnityEngine.Input.axes.Insert("Mouse X",.1*_mouseMovementDelta.x),window.UnityEngine.Input.axes.Insert("Mouse Y",.1*_mouseMovementDelta.y),window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onMouseScroll=function(t){window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",.1*t.wheel),window.UnityEngine.Input.mouseScrollDelta=new pc.Vec2(0,t.wheel)},_onMouseDown=function(t){window.UnityEngine.Input.mouseButtonsDown[t.button]=!0,window.UnityEngine.Input.mouseButtons[t.button]=!0,window.UnityEngine.Input.mouseButtonsUp[t.button]=!1;var e={x:t.x,y:this.graphicsDevice._height-t.y};window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onTouchStart=function(t){var e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchStart(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseDown.call(this,e),!0},_onTouchEnd=function(t){var e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchEnd(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseUp.call(this,e),!0},_onTouchMove=function(t){var e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchMoved(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseMove.call(this,e),!0};pc.Application.prototype._onMouseUp=_onMouseUp,pc.Application.prototype._onMouseDown=_onMouseDown,pc.Application.prototype._onTouchStart=_onTouchStart,pc.Application.prototype._onTouchEnd=_onTouchEnd,pc.extend(pc.Application.prototype,{mimicUnityMouse:function(){window.UnityEngine.Input.mousePosition=new pc.Vec2(0,0);var t=this.touch,e=this.mouse,i=this.graphicsDevice.canvas;"ontouchstart"in window&&pc.input&&pc.input.TouchDevice&&(t=t||new pc.input.TouchDevice(i));var n=!!e;e=e||new pc.Mouse(i),this.touch=t,this.mouse=e,this.touch?(this.touch.on(pc.EVENT_TOUCHSTART,_onTouchStart,this),this.touch.on(pc.EVENT_TOUCHEND,_onTouchEnd,this),this.touch.on(pc.EVENT_TOUCHMOVE,_onTouchMove,this),this.touch.on(pc.EVENT_TOUCHCANCEL,_onTouchEnd,this),UnityEngine.Input.mousePresent=n,UnityEngine.Input.touchSupported=!0):(this.mouse.on(pc.EVENT_MOUSEUP,_onMouseUp,this),this.mouse.on(pc.EVENT_MOUSEDOWN,_onMouseDown,this),this.mouse.on(pc.EVENT_MOUSEMOVE,_onMouseMove,this),this.mouse.on(pc.EVENT_MOUSEWHEEL,_onMouseScroll,this)),this.on("prerender",this._updateInputFlags,this),this.on("prerender",this._updateScreenCache,this),this.on("frameend",this._resetScroll,this)},_updateInputFlags:function(t){window.UnityEngine.Input.mouseButtonsUp[0]=!1,window.UnityEngine.Input.mouseButtonsUp[1]=!1,window.UnityEngine.Input.mouseButtonsUp[2]=!1,window.UnityEngine.Input.mouseButtonsDown[0]=!1,window.UnityEngine.Input.mouseButtonsDown[1]=!1,window.UnityEngine.Input.mouseButtonsDown[2]=!1,window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",0)},_updateScreenCache:function(){this.renderer._screensRendered={}},_noticeScriptComponent:function(t,e){var i=t.code.$$fullname;this._componentsCache=this._componentsCache||{},this._componentsCache[i]=this._componentsCache[i]||[],e?this._componentsCache[i].push(t.code):this._componentsCache[i]=this._componentsCache[i].filter((function(e){return e!=t.code}))},_resetScroll:function(){window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",0),window.UnityEngine.Input.mouseScrollDelta=new pc.Vec2(0,0)},getRootObjects:function(){return this.root.children},getMainCamera:function(){for(var t=null,e=0;e<this.systems.camera.cameras.length;e++){var i=this.systems.camera.cameras[e];if(null!=i.entity.tags&&"MainCamera"==i.entity.tags._list[0])return i;null!=i.renderTarget||t||(t=i)}return t},initializeBuiltInTextures:function(){for(var t=[["white",[255,255,255,255]],["red",[255,0,0,0]],["gray",[127,127,127,127]],["bump",[127,127,255,127]],["black",[0,0,0,0]]],e=null,i=0;i<t.length;i++){for(var n=t[i][1],r=new pc.Texture(this.graphicsDevice,{width:4,height:4,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1}),s=r.lock(),o=0;o<16;o++)s[4*o+0]=n[0],s[4*o+1]=n[1],s[4*o+2]=n[2],s[4*o+3]=n[3];r.unlock(),UnityEngine.Texture2D[t[i][0]+"Texture"]=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,r),e=s}UnityEngine.Texture2D.greyTexture=UnityEngine.Texture2D.grayTexture;var a=new pc.Texture(this.graphicsDevice,{width:4,height:4,format:pc.PIXELFORMAT_R8_G8_B8_A8,cubemap:!0,premultiplyAlpha:!1});a._levels=[[e,e,e,e,e]],a.upload(),UnityEngine.Cubemap.blackCube=UnityEngine.Object.FromHandle(UnityEngine.Cubemap,a);var u=new pc.Texture(this.graphicsDevice,{width:1024,height:1,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});(h=document.createElement("IMG")).src=unityAttenuationTextureBase64,u.setSource(h),UnityEngine.Texture2D.attenuationTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,u);var c=new pc.Texture(this.graphicsDevice,{width:128,height:128,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});(h=document.createElement("IMG")).src=unitySpotTextureBase64,c.setSource(h),UnityEngine.Texture2D.spotTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,c);var h,l=new pc.Texture(this.graphicsDevice,{width:256,height:64,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});(h=document.createElement("IMG")).src=unityNHxRoughnessBase64,l.setSource(h),UnityEngine.Texture2D.nhxRoughnessTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,l),pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURE2D]=UnityEngine.Texture2D.blackTexture.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURECUBE]=UnityEngine.Cubemap.blackCube.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURE2D_SHADOW]=UnityEngine.Texture2D.blackTexture.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURECUBE_SHADOW]=UnityEngine.Cubemap.blackCube.handle},installPlayroundOverrides:function(){var overrides=window.playgroundOverrides||{};for(var className in overrides)if(overrides.hasOwnProperty(className)){var classNameString=JSON.stringify(className),backupClassNameString=JSON.stringify("_"+className),code="Deserializers[ "+backupClassNameString+" ] = Deserializers[ "+classNameString+"];\n";code+="Deserializers[ "+classNameString+" ] = function () {\n",code+="  var result = Deserializers[ "+backupClassNameString+" ].apply( this, arguments );\n";var fields=overrides[className];for(var fieldName in fields)if(fields.hasOwnProperty(fieldName)){var value=fields[fieldName];switch(value[0]){case"float":case"int":case"string":code+="  result."+fieldName+" = "+JSON.stringify(value[1])+"; \n";break;case"boolean":code+="  result."+fieldName+" = "+JSON.stringify(!!value[1])+"; \n";break;case"color":code+="  result."+fieldName+" = new pc.Color("+value.slice(1,5).join(",")+"); \n";break;case"vector2":code+="  result."+fieldName+" = new pc.Vec2("+value.slice(1,3).join(",")+"); \n";break;case"vector3":code+="  result."+fieldName+" = new pc.Vec3("+value.slice(1,4).join(",")+"); \n";break;case"vector4":code+="  result."+fieldName+" = new pc.Vec4("+value.slice(1,5).join(",")+"); \n";break;case"enum":code+="  result."+fieldName+" = "+parseInt(value[1])+"; \n"}}code+="  return result;\n",code+="}",eval("(function() { "+code+"})()")}},muteAudio:function(){this.systems.sound.volume=0},unmuteAudio:function(){this.systems.sound.volume=1},pause:function(){pc.pause(),this.paused=!0,this.muteAudio()},resume:function(){this.paused&&(pc.resume(),this.paused=!1,this.unmuteAudio())}})}(),pc.extend(pc,function(){const t={size:"fontSize",color:"color",fontStyle:"fontStyle"},e={aqua:"#00ffffff",black:"#000000ff",blue:"#0000ffff",brown:"#a52a2aff",cyan:"#00ffffff",fuchsia:"#ff00ffff",green:"#008000ff",grey:"#808080ff",lightblue:"#add8e6ff",lime:"#00ff00ff",magenta:"#ff00ffff",maroon:"#800000ff",navy:"#000080ff",olive:"#808000ff",orange:"#ffa500ff",purple:"#800080ff",red:"#ff0000ff",silver:"#c0c0c0ff",teal:"#008080ff",white:"#ffffffff",yellow:"#ffff00ff"};var i=function(t,e){this.startIndex=t,this.foundTag=e,this.isClosing=!1;var i=(e=e.substr(1,e.length-2)).split("="),n=i[0];(n=n.toLowerCase()).startsWith("/")&&(n=n.substr(1),this.isClosing=!0),this.tag=n;var r=i[1]?i[1]:null;if(r&&r.startsWith('"')&&r.endsWith('"')&&(r=r.substr(1,r.length-2)),r&&(r=r.toLowerCase()),this.value=r,this.isClosing)return this;if(this.colorValue=new pc.Color,this.intValue=0,!this.isClosing)switch(this.tag){case"color":this.colorValue=this.parseColor(this.value,this.colorValue);break;case"size":this.intValue=Number.parseInt(this.value)}return this};return pc.extend(i.prototype,{apply:function(e,i,n){var r=t[this.tag];if(this.isClosing)switch(this.tag){case"color":e.color.copy(i.color);break;case"size":e.fontSize=i.fontSize,e.fontScale=i.fontScale;break;default:e[r]=i[r]}else switch(this.tag){case"color":e.color.copy(this.colorValue);break;case"size":e.fontSize=this.intValue,e.fontScale=e.fontSize/n;break;default:e[r]=this.intValue}},parseColor:function(t,i){return i=i||new pc.Color,t.startsWith("#")||(t=e[t]),i.fromString(t),i}}),pc.extend(i,{tagRegex:/<.[^>]*>/gm,supportedSingleTags:{br:!0,quad:!0},unityColorsMap:e,removeTags:function(t){return t.replace(this.tagRegex,"")},extractTags:function(t,e){var i=e._tags;i.length=0;for(var n=0,r=null;null!=(r=this.tagRegex.exec(t));){var s=r[0],o=new pc.TextTag(r.index-n,s);n+=s.length,i.push(o)}var a=this.removeTags(t),u=this.validateTags(i,a);return e.areTagsValid=u,t=u?a:t},validateTags:function(t,e){if(0===t.length)return!0;for(var i=[],n=0;n<t.length;n++){var r=t[n];if(!pc.TextTag.supportedSingleTags[r.tag])if(r.isClosing){var s=i.pop();if(s.tag!==r.tag)return!1;r.content=e.substr(s.startIndex,r.startIndex-s.startIndex),s.content=e.substr(s.startIndex,r.startIndex-s.startIndex)}else i.push(r)}return 0===i.length}}),{TextTag:i}}()),pc.extend(pc,function(){var t=function(t,e,i,n,r){this.font=t,this.fontSize=e,this.fontScale=i,this.color=n.clone(),this.fontStyle=r};pc.extend(t.prototype,{init:function(t,e,i,n,r){this.font=t,this.fontSize=e,this.fontScale=i,this.color.copy(n),this.fontStyle=r},copy:function(t){this.font=t.font,this.fontSize=t.fontSize,this.fontScale=t.fontScale,this.color.copy(t.color),this.fontStyle=t.fontStyle}});var e=function(){return this.breakable={},this.breakable[" "]=10,this.breakable[","]=20,this.breakable[";"]=30,this.breakable["."]=40,this.breakable["\n"]=500,this};pc.extend(e.prototype,{cleanse:function(t){return t.replace(/\r\n/gm,"\n").replace(/\n\r/gm,"\n")},performWrap:function(t,e,i){var n="";t=this.cleanse(t);for(var r=Math.round(Math.sqrt(e*t.length/i)),s=Math.round(t.length/r),o=s,a=0,u=0,c=0;c<r-1;c++)u=a,a=this.bestBreak(t,o,2*s),n+=t.substring(u,a).trim()+"\n",o=a+s;return n+=t.substring(a)},bestBreak:function(t,e,i){for(var n=e,r=0,s=0,o=e-(i=Math.min(Math.min(e+i,t.length-1)-e,e-Math.max(e-i,0)));o<=e+i;o++){var a=this.breakable[t[o]];a&&((s=a/Math.abs(1*(e-o)))>r&&(n=o,r=s))}return Math.min(n+1,t.length-1)}});return{EditableSettings:t,StringWrap:e,MeasuredLine:function(t,e,i){this.text=t,this.width=e,this.fontScale=i},UICharInfo:function(t,e){this.cursorPos=t||new pc.Vec3,this.charWidth=e||0},UILineInfo:function(t,e,i,n){this.startCharIdx=t||0,this.height=e||0,this.topY=i||0,this.leading=n||0}}}()),pc.extend(pc,function(){const t=[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32}];var e=new pc.StringWrap;const i=new pc.Vec4,n=new pc.Vec4,r=new pc.Vec4;var s=function(t){return this._offset=new pc.Vec3,this._bakedOffset=new pc.Vec3,this._bounds=new pc.Vec2,this._metrics=new pc.Vec4,this.canvasRenderer=t,this._vertexCount=0,this._bufferSize=0,this._buffer=null,this._resizeBuffers(16),this._font=null,this._fontScale=0,this._bestFit=!1,this._font=null,this._maxFontSize=0,this._minFontSize=0,this._horizontalWrap=!1,this._verticalOverflow=!1,this._lineHeight=0,this._fontSize=0,this._align=pc.TEXT_ALIGN_CENTER,this._color=new pc.Color(1,1,1,1),this._dirtyVertices=!1,this._dirtyOffset=!1,this._lineCount=0,this._characters=[],this._lines=[],this._tags=[],this.areTagsValid=!0,this._defaultSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this._currentSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this._measureSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this.graphicsDevice=pc.Application.getApplication().graphicsDevice,this};s.fontRatio=3.75;var o=null;return s.createEmptyMesh=function(){var e=pc.Application.getApplication().graphicsDevice,i=new pc.VertexFormat(e,t),n=new pc.VertexBuffer(e,i,0),r=new pc.Mesh(!0);return r.vertexBuffer=n,r.indexBuffer=[new pc.IndexBuffer(e,pc.INDEXFORMAT_UINT16,0)],r.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,r.primitive[0].base=0,r.primitive[0].count=0,r.primitive[0].indexed=!0,r},pc.extend(s.prototype,{_reset:function(){this._bufferSize=0,this._buffer=new Float32Array(0)},_textIndexBuffer:function(){if(o)return o;o=new pc.IndexBuffer(this.graphicsDevice,pc.INDEXFORMAT_UINT16,32768);for(var t=new Uint16Array(o.lock()),e=0,i=0;i<32762;i+=6)t[i+0]=e+3,t[i+1]=e+0,t[i+2]=e+1,t[i+3]=e+1,t[i+4]=e+3,t[i+5]=e+2,e+=4;return o.unlock(),o.destroy=function(){},o},populate:function(t,e){e._font?(this._updateSettings(e),this._updateText(t),e._dirtyOffset=this._dirtyOffset,e._dirtyVertices=this._dirtyVertices,e._metrics=this._metrics,this._dirtyVertices&&this._fillMesh(),this._dirtyOffset&&this._updateAligns()):this.vertexCount=0},updateMesh:function(t,e,i){i=i||pc.Vec3.ZERO;for(var n=this._vertexCount,r=t.vertexBuffer,s=0;s<n;s++)this._buffer[11*s+0]+=i.x-this._bakedOffset.x,this._buffer[11*s+1]+=i.y-this._bakedOffset.y,this._buffer[11*s+2]+=i.z-this._bakedOffset.z;for(s=0;s<this._lines.length;s++){this._lines[s].topY+=i.y-this._bakedOffset.y}for(s=0;s<this._characters.length;s++){this._characters[s].cursorPos.sub(this._bakedOffset).add(i)}r.numVertices=n,r.storage=this._buffer.buffer,r.unlock(),t.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,t.primitive[0].base=0,t.primitive[0].count=n/4*6,t.primitive[0].indexed=!0,t.indexBuffer[0]=this._textIndexBuffer(),this._bakedOffset.copy(i)},_updateAligns:function(t){t=t||this._measureText(this._text,void 0,!1);var e=this._font.data,i=e.info.lineHeight*this._fontScale,n=(this._verticalOverflow?t.length:Math.min(t.length,Math.floor(this._bounds.y/i)))*i,r=this._fontSize/e.info.fontSize;this._bestFit&&(r=this._minFontSize/e.info.fontSize);for(var s=-1,o=0;o<t.length;o++)s=Math.max(t[o].width,s);this._metrics.set(Math.ceil(s/this._fontScale*r),Math.ceil(n/this._fontScale*r),Math.ceil(this._metrics.z),Math.ceil(this._metrics.w)),0==this._fontScale&&(this._metrics.x=0,this._metrics.y=0);var a=this._bounds.y,u=0;switch(this._verticalAlign){case pc.TEXT_VERTICAL_ALIGN_BOTTOM:u=a-n;break;case pc.TEXT_VERTICAL_ALIGN_MIDDLE:u=.5*(a-n);break;case pc.TEXT_VERTICAL_ALIGN_TOP:u=0}this._offset.set(0,a-u-i,0),this._dirtyOffset=!1},applyTags:function(t,e,i,n){if(this.areTagsValid)for(var r=0;r<this._tags.length;r++){var s=this._tags[r];t===s.startIndex&&s.apply(e,i,n)}},_fillMesh:function(){this._characters.length=0,this._lines.length=0;var t=this._font.data,o=this._text;o=(o=o.replace(/\r\n/gm,"\n").replace(/\n\r/gm,"\n")).replace(/\t/gm,"    "),o=pc.TextTag.extractTags(o,this),this._bakedOffset.set(0,0,0),this._fontScale=this._fontSize/t.info.fontSize;for(var a=this._measureText(o,1e15,!1),u=-1,c=0,h=0;h<a.length;h++)u=Math.max(u,a[h].width),c+=t.info.lineHeight*a[h].fontScale;var l=Math.min(this._bounds.x/u,this._bounds.y/c),p=Math.min(this._maxFontSize,t.info.fontSize*l);this._metrics.set(0,0,u,c);var d=this._bestFit&&!this._verticalOverflow;if(d&&this._bounds.x>0){this._metrics.set(0,0,u/this._fontSize*this._maxFontSize,c/this._fontSize*this._maxFontSize),this._horizontalWrap&&(o=e.performWrap(o,1*this._bounds.y/this._bounds.x,s.fontRatio));var f=o.split("\n").length;l=this._bounds.y/(f*t.info.lineHeight),p=t.info.fontSize*l;var y=Math.max(Math.min(this._maxFontSize,p),this._minFontSize);this._fontScale=y/t.info.fontSize}var m=0,_=0,g=0;if(a=this._measureText(o,d||!this._horizontalWrap?1e15:this._bounds.x,!0),d){var v=-1;for(h=0;h<a.length;h++)v=Math.max(v,a[h].width);if(v>this._bounds.x){var A=1*this._bounds.x/v;this._fontScale*=A;for(h=0;h<a.length;h++)a[h].width*=A}}this._defaultSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._currentSettings.init(this._font,this._fontSize,this._fontScale,this._color,0);for(var E=0,b=0,S=0,M=0;M<a.length;M++){var C=a[M];switch(E=b,this._align){case pc.TEXT_ALIGN_LEFT:m=0;break;case pc.TEXT_ALIGN_CENTER:m=.5*(this._bounds.x-C.width);break;case pc.TEXT_ALIGN_RIGHT:m=this._bounds.x-C.width}if(!this._verticalOverflow&&0!=this._bounds.y&&-(_-t.info.lineHeight*this._currentSettings.fontScale)>this._bounds.y)0==M&&console.warn("[Rendering] Text will be hidden, as there are not enough space even for 1 line!\nSet BestFit or enable vertical overflow");else{var x=t.info.lineHeight*C.fontScale;_-=x-t.info.lineHeight*a[Math.max(M-1,0)].fontScale;for(h=0;h<C.text.length;h++){this.applyTags(S,this._currentSettings,this._defaultSettings,t.info.fontSize),x=t.info.lineHeight*this._currentSettings.fontScale;var P=C.text.charCodeAt(h),O=0,T=0,F=0,w=t.chars[P];if(w){O=w.xoffset*this._currentSettings.fontScale,T=w.yoffset*this._currentSettings.fontScale,F=w.xadvance*this._currentSettings.fontScale;var D=w.width*this._currentSettings.fontScale,I=w.height*this._currentSettings.fontScale,B=_+x,R=x;i.set(m+O,B-T-I,0),n.set(m+O+D,B-T,0),r.set(0,1-(T+I)/R,1,1-T/R),this.addCharToBuffer(g,i,n,w,r,this._currentSettings.color),this._characters.push(new pc.UICharInfo(new pc.Vec3(m+O,B-T-I,0).add(this._bakedOffset),D)),m+=F,g++,b++,S++}}this._lines.push(new pc.UILineInfo(E,x,_+this._bakedOffset.y+x,0)),_-=this._lineHeight*t.info.lineHeight*C.fontScale,this.applyTags(S,this._currentSettings,this._defaultSettings,t.info.fontSize),S++}}this._vertexCount=4*g,this._dirtyVertices=!1,this._updateAligns(a),this._lineCount=a.length,this.canvasRenderer&&this.canvasRenderer.cacheColors(this.mesh)},addCharToBuffer(t,e,i,n,r,s){var o=4*t,a=11*(o+0),u=11*(o+1),c=11*(o+2),h=11*(o+3);this._buffer[a]=e.x,this._buffer[a+1]=e.y,this._buffer[a+2]=e.z,this._buffer[a+3]=n.uvBottomLeft[0],this._buffer[a+4]=n.uvBottomLeft[1],this._buffer[a+5]=r.x,this._buffer[a+6]=r.y,this._buffer[a+7]=s.r,this._buffer[a+8]=s.g,this._buffer[a+9]=s.b,this._buffer[a+10]=s.a,this._buffer[u]=e.x,this._buffer[u+1]=i.y,this._buffer[u+2]=e.z,this._buffer[u+3]=n.uvTopLeft[0],this._buffer[u+4]=n.uvTopLeft[1],this._buffer[u+5]=r.x,this._buffer[u+6]=r.w,this._buffer[u+7]=s.r,this._buffer[u+8]=s.g,this._buffer[u+9]=s.b,this._buffer[u+10]=s.a,this._buffer[c]=i.x,this._buffer[c+1]=i.y,this._buffer[c+2]=e.z,this._buffer[c+3]=n.uvTopRight[0],this._buffer[c+4]=n.uvTopRight[1],this._buffer[c+5]=r.z,this._buffer[c+6]=r.w,this._buffer[c+7]=s.r,this._buffer[c+8]=s.g,this._buffer[c+9]=s.b,this._buffer[c+10]=s.a,this._buffer[h]=i.x,this._buffer[h+1]=e.y,this._buffer[h+2]=e.z,this._buffer[h+3]=n.uvBottomRight[0],this._buffer[h+4]=n.uvBottomRight[1],this._buffer[h+5]=r.z,this._buffer[h+6]=r.y,this._buffer[h+7]=s.r,this._buffer[h+8]=s.g,this._buffer[h+9]=s.b,this._buffer[h+10]=s.a},measureText:function(t,e,i){if(t=t||"",this._updateSettings(i),!this._font)return pc.Vec2.ZERO;var n=this._font.data;this._fontScale=this._fontSize/n.info.fontSize,t=pc.TextTag.removeTags(t);for(var r=this._measureText(t,e,!1),s=-1,o=0;o<r.length;o++)s=Math.max(s,r[o].width);var a=r.length*n.info.lineHeight*this._fontScale;return new pc.Vec2(s,a)},_measureText:function(t,e,i){var n=this._font.data,r=[],s=t.replace("\n\r","\n").replace("\r\n","\n").split(/\n/),o="",a=n.chars[" ".charCodeAt(0)],u=a?a.xadvance*this._fontScale:0;this._defaultSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._currentSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._measureSettings.init(this._font,this._fontSize,this._fontScale,this._color,0);for(var c=0,h=0,l={maxFontScale:0},p=0;p<s.length;p++){var d=s[p].split(" ");this._measureSettings.copy(this._currentSettings),d=this._checkBigWords(d,n,this._fontScale,e,c,this._measureSettings,this._defaultSettings,n.info.fontSize,i);for(var f=0,y=0;y<d.length;y++){var m=d[y],_=this._calculateWidth(m,n,this._fontScale,c,this._currentSettings,this._defaultSettings,n.info.fontSize,l);f>0&&f+_>e&&(u=a?a.xadvance*this._currentSettings.fontScale:0,o=o.substring(0,o.length-1),f-=u,r.push(new pc.MeasuredLine(o,f,h)),h=0,o="",f=0,c++),h=Math.max(h,l.maxFontScale),c+=m.length,o+=m+" ",f+=_+(u=a?a.xadvance*this._currentSettings.fontScale:0),this.applyTags(c,this._currentSettings,this._defaultSettings,n.info.fontSize),c++}o=o.substring(0,o.length-1),f-=u,r.push(new pc.MeasuredLine(o,f,h)),h=0,o="",f=0}return r},getMeasuredText:function(t){return t.map(t=>t.text).join("\n")},_calculateWidth:function(t,e,i,n,r,s,o,a){for(var u=0,c=0;c<t.length;c++){this.applyTags(n,r,s,o),a&&(a.maxFontScale=Math.max(a.maxFontScale,r.fontScale));var h=t.charCodeAt(c),l=e.chars[h];l&&(u+=l.xadvance*r.fontScale),n++}return 0===t.length&&a&&(a.maxFontScale=i),u},_splitWord:function(t,e,i,n){for(var r=[],s=0,o=0;o<t.length;){var a=t.charCodeAt(o),u=e.chars[a],c=(u?u.xadvance:0)*i;if(u){if(s>0&&s+c>=n){var h=t.substring(0,o);t=t.substring(o),s=c,o=1,r.push(h);continue}s+=c}o++}return r.push(t),r},_checkBigWords:function(t,e,i,n,r,s,o,a,u){for(var c=[],h=0;h<t.length;h++){var l=t[h];if(this._calculateWidth(l,e,i,r,s,o,a)>n)for(var p=this._splitWord(l,e,i,n),d=0;d<p.length;d++)c.push(p[d]),r+=p[d].length,u&&d!==p.length-1&&this.applyTagsOffsets(r,1);else c.push(l)}return c},applyTagsOffsets(t,e){for(var i=0;i<this._tags.length;i++){var n=this._tags[i];n.startIndex<t||(n.startIndex+=e)}},_updateText:function(t){this._text!=t&&(this._dirtyVertices=!0,this._dirtyOffset=!0),this._text=t,this._resizeBuffers(t.length)},_updateSettings:function(t){this._verticalAlign!=t.verticalAlign&&(this._dirtyOffset=!0),this._fontSize==t.fontSize&&this._bestFit==t.bestFit&&this._font==t.font&&this._maxFontSize==t.maxFontSize&&this._minFontSize==t.minFontSize&&this._horizontalWrap==t.horizontalWrap&&this._verticalOverflow==t.verticalOverflow&&this._lineHeight==t.lineHeight&&this._fontSize==t.fontSize&&this._align==t.align&&this._color.equals(t.color)||(this._dirtyVertices=!0,this._dirtyOffset=!0),this._bounds&&this._bounds.x==t.bounds.x&&this._bounds.y==t.bounds.y||(this._dirtyOffset=!0,(this._horizontalWrap||this._bestFit||this._align!=pc.TEXT_ALIGN_LEFT)&&(this._dirtyVertices=!0)),this._verticalAlign=t.verticalAlign,this._fontSize=t.fontSize,this._bestFit=t.bestFit,this._font=t.font,this._align=t.align,this._maxFontSize=t.maxFontSize,this._minFontSize=t.minFontSize,this._horizontalWrap=t.horizontalWrap,this._verticalOverflow=t.verticalOverflow,this._bounds.copy(t.bounds),this._lineHeight=t.lineHeight,this._color.copy(t.color)},_resizeBuffers:function(t){this._bufferSize=t,this._buffer=new Float32Array(44*t)},populateWithErrors:function(t,e,i){e.bestFit=e.resizeTextForBestFit,e.fontSize=e.fontSize,e.font=e.font.handle,e.maxFontSize=e.resizeTextMaxSize,e.minFontSize=e.resizeTextMinSize,e.lineHeight=e.lineSpacing,e.verticalOverflow=e.verticalOverflow,e.horizontalWrap=!(0==e.horizontalOverflow),e.bounds=e.generationExtents,e.verticalAlign="top",e.align=pc.TEXT_ALIGN_LEFT,e._bestFit=e.resizeTextForBestFit,e._fontSize=e.fontSize,e._font=e.font,e._maxFontSize=e.resizeTextMaxSize,e._minFontSize=e.resizeTextMinSize,e._lineHeight=e.lineSpacing,e._verticalOverflow=e.verticalOverflow,e._horizontalWrap=!(0==e.horizontalOverflow),e._bounds=e.generationExtents,e._verticalAlign="top",e._align=pc.TEXT_ALIGN_LEFT,this.populate(t,e)}}),Object.defineProperty(s.prototype,"offset",{get:function(){return this._offset}}),Object.defineProperty(s.prototype,"vertexCount",{get:function(){return this._vertexCount}}),Object.defineProperty(s.prototype,"lineCount",{get:function(){return this._lineCount}}),Object.defineProperty(s.prototype,"characterCount",{get:function(){return this._characters.length}}),Object.defineProperty(s.prototype,"lines",{get:function(){return this._lines}}),Object.defineProperty(s.prototype,"characters",{get:function(){return this._characters}}),{TextGenerator:s}}()),function(){var t,e=new pc.Quat,i=new pc.Quat,n=new pc.Mat4,r=new pc.Mat4,s=pc.GraphNode.prototype._onInsertChild;pc.extend(pc.GraphNode.prototype,{removeOrReparent:function(t){return null==t?this.parent.removeChild(this):this.reparent(t)},calculateLossyScale:function(t=new pc.Vec3){return r.setTRS(pc.Vec3.ZERO,this.getRotation_Unity(e).invert(),pc.Vec3.ONE),this._getWorldRotationAndScale(n),r.mul2(r,n),t.set(r.data[0],r.data[5],r.data[10]),t},getLossyScale:function(t=new pc.Vec3){return this._dirtyWorld&&this.syncHierarchy(),t.copy(this.cachedLossyScale),t},destroy:function(){this.removeOrReparent(null)},_onInsertChild:function(t){s.call(this,t);var e=this._app.systems;e.physics.syncHierarchy(t),e.physics2D.syncHierarchy(t)},_onModifyTransform:function(){var t=this._app.systems;t.physics.syncTransforms(this),t.physics2D.syncTransforms(this)},setLocalTransform:function(t){this.localTransform.copy(t),this.localPosition.copy(t.getTranslation()),this.localRotation.copy(t.getRotation()),this.localScale.copy(t.getScale()),this._dirtifyLocal()},_dirtifyWorld:function(t){if(t=!!t,!this._dirtyWorld){this._dirtyWorld=!0,t||this._app.scene.addDirty(this);for(var e=0;e<this._children.length;e++)this._children[e]._dirtyWorld||this._children[e]._dirtifyWorld(!0)}this._dirtyNormal=!0,this._aabbVer++},_dirtifyRect:function(){this._dirtyRect||(this._dirtyRect=!0,this._app.scene.addDirty(this)),this._aabbVer++},_dirtifyWorldWithoutTransform:function(){if(!this._dirtyWorld){this._dirtyWorld=!0;for(var t=0;t<this._children.length;t++)this._children[t]._dirtyWorld||this._children[t]._dirtifyWorldWithoutTransform()}this._dirtyNormal=!0},_isOddlyScaled:function(){var t=this.worldTransform.data,e=t[0],i=t[1],n=t[2],r=t[4],s=t[5],o=t[6],a=t[8],u=t[9],c=t[10];return e*(s*c-o*u)-r*(i*c-n*u)+a*(i*o-n*s)<0},_nodeWorldTransformUpdated:function(){this.fire("transformChanged"),this.camera&&this.camera.camera._updateScreens(),this.reflectionprobe&&this.reflectionprobe.onTransformChanged()},_sync:function(){if(this._dirtyLocalEulerAngles&&(this.localRotation.setFromEulerAngles_Unity(this.localEulerAngles.x,this.localEulerAngles.y,this.localEulerAngles.z),this._dirtyLocal=!0,this._dirtyLocalEulerAngles=!1),this._dirtyLocal&&(this.localRotation.normalize(),this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale),this._dirtyLocal=!1,this._dirtifyWorld(!0)),this._dirtyWorld){if(this._static&&this._staticVersion++,null===this._parent)this.worldTransform.copy(this.localTransform),this._nodeWorldTransformUpdated();else if(this._parent.getWorldTransform(),this.scaleCompensation){var t,e=this._parent,i=this.localScale,n=e;if(n){for(;n&&n.scaleCompensation;)n=n._parent;n&&(n=n._parent)&&(t=n.worldTransform.getScale(),scaleCompensateScale.mul2(t,this.localScale),i=scaleCompensateScale)}scaleCompensateRot2.setFromMat4(e.worldTransform),scaleCompensateRot.mul2(scaleCompensateRot2,this.localRotation);var r=e.worldTransform;e.scaleCompensation&&(scaleCompensateScaleForParent.mul2(t,e.getLocalScale()),scaleCompensatePosTransform.setTRS(r.getTranslation(scaleCompensatePos),scaleCompensateRot2,scaleCompensateScaleForParent),r=scaleCompensatePosTransform),r.transformPoint(this.localPosition,scaleCompensatePos),scaleCompensateRot.normalize(),this.worldTransform.setTRS(scaleCompensatePos,scaleCompensateRot,i)}else this.worldTransform.mul2(this._parent.worldTransform,this.localTransform);this.worldTransformInverse.copy(this.worldTransform).invert(),this.calculateLossyScale(this.cachedLossyScale),this._dirtyWorld=!1,this._nodeWorldTransformUpdated()}},setLocalScale:function(t,e,i){if(t instanceof pc.Vec3){if(this.localScale.equals(t))return;this.localScale.copy(t)}else{if(this.localScale.x==t&&this.localScale.y==e&&this.localScale.z==i)return;this.localScale.set(t,e,i)}this._dirtifyLocal()},getComponents:function(){return[]},findByNameImmediate:function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];if(i.name==t)return i}return null},findByNameEnabled:function(t){return t?this.findByNamesEnabledInternal(t.split("/"),0):null},findByNamesEnabledInternal:function(t,e){if(!this.enabled)return null;if(this.scene||this.name!==t[e])e=0;else{if(e===t.length-1)return this;e++}for(let i=0;i<this._children.length;i++){const n=this._children[i].findByNamesEnabledInternal(t,e);if(null!==n)return n}return null},getEulerAngles_Unity:function(){return this.getRotation_Unity(e).getEulerAngles_Unity(this.eulerAngles)},getPositiveEulerAngles:function(){return this.getEulerAngles_Unity()},setEulerAngles_Unity:(t=new pc.Quat,function(e,i,n){if(e instanceof pc.Vec3?this.localRotation.setFromEulerAngles_Unity(e.x,e.y,e.z):this.localRotation.setFromEulerAngles_Unity(e,i,n),null!==this._parent){var r=this._parent.getRotation();t.copy(r).invert(),this.localRotation.mul2(t,this.localRotation)}this._dirtifyLocal()}),getRotation_Unity:function(t=new pc.Quat){this._dirtyLocalEulerAngles?t.setFromEulerAngles_Unity(this.localEulerAngles.x,this.localEulerAngles.y,this.localEulerAngles.z):t.copy(this.localRotation),t.normalize();let e=this.parent;for(;e;)e._dirtyLocalEulerAngles?i.setFromEulerAngles_Unity(e.localEulerAngles.x,e.localEulerAngles.y,e.localEulerAngles.z):i.copy(e.localRotation),i.normalize(),t.mul2(i,t),e=e.parent;return t},getLocalEulerAngles_Unity:function(){return this.localRotation.getEulerAngles_Unity(this.localEulerAngles),this.localEulerAngles},setLocalEulerAngles_Unity:function(t,e,i){t instanceof pc.Vec3?this.localRotation.setFromEulerAngles_Unity(t.x,t.y,t.z):this.localRotation.setFromEulerAngles_Unity(t,e,i),this._dirtifyLocal()},_getWorldRotationAndScale:function(t=new pc.Mat4){if(this._dirtyLocalEulerAngles?e.setFromEulerAngles_Unity(this.localEulerAngles.x,this.localEulerAngles.y,this.localEulerAngles.z):e.copy(this.localRotation),e.normalize(),t.setTRS(pc.Vec3.ZERO,e,this.localScale),this.parent){const e=this.parent._getWorldRotationAndScale();t.mul2(e,t)}return t},setParent:function(t,e){if(e){var i=this.getWorldTransform().getScale(),n=this.getPosition(),r=this.getRotation();this.removeOrReparent(null!=t?t:null,!0);var s=this.getWorldTransform().getScale(),o=this.getLocalScale(),a=new pc.Vec3(o.x*i.x/s.x,o.y*i.y/s.y,o.z*i.z/s.z);this.setLocalScale(a),this.setPosition(n),this.setRotation(r)}else{var u=this.getLocalScale(),c=this.getLocalPosition(),h=this.getLocalRotation();this.removeOrReparent(null!=t?t:null,!0),this.setLocalScale(u),this.setLocalPosition(c),this.setLocalRotation(h)}if(this.element){var l=pc.UIUtils.findParentScreen(this);this.reparentElementRecursive(l)}},reparentElementRecursive:function(t){if(this.element){var e=this._unityComponents?this._unityComponents.canvasRenderer[0]:null;e&&e.reparentCanvas(t)}for(var i=this.children,n=0;n<i.length;n++){i[n].reparentElementRecursive(t)}},isParentOf:function(t){var e=t._graphDepth-this._graphDepth;if(e<=0||e>=t._graphDepth||null===t.parent)return!1;for(var i=t,n=0;n<e;n++)i=i.parent;return i==this},isChildOf:function(t){t.isParentOf(this)}}),Object.defineProperty(pc.GraphNode.prototype,"aabbVersion",{get:function(){return this._aabbVer}}),Object.defineProperty(pc.GraphNode.prototype,"forward",{get:function(){return this._forward||(this._forward=new pc.Vec3),this.getWorldTransform().getZ(this._forward).normalize()}})}(),pc.extend(pc.Entity.prototype,{sendMessageToScripts:function(t,e,i){var n=this._unityComponents.monoBehaviour;if(0!==n.length&&t)for(var r=0;r<n.length;r++){var s=n[r].code;if(s!==i)try{if(s&&s[t]){var o=s[t].apply(s,e);o&&"Bridge.GeneratorEnumerator"==o.$$fullname&&new UnityEngine.Coroutine(o,s.handle)}}catch(t){console.error(t)}}},_elementDimesionsChange:function(){for(var t=0;t<this._dimensionListeners.length;t++)this._dimensionListeners[t].OnRectTransformDimensionsChange()},sendPhysicsEvent:function(t,e){if(!this._magicMethods)return!1;var i=this._magicMethods[t];if(!i)return!1;for(var n=0;n<i.length;n++){var r=i[n];try{r.code[t].call(r.code,e)}catch(t){console.error(t)}}return!0},getScene:function(){let t=this.parent;return t?t.scene?t.scene:t.getScene():null},removeOrReparent:function(t,e){if(null===t)if(e){var i=this.getWorldTransform(),n=this.getScene();n||(n=window.$scene),this.reparent(n.root,-1),this.setLocalTransform(i)}else this.parent.removeChild(this);else this.reparent(t,-1)},allChildren:function(t){t=t||[];for(var e=0;e<this.children.length;e++)this.children[e].allChildren&&(t.push(this.children[e]),this.children[e].allChildren(t));return t},parents:function(){for(var t=[],e=this.parent;null!=e;)t.push(e),e=e.parent;return t},getComponents:function(t){var e=[];if(!t){for(var i in this.c=this.c||[],this.c)this.c.hasOwnProperty(i)&&"script"!=i&&e.push(this.c[i]);if(this.c.script&&this.c.script.scripts)for(var n=0;n<this.c.script.scripts.length;n++)e.push(this.c.script.scripts[n])}for(var r in this._unityComponents)if(this._unityComponents.hasOwnProperty(r)){var s=this._unityComponents[r];for(var o in s)s.hasOwnProperty(o)&&e.push(s[o])}return e},getUnityComponents:function(t){var e=[],i=this._unityComponents;if(!i)return e;for(var n=0,r=t.length;n<r;++n){var s=t[n];if(i.hasOwnProperty(s)){var o=i[s];for(var a in o)o.hasOwnProperty(a)&&e.push(o[a])}}return e},getUnityComponent:function(t){return this._unityComponents&&this._unityComponents[t][0]||null},collectAllUnityComponents:function(){for(var t=this._app.systems.unity.systemIds,e=this.getUnityComponents(t),i=this.allChildren(),n=0;n<i.length;n++)e=i[n].getUnityComponents(t).concat(e);return e}}),pc.Camera.prototype._getProjectionMatrix=pc.Camera.prototype.getProjectionMatrix,pc.extend(pc.Camera.prototype,{getProjectionMatrix:function(){var t=this._projMatDirty;if(this._projMatDirty&&this._projMatOverride?this._projMat.copy(this._projMatOverride):this._getProjectionMatrix(),t){var e=this._nearClip,i=this._farClip,n=this.aspectRatio,r=this.orthoHeight;this._shaderParams[0]=1/i,this._shaderParams[1]=i,this._shaderParams[2]=(1-i/e)/2,this._shaderParams[3]=(1+i/e)/2,this._orthoParams[0]=r*n,this._orthoParams[1]=r,this._orthoParams[2]=0,this._orthoParams[3]=this.projection===pc.PROJECTION_ORTHOGRAPHIC?1:0,this._zbufferParams[0]=1-i/e,this._zbufferParams[1]=i/e,this._zbufferParams[2]=this._zbufferParams[0]/i,this._zbufferParams[3]=this._zbufferParams[1]/i,this._projectionParams[0]=1,this._projectionParams[1]=e,this._projectionParams[2]=i,this._projectionParams[3]=1/i,this._updateScreens(),this._projInvMat.copy(this._projMat),this._projInvMat.invert(),this._vpDirty=!0}return this._projMat},setProjectionMatrix:function(t){this._projMatOverride=t?t.clone():null,this._projMatDirty=!0,this._vpDirty=!0},_updateScreens:function(){for(var t=pc.Application.getApplication().scene.worldScreens,e=0;e<t.length;e++){var i=t[e];i.screenType==pc.SCREEN_TYPE_CAMERA&&i._calcProjectionMatrix()}}}),function(){var t=[null,null,pc.Vec2,pc.Vec3,pc.Vec4],e=new Float32Array([1,1,1,1]),i=new Float32Array([0,0,0,0]),n=new Float32Array([0,0,0,1]),r=new Float32Array([1,0,0,1]),s=new Float32Array([0,0,1,1]);pc.extend(pc.MeshInstance.prototype,{updateKey:function(){var t=this.material,e=t?t.renderQueue:null,i=t?t.blendType:null,n=2e7-1e3*(e||2e3)+(t?t.id:0);this._key[pc.SORTKEY_FORWARD]=function(t,e,i,n){return(15&t)<<27|(e===pc.BLEND_NONE?1:0)<<26|(i?1:0)<<25|(33554431&n)<<0}(this.layer,i||pc.BLEND_NORMAL,!1,n)},configureLightmap:function(){let t=UnityEngine.LightmapSettings.manager.getLightmap(this.lightmapSceneIndex,this.lightmapIndex);t&&t.lightmapColor?this.setParameter("unity_Lightmap",t.lightmapColor.handle):this.setParameter("unity_Lightmap",null),(this._shaderDefs&pc.SHADERDEF_DIRLM)>0&&(t&&t.lightmapDirection?this.setParameter("unity_LightmapInd",t.lightmapDirection.handle):this.setParameter("unity_LightmapInd",null))}}),Object.defineProperty(pc.MeshInstance.prototype,"renderQueue",{get:function(){return this.material?this.material.renderQueue:2e3}}),pc.extend(pc.Mesh.prototype,{allStreams:[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_BLENDWEIGHT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_BLENDINDICES,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD2,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD3,components:2,type:pc.ELEMENTTYPE_FLOAT32}],defaultStreams:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1],uiVertexSemantics:[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32}],destroy:function(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=null);for(var t=0;t<this.indexBuffer.length;t++)this.indexBuffer[t]&&this.indexBuffer[t].destroy(),this.indexBuffer=[]},defaultVertexBuffer:function(t,e,i){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(this.allStreams[r]);var s=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,n);return new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,s,e,this.bufferUsage||pc.BUFFER_STATIC,i)},getDescriptionForSemantics:function(t,e){if(e)return{semantic:t,components:e,type:pc.ELEMENTTYPE_FLOAT32};for(var i=0;i<this.allStreams.length;i++)if(this.allStreams[i].semantic===t)return this.allStreams[i];throw new Error("Unknown or unsupported semantic requested: "+t)},defaultIndexBuffer:function(t,e){return new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,t,this.bufferUsage||pc.BUFFER_STATIC,e)},markDynamic:function(){this.vertexBuffer&&(this.vertexBuffer.lock(),this.vertexBuffer.usage=pc.BUFFER_DYNAMIC,this.vertexBuffer.unlock()),this.indexBuffer[0]&&(this.indexBuffer[0].lock(),this.indexBuffer[0].usage=pc.BUFFER_DYNAMIC,this.indexBuffer[0].unlock()),this.bufferUsage=pc.BUFFER_DYNAMIC},uploadMeshData:function(){this.vertexBuffer&&this.vertexBuffer.unlock();for(var t=0;t<this.subMeshes.length;t++){var e=this.subMeshes[t];e.vertexBuffer=this.vertexBuffer,e.indexBuffer[0]&&e.indexBuffer[0].unlock()}},clear:function(){this.vertexBuffer&&this.vertexBuffer.resize(0),this.indexBuffer[0]&&this.indexBuffer[0].resize(0),this.subMeshes=[this],this.version++},setIndicies:function(t,e,i,n,r){this.subMeshes.length>=i&&this.setSubMeshCount(i+1);var s=this.subMeshes[i],o=null;switch(e){case UnityEngine.MeshTopology.Triangles:o=pc.gfx.PRIMITIVE_TRIANGLES;break;case UnityEngine.MeshTopology.Lines:o=pc.gfx.PRIMITIVE_LINES;break;case UnityEngine.MeshTopology.LineStrip:o=pc.gfx.PRIMITIVE_LINESTRIP;break;case UnityEngine.MeshTopology.Points:o=pc.gfx.PRIMITIVE_POINTS}if(null===o)throw new Error("Unknown or unsupported topology "+e+" passed!");s.primitive[0].type=o,s.primitive[0].base=r,s.primitive[0].count=t.length,s.primitive[0].indexed=!0,s.vertexBuffer=this.vertexBuffer,s.indexBuffer[0]=s.indexBuffer[0]||new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC),s.indexBuffer[0].resize(t.length),new Uint16Array(s.indexBuffer[0].lock()).set(t),!1!==n&&this.recalculateBounds(),this.uploadMeshData(),this.version++},getIndicies:function(t){var e=this.subMeshes[t];return new Uint16Array(e.indexBuffer[0].lock())},getUVInTriangle:function(t,e){var i=this.vertexBuffer,n=new pc.Vec2,r=3*t;if(!i)return n;for(var s=i.format.getStructureFor(pc.SEMANTIC_TEXCOORD0),o=0,a=this.subMeshes[o].indexBuffer[0].storage;r>=a.length;)r-=a.length,o++,a=this.subMeshes[o].indexBuffer[0].storage;if(s.offset<0)return n;var u=(a[r+e]*s.stride+s.offset)/4,c=new Float32Array(i.storage);return n.set(c[u+0],c[u+1]),n},getVectorStream:function(e,i,n){var r=this.vertexBuffer;if(r){var s=r.format.getStructureFor(i);if(!(s.offset<0)){for(var o=new Float32Array(r.storage),a=new Array(r.numVertices),u=0,c=s.offset/4;c<o.length;c+=s.stride/4){var h=new t[n];h.x=o[c+0],h.y=o[c+1],n>2&&(h.z=o[c+2]),n>3&&(h.w=o[c+3]),a[u++]=h}e._items=a,e._size=a.length}}},setVectorStream:function(t,e,i){if(t&&0!==t._size){this.enableSemantic(e);var n=this.vertexBuffer;n.resize(Math.max(t._size,n.numVertices));var r=n.format.getStructureFor(e),s=new Float32Array(n.storage),o=0,a=t._size*r.stride/4;switch(i){case 2:for(var u=r.offset/4;u<a;u+=r.stride/4){var c=t._items[o++];s[u+0]=c.x,s[u+1]=c.y}break;case 3:for(u=r.offset/4;u<a;u+=r.stride/4){c=t._items[o++];s[u+0]=c.x,s[u+1]=c.y,s[u+2]=c.z}break;case 4:for(u=r.offset/4;u<a;u+=r.stride/4){c=t._items[o++];s[u+0]=c.x,s[u+1]=c.y,s[u+2]=c.z,s[u+3]=c.w}}this.meshInstance&&this.meshInstance._aabbVer++,this.uploadMeshData(),this.version++}else this.disableSemantic(e)},getColorStream:function(t,e,i){var n=this.vertexBuffer;if(n){var r=n.format.getStructureFor(e);if(!(r.offset<0)){for(var s=new Float32Array(n.storage),o=new Array(n.numVertices),a=0,u=r.offset/4;u<s.length;u+=r.stride/4){var c=new pc.Color;c.r=s[u+0]*i,c.g=s[u+1]*i,c.b=s[u+2]*i,c.a=s[u+3]*i,o[a++]=c}t._items=o,t._size=o.length}}},getUIVertexStream:function(t,e){if(t._size=0,e._size=0,this.vertexBuffer&&this.indexBuffer[0]){t._size=t._items.length=this.vertexBuffer.numVertices,e._size=e._items.length=this.primitive[0].count,e._items=Array.from(new Uint16Array(this.indexBuffer[0].storage));for(var i=new Float32Array(this.vertexBuffer.storage),n=this.vertexBuffer.format.size/4,r=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),s=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_NORMAL,!0),o=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TANGENT,!0),a=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_COLOR,!0),u=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD0,!0),c=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD1,!0),h=0;h<i.length;h+=n){var l=new UnityEngine.UIVertex,p=-1;t._items[h/n|0]=l,(p=r.offset)>=0&&l.position.set(i[h+p+0],i[h+p+1],i[h+p+2]),(p=s.offset)>=0&&l.normal.set(i[h+p+0],i[h+p+1],i[h+p+2]),(p=o.offset)>=0&&l.tangent.set(i[h+p+0],i[h+p+1],i[h+p+2],i[h+p+3]),(p=a.offset)>=0&&(l.color.r=255*i[h+p+0]|0,l.color.g=255*i[h+p+1]|0,l.color.b=255*i[h+p+2]|0,l.color.a=255*i[h+p+3]|0),(p=u.offset)>=0&&l.uv0.set(i[h+p+0],i[h+p+1]),(p=c.offset)>=0&&l.uv1.set(i[h+p+0],i[h+p+1])}}},setUIVertexStream:function(t,e){if(this.vertexBuffer){var i=this.uiVertexSemantics,n=this.vertexBuffer.format;if(n.elements.length!==i.length)this.vertexBuffer.destroy(),this.vertexBuffer=null;else for(var r=0;r<i.length;r++)if(n.elements[r].name!==i[r].semantic){this.vertexBuffer.destroy(),this.vertexBuffer=null;break}}if(!this.vertexBuffer){var s=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,this.uiVertexSemantics);this.vertexBuffer=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,s,t._size,this.bufferUsage||pc.BUFFER_STATIC,null)}e._items.length=e._size,this.setIndicies(e._items,UnityEngine.MeshTopology.Triangles,0,!0,0),this.vertexBuffer.resize(t._size);var o=new Float32Array(this.vertexBuffer.storage);for(r=0;r<o.length;r+=18){var a=t._items[r/18];o[r+0]=a.position.x,o[r+1]=a.position.y,o[r+2]=a.position.z,o[r+3]=a.normal.x,o[r+4]=a.normal.y,o[r+5]=a.normal.z,o[r+6]=a.tangent.x,o[r+7]=a.tangent.y,o[r+8]=a.tangent.z,o[r+9]=a.tangent.w,o[r+10]=a.color.r/255,o[r+11]=a.color.g/255,o[r+12]=a.color.b/255,o[r+13]=a.color.a/255,o[r+14]=a.uv0.x,o[r+15]=a.uv0.y,o[r+16]=a.uv1.x,o[r+17]=a.uv1.y}this.uploadMeshData(),this.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,this.primitive[0].base=0,this.primitive[0].count=e._items.length,this.primitive[0].indexed=!0},setColorStream:function(t,e,i){if(t&&0!==t._size){this.enableSemantic(e);var n=this.vertexBuffer;n.resize(Math.max(t._size,n.numVertices));for(var r=n.format.getStructureFor(e),s=new Float32Array(n.storage),o=0,a=t._size*r.stride/4,u=1/i,c=r.offset/4;c<a;c+=r.stride/4){var h=t._items[o++];s[c+0]=h.r*u,s[c+1]=h.g*u,s[c+2]=h.b*u,s[c+3]=h.a*u}this.uploadMeshData(),this.version++}else this.disableSemantic(e)},initializeBuffers:function(){this.destroy(),this.vertexBuffer=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,[]),0),this.vertexBuffer.numBytes=0,this.vertexBuffer.numVertices=0,this.indexBuffer=[new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC)]},enableSemantic:function(t){var e=this.vertexBuffer;e||((e=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,[]),0)).numBytes=0,e.numVertices=0,this.vertexBuffer=e);var i=e.format;if(!(i.getStructureFor(t).offset>=0)){for(var n=new Float32Array(e.storage),r=[],s=0;s<i.elements.length;s++){var o=i.elements[s];r.push({semantic:o.name,type:o.dataType,components:o.numComponents,normalize:o.normalize})}r.push(this.getDescriptionForSemantics(t));for(var a=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,r),u=new Float32Array(a.size/4*e.numVertices),c=0;c<e.numVertices;c++)for(o=0;o<i.size/4;o++)u[c*a.size/4+o]=n[c*i.size/4+o];e.invalidateBuffer();var h=e.numVertices*e.format.size;e.device._vram.vb+=h-e.numBytes,e.format=a,e.numBytes=h,e.storage=u.buffer}},disableSemantic:function(t){var e=this.vertexBuffer;if(e){var i=e.format;if(!(i.getStructureFor(t).offset<0)){for(var n=this.getDescriptionForSemantics(t),r=new Float32Array(e.storage),s=[],o=0;o<i.elements.length;o++){var a=i.elements[o];a.name!==t&&s.push({semantic:a.name,type:a.dataType,components:a.numComponents,normalize:a.normalize})}var u=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,s),c=new Float32Array(u.size/4*e.numVertices),h=0;for(o=0;o<e.numVertices;o++){var l=o-Math.floor(o/(u.size/4));l>=n.offset&&l<n.offset+n.components||(c[h++]=r[o])}e.invalidateBuffer();var p=e.numVertices*e.format.size;e.device._vram.vb+=p-e.numBytes,e.format=u,e.numBytes=p,e.storage=c.buffer}}},recalculateBounds:function(){var t=new pc.Vec3,e=new pc.Vec3,i=new pc.Vec3,n=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0);if(n.offset<0)this._aabb.setMinMax(pc.Vec3.ZERO,pc.Vec3.ZERO);else{for(var r=new Float32Array(this.vertexBuffer.lock()),s=0;s<this.subMeshes.length;s++)for(var o=this.subMeshes[s],a=new Uint16Array(o.indexBuffer[0].storage),u=0;u<a.length;u++){var c=a[u]*n.stride+n.offset;i.set(r[c+0],r[c+1],r[c+2]),t.x=t.x>i.x?i.x:t.x,t.y=t.y>i.y?i.y:t.y,t.z=t.z>i.z?i.z:t.z,e.x=e.x<i.x?i.x:e.x,e.y=e.y<i.y?i.y:e.y,e.z=e.z<i.z?i.z:e.z}this._aabb.setMinMax(t,e)}},getVertexArrayObject:function(){if(this.vao)return this.vao;var t=UnityEngine.Graphics.graphicsDevice;this.vao=t.gl.createVertexArray(),t.gl.bindVertexArray(this.vao),this.vertexBuffer.unlock(),this.indexBuffer[0].unlock();for(var o=this.vertexBuffer.format,a=0;a<16;a++)t.gl.disableVertexAttribArray(a);t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.POSITION,n),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.COLOR,e),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.TANGENT,r),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.NORMAL,s),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.TEXCOORD0,i);for(a=0;a<o.elements.length;a++){var u=o.elements[a],c=pc.ShaderAttributeSlots[u.name];t.gl.enableVertexAttribArray(c),t.gl.vertexAttribPointer(c,u.numComponents,t.glType[u.dataType],u.normalize,u.stride,u.offset)}return t.gl.bindVertexArray(null),this.vao},setSubMeshCount:function(t){for(var e=t;e<this.subMeshes.length;e++)this.subMeshes[e]._refCount=-1/0;this.subMeshes.length=t;for(e=0;e<t;e++)this.subMeshes[e]||(this.subMeshes[e]=new pc.Mesh(!0),this.subMeshes[e].vertexBuffer=this.vertexBuffer,this.subMeshes[e].indexBuffer=[new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC)]);this.version++},recalculateNormals:function(){this.enableSemantic(pc.SEMANTIC_NORMAL);for(var t=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),e=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_NORMAL,!0),i=new Float32Array(this.vertexBuffer.lock()),n=new pc.Vec3,r=new pc.Vec3,s=new pc.Vec3,o=-1,a=0;a<this.subMeshes.length;a++){if(this.getTopology(a)!==UnityEngine.MeshTopology.Triangles)throw new Error("Cannot recalculate normals for non-triangle mesh");for(var u=this.subMeshes[a],c=new Uint16Array(u.indexBuffer[0].storage),h=0;h<c.length;h+=3)o=c[h+0]*t.stride+t.offset,n.set(i[o+0],i[o+1],i[o+2]),o=c[h+1]*t.stride+t.offset,r.set(i[o+0],i[o+1],i[o+2]),o=c[h+2]*t.stride+t.offset,s.set(i[o+0],i[o+1],i[o+2]),r.sub(s),n.sub(s),s.cross(n,r),i[(o=c[h+0]*e.stride+e.offset)+0]=s.x,i[o+1]=s.y,i[o+2]=s.z,i[(o=c[h+1]*e.stride+e.offset)+0]=s.x,i[o+1]=s.y,i[o+2]=s.z,i[(o=c[h+2]*e.stride+e.offset)+0]=s.x,i[o+1]=s.y,i[o+2]=s.z}this.vertexBuffer.unlock()},recalculateTangents:function(){var t=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD0,!0);if(!(t.offset<0)){this.enableSemantic(pc.SEMANTIC_TANGENT);for(var e=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),i=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TANGENT,!0),n=new Float32Array(this.vertexBuffer.lock()),r=new pc.Vec3,s=new pc.Vec3,o=new pc.Vec3,a=new pc.Vec2,u=new pc.Vec2,c=new pc.Vec2,h=new pc.Vec3,l=-1,p=0;p<this.subMeshes.length;p++){if(this.getTopology(p)!==UnityEngine.MeshTopology.Triangles)throw new Error("Cannot recalculate tangents for non-triangle mesh");for(var d=this.subMeshes[p],f=new Uint16Array(d.indexBuffer[0].storage),y=0;y<f.length;y+=3){l=f[y+0]*e.stride+e.offset,r.set(n[l+0],n[l+1],n[l+2]),l=f[y+1]*e.stride+e.offset,s.set(n[l+0],n[l+1],n[l+2]),l=f[y+2]*e.stride+e.offset,o.set(n[l+0],n[l+1],n[l+2]),l=f[y+0]*t.stride+t.offset,a.set(n[l+0],n[l+1]),l=f[y+1]*t.stride+t.offset,u.set(n[l+0],n[l+1]),l=f[y+2]*t.stride+t.offset,c.set(n[l+0],n[l+1]);var m=u.x-a.x,_=c.x-a.x,g=u.x-c.x,v=u.y-a.y,A=c.y-a.y,E=u.y-c.y,b=Math.abs(m)+Math.abs(v),S=Math.abs(_)+Math.abs(A),M=Math.abs(g)+Math.abs(E);b>S?b>M?(h.sub2(s,r),h.x*=m>0?1:-1,h.y*=v>0?1:-1):(h.sub2(o,s),h.x*=g>0?1:-1,h.y*=E>0?1:-1):S>M?(h.sub2(o,r),h.x*=_>0?1:-1,h.y*=A>0?1:-1):(h.sub2(o,s),h.x*=g>0?1:-1,h.y*=E>0?1:-1),n[(l=f[y+0]*i.stride+i.offset)+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1,n[(l=f[y+1]*i.stride+i.offset)+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1,n[(l=f[y+2]*i.stride+i.offset)+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1}}this.vertexBuffer.unlock()}},getVertexCount:function(){return this.vertexBuffer?this.vertexBuffer.numVertices:0},getTopology:function(t){var e=this.subMeshes[t];switch(e.primitive[0].type){case pc.gfx.PRIMITIVE_TRIANGLES:return UnityEngine.MeshTopology.Triangles;case pc.gfx.PRIMITIVE_LINES:return UnityEngine.MeshTopology.Lines;case pc.gfx.PRIMITIVE_LINESTRIP:return UnityEngine.MeshTopology.LineStrip;case pc.gfx.PRIMITIVE_POINTS:return UnityEngine.MeshTopology.Points}throw new Error("Mesh's topology is set to "+e.primitive[0].type+", which is not suppored by Unity API")},configureIndexBufferAsTriangleStrip:function(t,e){this.primitive[t].type=pc.gfx.PRIMITIVE_TRISTRIP,this.primitive[t].base=0,this.primitive[t].count=e,this.primitive[t].indexed=!0},configureIndexBufferAsTriangles:function(t,e){this.primitive[t].type=pc.gfx.PRIMITIVE_TRIANGLES,this.primitive[t].base=0,this.primitive[t].count=e,this.primitive[t].indexed=!0},clone:function(){var t=new pc.Mesh;t.name=this.name+" Instance",t.aabb.copy(this.aabb);var e=pc.ShaderAttributeSlots,i=[];Object.assign(i,this.defaultStreams);for(var n=this.vertexBuffer.format.elements,r=0;r<n.length;r++)i[e[n[r].name]]=!0;var s=t.defaultVertexBuffer(i,this.getVertexCount(),this.vertexBuffer.storage.slice(0,this.vertexBuffer.storage.byteLength));t.vertexBuffer=s,t.subMeshes=[];for(r=0;r<this.subMeshes.length;r++){var o=this.subMeshes[r],a=o.indexBuffer[0],u=a.storage.slice(0,a.storage.byteLength),c=new Int16Array(u),h=new pc.Mesh(!0);h.aabb.copy(o.aabb);var l=t.defaultIndexBuffer(c.length,c);h.vertexBuffer=s,h.indexBuffer[0]=l,h.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,h.primitive[0].base=0,h.primitive[0].count=c.length,h.primitive[0].indexed=!0,t.subMeshes.push(h)}t.indexBuffer=t.subMeshes[0].indexBuffer,t.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,t.primitive[0].base=0,t.primitive[0].count=t.indexBuffer[0].numIndices,t.primitive[0].indexed=!0;for(r=0;r<this.bindposes.length;r++)t.bindposes.push(this.bindposes[r].clone());return t}})}(),function(){var t=pc.Model;pc.Model=function(){t.call(this),this._lightmapIndex=-1,this._lightmapSceneIndex=0,this._lightmapScaleOffset=new pc.Vec4,this._sortingLayerIndex=0,this._sortingOrder=0,this._drawOrder=0,this._nearestScreen=null,this._stencil=null,this._element=null,this._visible=!0,this._parameters={},this._constAttributes={},this._isStatic=!1,this._needsUpdate=!0,this._masksChildren=!1},pc.Model.prototype=t.prototype,Object.defineProperty(pc.Model.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this._needsUpdate||this._updateVisibility()}}),Object.defineProperty(pc.Model.prototype,"stencil",{get:function(){return this._stencil},set:function(t){this._stencil=t,this._needsUpdate||this._updateStencil()}}),Object.defineProperty(pc.Model.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t,this._needsUpdate||this._updateElement()}}),Object.defineProperty(pc.Model.prototype,"nearestScreen",{get:function(){return this._nearestScreen},set:function(t){this._nearestScreen=t,this._needsUpdate||this._updateNearestScreen()}}),Object.defineProperty(pc.Model.prototype,"lightmapIndex",{get:function(){return this._lightmapIndex},set:function(t){this._lightmapIndex=t,this._needsUpdate||this._configureLightmaps()}}),Object.defineProperty(pc.Model.prototype,"lightmapScaleOffset",{get:function(){return this._lightmapScaleOffset},set:function(t){this._lightmapScaleOffset=t,this._needsUpdate||this._configureLightmaps()}}),Object.defineProperty(pc.Model.prototype,"materials",{get:function(){return this._materials},set:function(t){this._materials=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"material",{get:function(){return this._materials?this._materials[0]:null},set:function(t){this._materials=this._materials||[],this._materials[0]=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"mesh",{get:function(){return this._mesh},set:function(t){this._mesh=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"skin",{get:function(){return this._skin},set:function(t){this._skin=t,this._needsUpdate||this._updateSkin()}}),Object.defineProperty(pc.Model.prototype,"bones",{get:function(){return this._bones},set:function(t){this._bones=t,this._needsUpdate||this._updateSkin()}}),Object.defineProperty(pc.Model.prototype,"sortingLayerIndex",{get:function(){return this._sortingLayerIndex},set:function(t){this._sortingLayerIndex=t,this._needsUpdate||this._updateSortingIndexes()}}),Object.defineProperty(pc.Model.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){this._sortingOrder=t,this._needsUpdate||this._updateSortingIndexes()}}),Object.defineProperty(pc.Model.prototype,"drawOrder",{get:function(){return this._drawOrder},set:function(t){this._drawOrder=t,this._needsUpdate||this._updateDrawOrder()}}),Object.defineProperty(pc.Model.prototype,"cullingLayer",{get:function(){return this._cullingLayer},set:function(t){this._cullingLayer=t,this._needsUpdate||this._updateCulling()}}),Object.defineProperty(pc.Model.prototype,"lightProbe",{get:function(){return this._lightProbe},set:function(t){this._lightProbe=t,this._needsUpdate||this._updateLightProbe()}}),Object.defineProperty(pc.Model.prototype,"lightProbeUsage",{get:function(){return this._lightProbeUsage},set:function(t){t!==this._lightProbeUsage&&(this._lightProbeUsage=t,this._needsUpdate||this._updateLightProbe())}}),Object.defineProperty(pc.Model.prototype,"blendReflectionProbes",{get:function(){return this._blendReflectionProbes},set:function(t){this._blendReflectionProbes!==t&&(this._blendReflectionProbes=t,this._needsUpdate||this._updateReflectionProbesBlending())}}),Object.defineProperty(pc.Model.prototype,"reflectionProbes",{get:function(){return this._reflectionProbes},set:function(t){null===this._reflectionProbes&&null===t||(this._reflectionProbes=t,this._needsUpdate||this._updateReflectionProbes())}}),Object.defineProperty(pc.Model.prototype,"flipFaces",{get:function(){return this._flipFaces},set:function(t){this._flipFaces!==t&&(this._flipFaces=t,this._needsUpdate||this._updateFlipFaces())}}),Object.defineProperty(pc.Model.prototype,"isStatic",{get:function(){return this._isStatic},set:function(t){var e;if(this._isStatic!==t&&(this._isStatic=t,this.model)){const i=this.model.meshInstances;for(e=0;e<i.length;e++)i[e].isStatic=t}}}),Object.defineProperty(pc.Model.prototype,"masksChildren",{get:function(){return this._masksChildren},set:function(t){this._masksChildren=t,this._needsUpdate||this._updateMasksChildren()}}),pc.extend(pc.Model.prototype,{setParameter:function(t,e){this._parameters[t]=e,this._needsUpdate||this._updateParameters()},deleteParameter:function(t){delete this._parameters[t],this._needsUpdate||this._updateParameters()},setConstant:function(t,e){this._constAttributes[t]=e,this._needsUpdate||this._updateConstants()},deleteConstant:function(t){delete this._constAttributes[t],this._needsUpdate||this._updateConstants()},setLightProbe:function(t,e){this._lightProbe=t,this._updateLightProbe(e)},update:function(){this._needsUpdate&&(this._needsUpdate=!1,this._configureMeshInstances())},setMeshDirectlyToMeshInstance:function(t){if(0===this.meshInstances.length)this.mesh!==t&&(this.mesh=t);else{let e=this.meshInstances[0];e.mesh!==t&&(e.mesh=t)}},setBlendShapeWeight:function(t,e){this.morphInstance?this.morphInstance.setWeight(t,e):console.error("SetBlendShapeWeight called for non blendable mesh.")},_configureMeshInstances:function(){if(this._mesh)if(this._materials){var t=this._mesh.subMeshes.length,e=this._materials.length,i=0,n=!1;i=1===t?Math.max(1,e):t,this.meshInstances.length=i;for(var r=0;r<this.meshInstances.length;r++){var s=this._materials[Math.min(this._materials.length-1,r)],o=this._mesh.subMeshes[Math.min(this._mesh.subMeshes.length-1,r)];if(this.meshInstances[r]){var a=this.meshInstances[r].mesh!==o;n=n||a||this.meshInstances[r].material!==s,this.meshInstances[r].mesh=o,this.meshInstances[r].material=s,a&&(this.meshInstances[r]._aabbVer=-1)}else this.meshInstances[r]=new pc.MeshInstance(this.entity,o,s),n=!0,this.morphInstance&&(this.meshInstances[r].morphInstance=this.morphInstance)}this.entity&&(this._flipFaces=this.entity._isOddlyScaled()),this._updateParameters(),this._updateConstants(),this._updateSkin(),this._updateFlipFaces(),this._updateSortingIndexes(),this._updateCulling(),this._updateEntity(),this._configureLightmaps(),this._updateLightProbe(),this._updateReflectionProbes(),this._updateReflectionProbesBlending(),this._updateVisibility(),this._updateElement(),this._updateNearestScreen(),this._updateDrawOrder(),this._updateStencil(),this._updateMasksChildren()}else console.log("Missing materials on "+this.entity.name);else this.meshInstances.length=0},_configureLightmaps:function(){if(this._mesh){var t=0;this._mesh.vertexBuffer.format.hasUv1||(t|=pc.SHADERDEF_LMUV0),1===UnityEngine.LightmapSettings.environmentLightingMode&&(t|=pc.SHADERDEF_LM_BAKED_AMBIENT),UnityEngine.LightmapSettings.lightmapsMode===UnityEngine.LightmapsMode.CombinedDirectional&&(t|=pc.SHADERDEF_DIRLM);for(var e=0;e<this.meshInstances.length;e++){var i=this.meshInstances[e];!this._lightmapScaleOffset||this._lightmapIndex<0?(i._shaderDefs&=~(pc.SHADERDEF_LM|pc.SHADERDEF_DIRLM|pc.SHADERDEF_LMUV0|pc.SHADERDEF_LM_DLDR),i.deleteParameter("unity_Lightmap"),i.deleteParameter("unity_LightmapInd"),i.deleteParameter("unity_LightmapST")):(i._shaderDefs|=t|pc.SHADERDEF_LM,i.setParameter("unity_LightmapST",[this._lightmapScaleOffset.x,this._lightmapScaleOffset.y,this._lightmapScaleOffset.z,this._lightmapScaleOffset.w]),i.lightmapIndex=this._lightmapIndex,i.lightmapSceneIndex=this._lightmapSceneIndex)}}},_updateParameters:function(){for(var t=Object.keys(this._parameters),e=0;e<this.meshInstances.length;e++){var i=this.meshInstances[e];i.parameters={};for(var n=0;n<t.length;n++)i.setParameter(t[n],this._parameters[t[n]])}},_updateConstants:function(){for(var t=Object.keys(this._constAttributes),e=0;e<this.meshInstances.length;e++){var i=this.meshInstances[e];i.constAttributes={};for(var n=0;n<t.length;n++)i.constAttributes[t[n]]=this._constAttributes[t[n]]}},_updateSkin:function(){if(this._skin){var t=new pc.SkinInstance(this._skin);t.bones=this._bones;for(var e=0;e<this.meshInstances.length;e++)this.meshInstances[e].mesh.skin=this._skin,this.meshInstances[e].skinInstance=t}},_updateSortingIndexes:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].sortingLayerIndex=this._sortingLayerIndex,this.meshInstances[t].sortingOrder=this._sortingOrder},_updateFlipFaces:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._flipFaces=this._flipFaces},_updateReflectionProbes:function(){for(var t=this._reflectionProbes?this._reflectionProbes[0]:null,e=this._reflectionProbes?this._reflectionProbes[1]:null,i=pc.reflectionProbeUniforms,n=0;n<this.meshInstances.length;n++){var r=this.meshInstances[n];if(null!=t){var s=t.getBox(r.aabb);r.setParameter(i[0],t.cubemap),r.setParameter(i[1],s.min.data),r.setParameter(i[2],s.max.data),r.setParameter(i[3],s.position.data)}else r.deleteParameter(i[0]),r.deleteParameter(i[1]),r.deleteParameter(i[2]),r.deleteParameter(i[3]);if(null!=e){s=e.getBox(r.aabb);r.setParameter(i[4],e.cubemap),r.setParameter(i[5],s.min.data),r.setParameter(i[6],s.max.data),r.setParameter(i[7],s.position.data)}else r.deleteParameter(i[4]),r.deleteParameter(i[5]),r.deleteParameter(i[6]),r.deleteParameter(i[7])}},_updateReflectionProbesBlending:function(){for(var t=0;t<this.meshInstances.length;t++){var e=this.meshInstances[t];this._blendReflectionProbes?e._shaderDefs|=pc.SHADERDEF_BLEND_REFLECTION_PROBES:e._shaderDefs&=~pc.SHADERDEF_BLEND_REFLECTION_PROBES}},_updateLightProbe:function(){for(var t=(!this._lightmapScaleOffset||this._lightmapIndex<0)&&this.lightProbeUsage,e=0;e<this.meshInstances.length;e++){var i=this.meshInstances[e];t?(i._shaderDefs|=pc.SHADERDEF_LIGHTPROBES,i._lightProbe=this._lightProbe):(i._shaderDefs&=~pc.SHADERDEF_LIGHTPROBES,i._lightProbe=null)}},_updateCulling:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].mask=1<<this._cullingLayer},_updateVisibility:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].visible=this._visible},_updateEntity:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].node=this.entity},_updateElement:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._element=this._element},_updateNearestScreen:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._nearestScreen=this._nearestScreen},_updateDrawOrder:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].drawOrder=this._drawOrder},_updateStencil:function(){for(var t=0;t<this.meshInstances.length;t++)this.meshInstances[t].stencilBack=this._stencil,this.meshInstances[t].stencilFront=this._stencil},_updateMasksChildren:function(){for(let t=0;t<this.meshInstances.length;t++){let e=this.meshInstances[t];this._masksChildren?e._shaderDefs|=pc.SHADERDEF_UI_MASK:e._shaderDefs&=~pc.SHADERDEF_UI_MASK}}})}(),pc.extend(pc.Scene.prototype,{rigidBodies:{},raycastRigidBody:function(t,e){var i=this.rigidBodies,n=pc.Application.getApplication().getMainCamera();if(!n)return null;var r=n.camera,s=r.screenToWorld(t.x,t.y,-r.nearClip,e.clientRect.width,e.clientRect.height),o=r.screenToWorld(t.x,t.y,-r.farClip,e.clientRect.width,e.clientRect.height).sub(s),a=null,u=Number.NEGATIVE_INFINITY;for(var c in i)if(i.hasOwnProperty(c)){var h=i[c].entity,l=i[c].data;if(h.enabled&&l){var p=h.getWorldTransform(),d=pc.math.rayCastBox(l.center,l.halfExtents,p,s,o);d&&d>u&&(u=d,a=h)}}return a},raycast:function(t){var e=this.rigidBodies,i=t.m_Origin,n=t.m_Direction,r=null,s=Number.NEGATIVE_INFINITY;for(var o in e)if(e.hasOwnProperty(o)){var a=e[o].entity,u=e[o].data,c=e[o].collider;if(a.enabled&&c.enabled&&u){var h=a.getWorldTransform(),l=pc.math.rayCastBox(u.center,u.halfExtents,h,i,n);l&&l>s&&(s=l,r=a)}}return r}}),window.Bridge.property=function(t,e,i,n,r,s){var o={enumerable:!s,configurable:!0};if(i&&i.get&&(o.get=i.get),i&&i.set&&(o.set=i.set),!i||!i.get&&!i.set){var a=Bridge.getTypeAlias(r)+"$"+e;r.$init=r.$init||{},n&&(r.$init[a]=i),function(t,e,i,n){t.get=function(){var t=this.$init[i];return void 0===t?n:t},t.set=function(t){this.$init[i]=t}}(o,0,a,i)}const u=[e],c=r.$descriptors||[];for(let t=0;t<c.length;t++){const i=c[t];if(i.name===e)for(let t=0;t<c.length;t++){const e=c[t];e.get===i.get&&e.set===i.set&&(-1===u.indexOf(e.name)&&u.push(e.name))}}for(const e of u)Object.defineProperty(t,e,o),t["get"+e]=t["get"+e]||o.get,t["set"+e]=t["set"+e]||o.set;return o},pc.extend(pc.Texture.prototype,{toBuffer:function(){var t=this.device.gl;this._glTexture||(this.device.setTexture(this,0),this.device.uploadTexture(this));var e=this._glTexture,i=this.width,n=this.height;(this._needsUpload||this._needsMipmapsUpload)&&this.device.uploadTexture(this);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var s=new Uint8Array(i*n*4);return t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,s),t.deleteFramebuffer(r),s},sync:function(t){var e=this.device.gl,i=this._glTexture,n=this.width/(1<<t),r=this.height/(1<<t),s=this.device.activeFramebuffer,o=e.createFramebuffer();if(this.device.setFramebuffer(o),this._cubemap){this._levels=this._levels||[],this._levels[t]=this._levels[t]||[];for(var a=0;a<6;a++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+a,i,t),this._levels[t][a]=new Uint8Array(n*r*4),e.readPixels(0,0,n,r,e.RGBA,e.UNSIGNED_BYTE,this._levels[t][a])}else e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,t),this._levels=this._levels||[],this._levels[t]=new Uint8Array(n*r*4),e.readPixels(0,0,n,r,e.RGBA,e.UNSIGNED_BYTE,this._levels[t]);this.device.setFramebuffer(s)},markUploaded:function(){this._needsUpdate||(this._needsUpload=!1)},setPixels:function(t){null===this._buffer&&(this._buffer=this.createBuffer(this._format,this._width,this._height));for(var e=0;e<t.length;e++){var i=4*e;this._buffer[i+0]=255*t[e].r,this._buffer[i+1]=255*t[e].g,this._buffer[i+2]=255*t[e].b,this._buffer[i+3]=255*t[e].a}this._levels[0]=this._buffer,this._needsUpload=!0},setPixelData:function(t){this.width,this.height,this.device.setTexture(this,0),this._levels=[t],this._needsUpload=!0,this.device.uploadTexture(this)},toDataURI:function(){var t=this.width,e=this.height,i=this.toBuffer(),n=document.createElement("canvas");n.width=t,n.height=e;var r=n.getContext("2d",{alpha:!0}),s=r.createImageData(t,e);return s.data.set(i),r.putImageData(s,0,0),r.scale(1,-1),r.translate(0,-s.height),r.drawImage(r.canvas,0,0),n.toDataURL()},copyCubemap:function(t){t._glTexture||this.device.uploadTexture(t),this._glTexture=t._glTexture,this._glTarget=t._glTarget,this._glInternalFormat=t._glInternalFormat,this._glFormat=t._glFormat,this._glPixelType=t._glPixelType,this._parameterFlags=t._parameterFlags,this.rgbm=t.rgbm,this._width=t._width,this._height=t._height,this._needsUpload=!1,this._needsMipmapsUpload=!1}}),pc.extend(pc.VertexBuffer.prototype,{resize:function(t){var e=t*this.format.size;if(e!=this.numBytes){this.device._vram.vb+=e-this.numBytes,this.numBytes=e,this.numVertices=t;var i=this.storage;this.storage=new ArrayBuffer(this.numBytes),new Uint8Array(this.storage).set(new Uint8Array(i.slice(0,this.numBytes))),this.invalidateBuffer()}},invalidateBuffer:function(){var t=this.device;if(this.bufferId){var e=t.gl;for(var i in e.deleteBuffer(this.bufferId),this.bufferId=null,t.boundBuffer=null,t.vertexBuffers.length=0,t.vbOffsets.length=0,t.attributesInvalidated=!0,t.enabledAttributes)e.disableVertexAttribArray(i);t.enabledAttributes={}}}}),pc.extend(pc.IndexBuffer.prototype,{resize:function(t){var e=t*this.bytesPerIndex;if(e!=this.numBytes){this.numBytes=e,this.numIndices=t;var i=this.storage;this.storage=new ArrayBuffer(this.numBytes),new Uint8Array(this.storage).set(new Uint8Array(i.slice(0,this.numBytes))),this.invalidateBuffer()}},invalidateBuffer:function(){var t=this.device;this.bufferId&&(t.gl.deleteBuffer(this.bufferId),this.bufferId=null,t.indexBuffer===this&&(t.indexBuffer=null))}}),pc.extend(pc.VertexFormat.prototype,{getStructureFor:function(t,e){for(var i=-1,n=e?4:1,r=0;r<this.elements.length;r++)if(this.elements[r].name==t){i=this.elements[r].offset;break}return result={offset:i/n,stride:this.size/n},result}}),pc.extend(pc.VertexIterator.prototype,{setVector4:function(t,e){this.element[t].set(e[0],e[1],e[2]||0,e[3]||1)},setVector3:function(t,e){this.element[t].set(e[0],e[1],e[2])},setVector2:function(t,e){this.element[t].set(e[0],e[1])}}),function(){var t=new pc.Vec2,e=new pc.Vec2;pc.extend(pc.Vec2,{ctor:pc.Vec2,$kind:"struct",kEpsilon:1e-5,kEpsilonNormalSqrt:1e-15,angle:function(i,n){return t.copy(i).normalize(),e.copy(n).normalize(),Math.acos(pc.math.clamp(t.dot(e),-1,1))*pc.math.RAD_TO_DEG},signedAngle:function(t,e){return pc.Vec2.angle(t,e)*pc.math.sign(t.x*e.y-t.y*e.x)},lengthClamp:function(t,e){return t.lengthSq()>e*e?t.clone().normalize().scale(e):t.clone()},reflect:function(e,i){t.copy(i);var n=-2*t.dot(e);return t.scale(n),t.add(e).clone()},moveTowards:function(e,i,n){var r=t.copy(i).sub(e),s=r.length();return s<=n||s<1401298e-51?i.clone():e.clone().add(r.scale(1/s*n))},smoothDamp:function(t,e,i,n,r,s){var o=2/(n=Math.max(1e-4,n)),a=o*s,u=1/(1+a+.479999989271164*a*a+.234999999403954*a*a*a),c=t.clone().sub(e.clone()),h=e.clone(),l=r*n,p=pc.Vec2.lengthClamp(c.clone(),l);e=t.clone().sub(p.clone());var d=i.v.clone().add(p.clone().scale(o)).scale(s);i.v=i.v.clone().sub(d.clone().scale(o)).scale(u);var f=e.clone().add(p.clone().add(d.clone()).scale(u));return h.clone().sub(t.clone()).dot(f.clone().sub(h.clone()))>0&&(f=h.clone(),i.v=f.clone().sub(h.clone()).scale(1/s)),f.clone()},equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec2},FromVector3:function(t){return new pc.Vec2(t.x,t.y)},FromVector4:function(t){return new pc.Vec2(t.x,t.y)}}),pc.extend(pc.Vec2.prototype,{setFromMax:function(t,e){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),this},strictEquals:function(t){return t instanceof pc.Vec2&&this.equals(t)},div:function(t){return this.x/=t.x,this.y/=t.y,this},$getType:function(){return pc.Vec2},getitem:pc.Vec2.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y}},setitem:pc.Vec2.prototype.iset=function(t,e){switch(t){case 0:return this.x=e;case 1:return this.y=e}},getHashCode:pc.Vec2.prototype.hash=function(){return this.x^this.y},$clone:function(t){return(t=t||new pc.Vec2).copy(this),t},fromVector3:function(t){return this.x=t.x,this.y=t.y,this},fromVector4:function(t){return this.x=t.x,this.y=t.y,this}})}(),function(){const t=new pc.Vec3(1,1,-1);let e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,r=new pc.Quat;pc.extend(pc.Vec3,{ctor:pc.Vec3,$kind:"struct",kEpsilon:1e-5,kEpsilonNormalSqrt:1e-15,distance:function(t,i){return e.copy(t).sub(i).length()},projectOnPlane:function(t,n,r){return r=r||new pc.Vec3,e.copy(t),i.copy(t),e.sub(i.project(n)),r.copy(e),r},smoothDamp:function(t,e,i,n,r,s){var o=2/(n=UnityEngine.Mathf.Max(1e-4,n)),a=o*s,u=1/(1+a+.479999989271164*a*a+.234999999403954*a*a*a),c=t.clone().sub(e.clone()),h=e.clone(),l=r*n,p=pc.Vec3.clampMagnitude(c.clone(),l);e=t.clone().sub(p.clone());var d=i.v.clone().add(p.clone().scale(o)).scale(s);i.v=i.v.clone().sub(d.clone().scale(o)).scale(u);var f=e.clone().add(p.clone().add(d.clone()).scale(u));return h.clone().sub(t.clone()).dot(f.clone().sub(h.clone()))>0&&(f=h.clone(),i.v=f.clone().sub(h.clone()).scale(1/s)),f.clone()},clampMagnitude:function(t,e){return t.length()>Math.abs(e)?t.clone().normalize().scale(e):t.clone()},reflect:function(t,i){return e.copy(i),e.scale(-2*t.dot(i)).add(t),e.clone()},moveTowards:function(t,i,n){var r=e.copy(i).sub(t),s=r.length();return s<=n||s<1401298e-51?i.clone():t.clone().add(r.scale(1/s*n))},orthoNormalize:function(t,e,i){t.normalize(),e.cross(t,e),e.cross(e,t),e.normalize(),i.cross(t,e)},signedAngle:function(t,n,r){e.copy(t).normalize(),i.copy(n).normalize();var s=pc.math.clamp(i.dot(e),-1,1);e.cross(t,n);var o=r.dot(e),a=pc.math.sign(o);return Math.acos(s)*a*pc.math.RAD_TO_DEG},rotateTowards:function(t,s,o,a){var u=e.cross(t,s),c=n.setLookAt(t,u),h=r.setLookAt(s,u),l=pc.Quat.rotateTowards(c,h,o*pc.math.RAD_TO_DEG);e.set(0,0,1);var p=l.transformVector(e,i),d=s.length()-t.length(),f=t.length()+pc.math.sign(d)*Math.min(Math.abs(d),a);return p.normalize(),p.mul(new pc.Vec3(f,f,f)),p.clone()},angle:function(t,n){return Math.acos(pc.math.clamp(e.copy(t).normalize().dot(i.copy(n).normalize()),-1,1))*pc.math.RAD_TO_DEG},equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec3},FromVector2:function(t){return new pc.Vec3(t.x,t.y,0)},FromVector4:function(t){return new pc.Vec3(t.x,t.y,t.z)},cachedNegativeInfinity:new pc.Vec3(-1/0,-1/0,-1/0),cachedPositiveInfinity:new pc.Vec3(1/0,1/0,1/0),cachedForward:new pc.Vec3(0,0,1),cachedBack:new pc.Vec3(0,0,-1),cachedOne:new pc.Vec3(1,1,1)}),pc.extend(pc.Vec3.prototype,{slerp:function(t,e,i){i=pc.math.clamp(i,0,1);var n=t.length();if(n<Number.EPSILON)return this.copy(t);var r=e.length();if(r<Number.EPSILON)return this.copy(e);var s=1-i,o=t.dot(e)/(n*r);if(o<=-1||1<=o)return this.copy(t).normalize().scale(s*n+i*r);var a=Math.acos(o);if(a<Number.EPSILON)return this.copy(t);var u=Math.sin(a),c=Math.sin(s*a)/u,h=Math.sin(i*a)/u;return this.set(t.x*c+e.x*h,t.y*c+e.y*h,t.z*c+e.z*h).normalize().scale(s*n+i*r)},slerpUnclamped:function(t,e,i){var n=t.length();if(n<Number.EPSILON)return this.copy(t);var r=e.length();if(r<Number.EPSILON)return this.copy(e);var s=1-i,o=t.dot(e)/(n*r);if(o<=-1||1<=o)return this.copy(t).normalize().scale(s*n+i*r);var a=Math.acos(o);if(a<Number.EPSILON)return this.copy(t);var u=Math.sin(a),c=Math.sin(s*a)/u,h=Math.sin(i*a)/u;return this.set(t.x*c+e.x*h,t.y*c+e.y*h,t.z*c+e.z*h).normalize().scale(s*n+i*r)},abs:function(t){return t?(t.x=this.x<0?-this.x:this.x,t.y=this.y<0?-this.y:this.y,t.z=this.z<0?-this.z:this.z,t):(this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y),this.z<0&&(this.z=-this.z),this)},strictEquals:function(t){return t instanceof pc.Vec3&&this.equals(t)},approximatelyEquals:function(t,e){return e=e||1e-5,Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e},$getType:function(){return pc.Vec3},getitem:pc.Vec3.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z}},setitem:pc.Vec3.prototype.iset=function(t,e){switch(t){case 0:return this.x=e;case 1:return this.y=e;case 2:return this.z=e}},getHashCode:pc.Vec3.prototype.hash=function(){return this.x^this.y^this.z},$clone:function(t){return(t=t||new pc.Vec3).copy(this),t},fromVector2:function(t){return this.x=t.x,this.y=t.y,this.z=0,this},fromVector4:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},equalsWithEpsilon:function(t,e){return e=e||1e-6,Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e}}),pc.Vec3.REVERSED_Z=t}(),function(){let t=new pc.Vec4;pc.extend(pc.Vec4,{ctor:pc.Vec4,$kind:"struct",distance:function(e,i){return t.copy(e).sub(i).length()},moveTowards:function(e,i,n){var r=t.copy(i).sub(e),s=r.length();return s<=n||s<1401298e-51?i.clone():e.clone().add(r.scale(1/s*n))},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec4},FromVector2:function(t){return new pc.Vec4(t.x,t.y,0,0)},FromVector3:function(t){return new pc.Vec4(t.x,t.y,t.z,0)}}),pc.extend(pc.Vec4.prototype,{project:function(t){var e=(this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w)/(t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w);return this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this.w=t.w*e,this},getitem:pc.Vec4.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}},setitem:pc.Vec4.prototype.iset=function(t,e){switch(t){case 0:return this.x=e;case 1:return this.y=e;case 2:return this.z=e;case 3:return this.w=e}},strictEquals:function(t){return t instanceof pc.Vec4&&this.equals(t)},lerpUnclamped:function(t,e,i){return this.x=t.x+i*(e.x-t.x),this.y=t.y+i*(e.y-t.y),this.z=t.z+i*(e.z-t.z),this},hash:function(){return this.x^this.y^this.z^this.w},getHashCode:function(){return this.hash()},fromVector2:function(t){return this.x=t.x,this.y=t.y,this.z=0,this.w=0,this},fromVector3:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=0,this},$getType:function(){return pc.Vec4},$clone:function(t){return(t=t||new pc.Vec4).copy(this),t}})}(),pc.extend(pc.Quat,{ctor:pc.Quat,$kind:"struct",getDefaultValue:function(){return new pc.Quat},rotateTowards:function(t,e,i){var n=this.angle(t,e);return n<1401298e-51?e:(new pc.Quat).slerpUnclamped(t,e,Math.min(1,i/n))},angle:function(t,e){var i=t.dot(e),n=0;return i<.999998986721039&&(n=2*Math.acos(Math.min(Math.abs(i),1))*pc.math.RAD_TO_DEG),n}}),pc.extend(pc.Quat.prototype,{getitem:pc.Quat.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}},setitem:pc.Quat.prototype.iset=function(t,e){switch(t){case 0:return this.x=e;case 1:return this.y=e;case 2:return this.z=e;case 3:return this.w=e}},setFromEulerAngles_Unity:function(t,e,i){var n=t*pc.math.DEG_TO_RAD*.5,r=e*pc.math.DEG_TO_RAD*.5,s=i*pc.math.DEG_TO_RAD*.5,o=Math.sin(n),a=Math.cos(n),u=Math.sin(r),c=Math.cos(r),h=Math.sin(s),l=Math.cos(s);return this.x=c*o*l+u*a*h,this.y=u*a*l-c*o*h,this.z=c*a*h-u*o*l,this.w=c*a*l+u*o*h,this},getEulerAngles_Unity:function(t){t=t||new pc.Vec3;var e=this,i=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w,n=e.x*e.w-e.y*e.z;return n>.4995*i?(t.x=Math.PI/2,t.y=2*Math.atan2(e.y,e.x),t.z=0):n<-.4995*i?(t.x=-Math.PI/2,t.y=-2*Math.atan2(e.y,e.x),t.z=0):(t.x=Math.asin(2*(e.w*e.x-e.y*e.z)),t.y=Math.atan2(2*e.w*e.y+2*e.z*e.x,1-2*(e.x*e.x+e.y*e.y)),t.z=Math.atan2(2*e.w*e.z+2*e.x*e.y,1-2*(e.z*e.z+e.x*e.x))),t.x=t.x*pc.math.RAD_TO_DEG,t.y=t.y*pc.math.RAD_TO_DEG,t.z=t.z*pc.math.RAD_TO_DEG,t.x+=t.x<0?360:0,t.y+=t.y<0?360:0,t.z+=t.z<0?360:0,t},getPositiveEulerAngles:function(){return this.getEulerAngles_Unity()},fromToRotation:function(t,e){var i=new pc.Vec3;i.cross(t,e);var n=new pc.Quat;return n.x=i.x,n.y=i.y,n.z=i.z,n.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),n.normalize()},lookRotation:function(t,e){var i=new pc.Vec3(0,0,0),n=new pc.Vec3(0,0,0),r=t.clone().scale(-1);r.normalize(),i.cross(e,r).normalize(),n.cross(r,i).normalize();var s=new pc.Mat3;return s.M11=i.x,s.M21=i.y,s.M31=i.z,s.M12=n.x,s.M22=n.y,s.M32=n.z,s.M13=r.x,s.M23=r.y,s.M33=r.z,this.rotationMatrix(s)},rotationMatrix:function(t){var e,i,n=new pc.Quat,r=t.M11+t.M22+t.M33;return r>0?(e=Math.sqrt(r+1),n.w=.5*e,e=.5/e,n.x=(t.M23-t.M32)*e,n.y=(t.M31-t.M13)*e,n.z=(t.M12-t.M21)*e):t.M11>=t.M22&&t.M11>=t.M33?(i=.5/(e=Math.sqrt(1+t.M11-t.M22-t.M33)),n.x=.5*e,n.y=(t.M12+t.M21)*i,n.z=(t.M13+t.M31)*i,n.w=(t.M23-t.M32)*i):t.M22>t.M33?(i=.5/(e=Math.sqrt(1+t.M22-t.M11-t.M33)),n.x=(t.M21+t.M12)*i,n.y=.5*e,n.z=(t.M32+t.M23)*i,n.w=(t.M31-t.M13)*i):(i=.5/(e=Math.sqrt(1+t.M33-t.M11-t.M22)),n.x=(t.M31+t.M13)*i,n.y=(t.M32+t.M23)*i,n.z=.5*e,n.w=(t.M12-t.M21)*i),n.normalize(),n},strictEquals:function(t){return t instanceof pc.Quat&&this.equals(t)},toAngleAxis:function(t,e){let i=this.$clone().normalize();t.v=2*Math.acos(i.w)*pc.math.RAD_TO_DEG;const n=Math.sqrt(1-i.w*i.w);1e-4>n?(e.v.x=1,e.v.z=e.v.y=0):(e.v.x=i.x/n,e.v.y=i.y/n,e.v.z=i.z/n)},$clone:function(t){return(t=t||new pc.Quat).copy(this),t}}),Object.defineProperty(pc.Quat.prototype,"xyz",{get:function(){return new pc.Vec3(this.x,this.y,this.z)}}),function(){var t,e,i,n;pc.extend(pc.Mat4,{ctor:pc.Mat4,$kind:"struct",fromArray:function(t){var e=Object.create(pc.Mat4.prototype);return e.data=t,e},getDefaultValue:function(){return new pc.Mat4},mat3FromMat4:function(t,e){t.data[0]=e.data[0],t.data[1]=e.data[1],t.data[2]=e.data[2],t.data[3]=e.data[4],t.data[4]=e.data[5],t.data[5]=e.data[6],t.data[6]=e.data[8],t.data[7]=e.data[9],t.data[8]=e.data[10]},inverse3DAffine:function(t,e){e.v=t.clone().invert()},setFrustumUnity:function(t,e,i,n,r,s){let o,a,u,c,h;return o=2*r,a=e-t,u=n-i,c=r-s,h=new pc.Mat4,h.data[0]=o/a,h.data[1]=0,h.data[2]=0,h.data[3]=0,h.data[4]=0,h.data[5]=o/u,h.data[6]=0,h.data[7]=0,h.data[8]=(e+t)/a,h.data[9]=(n+i)/u,h.data[10]=(s+r)/c,h.data[11]=-1,h.data[12]=0,h.data[13]=0,h.data[14]=o*s/c,h.data[15]=0,h},setLookAtUnity:function(t,e,i){let n=new pc.Mat4,r=new pc.Vec3,s=new pc.Vec3,o=new pc.Vec3;return o.sub2(e,t),o.length()<1e-6?n.setIdentity():(o.normalize(),s.copy(i).normalize(),r.cross(s,o).normalize(),s.cross(o,r),n.data[0]=-r.x,n.data[1]=r.y,n.data[2]=-r.z,n.data[3]=0,n.data[4]=s.x,n.data[5]=s.y,n.data[6]=s.z,n.data[7]=0,n.data[8]=-o.x,n.data[9]=-o.y,n.data[10]=-o.z,n.data[11]=0,n.data[12]=t.x,n.data[13]=t.y,n.data[14]=t.z,n.data[15]=1,this)},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)}}),pc.Mat4.prototype.getitem=pc.Mat4.prototype.iget=function(t){return this.data[t]},pc.Mat4.prototype.setitem=pc.Mat4.prototype.iset=function(t,e){return this.data[t]=e},pc.Mat4.prototype.getitem$1=pc.Mat4.prototype.ijget=function(t,e){return this.data[t+4*e]},pc.Mat4.prototype.setitem$1=pc.Mat4.prototype.ijset=function(t,e,i){return this.data[t+4*e]=i},pc.Mat4.prototype.getHashCode=pc.Mat4.prototype.hash=function(){return this.x^this.y^this.z},pc.extend(pc.Mat4.prototype,{setColumn:function(t,e){return this.data[4*t]=e.x,this.data[4*t+1]=e.y,this.data[4*t+2]=e.z,this.data[4*t+3]=e.w,this},getColumn:function(t){switch(t){case 0:return new pc.Vec4(this.data[0],this.data[1],this.data[2],this.data[3]);case 1:return new pc.Vec4(this.data[4],this.data[5],this.data[6],this.data[7]);case 2:return new pc.Vec4(this.data[8],this.data[9],this.data[10],this.data[11]);case 3:return new pc.Vec4(this.data[12],this.data[13],this.data[14],this.data[15])}},getRow:function(t){switch(t){case 0:return new pc.Vec4(this.data[0],this.data[4],this.data[8],this.data[12]);case 1:return new pc.Vec4(this.data[1],this.data[5],this.data[9],this.data[13]);case 2:return new pc.Vec4(this.data[2],this.data[6],this.data[10],this.data[14]);case 3:return new pc.Vec4(this.data[3],this.data[7],this.data[11],this.data[15])}},scale:function(t){for(var e=0;e<16;e++)this.data[e]*=t},determinant:function(){var t,e,i,n,r,s,o,a,u,c,h,l,p,d,f,y,m;return t=(m=this.data)[0],e=m[1],i=m[2],n=m[3],r=m[4],s=m[5],o=m[6],a=m[7],u=m[8],c=m[9],h=m[10],l=m[11],p=m[12],d=m[13],f=m[14],(t*s-e*r)*(h*(y=m[15])-l*f)-(t*o-i*r)*(c*y-l*d)+(t*a-n*r)*(c*f-h*d)+(e*o-i*s)*(u*y-l*p)-(e*a-n*s)*(u*f-h*p)+(i*a-n*o)*(u*d-c*p)},getRotation:function(t){let e=t||new pc.Quat;return e.setFromMat4(this),e},make64:function(){return this.data=new Float64Array(this.data),this},multiplyInverse:(t=new pc.Vec3,e=new pc.Vec3,i=new pc.Quat,n=new pc.Quat,function(r){i.setFromMat4(this).conjugate(),n.setFromMat4(r),r.getTranslation(e),this.getTranslation(t),e.sub(t),i.transformVector(e,e),i.mul(n),this.setTRS(e,i,pc.Vec3.ONE)}),transformVectorInverse:function(){var t=new pc.Quat,e=new pc.Vec3;return function(i,n){return n=n||new pc.Vec3,t.setFromMat4(this),this.getTranslation(e),n.sub2(i,e),t.transformVectorInverse(n,n),n}}(),setRotation:function(t){return this.setTRS(pc.Vec3.ZERO,t,pc.Vec3.ONE)},setTranslation:function(t){var e=this.data;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},setPerspective_Unity:function(t,e,i,n,r){return this.setPerspective(t,e,i,n,r),this.data[8]*=-1,this.data[9]*=-1,this.data[10]*=-1,this.data[11]*=-1,this},multiplyPoint:function(t,e){var i,n,r,s;s=this.data,i=t.x,n=t.y,r=t.z,(e=void 0===e?new pc.Vec3:e).x=i*s[0]+n*s[4]+r*s[8]+s[12],e.y=i*s[1]+n*s[5]+r*s[9]+s[13],e.z=i*s[2]+n*s[6]+r*s[10]+s[14];var o=1/(i*s[3]+n*s[7]+r*s[11]+s[15]);return e.scale(o),e},setData:function(t,e,i,n,r,s,o,a,u,c,h,l,p,d,f,y){return this.data[0]=t,this.data[1]=e,this.data[2]=i,this.data[3]=n,this.data[4]=r,this.data[5]=s,this.data[6]=o,this.data[7]=a,this.data[8]=u,this.data[9]=c,this.data[10]=h,this.data[11]=l,this.data[12]=p,this.data[13]=d,this.data[14]=f,this.data[15]=y,this},validTRS:function(){return!(Math.abs(this.data[3])>1e-5||Math.abs(this.data[7])>1e-5||Math.abs(this.data[11])>1e-5||Math.abs(this.data[15]-1)>1e-5)&&!(Math.abs(this.determinant)<1e-5)},decomposeProjection:function(){let t=new UnityEngine.FrustumPlanes.ctor;return t.zFar=(this.data[15]-this.data[14])/(this.data[11]-this.data[10]),t.zNear=(this.data[15]+this.data[14])/(this.data[11]+this.data[10]),t.left=(this.data[11]+this.data[8])/(this.data[3]+this.data[0])*t.zNear,t.right=(this.data[11]-this.data[8])/(this.data[3]-this.data[0])*t.zNear,t.top=(this.data[11]-this.data[9])/(this.data[7]-this.data[5])*t.zNear,t.bottom=(this.data[11]+this.data[9])/(this.data[7]+this.data[5])*t.zNear,t},transformPlane:function(t){let e=this.clone().invert(),i=t.normal.x,n=t.normal.y,r=t.normal.z,s=t.distance;return new UnityEngine.Plane.$ctor1(new pc.Vec3(e.e00*i+e.e10*n+e.e20*r+e.e30*s,e.e01*i+e.e11*n+e.e21*r+e.e31*s,e.e02*i+e.e12*n+e.e22*r+e.e32*s),e.e03*i+e.e13*n+e.e23*r+e.e33*s)},strictEquals:function(t){return t instanceof pc.Mat4&&this.equals(t)},$clone:function(t){return(t=t||new pc.Mat4).copy(this),t},equalsWithEpsilon:function(t,e){e=e||1e-6;const i=this.data,n=t.data;for(let t=0;t<16;t++)if(Math.abs(i[t]-n[t])>=e)return!1;return!0}}),Object.defineProperty(pc.Mat4.prototype,"e00",{get:function(){return this.data[0]},set:function(t){this.data[0]=t}}),Object.defineProperty(pc.Mat4.prototype,"e10",{get:function(){return this.data[1]},set:function(t){this.data[1]=t}}),Object.defineProperty(pc.Mat4.prototype,"e20",{get:function(){return this.data[2]},set:function(t){this.data[2]=t}}),Object.defineProperty(pc.Mat4.prototype,"e30",{get:function(){return this.data[3]},set:function(t){this.data[3]=t}}),Object.defineProperty(pc.Mat4.prototype,"e01",{get:function(){return this.data[4]},set:function(t){this.data[4]=t}}),Object.defineProperty(pc.Mat4.prototype,"e11",{get:function(){return this.data[5]},set:function(t){this.data[5]=t}}),Object.defineProperty(pc.Mat4.prototype,"e21",{get:function(){return this.data[6]},set:function(t){this.data[6]=t}}),Object.defineProperty(pc.Mat4.prototype,"e31",{get:function(){return this.data[7]},set:function(t){this.data[7]=t}}),Object.defineProperty(pc.Mat4.prototype,"e02",{get:function(){return this.data[8]},set:function(t){this.data[8]=t}}),Object.defineProperty(pc.Mat4.prototype,"e12",{get:function(){return this.data[9]},set:function(t){this.data[9]=t}}),Object.defineProperty(pc.Mat4.prototype,"e22",{get:function(){return this.data[10]},set:function(t){this.data[10]=t}}),Object.defineProperty(pc.Mat4.prototype,"e32",{get:function(){return this.data[11]},set:function(t){this.data[11]=t}}),Object.defineProperty(pc.Mat4.prototype,"e03",{get:function(){return this.data[12]},set:function(t){this.data[12]=t}}),Object.defineProperty(pc.Mat4.prototype,"e13",{get:function(){return this.data[13]},set:function(t){this.data[13]=t}}),Object.defineProperty(pc.Mat4.prototype,"e23",{get:function(){return this.data[14]},set:function(t){this.data[14]=t}}),Object.defineProperty(pc.Mat4.prototype,"e33",{get:function(){return this.data[15]},set:function(t){this.data[15]=t}}),Object.defineProperty(pc.Mat4.prototype,"singular",{get:function(){return 0===this.determinant()}})}(),pc.GraphicsDevice.prototype.applyStencilState=function(t,e,i){t||e||!i?(t||e)&&(this.setStencilTest(!0),t===e?(this.setStencilFunc(t.func,t.ref,t.readMask),this.setStencilOperation(t.fail,t.zfail,t.zpass,t.writeMask)):(t?(this.setStencilFuncFront(t.func,t.ref,t.readMask),this.setStencilOperationFront(t.fail,t.zfail,t.zpass,t.writeMask)):(this.setStencilFuncFront(pc.FUNC_ALWAYS,0,255),this.setStencilOperationFront(pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,255)),e?(this.setStencilFuncBack(e.func,e.ref,e.readMask),this.setStencilOperationBack(e.fail,e.zfail,e.zpass,e.writeMask)):(this.setStencilFuncBack(pc.FUNC_ALWAYS,0,255),this.setStencilOperationBack(pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,255)))):this.setStencilTest(!1)},pc.UNIFORMS_USAGE_MAP={},pc.UNIFORMS_USAGE_MAP["unity_CameraWorldClipPlanes[0]"]=1,pc.UNIFORMS_USAGE_MAP.unity_MatrixMVP=2,pc.UNIFORMS_USAGE_MAP.unity_MatrixMV=4,pc.UNIFORMS_USAGE_MAP.unity_MatrixVP=8,pc.UNIFORMS_USAGE_MAP.unity_MatrixV=16,pc.UNIFORMS_USAGE_MAP.unity_MatrixInvV=32,pc.UNIFORMS_USAGE_MAP.glstate_matrix_projection=64,pc.UNIFORMS_USAGE_MAP.unity_MatrixTMV=128,pc.UNIFORMS_USAGE_MAP.unity_MatrixITMV=256,pc.UNIFORMS_USAGE_MAP.unity_ObjectToWorld=512,pc.UNIFORMS_USAGE_MAP.unity_WorldToObject=1024,pc.UNIFORMS_USAGE_MAP.unity_CameraProjection=2048,pc.UNIFORMS_USAGE_MAP.unity_CameraInvProjection=4096,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixMVP[0]"]=2,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixMV[0]"]=4,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixVP[0]"]=8,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixV[0]"]=16,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixInvV[0]"]=32,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4glstate_matrix_projection[0]"]=64,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixTMV[0]"]=128,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixITMV[0]"]=256,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_ObjectToWorld[0]"]=512,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_WorldToObject[0]"]=1024,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_CameraProjection[0]"]=2048,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_CameraInvProjection[0]"]=4096,pc.GraphicsDevice.prototype.getUniformsInUse=function(t){for(var e=0,i=0;i<t.length;i++){var n=t[i],r=pc.UNIFORMS_USAGE_MAP[n.scopeId.name];void 0!==r&&(e|=r)}return e},function(){var t=null,e=null,i=null,n=0,r=new pc.Color,s=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,6],o=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,5,6,10,10,9,5,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10],a=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10];pc.extend(pc.ImageElement.prototype,{_imageIndexBuffer:function(){return t||(t=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,o.length),new Uint16Array(t.lock()).set(o),t.unlock(),t.destroy=function(){},t)},_emptyCenterImageIndexBuffer:function(){return e||(e=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,a.length),new Uint16Array(e.lock()).set(a),e.unlock(),e.destroy=function(){},e)},_imageRadialIndexBuffer:function(){return i||(i=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,s.length),new Uint16Array(i.lock()).set(s),i.unlock(),i.destroy=function(){},i)},_createMesh:function(){if(this._entity.isPrefab)return null;var t=new pc.VertexFormat(this._system.app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32}],16);n=9,this._fillEdges=new pc.Vec4(0,0,1,1),this._buffer=new Float32Array(16*n);var e=new pc.VertexBuffer(this._system.app.graphicsDevice,t,16,pc.BUFFER_STATIC,this._buffer.buffer),i=new pc.Mesh(!0);return i.vertexBuffer=e,i.indexBuffer[0]=this._imageIndexBuffer(),i.primitive[0].type=pc.PRIMITIVE_TRIANGLES,i.primitive[0].base=0,i.primitive[0].count=o.length,i.primitive[0].indexed=!0,i.subMeshes=[i],i},_updateMesh:function(){null==this._texture&&(this._spriteType=pc.SPRITE_TYPE_SIMPLE),this._mesh?(this._spriteType==pc.SPRITE_TYPE_FILLED&&this._fillMethod==pc.FILL_METHOD_RADIAL360?(this._updateMeshRadial(),this._mesh.indexBuffer[0]=this._imageRadialIndexBuffer(),this._mesh.primitive[0].count=s.length):(this._updateMeshSqare(),this._fillCenter?(this._mesh.indexBuffer[0]=this._imageIndexBuffer(),this._mesh.primitive[0].count=o.length):(this._mesh.indexBuffer[0]=this._emptyCenterImageIndexBuffer(),this._mesh.primitive[0].count=a.length)),this._canvasRenderer.setMesh(this._mesh)):this._canvasRenderer.setMesh(null)},_updateMeshSqare:function(){var t=this._element.width||0,e=this._element.height||0,i=new pc.Vec4(0,0,0,0),r=new pc.Vec2(0,0);this._calculatePaddings(t,e,i,r),this._spriteType==pc.SPRITE_TYPE_FILLED?(this._fillMethod==pc.FILL_METHOD_HORIZONTAL&&this._fillEdges.set(this._fillOrigin==pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-this._fillAmount,0,this._fillOrigin==pc.FILL_ORIGIN_BOTTOM_LEFT?this._fillAmount:1,1),this._fillMethod==pc.FILL_METHOD_VERTICAL&&this._fillEdges.set(0,this._fillOrigin==pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-this._fillAmount,1,this._fillOrigin==pc.FILL_ORIGIN_BOTTOM_LEFT?this._fillAmount:1)):this._fillEdges.set(0,0,1,1);var s=this._spriteType==pc.SPRITE_TYPE_SLICED||this._spriteType==pc.SPRITE_TYPE_TILED?1:0;this._sprite&&this._element.screen&&(s=s*this._element.screen.screen.referencePixelsPerUnit/this._sprite.pixelsPerUnit);var o=[i.x+t*this._fillEdges.x,i.x+t*this._fillEdges.x+Math.min(this._border.x*s,.5*t),i.x+(t-i.x-i.z)*this._fillEdges.z-Math.min(this._border.z*s,.5*t),i.x+(t-i.x-i.z)*this._fillEdges.z],a=[i.y+(e-i.y-i.w)*this._fillEdges.w,i.y+(e-i.y-i.w)*this._fillEdges.w-Math.min(this._border.w*s,.5*e),i.y+e*this._fillEdges.y+Math.min(this._border.y*s,.5*e),i.y+e*this._fillEdges.y],u=[pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.x),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.x),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.z),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.z)],c=[pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.w),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.w),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.y),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.y)];if(this._spriteType!=pc.SPRITE_TYPE_SLICED&&this._spriteType!=pc.SPRITE_TYPE_TILED||!this._texture)this._spriteType,pc.SPRITE_TYPE_TILED;else{if(u[1]=u[1]+this._border.x/this._texture.width,u[2]=u[2]-this._border.z/this._texture.width,o[1]>o[2]){var h=o[1];o[1]=o[2],o[2]=h}if(c[1]=c[1]-this._border.w/this._texture.height,c[2]=c[2]+this._border.y/this._texture.height,a[2]>a[1]){h=a[1];a[1]=a[2],a[2]=h}}for(var l=this._mesh.vertexBuffer,p=this.color,d=new Float32Array(l.storage),f=0;f<4;f++)for(var y=0;y<4;y++){var m=(4*f+y)*n;d[m++]=-this._element._pivotPoint.x+o[y],d[m++]=-this._element._pivotPoint.y+a[f],d[m++]=0,d[m++]=u[y],d[m++]=c[f],d[m++]=p.r,d[m++]=p.g,d[m++]=p.b,d[m++]=p.a}l.unlock()},_calculatePaddings:function(t,e,i,n){var r=t,s=e,o=1,a=1;if(this._texture&&(r=this._texture.width,s=this._texture.height),this._sprite){i.copy(this._sprite.transparency);var u=this._sprite.getTextureRect();r=u[2]-u[0]+i.x+i.z,s=u[3]-u[1]+i.y+i.w}if(t==r&&e==s||(o=t/r,a=e/s),n.x=t,n.y=e,this._preserveAspect&&this._spriteType!=pc.SPRITE_TYPE_SLICED&&this._spriteType!=pc.SPRITE_TYPE_TILED){var c=Math.min(o,a);n.x=c*r,n.y=c*s,i.scale(c)}else 1==o&&1==a||(i.x*=o,i.y*=a,i.z*=o,i.w*=a);return n.x==t&&n.y==e||i.add(new pc.Vec4((t-n.x)*this._element.pivot.x,(e-n.y)*this._element.pivot.y,(t-n.x)*(1-this._element.pivot.x),(e-n.y)*(1-this._element.pivot.y))),i},_updateMeshRadial:function(){var t=this._element.width||0,e=this._element.height||0,i=new pc.Vec4(0,0,0,0),r=new pc.Vec2(0,0);this._calculatePaddings(t,e,i,r);var s=360*this._fillAmount,o=r.x/2,a=i.x+o,u=r.y/2,c=i.y+u,h=this._rect.z/2,l=this._rect.w/2,p=this._rect.x+h,d=this._rect.y+l,f=[a],y=[c],m=[p],_=[d],g=0,v=0,A=!1;switch(this._fillOrigin){case pc.FILL_ORIGIN_RADIAL_BOTTOM:v=270;break;case pc.FILL_ORIGIN_RADIAL_RIGHT:v=0;break;case pc.FILL_ORIGIN_RADIAL_TOP:v=90;break;case pc.FILL_ORIGIN_RADIAL_LEFT:v=180}for(var E=this._element["UnityEngine.UI.Image"].m_FillClockwise?-1:1,b=0,S=0;s>0;){var M=Math.min(s,g);(v=((v+=E*M)+360)%360)<=45||v>315?(f.push(a+o),m.push(p+h),S=Math.tan(v*pc.math.DEG_TO_RAD),y.push(c+u*S),_.push(d+l*S)):v<=135?(b=1/Math.tan(v*pc.math.DEG_TO_RAD),f.push(a+o*b),m.push(p+h*b),y.push(c+u),_.push(d+l)):v<=225?(f.push(a-o),m.push(p-h),S=-Math.tan(v*pc.math.DEG_TO_RAD),y.push(c+u*S),_.push(d+l*S)):v<=315&&(b=-1/Math.tan(v*pc.math.DEG_TO_RAD),f.push(a+o*b),m.push(p+h*b),y.push(c-u),_.push(d-l)),s-=M,A?g=90:(g=45,A=!0)}for(;f.length<16;)f.push(a);for(;y.length<16;)y.push(c);for(;m.length<16;)m.push(p);for(;_.length<16;)_.push(d);for(var C=this._mesh.vertexBuffer,x=this.color,P=new Float32Array(C.storage),O=0;O<16;O++)P[O*n+0]=-this._element._pivotPoint.x+f[O],P[O*n+1]=-this._element._pivotPoint.y+y[O],P[O*n+2]=0,P[O*n+3]=m[O],P[O*n+4]=_[O],P[O*n+5]=x.r,P[O*n+6]=x.g,P[O*n+7]=x.b,P[O*n+8]=x.a;C.unlock()},synchornizeProperties:function(t,e){var i=t.m_OverrideSprite||t.m_Sprite,n=i?i.handle:null,s=e&&t.m_Texture?t.m_Texture.handle:null,o=e?this._texture!==s:this._sprite!==n,a=e&&(t.m_UVRect.m_XMin!==this._rect.x||t.m_UVRect.m_YMin!==this._rect.y||t.m_UVRect.m_Width!==this._rect.z||t.m_UVRect.m_Height!==this._rect.w);(this._fillCenter!==t.m_FillCenter||this._fillAmount!==t.m_FillAmount||this._fillMethod!==t.m_FillMethod||this._fillOrigin!==t.m_FillOrigin||o||a)&&(e&&this._texture!==s?this.texture=s:this._sprite!==n&&(this.sprite=n),a&&this._rect.set(t.m_UVRect.m_XMin,t.m_UVRect.m_YMin,t.m_UVRect.m_Width,t.m_UVRect.m_Height),e||(this._fillCenter=t.m_FillCenter,this._fillAmount=t.m_FillAmount,this._fillMethod=t.m_FillMethod,this._fillOrigin=t.m_FillOrigin),this._updateMesh()),r.copy(t.m_Color)}}),pc.extend(pc,{SPRITE_TYPE_SIMPLE:0,SPRITE_TYPE_SLICED:1,SPRITE_TYPE_TILED:2,SPRITE_TYPE_FILLED:3,FILL_METHOD_HORIZONTAL:0,FILL_METHOD_VERTICAL:1,FILL_METHOD_RADIAL90:2,FILL_METHOD_RADIAL180:3,FILL_METHOD_RADIAL360:4,FILL_ORIGIN_BOTTOM_LEFT:0,FILL_ORIGIN_TOP_RIGHT:1,FILL_ORIGIN_RADIAL_BOTTOM:0,FILL_ORIGIN_RADIAL_RIGHT:1,FILL_ORIGIN_RADIAL_TOP:2,FILL_ORIGIN_RADIAL_LEFT:3}),Object.defineProperty(pc.ImageElement.prototype,"sprite",{set:function(t){if(this._sprite=t,t){this._texture=t.texture,this._canvasRenderer.setTexture(this._texture);var e=t.uvRect;e instanceof pc.Vec4?this._rect.set(e.x,e.y,e.z,e.w):this._rect.set(e[0],e[1],e[2],e[3]);var i=this.spriteType==pc.SPRITE_TYPE_SIMPLE?pc.Vec4.ZERO:t.border;i instanceof pc.Vec4?this._border.set(i.x,i.y,i.z,i.w):this._border.set(i[0],i[1],i[2],i[3])}else this._texture=null,this._canvasRenderer.setTexture(this._texture);this._updateMesh()},get:function(){return this._sprite}}),Object.defineProperty(pc.ImageElement.prototype,"spriteType",{set:function(t){this._spriteType=t,this.sprite=this._sprite},get:function(){return this._spriteType||pc.SPRITE_TYPE_SLICED}}),Object.defineProperty(pc.ImageElement.prototype,"preserveAspect",{set:function(t){this._preserveAspect=t,this._updateMesh()},get:function(){return this._preserveAspect}}),Object.defineProperty(pc.ImageElement.prototype,"fillMethod",{set:function(t){this._fillMethod=t,this._updateMesh()},get:function(){return this._fillMethod}}),Object.defineProperty(pc.ImageElement.prototype,"fillCenter",{set:function(t){this._fillCenter=t,this._updateMesh()},get:function(){return this._fillCenter}}),Object.defineProperty(pc.ImageElement.prototype,"fillOrigin",{set:function(t){this._fillOrigin=t,this._updateMesh()},get:function(){return this._fillOrigin}}),Object.defineProperty(pc.ImageElement.prototype,"fillAmount",{set:function(t){this._fillAmount=t,this._updateMesh()},get:function(){return this._fillAmount}})}(),function(){var t=new pc.Color,e=new pc.Vec3;pc.extend(pc.TextElement.prototype,{_createMesh:function(){if(this._entity.isPrefab)return null;this.bounds=new pc.Vec2,this._textOffsets=new pc.Vec3,this._textGenerator=new pc.TextGenerator(this.canvasRenderer),this._computedAlpha=1;var t=pc.TextGenerator.createEmptyMesh();return t.subMeshes=[t],t},_updateAligns:function(t){void 0!==this._element.width&&void 0!==this._element.height&&(t||(this.bounds.set(this._element.width,this._element.height),this._textGenerator.populate(this.text,this)),e.set(-this._element._pivotPoint.x,-this._element._pivotPoint.y,0).add(this._textGenerator.offset),this._textGenerator.updateMesh(this._mesh,this,e))},_updateMesh:function(t,e){this._entity.isPrefab||(this._element.entity._dirtyRect&&this._entity._sync(),(0==this._element.width||0==this._element.height||this._element&&this._element.width&&this._element.height)&&(this.bounds.set(this._element.width,this._element.height),this._textGenerator.populate(e,this),0!=this._textGenerator.vertexCount?(this._dirtyVertices&&this._textGenerator.updateMesh(this._mesh,this),this._dirtyOffset&&this._updateAligns(!0),(this._dirtyVertices||this._dirtyOffset)&&this._element.entity._dirtifyWorld(),this._canvasRenderer.getMesh()||this._canvasRenderer.setMesh(t)):this._canvasRenderer.setMesh(null)))},setVerticesDirty:function(){this._updateText(this._text)},_updateText:function(t){this._font&&(void 0===t&&(t=this._text),this._mesh||(this._updateMaterial(),this._mesh=this._createMesh(t),this._canvasRenderer.setMesh(this._mesh)),this._updateMesh(this._mesh,t),this._canvasRenderer.setTexture(this._font.texture))},synchornizeProperties:function(e){t.copy(e.m_Color)}}),Object.defineProperty(pc.TextElement.prototype,"tintTexture",{set:function(t){this._tintTexture=t,this._updateText(this._text)},get:function(){return this._tintTexture}})}(),Object.defineProperty(pc.ScreenComponent.prototype,"referencePixelsPerUnit",{get:function(){return this._referencePixelsPerUnit},set:function(t){this._referencePixelsPerUnit=t,this.resolution=this._resolution}}),Object.defineProperty(pc.ScreenComponent.prototype,"rootScreen",{get:function(){for(var t=this,e=this.entity;e;)t=e.screen||t,e=e.parent;return t}}),Object.defineProperty(pc.ScreenComponent.prototype,"scaleFactor",{get:function(){return this._scaleFactor},set:function(t){this._scaleFactor=t,this._updateScale(),this._calcProjectionMatrix()}}),Object.defineProperty(pc.ScreenComponent.prototype,"overrideSorting",{get:function(){return this["__UnityEngine.Canvas"].overrideSorting},set:function(t){this._sortingOrder=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"sortingOrder",{get:function(){return!this.isNested||this["__UnityEngine.Canvas"].overrideSorting?this._sortingOrder:this.parentScreen.sortingOrder},set:function(t){this._sortingOrder=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"sortingLayerIndex",{get:function(){return!this.isNested||this["__UnityEngine.Canvas"].overrideSorting?this._sortingLayerIndex:this.parentScreen.sortingLayerIndex},set:function(t){this._sortingLayerIndex=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"isNested",{get:function(){return null!=this.parentScreen}}),Object.defineProperty(pc.ScreenComponent.prototype,"drawOrder",{get:function(){return this.entity.element.drawOrder}}),pc.extend(pc.Color,{ctor:pc.Color,$kind:"struct",gammaToLinear:function(t){return t<=.04045?t/12.92:t<1?Math.pow((t+.055)/1.055,2.4):Math.pow(t,2.2)},hsvToRGB:function(t,e,i,n){let r,s,o,a,u;switch(a=Math.floor(6*t),u=6*t-a,a%6){case 0:r=i,s=i*(1-(1-u)*e),o=i*(1-e);break;case 1:r=i*(1-u*e),s=i,o=i*(1-e);break;case 2:r=i*(1-e),s=i,o=i*(1-(1-u)*e);break;case 3:r=i*(1-e),s=i*(1-u*e),o=i;break;case 4:r=i*(1-(1-u)*e),s=i*(1-e),o=i;break;case 5:r=i,s=i*(1-e),o=i*(1-u*e)}return n||(r=pc.math.clamp(r,0,1),s=pc.math.clamp(s,0,1),o=pc.math.clamp(o,0,1)),new pc.Color(r,s,o,1)},rgbToHSV:function(t,e,i,n){t.b>t.g&&t.b>t.r?this.rgbHelper(4,t.b,t.r,t.g,e,i,n):t.g>t.r?this.rgbHelper(2,t.g,t.b,t.r,e,i,n):this.rgbHelper(0,t.r,t.g,t.b,e,i,n)},rgbToHSVHelper:function(t,e,i,n,r,s,o){if(o.v=e,0!==o.v){let e=i<=n?i:n,a=o.v-e;if(0!==a?(s.v=a/o.v,r.v=t+(i-n)/a):(s.v=0,r.v=t+(i-n)),r.v/=6,r.v>=0)return;++r.v}else s.v=0,r.v=0},lerp:function(t,e,i){return pc.Color.lerpUnclamped(t,e,pc.math.clamp(i,0,1))},lerpUnclamped:function(t,e,i){return new pc.Color(UnityEngine.Mathf.LerpUnclamped(t.r,e.r,i),UnityEngine.Mathf.LerpUnclamped(t.g,e.g,i),UnityEngine.Mathf.LerpUnclamped(t.b,e.b,i),UnityEngine.Mathf.LerpUnclamped(t.a,e.a,i))},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)},getDefaultValue:function(){return new pc.Color}}),pc.extend(pc.Color.prototype,{getitem:function(t){switch(t){case 0:return this.r;case 1:return this.g;case 2:return this.b;case 3:return this.a}},setitem:function(t,e){switch(t){case 0:return this.r=e;case 1:return this.g=e;case 2:return this.b=e;case 3:return this.a=e}},premultiply:function(){return this.r=this.r*this.a,this.g=this.g*this.a,this.b=this.b*this.a,this},mul:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this},mul2:function(t,e){return this.r=t.r*e.r,this.g=t.g*e.g,this.b=t.b*e.b,this.a=t.a*e.a,this},scale:function(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this},toLinear:function(){return this.r=pc.Color.gammaToLinear(this.r),this.g=pc.Color.gammaToLinear(this.g),this.b=pc.Color.gammaToLinear(this.b),this},equals:function(t){return this.r-t.r<1e-5&&this.g-t.g<1e-5&&this.b-t.b<1e-5&&this.a-t.a<1e-5},getHashCode:pc.Color.prototype.hash=function(){return this.x^this.y^this.z^this.w},strictEquals:function(t){return t instanceof pc.Color&&this.equals(t)},lerpTo:function(t,e){this.r=t.r*e+this.r*(1-e),this.g=t.g*e+this.g*(1-e),this.b=t.b*e+this.b*(1-e),this.a=t.a*e+this.a*(1-e)},grayscale:function(){return.29899999499321*this.r+.587000012397766*this.g+.114*this.b},linear:function(){return new pc.Color(UnityEngine.Mathf.GammaToLinearSpace(this.r),UnityEngine.Mathf.GammaToLinearSpace(this.g),UnityEngine.Mathf.GammaToLinearSpace(this.b),this.a)},gamma:function(){return new pc.Color(UnityEngine.Mathf.LinearToGammaSpace(this.r),UnityEngine.Mathf.LinearToGammaSpace(this.g),UnityEngine.Mathf.LinearToGammaSpace(this.b),this.a)},maxColorComponent:function(){return Math.max(Math.max(this.r,this.g),this.b)},$getType:function(){return pc.Color},$clone:function(t){return(t=t||new pc.Color).copy(this),t}}),pc.extend(pc.Light.prototype,{getFinalColor:function(){return this.dirtyColor&&(this.dirtyColor=!1,this.setColor(this._color)),this._finalColor},getLinearFinalColor:function(){return this.dirtyColor&&(this.dirtyColor=!1,this.setColor(this._color)),this._linearFinalColor}}),function(){var t=new RegExp(/[A-Za-z\u0061-\u007A\u00B5\u00DF-\u00F6\u00F8-\u00FF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0561-\u0587\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7FA\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A\u0041-\u005A\u00C0-\u00D6\u00D8-\u00DE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA\uFF21-\uFF3A\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uAA70\uAADD\uAAF3\uAAF4\uFF70\uFF9E\uFF9F\u00AA\u00BA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/),e=new RegExp(/[0-9\u0030-\u0039\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/),i=new RegExp(/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65\u002D\u058A\u05BE\u1400\u1806\u2010-\u2015\u2E17\u2E1A\u2E3A\u2E3B\u301C\u3030\u30A0\uFE31\uFE32\uFE58\uFE63\uFF0D\u0028\u005B\u007B\u0F3A\u0F3C\u169B\u201A\u201E\u2045\u207D\u208D\u2329\u2768\u276A\u276C\u276E\u2770\u2772\u2774\u27C5\u27E6\u27E8\u27EA\u27EC\u27EE\u2983\u2985\u2987\u2989\u298B\u298D\u298F\u2991\u2993\u2995\u2997\u29D8\u29DA\u29FC\u2E22\u2E24\u2E26\u2E28\u3008\u300A\u300C\u300E\u3010\u3014\u3016\u3018\u301A\u301D\uFD3E\uFE17\uFE35\uFE37\uFE39\uFE3B\uFE3D\uFE3F\uFE41\uFE43\uFE47\uFE59\uFE5B\uFE5D\uFF08\uFF3B\uFF5B\uFF5F\uFF62\u0029\u005D\u007D\u0F3B\u0F3D\u169C\u2046\u207E\u208E\u232A\u2769\u276B\u276D\u276F\u2771\u2773\u2775\u27C6\u27E7\u27E9\u27EB\u27ED\u27EF\u2984\u2986\u2988\u298A\u298C\u298E\u2990\u2992\u2994\u2996\u2998\u29D9\u29DB\u29FD\u2E23\u2E25\u2E27\u2E29\u3009\u300B\u300D\u300F\u3011\u3015\u3017\u3019\u301B\u301E\u301F\uFD3F\uFE18\uFE36\uFE38\uFE3A\uFE3C\uFE3E\uFE40\uFE42\uFE44\uFE48\uFE5A\uFE5C\uFE5E\uFF09\uFF3D\uFF5D\uFF60\uFF63\u00AB\u2018\u201B\u201C\u201F\u2039\u2E02\u2E04\u2E09\u2E0C\u2E1C\u2E20\u00BB\u2019\u201D\u203A\u2E03\u2E05\u2E0A\u2E0D\u2E1D\u2E21\u005F\u203F\u2040\u2054\uFE33\uFE34\uFE4D-\uFE4F\uFF3F\u0021-\u0023\u0025-\u0027\u002A\u002C\u002E\u002F\u003A\u003B\u003F\u0040\u005C\u00A1\u00A7\u00B6\u00B7\u00BF\u037E\u0387\u055A-\u055F\u0589\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u166D\u166E\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u1805\u1807-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2016\u2017\u2020-\u2027\u2030-\u2038\u203B-\u203E\u2041-\u2043\u2047-\u2051\u2053\u2055-\u205E\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00\u2E01\u2E06-\u2E08\u2E0B\u2E0E-\u2E16\u2E18\u2E19\u2E1B\u2E1E\u2E1F\u2E2A-\u2E2E\u2E30-\u2E39\u3001-\u3003\u303D\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFE10-\uFE16\uFE19\uFE30\uFE45\uFE46\uFE49-\uFE4C\uFE50-\uFE52\uFE54-\uFE57\uFE5F-\uFE61\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF07\uFF0A\uFF0C\uFF0E\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3C\uFF61\uFF64\uFF65]/),n=new RegExp(/[\u2028\u2029\u0020\u00A0\u1680\u180E\u2000-\u200A\u202F\u205F\u3000]/),r=[33,34,35,37,38,39,40,41,42,44,45,46,47,58,59,63,64,91,92,93,95,123,125,161,171,173,183,187,191];System.Array.resize=function(t,e,i){if(e<0)throw new System.ArgumentOutOfRangeException.$ctor3("newSize",e,"newSize cannot be less than 0.");var n=0,r=Bridge.isFunction(i),s=!1,o=t.v;if(o){var a=o;n=a.length,o=new Array(e);var u=Math.min(n,e);if(u>0){let t=a[0];s=t&&"struct"===t.__proto__.$kind,o[0]=s?t.$clone():t}for(let t=1;t<u;t++)o[t]=s?a[t].$clone():a[t]}else o=new Array(e);if(e>n){let t=r?i():i;s=t&&"struct"===t.__proto__.$kind,o[n]=s?t.$clone():t}for(let t=n+1;t<e;t++){let e=r?i():i;s&&(e=e.$clone()),o[t]=e}t.v=o};var s=function(t,e){this.o=t,this.n=e};Object.defineProperty(s.prototype,"v",{get:function(){return null==this.n?this.o:this.o[this.n]},set:function(t){null==this.n&&(t&&t.$clone?t.$clone(this.o):this.o=t),this.o[this.n]=t}}),Bridge.ref=function(t,e){return Bridge.isArray(e)&&(e=System.Array.toIndex(t,e)),new s(t,e)},System.Char.isWhiteSpace=function(t){return" "===t||"\t"===t||"\n"===t||"\v"===t||"\f"===t||"\r"===t||""===t||""===t},System.Char.isLetter=function(e){return e<256?e>=65&&e<=90||e>=97&&e<=122:t.test(String.fromCharCode(e))},System.Char.isDigit=function(t){return t<256?t>=48&&t<=57:e.test(String.fromCharCode(t))},System.Char.isPunctuation=function(t){return t<256?-1!=r.indexOf(t):i.test(String.fromCharCode(t))},System.Char.isHighSurrogate=function(t){return t>=55296&&t<=56319},System.Char.isLowSurrogate=function(t){return t>=56320&&t<=57343},System.Char.isSurrogate=function(t){return t>=55296&&t<=57343},System.Char.isSeparator=function(t){return t<256?32==t||160==t:n.test(String.fromCharCode(t))}}(),Object.assign(pc,function(){var t=function(t,e){this._videoWidth=0,this._videoHeight=0,this._frameCount=0,this._frameRate=24,void 0!==e&&(this._videoWidth=void 0!==e.width?e.width:this._videoWidth,this._videoHeight=void 0!==e.height?e.height:this._videoHeight,this._frameRate=void 0!==e.frameRate?e.frameRate:this._frameRate,this._frameCount=void 0!==e.frameCount?e.frameCount:this._frameCount),pc.Texture.prototype.constructor.call(this,t,e)};return(t.prototype=Object.create(pc.Texture.prototype)).constructor=t,Object.defineProperty(t.prototype,"frameRate",{get:function(){return this._frameRate}}),Object.defineProperty(t.prototype,"frameCount",{get:function(){return this._frameCount}}),Object.defineProperty(t.prototype,"videoWidth",{get:function(){return this._videoWidth}}),Object.defineProperty(t.prototype,"videoHeight",{get:function(){return this._videoHeight}}),{VideoTexture:t}}()),pc.extend(pc,function(){var t=function(t){return this.attributes=t,this.$sprite=!0,this};return t.create=function(t,e,i,n){const r=(e.z-e.x)/2/n,s=(e.w-e.y)/2/n;return new pc.Sprite({aabb:{center:[0,0,0],halfExtents:[r,s,0]},border:new pc.Vec4(0,0,0,0),bounds:[-r,-s,r,s],pixelsPerUnit:n,texture:t,textureRect:e.data,transparency:new pc.Vec4(0,0,0,0),triangles:[0,1,2,2,1,3],vertices:[-r,s,0,0,1,r,s,0,1,1,-r,-s,0,0,0,r,-s,0,1,0]})},t.prototype={getTextureRect:function(){return this.attributes.textureRect},getBorder:function(){return this.attributes.border},getTexture:function(){return this.attributes.texture},getTransparency:function(){return this.attributes.transparency},getBounds:function(){return this.attributes.bounds},getPixelsPerUnit:function(){return this.attributes.pixelsPerUnit},getMesh:function(){if(this.mesh)return this.mesh;var e=new pc.Mesh(!0),i=t.vertexFormat=t.vertexFormat||new pc.VertexFormat(this.attributes.graphicsDevice||this.attributes.texture.device,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32}]),n=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,i,this.attributes.vertices.length/5);n.storage=new Float32Array(this.attributes.vertices),n.unlock(),e.vertexBuffer=n;var r=new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,this.attributes.triangles.length);return r.storage=new Uint16Array(this.attributes.triangles),r.unlock(),e.indexBuffer[0]=r,e.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,e.primitive[0].base=0,e.primitive[0].count=this.attributes.triangles.length,e.primitive[0].indexed=!0,e.aabb=new pc.BoundingBox(new pc.Vec3(this.attributes.aabb[0],this.attributes.aabb[1],this.attributes.aabb[2]),new pc.Vec3(this.attributes.aabb[3],this.attributes.aabb[4],this.attributes.aabb[5])),e.subMeshes=[e],this.mesh=e}},Object.defineProperty(t.prototype,"transparency",{get:t.prototype.getTransparency}),Object.defineProperty(t.prototype,"textureRect",{get:t.prototype.getTextureRect}),Object.defineProperty(t.prototype,"pixelsPerUnit",{get:t.prototype.getPixelsPerUnit}),Object.defineProperty(t.prototype,"texture",{get:t.prototype.getTexture}),Object.defineProperty(t.prototype,"border",{get:t.prototype.getBorder}),Object.defineProperty(t.prototype,"uvRect",{get:function(){var t=this.textureRect,e=this.texture;return new pc.Vec4(t[0]/e.width,t[1]/e.height,(t[2]-t[0])/e.width,(t[3]-t[1])/e.height)}}),Object.defineProperty(t.prototype,"pixelSize",{get:function(){return new pc.Vec2(this.textureRect[2]-this.textureRect[0],this.textureRect[3]-this.textureRect[1])}}),{Sprite:t}}()),pc.extend(pc,function(){var t=function(t,e,i){this._path=t,this._property=e,this._componentTypeName=i,this._name=t+":"+i+":"+e,this._keys=[]};t.prototype={};var e=function(){return this};return(e.prototype=Object.create(pc.Animation.prototype)).constructor=e,pc.extend(e.prototype,{}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key=this._key||this.name+"#"+this.id}}),{CurveAnimation:e,CurveKey:function(t,e,i,n){this.time=t,this.value=e,this.inTangent=i,this.outTangent=n},CurveNode:t}}()),pc.extend(pc,function(){new pc.Vec3;function t(t){this._written=!1,this._curve=t,this._value=null}t.prototype.write=function(){return!!this._written&&(this._written=!1,this._object?this._target[this._object][this._property]=this._value:this._target[this._property]=this._value,!0)},t.prototype.setValue=function(t){if(void 0===t)throw new Error;this._written=t!=this._value,this._value=t};var e=function(t){this._guid=pc.guid.create(),this._speed=1,this._looping=!0,this._animation=null,this._time=0,this._interpolatedKeys=[],this._interpolatedKeyDict={},this._interpolatedKeyNames=[],this._currKeyIndices={},this.graph=t};return(e.prototype=Object.create(pc.Skeleton.prototype)).constructor=e,e.prototype={setGraph:function(t){this.graph=t,this._setupKeys()},setAnimation:function(t){this._animation=t,this._looping=t.isLooping,this._time=0,this._setupKeys()},_setupKeys:function(){this._sampler=new pc.CurveSampler},updateGraph:function(){this._sampler.apply(UnityEngine.Object.FromHandle(UnityEngine.GameObject,this.graph))},blend:function(t,e,i){var n=t._sampler.id+"+"+e._sampler.id;this._blendId!=n&&(this._sampler=new pc.CurveSampler),this._sampler.blendSamplers(t._sampler,i,e._sampler,1-i)},addTime:function(t){if(null!==this._animation){var e=this._animation.curves,i=this._animation.length;if(this._time===i&&!this._looping)return;t*=this._speed,this._time+=t,this._time>=i?this._time=this._looping?0:i:this._time<0&&(this._time=this._looping?i:0);for(var n=0;n<e.length;n++)e[n].sample(this._sampler,this._time)}},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},getLooping:function(){return this._looping},setLooping:function(t){this._looping=t}},Object.defineProperty(e.prototype,"animation",{get:pc.Skeleton.prototype.getAnimation,set:e.prototype.setAnimation}),Object.defineProperty(e.prototype,"speed",{get:e.prototype.getSpeed,set:e.prototype.setSpeed}),Object.defineProperty(e.prototype,"looping",{get:e.prototype.getLooping,set:e.prototype.setLooping}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._time},set:function(t){this._time=t;for(var e=this._interpolatedKeys.length,i=0;i<e;i++){var n=this._interpolatedKeys[i]._name;this._currKeyIndices[n]=0}this.addTime(0),this.updateGraph()}}),{PropertySkeleton:e}}()),pc.extend(pc,function(){var t=function(t){return this.id=t.id,this.name=t.name,this.speed=t.speed,this.speedParameter=t.speedParameter,this.speedParameterActive=t.speedParameterActive,this.mirror=t.mirror,this.mirrorParameter=t.mirrorParameter,this.mirrorParameterActive=t.mirrorParameterActive,this.motion=t.motion,this};t.prototype={};var e=function(t){return this.condition=t.condition,this.parameter=t.parameter,this.threshold=t.threshold,this};e.CONDITION_IF=1,e.CONDITION_IF_NOT=2,e.CONDITION_GREATER=3,e.CONDITION_LESS=4,e.CONDITION_EQUALS=6,e.CONDITION_NOT_EQUAL=7,e.prototype={matches:function(t,i){var n=i[this.parameter]||t[this.parameter];switch(this.condition){case e.CONDITION_IF:return i[this.parameter]&&(i[this.parameter]=!1),n;case e.CONDITION_IF_NOT:return!n;case e.CONDITION_GREATER:return n>this.threshold;case e.CONDITION_LESS:return n<this.threshold;case e.CONDITION_EQUALS:return n==this.threshold;case e.CONDITION_NOT_EQUAL:return n!=this.threshold}return!1}};var i=function(t){return this.sourceState=t.sourceState,this.targetState=t.targetState,this.mute=t.mute,this.solo=t.solo,this.exitTime=t.exitTime,this.hasExitTime=t.hasExitTime,this.duration=t.duration,this.hasFixedDuration=t.hasFixedDuration,this.conditions=t.conditions,this.canTransitionToSelf=t.canTransitionToSelf,this};i.prototype={matches:function(t,e){if(0==this.conditions.length)return!1;for(var i=0;i<this.conditions.length;i++)if(!this.conditions[i].matches(t,e))return!1;return!0}};var n=function(t){return this.name=t.name,this.type=t.type,this.type==n.PARAMETER_TYPE_FLOAT&&(this.default=t.defaultFloat),this.type==n.PARAMETER_TYPE_INT&&(this.default=t.defaultInt),this.type==n.PARAMETER_TYPE_BOOL&&(this.default=t.defaultBool),this};n.PARAMETER_TYPE_FLOAT=1,n.PARAMETER_TYPE_INT=3,n.PARAMETER_TYPE_BOOL=4,n.PARAMETER_TYPE_TRIGGER=9,n.prototype={};var r=function(t){this.id=t.id,this.states=t.states,this.stateMap={};for(var e=0;e<this.states.length;e++)this.stateMap[this.states[e].id]=this.states[e];return this.defaultState=t.defaultState,this.entryTransitions=t.entryTransitions,this.anyStateTransitions=t.anyStateTransitions,this.transitions=t.transitions,this};r.prototype={};var s=function(t){return this.layers=t.layers,this.parameters=t.parameters,this};return s.prototype={},s.Parameter=n,s.Layer=r,s.State=t,s.Transition=i,s.Condition=e,{AnimatorController:s}}()),pc.extend(pc,function(){var t=function(t){return this._animation=t,t.animator=this,this.setAnimatorController(null),pc.ComponentSystem.on("update",this.update,this),this};return t.prototype={setAnimatorController:function(t){},scheduleTransitionRequest:function(t,e){},processTransitionQueue:function(t,e){},applyCurrentStateSettings:function(t){},processLayer:function(t){},update:function(t){},setTrigger:function(t){},setParameter:function(t,e){}},{Animator:t}}()),function(){function t(){this._seed=1}Object.assign(t.prototype,{setSeed:function(t){this._seed=t},nextInteger:function(){return this._seed=16807*this._seed%2147483647},nextFloat:function(){return this.nextInteger()/2147483647},nextGFloat:function(){return(this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat())/6}}),pc.Random=t}(),function(){function t(){this.value=0}t.prototype.update=function(t){this.value+=t},t.prototype.take=function(t){this.value>=t&&(this.value-=t)},Object.defineProperty(t.prototype,"accumulated",{get:function(){return Math.floor(this.value)}}),pc.IntAccumulator=t}(),function(){"use strict";var t,e,i={BLEND:0,FIXED:1},n=function(t,e,n){t=t||[],e=e||[],this.colorKeys="object"!=typeof t[0]?this.formatColorKeys(t):t,this.alphaKeys="object"!=typeof e[0]?this.formatAlphaKeys(e):e,this.mode=n||i.BLEND},r={lower:null,upper:null},s={lower:null,upper:null};n.prototype.sampleInplace=function(t,e){if(this.findExtremeColors(t,r),this.findExtremeAlphaValues(t,s),r.lower==r.upper&&s.lower==s.upper)return e.copy(r.lower.color),void(e.a=s.lower.alpha);switch(this.mode){case i.FIXED:return void(r.lower.position==t?(e.copy(r.lower.color),e.a=s.lower.alpha):(e.copy(r.upper.color),e.a=s.upper.alpha));case i.BLEND:var n=(t-r.lower.time)/(r.upper.time-r.lower.time),o=(t-s.lower.time)/(s.upper.time-s.lower.time);return void this.lerpColorInPlace(r.lower.color,r.upper.color,s.lower.alpha,s.upper.alpha,n,o,e);default:throw new System.NotSupportedException}},n.prototype.evaluate=function(t){var e=new pc.Color;return this.sampleInplace(t,e),e},n.prototype.evaluateRef=function(t,e){return this.sampleInplace(t,e),e},n.prototype.findExtremeColors=function(i,n){t=e=this.colorKeys[0];for(var r=0;r<this.colorKeys.length;r++){if(!(this.colorKeys[r].time<=i)){e=this.colorKeys[r];break}t=e=this.colorKeys[r]}n.lower=t,n.upper=e},n.prototype.findExtremeAlphaValues=function(i,n){t=e=this.alphaKeys[0];for(var r=0;r<this.alphaKeys.length;r++){if(!(this.alphaKeys[r].time<=i)){e=this.alphaKeys[r];break}t=e=this.alphaKeys[r]}n.lower=t,n.upper=e},n.prototype.lerpColorInPlace=function(t,e,i,n,r,s,o){o.r=pc.math.lerp(t.r,e.r,r),o.g=pc.math.lerp(t.g,e.g,r),o.b=pc.math.lerp(t.b,e.b,r),o.a=pc.math.lerp(i,n,s)},n.prototype.formatColorKeys=function(t){for(var e=[],i=0;i<t.length;i+=5){var n={};n.time=t[i],n.color=new pc.Color(t[i+1],t[i+2],t[i+3],t[i+4]),e.push(n)}return e},n.prototype.formatAlphaKeys=function(t){for(var e=[],i=0;i<t.length;i+=2){var n={};n.time=t[i],n.alpha=t[i+1],e.push(n)}return e},n.prototype.setKeys=function(t,e){this.colorKeys=("object"!=typeof t[0]?this.formatColorKeys(t):t)||[],this.alphaKeys=("object"!=typeof e[0]?this.formatAlphaKeys(e):e)||[]},n.prototype.setKey=function(t,e){for(var i=0;i<this.colorKeys.length;i++)this.colorKeys.time==t.time&&(this.colorKeys[i]=t,t=null);null!=t&&this.colorKeys.push(t);for(i=0;i<this.alphaKeys.length;i++)this.alphaKeys.time==e.time&&(this.alphaKeys[i]=e,e=null);null!=e&&this.alphaKeys.push(e)},pc.GradientType=i,pc.ColorGradient=n}(),function(){var t={Constant:0,Curve:1,TwoCurves:2,TwoConstants:3},e=function(e,i,n){"number"==typeof e&&i instanceof pc.AnimationCurve&&n instanceof pc.AnimationCurve?this.init(0,0,i,n,t.TwoCurves,e):"number"==typeof e&&"number"==typeof i?this.init(e,i,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.TwoConstants,1):"number"==typeof e&&i instanceof pc.AnimationCurve?this.init(0,0,new pc.AnimationCurve({}),i,t.Constant,e):"number"==typeof e?this.init(0,e,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.Constant,1):this.init(0,0,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.Constant,1)};e.prototype.init=function(t,e,i,n,r,s){this.m_ConstantMax=e,this.m_ConstantMin=t,this.m_CurveMax=n,this.m_CurveMin=i,this.m_CurveMultiplier=s,this.m_Mode=r,this._random=new pc.Random},Object.defineProperty(e.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(e.prototype,"constant",{get:function(){return this.m_ConstantMax},set:function(t){this.m_ConstantMax=t}}),Object.defineProperty(e.prototype,"constantMax",{get:function(){return this.m_ConstantMax},set:function(t){this.m_ConstantMax=t}}),Object.defineProperty(e.prototype,"constantMin",{get:function(){return this.m_ConstantMin},set:function(t){this.m_ConstantMin=t}}),Object.defineProperty(e.prototype,"curve",{get:function(){return this.m_CurveMax},set:function(t){this.m_CurveMax=t}}),Object.defineProperty(e.prototype,"curveMax",{get:function(){return this.m_CurveMax},set:function(t){this.m_CurveMax=t}}),Object.defineProperty(e.prototype,"curveMin",{get:function(){return this.m_CurveMin},set:function(t){this.m_CurveMin=t}}),Object.defineProperty(e.prototype,"curveMultiplier",{get:function(){return this.m_CurveMultiplier},set:function(t){this.m_CurveMultiplier=t}}),e.prototype.evaluate=function(e){switch(this.mode){case t.Constant:return this._evaluateConstant();case t.Curve:return this._evaluateCurve(e);case t.TwoConstants:return this._evaluateTwoConstants(e,this._random.nextFloat());case t.TwoCurves:return this._evaluateTwoCurves(e,this._random.nextFloat())}},e.prototype._evaluateConstant=function(){return this.m_ConstantMax},e.prototype._evaluateCurve=function(t){return this.m_CurveMax.value(t)*this.m_CurveMultiplier},e.prototype._evaluateTwoCurves=function(t,e){var i=this.m_CurveMin.value(t)*this.m_CurveMultiplier,n=this.m_CurveMax.value(t)*this.m_CurveMultiplier;return pc.math.lerp(i,n,e)},e.prototype._evaluateTwoConstants=function(t,e){return pc.math.lerp(this.m_ConstantMin,this.constantMax,e)},pc.MinMaxCurveMode=t,pc.MinMaxCurve=e}(),function(){var t=new pc.Color,e=new pc.Color,i={Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4},n=function(t,e){t instanceof pc.Color&&e instanceof pc.Color?this.init(t,e,new pc.ColorGradient,new pc.ColorGradient,i.TwoColors):t instanceof pc.ColorGradient&&e instanceof pc.ColorGradient?this.init(0,0,t,e,i.TwoGradients):t instanceof pc.Color?this.init(0,t,new pc.ColorGradient,new pc.ColorGradient,i.Color):t instanceof pc.ColorGradient?this.init(0,0,new pc.ColorGradient,t,i.Gradient):this.init(0,0,new pc.ColorGradient,new pc.ColorGradient,i.Color)};n.prototype.init=function(t,e,i,n,r){return this.m_ColorMax=e,this.m_ColorMin=t,this.m_GradientMax=n,this.m_GradientMin=i,this.m_Mode=r,this._random=new pc.Random,this},Object.defineProperty(n.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(n.prototype,"color",{get:function(){return this.m_ColorMax},set:function(t){this.m_ColorMax=t}}),Object.defineProperty(n.prototype,"colorMin",{get:function(){return this.m_ColorMin},set:function(t){this.m_ColorMin=t}}),Object.defineProperty(n.prototype,"colorMax",{get:function(){return this.m_ColorMax},set:function(t){this.m_ColorMax=t}}),Object.defineProperty(n.prototype,"gradient",{get:function(){return this.m_GradientMax},set:function(t){this.m_GradientMax=t}}),Object.defineProperty(n.prototype,"gradientMax",{get:function(){return this.m_GradientMax},set:function(t){this.m_GradientMax=t}}),Object.defineProperty(n.prototype,"gradientMin",{get:function(){return this.m_GradientMin},set:function(t){this.m_GradientMin=t}}),n.prototype.evaluate=function(t){var e=new pc.Color(1,1,1,1);switch(this.mode){case i.Color:this._evaluateColorInplace(e);break;case i.Gradient:this._evaluateGradientInplace(t,e);break;case i.TwoColors:this._evaluateTwoColorsInplace(t,e);break;case i.TwoGradients:this._evaluateTwoGradientsInplace(t,e);break;case i.RandomColor:this._evaluateGradientInplace(this._random.nextFloat(),e)}return e},n.prototype.evaluateInplace=function(t,e){switch(this.mode){case i.Color:this._evaluateColorInplace(e);break;case i.Gradient:this._evaluateGradientInplace(t,e);break;case i.TwoColors:this._evaluateTwoColorsInplace(t,e);break;case i.TwoGradients:this._evaluateTwoGradientsInplace(t,e);break;case i.RandomColor:this._evaluateGradientInplace(this._random.nextFloat(),e)}},n.prototype._evaluateColorInplace=function(t){t.copy(this.m_ColorMax)},n.prototype._evaluateGradientInplace=function(t,e){this.gradient.sampleInplace(t,e)},n.prototype._evaluateTwoGradientsInplace=function(i,n){this.gradientMin.sampleInplace(i,t),this.gradientMax.sampleInplace(i,e);var r=this._random.nextFloat();n.copy(t).lerpTo(e,r)},n.prototype._evaluateTwoColorsInplace=function(t,e){var i=this._random.nextFloat();e.copy(this.colorMin).lerpTo(this.m_ColorMax,i)},pc.MinMaxGradientMode=i,pc.MinMaxGradient=n}(),function(){var t=new pc.Vec3;function e(){this.t=new pc.Vec3,this.r=new pc.Quat,this.s=new pc.Vec3,this.ownSpeed=new pc.Vec3,this.totalSpeed=new pc.Vec3,this.initialScale=new pc.Vec3,this.tmpScale=new pc.Vec3(1,1,1),this.angularVelocity=new pc.Vec3,this.startRotationAxis=new pc.Vec3(0,0,1),this.color=new pc.Color(1,1,1,1),this.startColor=new pc.Color(1,1,1,1),this.texSheetAnimationInitialized=!1,this.lifetime=0,this.elapsedTime=0,this.birthTimeOffset=0,this.velocityOverLifetimeValue=t,this.rotationOverLifetimeValue=t,this.colorOverLifetimeValue=t,this.colorBySpeedValue=t,this.sizeOverLifetimeValue=t,this.inheritVelocityValue=t,this.forceOverLifetimeValue=t}Object.defineProperty(e.prototype,"lifePart",{get:function(){return this.elapsedTime/this.lifetime}}),Object.defineProperty(e.prototype,"isAlive",{get:function(){return this.elapsedTime<this.lifetime}}),e.prototype.initialize=function(t){this.t.copy(t.translation),this.r.copy(t.rotation),this.s.copy(t.scale),this.initialScale.copy(t.scale),t.startRotationAxis&&this.startRotationAxis.copy(t.startRotationAxis),this.ownSpeed.copy(t.speed),this.color.copy(t.color),this.startColor.copy(t.color),this.lifetime=t.lifetime,this.elapsedTime=0,this.startFrame=null,this.tmpScale.set(1,1,1),this.velocityOverLifetimeValue=null,this.rotationOverLifetimeValue=null,this.colorOverLifetimeValue=null,this.colorBySpeedValue=null,this.sizeOverLifetimeValue=null,this.inheritVelocityValue=null,this.forceOverLifetimeValue=null,this.birthTimeOffset=t.birthTimeOffset,this.texSheetAnimationInitialized=!1,this.angularVelocity.set(0,0,0),this.totalSpeed.set(0,0,0)},e.prototype.copy=function(t){this.t.copy(t.t),this.r.copy(t.r),this.s.copy(t.s),this.ownSpeed.copy(t.ownSpeed),this.totalSpeed.copy(t.totalSpeed),this.initialScale.copy(t.initialScale),this.tmpScale.copy(t.tmpScale),this.angularVelocity.copy(t.angularVelocity),this.color.copy(t.color),this.startColor.copy(t.startColor),this.texSheetAnimationInitialized=t.texSheetAnimationInitialized,this.lifetime=t.lifetime,this.elapsedTime=t.elapsedTime,this.startRotationAxis.copy(t.startRotationAxis),t.velocityOverLifetimeValue?this.velocityOverLifetimeValue=(new pc.Vec3).copy(t.velocityOverLifetimeValue):this.velocityOverLifetimeValue=null,t.rotationOverLifetimeValue?this.rotationOverLifetimeValue=(new pc.Vec3).copy(t.rotationOverLifetimeValue):this.rotationOverLifetimeValue=null,t.colorOverLifetimeValue?this.colorOverLifetimeValue=(new pc.Vec3).copy(t.colorOverLifetimeValue):this.colorOverLifetimeValue=null,t.colorBySpeedValue?this.colorBySpeedValue=(new pc.Vec3).copy(t.colorBySpeedValue):this.colorBySpeedValue=null,t.sizeOverLifetimeValue?this.sizeOverLifetimeValue=(new pc.Vec3).copy(t.sizeOverLifetimeValue):this.sizeOverLifetimeValue=null,t.inheritVelocityValue?this.inheritVelocityValue=(new pc.Vec3).copy(t.inheritVelocityValue):this.inheritVelocityValue=null,t.forceOverLifetimeValue?this.forceOverLifetimeValue=(new pc.Vec3).copy(t.forceOverLifetimeValue):this.forceOverLifetimeValue=null},e.prototype.GetCurrentSize3D=function(t){return this.tmpScale.copy(this.initialScale),null!=t.sizeOverLifetime&&t.sizeOverLifetime.enabled&&t.sizeOverLifetime.processInplace(p,dt),null!=t.sizeBySpeed&&t.sizeBySpeed.enabled&&t.sizeBySpeed.processInplace(p,dt),this.tmpScale},e.prototype.GetCurrentColor=function(t){return this.color.copy(this.startColor),null!=t.colorOverLifetime&&t.colorOverLifetime.enabled&&t.colorOverLifetime.processInplace(this,dt),null!=t.colorBySpeed&&t.colorBySpeed.enabled&&t.colorBySpeed.processInplace(this,dt),this.color},pc.Particle=e}(),function(){function t(t){this._particles=new Array,this.aliveCount=0,this._maxParticles=t||0}Object.defineProperty(t.prototype,"maxParticles",{get:function(){return this._maxParticles},set:function(t){this._maxParticles=t}}),Object.defineProperty(t.prototype,"aliveCount",{get:function(){return this._aliveCount},set:function(t){this._aliveCount=t}}),t.prototype.resize=function(t){if(t=Math.min(Math.max(t,1),this.maxParticles),this._particles.length<t){var e=new Array(t),i=0;for(i=0;i<this._particles.length;++i)e[i]=this._particles[i];for(i=i;i<t;++i)e[i]=new pc.Particle;this._particles=e}},t.prototype.get=function(t){return this._particles.length<=t&&this._particles.length<this.maxParticles&&this.resize(2*this._particles.length),this._particles[t]},t.prototype.acquire=function(){if(this.aliveCount<this.maxParticles){this.aliveCount>=this._particles.length&&this.resize(2*this._particles.length);var t=this._particles[this.aliveCount];return t._cacheIndex=this.aliveCount,this.aliveCount++,t}return null},t.prototype.release=function(t){var e,i=t._cacheIndex,n=this.aliveCount-1;e=this._particles[i],this._particles[i]=this._particles[n],this._particles[i]._cacheIndex=i,this._particles[n]=e,--this.aliveCount},t.prototype.clear=function(){this.aliveCount=0},t.prototype.dispose=function(){this._particles=null,this.aliveCount=0,this.maxParticles=0},pc.ParticleCache=t}(),function(){var t={translation:new pc.Vec3,rotation:new pc.Quat,startRotationAxis:new pc.Vec3,scale:new pc.Vec3,direction:new pc.Vec3,speed:new pc.Vec3,lifetime:0,color:new pc.Color},e=new pc.Quat,i=new pc.Vec3,n=new pc.Vec3,r=new pc.Mat4,s=new pc.Vec3,o=new pc.Vec3,a=new pc.Quat;function u(){this._entity=null,this._random=new pc.Random,this._cache=new pc.ParticleCache,this._shouldEmit=!1,this._paused=!1,this._lifetime=0,this._playTime=0,this.delayTimer=0,this._emittedCount=0,this._previousPosition=new pc.Vec3,this._currentVelocity=new pc.Vec3,this._scaleFactor=new pc.Vec3,pc.events.attach(this),this.colorBySpeed=new pc.ParticleSystemColorBySpeed(this),this.colorOverLifetime=new pc.ParticleSystemColorOverLifetime(this),this.emission=new pc.ParticleSystemEmitter(this),this.main=new pc.ParticleSystemMain(this),this.rotationBySpeed=new pc.ParticleSystemRotationBySpeed(this),this.rotationOverLifetime=new pc.ParticleSystemRotationOverLifetime(this),this.shape=new pc.ParticleSystemShape(this),this.sizeBySpeed=new pc.ParticleSystemSizeBySpeed(this),this.sizeOverLifetime=new pc.ParticleSystemSizeOverLifetime(this),this.textureSheetAnimation=new pc.ParticleSystemTextureSheetAnimation(this),this.velocityOverLifetime=new pc.ParticleSystemVelocityOverLifetime(this),this.noise=new pc.ParticleSystemNoise(this),this.inheritVelocity=new pc.ParticleSystemInheritVelocity(this),this.forceOverLifetime=new pc.ParticleSystemForceOverLifetime(this),this.limitVelocityOverLifetime=new pc.ParticleSystemLimitVelocityOverLifetime(this)}Object.defineProperty(u.prototype,"isActive",{get:function(){return this._shouldEmit||this._cache.aliveCount>0}}),Object.defineProperty(u.prototype,"entity",{get:function(){return this._entity}}),Object.defineProperty(u.prototype,"lifePart",{get:function(){return this._lifetime/this.main.duration}}),Object.defineProperty(u.prototype,"lifetime",{get:function(){return this._lifetime},set:function(t){return this._lifetime=t}}),Object.defineProperty(u.prototype,"particleCount",{get:function(){return this._cache.aliveCount}}),Object.defineProperty(u.prototype,"emittedParticlesCount",{get:function(){return this._emittedCount}}),Object.defineProperty(u.prototype,"main",{get:function(){return this._mainModule},set:function(t){return this._mainModule=t}}),Object.defineProperty(u.prototype,"emission",{get:function(){return this._emission},set:function(t){return this._emission=t}}),Object.defineProperty(u.prototype,"shape",{get:function(){return this._shapeModule},set:function(t){return this._shapeModule=t}}),Object.defineProperty(u.prototype,"velocityOverLifetime",{get:function(){return this._velocityOverLifetimeModule},set:function(t){return this._velocityOverLifetimeModule=t}}),Object.defineProperty(u.prototype,"colorOverLifetime",{get:function(){return this._colorOverLifetimeModule},set:function(t){return this._colorOverLifetimeModule=t}}),Object.defineProperty(u.prototype,"colorBySpeed",{get:function(){return this._colorBySpeedModule},set:function(t){return this._colorBySpeedModule=t}}),Object.defineProperty(u.prototype,"sizeOverLifetime",{get:function(){return this._sizeOverLifetimeModule},set:function(t){return this._sizeOverLifetimeModule=t}}),Object.defineProperty(u.prototype,"sizeBySpeed",{get:function(){return this._sizeBySpeedModule},set:function(t){return this._sizeBySpeedModule=t}}),Object.defineProperty(u.prototype,"rotationOverLifetime",{get:function(){return this._rotationOverLifetimeModule},set:function(t){return this._rotationOverLifetimeModule=t}}),Object.defineProperty(u.prototype,"rotationBySpeed",{get:function(){return this._rotationBySpeedModule},set:function(t){return this._rotationBySpeedModule=t}}),Object.defineProperty(u.prototype,"textureSheetAnimation",{get:function(){return this._textureSheetAnimationModule},set:function(t){return this._textureSheetAnimationModule=t}}),Object.defineProperty(u.prototype,"time",{get:function(){return this._playTime}}),Object.defineProperty(u.prototype,"currentVelocity",{get:function(){return this._currentVelocity}}),Object.defineProperty(u.prototype,"isPaused",{get:function(){return this._paused}}),Object.defineProperty(u.prototype,"isPlaying",{get:function(){return this.isActive&&!this._paused}}),Object.defineProperty(u.prototype,"isStopped",{get:function(){return!this._shouldEmit}}),Object.defineProperty(u.prototype,"isEmitting",{get:function(){return this._shouldEmit}}),u.prototype.isAlive=function(t){var e={res:this.isActive};return this.doOnChildren(t,(function(t,e){e.res=e.res&&t.isAlive}),e),e.res},u.prototype.clear=function(){this._cache.clear()},u.prototype.stop=function(t,e){switch(t=void 0===t||t,e=void 0===e?UnityEngine.ParticleSystemStopBehavior.StopEmitting:e){case UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear:this._shouldEmit=!1,this.clear();break;case UnityEngine.ParticleSystemStopBehavior.StopEmitting:default:this._shouldEmit=!1}this.doOnChildren(t,(function(t){t.stop(!1)}))},u.prototype.pause=function(t){this._paused=!0},u.prototype.play=function(t){if(this._paused)this._paused=!1;else{this._shouldEmit=!0,this._paused=!1,this._lifetime=0,this.delayTimer=0,this._playTime=0,this.emission.lastSpawnTime_rate=0,this.emission.reinitBurstData(),t=void 0===t||t;this.doOnChildren(t,(function(t){t.play(!1)})),this._mainModule.prewarm&&this.prewarm()}},u.prototype.prewarm=function(){var t=this._mainModule.startLifetime.evaluate(this.lifePart);this.runSimulation(t,!0)},u.prototype.simulate=function(t,e,i,n){i&&this.stop(e,UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear),this._paused=!1,this.isActive||this.play(!1),this.runSimulation(t,n),this.pause();var r={time:t,withChildren:e,restart:i,fixedTimeStep:n};this.doOnChildren(e,(function(t,e){t.simulate(e.time,e.withChildren,e.restart,e.fixedTimeStep)}),r)},u.prototype.runSimulation=function(t,e){for(var i=e?UnityEngine.Time.fixedDeltaTime:.0333,n=this._entity.getWorldTransform(),r=this._entity.getLocalTransform(),s=0,o=0;s<t;)o=Math.min(t-s,i),this.update(o,n,r),s+=o},u.prototype.updateCurrentVelocity=function(t){var e=this._entity._unityComponents.rigidbody[0];this.main.emitterVelocityMode===UnityEngine.ParticleSystemEmitterVelocityMode.Rigidbody&&e?this._currentVelocity.copy(e.velocity):(s.copy(this._entity.getPosition()),this._currentVelocity.copy(s).sub(this._previousPosition).scale(1/t),this._previousPosition.copy(s))},u.prototype.createParticle=function(i,n,r){t.translation.copy(pc.Vec3.ZERO),t.rotation.copy(pc.Quat.IDENTITY),t.scale.x=t.scale.y=t.scale.z=1,t.direction.copy(pc.Vec3.BACK);var s=this._cache.acquire();++this._emittedCount;var o=this.lifePart;null!=this.shape&&this.shape.enabled&&this.shape.applyNextTransform(t.translation,t.rotation,t.direction),this._mainModule.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.World&&(i.transformPoint(t.translation,t.translation),i.transformVector(t.direction,t.direction),t.direction.normalize());var a=this._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode;a!==UnityEngine.ParticleSystemRenderMode.Stretch&&(this.main.startRotation3D?e.setFromEulerAngles(this.main.startRotationX.evaluate(o)*pc.math.RAD_TO_DEG,this.main.startRotationY.evaluate(o)*pc.math.RAD_TO_DEG,this.main.startRotationZ.evaluate(o)*pc.math.RAD_TO_DEG):(a===UnityEngine.ParticleSystemRenderMode.Billboard?t.startRotationAxis.copy(t.rotation.transformVector(pc.Vec3.FORWARD)).normalize():(t.startRotationAxis.x=this._random.nextFloat()-.5,t.startRotationAxis.y=this._random.nextFloat()-.5,t.startRotationAxis.z=this._random.nextFloat()-.5,t.startRotationAxis.normalize()),e.setFromAxisAngle(t.startRotationAxis,this.main.startRotation.evaluate(o)*pc.math.RAD_TO_DEG))),t.rotation.mul(e),this.main.startSize3D?(t.scale.x=this.main.startSizeX.evaluate(o),t.scale.y=this.main.startSizeY.evaluate(o),t.scale.z=this.main.startSizeZ.evaluate(o)):t.scale.copy(pc.Vec3.ONE).scale(this.main.startSize.evaluate(o));var u=Math.abs(this.main.startSpeed.evaluate(o));return t.speed.copy(t.direction).scale(u),this.main.startColor.evaluateInplace(o,t.color),t.lifetime=this.main.startLifetime.evaluate(o),t.birthTimeOffset=r,s.initialize(t),s},u.prototype._updateParticles=function(t,e,i){this.main.simulationSpace==UnityEngine.ParticleSystemSimulationSpace.Local&&(r.copy(e).invert(),r.transformVector(n,n)),this._updateScaleFactor(e,i);for(var s=0;s<this._cache.aliveCount;++s){var o=this._cache.get(s);this._processParticle(o,t,this._scaleFactor,this._cache,r)}},u.prototype._processParticle=function(t,e,r,s,u){t.tmpScale.copy(t.initialScale),t.color.copy(t.startColor),(this.rotationOverLifetime.enabled||this.rotationBySpeed.enabled)&&t.angularVelocity.set(0,0,0),0!==t.birthTimeOffset&&(e=t.birthTimeOffset,t.birthTimeOffset=0);var c=this.main.gravityModifier.evaluate(this.lifePart);n.copy(UnityEngine.Physics.gravity),n.scale(c).scale(e),u.transformVector(n,n),t.ownSpeed.add(n),t.totalSpeed.copy(t.ownSpeed),this.inheritVelocity.enabled&&this.inheritVelocity.processInplace(t,e),this.forceOverLifetime.enabled&&this.forceOverLifetime.processInplace(t,e),this.velocityOverLifetime.enabled&&this.velocityOverLifetime.processInplace(t,e),this.colorOverLifetime.enabled&&this.colorOverLifetime.processInplace(t,e),this.colorBySpeed.enabled&&this.colorBySpeed.processInplace(t,e),this.rotationOverLifetime.enabled&&this.rotationOverLifetime.processInplace(t,e),this.rotationBySpeed.enabled&&this.rotationBySpeed.processInplace(t,e),this.sizeOverLifetime.enabled&&this.sizeOverLifetime.processInplace(t,e),this.sizeBySpeed.enabled&&this.sizeBySpeed.processInplace(t,e),this.textureSheetAnimation.enabled&&this.textureSheetAnimation.processInplace(t,e),this.noise.enabled&&this.noise.processInplace(t,e),this.limitVelocityOverLifetime.enabled&&this.limitVelocityOverLifetime.processInplace(t,e),o.copy(t.angularVelocity),o.scale(e),a.setFromEulerAngles(o.x,o.y,o.z),t.totalSpeed.mul2(t.totalSpeed,r),t.t.add(i.copy(t.totalSpeed).scale(e)),t.r.mul(a),t.s.copy(t.tmpScale),t.elapsedTime+=e},u.prototype._updateScaleFactor=function(t,e){this._scaleFactor.copy(pc.Vec3.ONE),this.main.scalingMode===UnityEngine.ParticleSystemScalingMode.Hierarchy?this._scaleFactor.copy(t.getScale()):this.main.scalingMode===UnityEngine.ParticleSystemScalingMode.Local&&this._scaleFactor.copy(e.getScale())},u.prototype.emit=function(t){var e=pc.math.clamp(t,0,this._mainModule.maxParticles-this._cache.aliveCount);if(e>0)for(var i=this._entity.localTransform,n=this._entity.worldTransform,r=0;r<e;++r)this.createParticle(n,i,0)},u.prototype.update=function(t,e,i){if(this.isActive&&!this._paused){var n=t;n*=this.main.simulationSpeed,this.main.useUnscaledTime||(n*=UnityEngine.Time.timeScale),this.delayTimer<this.main.startDelay.evaluate(0)?this.delayTimer+=n:(this._lifetime+=n,this._playTime+=n,this._lifetime>this.main.duration&&this.main.loop&&(this._lifetime-=this.main.duration,this.fire("ParticleSystemNewLoop")),this.lifetime>this.main.duration&&!this.main.loop&&(this._shouldEmit=!1),this.updateCurrentVelocity(t),this.cleanupOldParticles(),this._shouldEmit&&null!=this.emission&&this.emission.enabled&&this.emission.update(n,e,i),this._updateParticles(n,e,i))}},u.prototype.cleanupOldParticles=function(){for(var t=this._cache.aliveCount-1;t>=0;--t){var e=this._cache.get(t);e.elapsedTime>e.lifetime&&this._cache.release(e)}},u.prototype.doOnChildren=function(t,e,i){if(t&&this._entity)for(var n=this._entity.allChildren(),r=0;r<n.length;r++){var s=n[r]._unityComponents.particlesystem[0];s&&e(s._particleSystem,i)}},u.prototype.getParticles=function(t){if(t){for(var e=Math.min(this._cache.aliveCount,t.length),i=0;i<e;i++)t[i].Handle.copy(this._cache.get(i));return e}},u.prototype.setParticles=function(t,e){if(t){for(var i=Math.min(this.main.maxParticles,e,t.length),s=0;s<i;s++){this._cache.get(s).copy(t[s].Handle)}this.main.simulationSpace==UnityEngine.ParticleSystemSimulationSpace.Local&&(r.copy(worldTransform).invert(),r.transformVector(n,n));for(s=0;s<this._cache.aliveCount;++s){var o=this._cache.get(s);this._processParticle(o,0,this._scaleFactor,this._cache,r)}}},pc.ParticleSystem=u}(),function(){var t=null,e=null,i=new pc.Vec3,n=new pc.Vec3,r=new pc.Vec3,s=new pc.Vec3,o=new Float32Array([-.5,-.5,0,1,1,1,1,0,0,-.5,.5,0,1,1,1,1,0,1,.5,.5,0,1,1,1,1,1,1,.5,-.5,0,1,1,1,1,1,0]),a=new Float32Array([-.5,-1,0,1,1,1,1,0,0,-.5,0,0,1,1,1,1,0,1,.5,0,0,1,1,1,1,1,1,.5,-1,0,1,1,1,1,1,0]),u=new Uint16Array([0,1,2,2,3,0]),c=[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32}],h=[{semantic:pc.SEMANTIC_TEXCOORD5,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD6,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD7,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR0,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR1,components:4,type:pc.ELEMENTTYPE_FLOAT32}];function l(){this.model=new pc.Model,this.configuration=new pc.Vec4,this._modelVersion=0,this._lastModelVersion=1,this.worldRotationTransform=new pc.Mat4,this.worldTranslationTransform=new pc.Mat4}Object.defineProperty(l.prototype,"sharedMaterials",{get:function(){return this._materials},set:function(t){this._materials=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"mesh",{get:function(){return this._mesh},set:function(t){this._mesh=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"alignment",{get:function(){return this._alignment},set:function(t){this._alignment=t}}),Object.defineProperty(l.prototype,"renderMode",{get:function(){return this._renderMode},set:function(t){this._renderMode=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"lengthScale",{get:function(){return this._lengthScale},set:function(t){this._lengthScale=t}}),Object.defineProperty(l.prototype,"velocityScale",{get:function(){return this._velocityScale},set:function(t){this._velocityScale=t}}),Object.defineProperty(l.prototype,"cameraVelocityScale",{get:function(){return this._cameraVelocityScale},set:function(t){this._cameraVelocityScale=t}}),Object.defineProperty(l.prototype,"normalDirection",{get:function(){return this._normalDirection},set:function(t){this._normalDirection=t}}),Object.defineProperty(l.prototype,"sortingOrder",{get:function(){return this.model.sortingOrder},set:function(t){this.model.sortingOrder=t}}),Object.defineProperty(l.prototype,"sortingLayerIndex",{get:function(){return this.model.sortingLayerIndex},set:function(t){this.model.sortingLayerIndex=t}}),Object.defineProperty(l.prototype,"sortingLayerName",{get:function(){return UnityEngine.SortingLayer.GetLayerNameFromValue(this.model.sortingLayerIndex)},set:function(t){this.model.sortingLayerIndex=UnityEngine.SortingLayer.GetLayerValueFromName(t)}}),Object.defineProperty(l.prototype,"sortingFudge",{get:function(){return this._sortingFudge},set:function(t){this._sortingFudge=t}}),Object.defineProperty(l.prototype,"minParticleSize",{get:function(){return this._minParticleSize},set:function(t){this._minParticleSize=t}}),Object.defineProperty(l.prototype,"maxParticleSize",{get:function(){return this._maxParticleSize},set:function(t){this._maxParticleSize=t}}),Object.defineProperty(l.prototype,"pivot",{get:function(){return this._pivot},set:function(t){this._pivot=t}}),Object.defineProperty(l.prototype,"trailMaterial",{get:function(){return this._trailMaterial},set:function(t){this._trailMaterial=t}}),Object.defineProperty(l.prototype,"sortMode",{get:function(){return this._sortMode},set:function(t){this._sortMode=t}}),Object.defineProperty(l.prototype,"activeVertexStreamsCount",{get:function(){return this._activeVertexStreamsCount},set:function(t){this._activeVertexStreamsCount=t}}),Object.assign(l.prototype,{_configureModel:function(){switch(this._modelVersion=this._lastModelVersion,this.renderMode){case UnityEngine.ParticleSystemRenderMode.Billboard:case UnityEngine.ParticleSystemRenderMode.Stretch:case UnityEngine.ParticleSystemRenderMode.HorizontalBillboard:case UnityEngine.ParticleSystemRenderMode.VerticalBillboard:this.model.mesh=this._prepareBillboardMesh();break;case UnityEngine.ParticleSystemRenderMode.Mesh:this.model.mesh=this._mesh?this._mesh.handle:null;break;case UnityEngine.ParticleSystemRenderMode.None:this.model.mesh=null}if(this._materials&&this._materials.length>0){var t=[];for(let e=0;e<this._materials.length;e++)1!==e&&t.push(this._materials[e].handle);this.model.materials=t}else this.model.materials=[];this.model.update();const e=this.model.meshInstances;for(let t=0;t<e.length;t++){let i=e[t];i.instancingData=this._prepareInstancingData(),i.constAttributes.COLOR=[1,1,1,1],i._shaderDefs|=pc.SHADERDEF_PARTICLES_INSTANCING}},_prepareInstancingData:function(){if(!this._instancingData){var t=pc.Application.getApplication();this._instancingVertexFormat=new pc.VertexFormat(t.graphicsDevice,h),this._instancingData={_buffer:new pc.VertexBuffer(t.graphicsDevice,this._instancingVertexFormat,0,pc.BUFFER_DYNAMIC,new Float32Array(0)),count:0,offset:0}}return this._instancingData},_prepareQuad:function(t){var e=pc.Application.getApplication(),i=new pc.Mesh,n=new pc.VertexFormat(e.graphicsDevice,c),r=t;return i.vertexBuffer=new pc.VertexBuffer(e.graphicsDevice,n,4,pc.BUFFER_STATIC,r),i.indexBuffer[0]=new pc.IndexBuffer(e.graphicsDevice,pc.INDEXFORMAT_UINT16,6,pc.BUFFER_STATIC,u),i.primitive[0].type=pc.PRIMITIVE_TRIANGLES,i.primitive[0].base=0,i.primitive[0].count=6,i.primitive[0].indexed=!0,i.subMeshes=[i],i},_prepareBillboardMesh:function(){return null===t&&(t=this._prepareQuad(o)),null===e&&(e=this._prepareQuad(a)),this.renderMode==UnityEngine.ParticleSystemRenderMode.Stretch?e:t},_resizeInstancingBuffer:function(t){this._instancingData&&(t>this._instancingData._buffer.numVertices&&this._instancingData._buffer.resize(t),this._instancingData.count=t)},_updateInstancingData:function(t,e){var i=this.model.meshInstances;if(0!==i.length){var n=this._instancingData._buffer,o=new Float32Array(n.lock());r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var a=0;a<e.aliveCount;a++){var u=this._instancingVertexFormat.size/4*a,c=e.get(a),h=c.t;r.x=Math.min(r.x,h.x),r.y=Math.min(r.y,h.y),r.z=Math.min(r.z,h.z),s.x=Math.max(s.x,h.x),s.y=Math.max(s.y,h.y),s.z=Math.max(s.z,h.z),o[u+0]=c.t.x,o[u+1]=c.t.y,o[u+2]=c.t.z,o[u+3]=c.r.x,o[u+4]=c.r.y,o[u+5]=c.r.z,o[u+6]=c.r.w,this.renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?(o[u+7]=c.s.x,o[u+8]=c.totalSpeed.length()*this.velocityScale+this.lengthScale*c.s.y,o[u+9]=c.s.z):(o[u+7]=c.s.x,o[u+8]=c.s.y,o[u+9]=c.s.z),o[u+10]=c.color.r,o[u+11]=c.color.g,o[u+12]=c.color.b,o[u+13]=c.color.a,null!=t.textureSheetAnimation&&t.textureSheetAnimation.enabled?(o[u+14]=1/t.textureSheetAnimation.numTilesX,o[u+15]=1/t.textureSheetAnimation.numTilesY,o[u+16]=c.texSheetColumn,o[u+17]=t.textureSheetAnimation.numTilesY-c.texSheetRow-1):(o[u+14]=1,o[u+15]=1,o[u+16]=0,o[u+17]=0)}for(a=0;a<i.length;a++){var l=i[a],p=null;switch(t.main.scalingMode){case UnityEngine.ParticleSystemScalingMode.Hierarchy:p=l.node.getWorldTransform().getScale();break;case UnityEngine.ParticleSystemScalingMode.Local:p=l.node.localScale;break;case UnityEngine.ParticleSystemScalingMode.Shape:p=pc.Vec3.ONE}this.worldRotationTransform.setTRS(pc.Vec3.ZERO,l.node.getRotation(),pc.Vec3.ONE),this.worldTranslationTransform.setTRS(l.node.getPosition(),pc.Quat.IDENTITY,pc.Vec3.ONE),l.setParameter("matrix_modelRotation",this.worldRotationTransform.data),l.setParameter("matrix_modelTranslation",this.worldTranslationTransform.data),l.setParameter("system_scale",[p.x,p.y,p.z]),l.setParameter("localToWorldMatrix",pc.Mat4.IDENTITY.data),this.renderMode==UnityEngine.ParticleSystemRenderMode.Stretch?l.setParameter("renderer_alignment",UnityEngine.ParticleSystemRenderSpace.View):t._shapeModule.alignToDirection?l.setParameter("renderer_alignment",UnityEngine.ParticleSystemRenderSpace.Local):l.setParameter("renderer_alignment",this.alignment),l.setParameter("worldSimulationSpace",t.main.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.World?1:0),l.parameters._TintColor||!l.material||l.material.parameters._TintColor||l.setParameter("_TintColor",[1,1,1,1]),l.worldAabbOverride||(l.worldAabbOverride=new pc.BoundingBox);var d=l.worldAabbOverride;d.setMinMax(r,s),t.main.simulationSpace!==UnityEngine.ParticleSystemSimulationSpace.World&&(this.worldTranslationTransform.setTRS(l.node.getPosition(),l.node.getRotation(),pc.Vec3.ONE),d.setFromTransformedAabb(d,this.worldTranslationTransform))}n.unlock()}},_sortParticles:function(t,e){var i=this.sortMode;switch(n=this.model.entity.getPosition(),i){case UnityEngine.ParticleSystemSortMode.Distance:t.sort(this.sortByDistance);break;case UnityEngine.ParticleSystemSortMode.OldestInFront:t.sort(this.sortOldestInFront);break;case UnityEngine.ParticleSystemSortMode.YoungestInFront:t.sort(this.sortYoungestInFront);break;case UnityEngine.ParticleSystemSortMode.None:}for(var r=0;r<e;r++)t[r]._cacheIndex=r},sortByDistance:function(t,e){if(!t.isAlive)return 1;if(!e.isAlive)return-1;var r=pc.Application.getApplication().getMainCamera().node.position;r.sub(n),i.copy(t.t).sub(r);var s=i.lengthSq();return i.copy(e.t).sub(r),s-i.lengthSq()},sortOldestInFront:function(t,e){return t.isAlive?e.isAlive?t.elapsedTime-e.elapsedTime:-1:1},sortYoungestInFront:function(t,e){return t.isAlive?e.isAlive?e.elapsedTime-t.elapsedTime:-1:1},update:function(t,e){return this._modelVersion!==this._lastModelVersion&&(this._configureModel(),!0)},render:function(t,e){var i=t._cache;i.aliveCount>0&&this._sortParticles(i._particles,i.aliveCount),this._resizeInstancingBuffer(i.aliveCount),this._updateInstancingData(t,i)}}),pc.ParticleSystemRenderer=l}(),function(){function t(t){this.m_ParticleSystem=t,this.duration=5,this.loop=!0,this.prewarm=!0,this.startDelay=new pc.MinMaxCurve,this.startDelay._random=t._random,this.startDelayMultiplier=1,this.startLifetime=new pc.MinMaxCurve(5),this.startLifetime._random=t._random,this.startLifetimeMultiplier=1,this.startSpeed=new pc.MinMaxCurve(5),this.startSpeed._random=t._random,this.startSpeedMultiplier=1,this.startSize=new pc.MinMaxCurve,this.startSize._random=t._random,this.startSizeMultiplier=1,this.startSizeX=new pc.MinMaxCurve,this.startSizeX._random=t._random,this.startSizeXMultiplier=1,this.startSizeY=new pc.MinMaxCurve,this.startSizeY._random=t._random,this.startSizeYMultiplier=1,this.startSizeZ=new pc.MinMaxCurve,this.startSizeZ._random=t._random,this.startSizeYMultiplier=1,this.startRotation=new pc.MinMaxCurve,this.startRotation._random=t._random,this.startRotationMultiplier=1,this.startRotationX=new pc.MinMaxCurve,this.startRotationX._random=t._random,this.startRotationXMultiplier=1,this.startRotationY=new pc.MinMaxCurve,this.startRotationY._random=t._random,this.startRotationYMultiplier=1,this.startRotationZ=new pc.MinMaxCurve,this.startRotationZ._random=t._random,this.startRotationZMultiplier=1,this.flipRotation=!1,this.startColor=new pc.MinMaxGradient,this.startColor._random=t._random,this.gravityModifier=new pc.MinMaxCurve,this.gravityModifier._random=t._random,this.gravityModifierMultiplier=1,this.simulationSpace=UnityEngine.ParticleSystemSimulationSpace.Local,this.customSimulationSpace=null,this.simulationSpeed=1,this.useUnscaledTime=!0,this.scalingMode=UnityEngine.ParticleSystemScalingMode.Local,this.playOnAwake=!0,this.maxParticles=10,this.emitterVelocityMode=UnityEngine.ParticleSystemEmitterVelocityMode.Transform}Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},set:function(t){this._duration=t}}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(t.prototype,"prewarm",{get:function(){return this._prewarm},set:function(t){this._prewarm=t}}),Object.defineProperty(t.prototype,"startDelay",{get:function(){return this._startDelay},set:function(t){this._startDelay=t}}),Object.defineProperty(t.prototype,"startDelayMultiplier",{get:function(){return this._startDelayMultiplier},set:function(t){this._startDelayMultiplier=t}}),Object.defineProperty(t.prototype,"startLifetime",{get:function(){return this._startLifetime},set:function(t){this._startLifetime=t}}),Object.defineProperty(t.prototype,"startLifetimeMultiplier",{get:function(){return this._startLifetimeMultiplier},set:function(t){this._startLifetimeMultiplier=t}}),Object.defineProperty(t.prototype,"startSpeed",{get:function(){return this._startSpeed},set:function(t){this._startSpeed=t}}),Object.defineProperty(t.prototype,"startSpeedMultiplier",{get:function(){return this._startSpeedMultiplier},set:function(t){this._startSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"startSize3D",{get:function(){return this._startSize3D},set:function(t){this._startSize3D=t}}),Object.defineProperty(t.prototype,"startSize",{get:function(){return this._startSize},set:function(t){this._startSize=t}}),Object.defineProperty(t.prototype,"startSizeX",{get:function(){return this._startSizeX},set:function(t){this._startSizeX=t}}),Object.defineProperty(t.prototype,"startSizeY",{get:function(){return this._startSizeY},set:function(t){this._startSizeY=t}}),Object.defineProperty(t.prototype,"startSizeZ",{get:function(){return this._startSizeZ},set:function(t){this._startSizeZ=t}}),Object.defineProperty(t.prototype,"startSizeMultiplier",{get:function(){return this._startSizeMultiplier},set:function(t){this._startSizeMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeXMultiplier",{get:function(){return this._startSizeXMultiplier},set:function(t){this._startSizeXMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeYMultiplier",{get:function(){return this._startSizeYMultiplier},set:function(t){this._startSizeYMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeZMultiplier",{get:function(){return this._startSizeZMultiplier},set:function(t){this._startSizeZMultiplier=t}}),Object.defineProperty(t.prototype,"startRotation3D",{get:function(){return this._startRotation3D},set:function(t){this._startRotation3D=t}}),Object.defineProperty(t.prototype,"startRotation",{get:function(){return this._startRotation},set:function(t){this._startRotation=t}}),Object.defineProperty(t.prototype,"startRotationX",{get:function(){return this._startRotationX},set:function(t){this._startRotationX=t}}),Object.defineProperty(t.prototype,"startRotationY",{get:function(){return this._startRotationY},set:function(t){this._startRotationY=t}}),Object.defineProperty(t.prototype,"startRotationZ",{get:function(){return this._startRotationZ},set:function(t){this._startRotationZ=t}}),Object.defineProperty(t.prototype,"startRotationMultiplier",{get:function(){return this._startRotationMultiplier},set:function(t){this._startRotationMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationXMultiplier",{get:function(){return this._startRotationXMultiplier},set:function(t){this._startRotationXMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationYMultiplier",{get:function(){return this._startRotationYMultiplier},set:function(t){this._startRotationYMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationZMultiplier",{get:function(){return this._startRotationZMultiplier},set:function(t){this._startRotationZMultiplier=t}}),Object.defineProperty(t.prototype,"flipRotation",{get:function(){return this._flipRotation},set:function(t){this._flipRotation=t}}),Object.defineProperty(t.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t}}),Object.defineProperty(t.prototype,"gravityModifier",{get:function(){return this._gravityModifier},set:function(t){this._gravityModifier=t}}),Object.defineProperty(t.prototype,"gravityModifierMultiplier",{get:function(){return this._gravityModifierMultiplier},set:function(t){this._gravityModifierMultiplier=t}}),Object.defineProperty(t.prototype,"simulationSpace",{get:function(){return this._simulationSpace},set:function(t){this._simulationSpace=t}}),Object.defineProperty(t.prototype,"customSimulationSpace",{get:function(){return this._customSimulationSpace},set:function(t){this._customSimulationSpace=t}}),Object.defineProperty(t.prototype,"simulationSpeed",{get:function(){return this._simulationSpeed},set:function(t){this._simulationSpeed=t}}),Object.defineProperty(t.prototype,"useUnscaledTime",{get:function(){return this._useUnscaledTime},set:function(t){this._useUnscaledTime=t}}),Object.defineProperty(t.prototype,"scalingMode",{get:function(){return this._scalingMode},set:function(t){this._scalingMode=t}}),Object.defineProperty(t.prototype,"playOnAwake",{get:function(){return this._playOnAwake},set:function(t){this._playOnAwake=t}}),Object.defineProperty(t.prototype,"maxParticles",{get:function(){return this._maxParticles},set:function(t){this._maxParticles=t,this.m_ParticleSystem._cache.maxParticles=this._maxParticles}}),Object.defineProperty(t.prototype,"emitterVelocityMode",{get:function(){return this._emitterVelocityMode},set:function(t){this._emitterVelocityMode=t}}),pc.ParticleSystemMain=t}(),function(){function t(){}function e(t){this.m_ParticleSystem=t,this._accumulator=new pc.IntAccumulator,this.enabled=!0,this.rateOverTime=new pc.MinMaxCurve(10),this.rateOverTime._random=t._random,this.rateOverTimeMultiplier=1,this.rateOverDistance=new pc.MinMaxCurve,this.rateOverDistance._random=t._random,this.rateOverTimeMultiplier=1,this.bursts=[],this.burstCount=0,this.burstsTimeline=[],this.lastSpawnTime_rate=0,this.m_ParticleSystem.on("ParticleSystemNewLoop",this.handleParticleSystemLoop)}Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(t){this._time=t}}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},set:function(t){this._count=t}}),Object.defineProperty(t.prototype,"maxCount",{get:function(){return this._count.constantMax},set:function(t){this._count.constantMax=t}}),Object.defineProperty(t.prototype,"minCount",{get:function(){return this._count.constantMin},set:function(t){this._count.constantMin=t}}),Object.defineProperty(t.prototype,"cycleCount",{get:function(){return this._cycleCount},set:function(t){this._cycleCount=t}}),Object.defineProperty(t.prototype,"repeatInterval",{get:function(){return this.m_RepeatInterval},set:function(t){this.m_RepeatInterval=t}}),Object.defineProperty(t.prototype,"shouldFire",{get:function(){return this.repeatCount>0}}),t.prototype.recalculateRepeatCount=function(){this.repeatCount=this.cycleCount>0?this.cycleCount:1/0},Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"rateOverTime",{get:function(){return this._rateOverTime},set:function(t){this._rateOverTime=t}}),Object.defineProperty(e.prototype,"rateOverTimeMultiplier",{get:function(){return this._rateOverTimeMultiplier},set:function(t){this._rateOverTimeMultiplier=t}}),Object.defineProperty(e.prototype,"rateOverDistance",{get:function(){return this._rateOverDistance},set:function(t){this._rateOverDistance=t}}),Object.defineProperty(e.prototype,"rateOverDistanceMultiplier",{get:function(){return this._rateOverDistanceMultiplier},set:function(t){this._rateOverDistanceMultiplier=t}}),Object.defineProperty(e.prototype,"burstCount",{get:function(){return this._burstCount},set:function(t){this._burstCount=t}}),e.prototype.setBursts=function(t){this.bursts=t},e.prototype.getBursts=function(t){for(var e=0;e<this._burstCount;++e)t[e]=this.bursts[e];return this._burstCount},e.prototype.getBurst=function(t){return this.bursts[i]},e.prototype.handleParticleSystemLoop=function(){for(var t=this.emission,e=0;e<t.bursts.length;++e)t.bursts[e].recalculateRepeatCount()},e.prototype.recalculateBurstData=function(){for(var t=0;t<this.bursts.length;++t){var e=this.bursts[t];null==e.timeToFire&&(e.recalculateRepeatCount(),e.timeToFire=e.time)}},e.prototype.reinitBurstData=function(){for(var t=0;t<this.bursts.length;++t){var e=this.bursts[t];e.recalculateRepeatCount(),e.timeToFire=e.time}},e.prototype.getParticlesFromBursts=function(t){for(var e=0,i=0;i<this.bursts.length;++i){var n=this.bursts[i];n.timeToFire-=t,n.shouldFire&&n.timeToFire<0&&(e+=n.count.evaluate(this.m_ParticleSystem.lifePart),n.timeToFire=n.repeatInterval,n.repeatCount-=1)}return e},e.prototype.update=function(t,e,i){this.recalculateBurstData();var n=this.getParticlesFromBursts(t),r=this.m_ParticleSystem._entity.worldTransform.getTranslation();this.previousPosition||(this.previousPosition=r.clone());var s=r.clone().sub(this.previousPosition).length();this.previousPosition=r;var o=n+this.rateOverDistance.evaluate(t)*s;if(this._accumulator.update(o),this.m_ParticleSystem.main.maxParticles<=this.m_ParticleSystem.particleCount)return 0;var a=Math.min(this._accumulator.accumulated,this.m_ParticleSystem.main.maxParticles-this.m_ParticleSystem.particleCount);this._accumulator.take(a);for(var u=0;u<a;++u)this.m_ParticleSystem.createParticle(e,i,0);for(var c=1/this.rateOverTime.evaluate(this.m_ParticleSystem.lifePart);this.lastSpawnTime_rate+c<this.m_ParticleSystem._playTime;){if(this.m_ParticleSystem.main.maxParticles<=this.m_ParticleSystem.particleCount)return 0;var h=this.m_ParticleSystem._playTime-this.lastSpawnTime_rate-c;this.m_ParticleSystem.createParticle(e,i,h),this.lastSpawnTime_rate+=c}},pc.ParticleSystemBurst=t,pc.ParticleSystemEmitter=e}(),function(){function t(t){this.m_ParticleSystem=t,this._TRS=pc.Mat4.IDENTITY,this._TR=pc.Mat4.IDENTITY,this.enabled=!1,this.radiusSpeed=new pc.MinMaxCurve,this.radiusSpeed._random=t._random,this.radiusSpeedMultiplier=1,this.arcSpeed=new pc.MinMaxCurve,this.arcSpeed._random=t._random,this.arcSpeedMultiplier=1,this.circularSpawner=new pc.CircularSpawner(this)}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return this._shapeType},set:function(t){switch(this._shapeType=t,t){case UnityEngine.ParticleSystemShapeType.Cone:this.impl=new pc.ConeShape(this,!1);break;case UnityEngine.ParticleSystemShapeType.ConeVolume:this.impl=new pc.ConeShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Sphere:this.impl=new pc.SphereShape(this);break;case UnityEngine.ParticleSystemShapeType.Hemisphere:this.impl=new pc.SphereShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Circle:this.impl=new pc.SphereShape(this,!1,!0);break;case UnityEngine.ParticleSystemShapeType.Donut:this.impl=new pc.DonutShape(this);break;case UnityEngine.ParticleSystemShapeType.Box:case UnityEngine.ParticleSystemShapeType.BoxShell:case UnityEngine.ParticleSystemShapeType.BoxEdge:case UnityEngine.ParticleSystemShapeType.Rectangle:case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:default:this.impl=new pc.BoxShape(this)}}}),Object.defineProperty(t.prototype,"randomDirectionAmount",{get:function(){return this._randomDirectionAmount},set:function(t){this._randomDirectionAmount=t}}),Object.defineProperty(t.prototype,"sphericalDirectionAmount",{get:function(){return this._sphericalDirectionAmount},set:function(t){this._sphericalDirectionAmount=t}}),Object.defineProperty(t.prototype,"randomPositionAmount",{get:function(){return this._randomPositionAmount},set:function(t){this._randomPositionAmount=t}}),Object.defineProperty(t.prototype,"alignToDirection",{get:function(){return this._alignToDirection},set:function(t){this._alignToDirection=t}}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._radiusMode},set:function(t){this._radiusMode=t}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._radiusSpread},set:function(t){this._radiusSpread=t}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._radiusSpeed},set:function(t){this._radiusSpeed=t}}),Object.defineProperty(t.prototype,"radiusSpeedMultiplier",{get:function(){return this._radiusSpeedMultiplier},set:function(t){this._radiusSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"radiusThickness",{get:function(){return this._radiusThickness},set:function(t){this._radiusThickness=t}}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t}}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._length=t}}),Object.defineProperty(t.prototype,"boxThickness",{get:function(){return this._boxThickness},set:function(t){this._boxThickness=t}}),Object.defineProperty(t.prototype,"arc",{get:function(){return this._arc},set:function(t){this._arc=t}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._arcMode},set:function(t){this._arcMode=t}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._arcSpread},set:function(t){this._arcSpread=t}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._arcSpeed},set:function(t){this._arcSpeed=t}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._arcSpeedMultiplier},set:function(t){this._arcSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"donutRadius",{get:function(){return this._donutRadius},set:function(t){this._donutRadius=t}}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._position=t}}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._rotation=t}}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.trsDirty=!0,this._scale=t}}),Object.defineProperty(t.prototype,"TRS",{get:function(){if(this.trsDirty){var t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TRS=(new pc.Mat4).setTRS(this.position,t,this.scale),this.trsDirty=!1}return this._TRS}}),Object.defineProperty(t.prototype,"TR",{get:function(){if(this.trDirty){var t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TR=(new pc.Mat4).setTRS(this.position,t,new pc.Vec3(1,1,1)),this.trDirty=!1}return this._TR}}),Object.defineProperty(t.prototype,"trsDirty",{get:function(){return this._trsDirty},set:function(t){this._trsDirty=t}}),Object.defineProperty(t.prototype,"trDirty",{get:function(){return this._trDirty},set:function(t){this._trDirty=t}}),Object.defineProperty(t.prototype,"impl",{get:function(){return this._impl},set:function(t){this._impl=t}});var e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,r=new pc.Quat,s=new pc.Vec3,o=new pc.Vec3;t.prototype.applyNextTransform=function(t,a,u){this.impl.applyTransformations(e,i),this.randomizePosition(e),this._shapeType==UnityEngine.ParticleSystemShapeType.Cone?(this.impl.applyTransformations(s,o,0),this.randomizeDirection(i,o)):this.randomizeDirection(i),this.TRS.transformPoint(e,t),this.TRS.transformVector(i,u),u.normalize(),0==u.x&&0==u.y&&0==u.z&&(u.z=1);var c=Math.sign(this.m_ParticleSystem.main.startSpeed.evaluate(this.m_ParticleSystem.lifePart));this.spherizeDirection(t,u,this.position),u.scale(c),n.copy(this.rotationBetweenVectors(pc.Vec3.FORWARD,u)),r.copy(this.rotationBetweenVectors(pc.Vec3.UP,u)),this.m_ParticleSystem._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?a.copy(r):this.alignToDirection?(a.setFromMat4(this.TR),a.mul(n)):a.copy(pc.Quat.IDENTITY)};var a=new pc.Vec3;t.prototype.randomizePosition=function(t){var e=this.m_ParticleSystem._random;this.randomPositionAmount>0&&(a.x=e.nextFloat()-.5,a.y=e.nextFloat()-.5,a.z=e.nextFloat()-.5,a.scale(this.randomPositionAmount),t.add(a))};var u=new pc.Vec3;t.prototype.randomizeDirection=function(t,e){var i=this.m_ParticleSystem._random;this.randomDirectionAmount>0&&(e?u.copy(e):(u.x=i.nextFloat()-.5,u.y=i.nextFloat()-.5,u.z=i.nextFloat()-.5),u.normalize(),t.lerp(t,u,this.randomDirectionAmount)),t.normalize()};var c=new pc.Vec3;t.prototype.spherizeDirection=function(t,e,i){this.sphericalDirectionAmount>0&&(c.copy(t).sub(i).normalize(),e.lerp(e,c,this.sphericalDirectionAmount)),e.normalize()};var h=new pc.Quat,l=new pc.Vec3;t.prototype.rotationBetweenVectors=function(t,e){return l.cross(t,e),h.x=l.x,h.y=l.y,h.z=l.z,h.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),h.normalize()},t.prototype.getPointInRadius=function(t){var e=this.m_ParticleSystem._random,i=1-this.radiusThickness;return(i+(1-i)*e.nextFloat())*t},pc.ParticleSystemShape=t}(),function(){var t=new pc.Vec3,e=new pc.Vec3,i=new pc.Vec3,n=new pc.Vec3;function r(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.orbitalX=new pc.MinMaxCurve,this.orbitalX._random=t._random,this.orbitalY=new pc.MinMaxCurve,this.orbitalY._random=t._random,this.orbitalZ=new pc.MinMaxCurve,this.orbitalZ._random=t._random,this.orbitalXMultiplier=1,this.orbitalYMultiplier=1,this.orbitalZMultiplier=1,this.orbitalOffsetX=new pc.MinMaxCurve,this.orbitalOffsetX._random=t._random,this.orbitalOffsetY=new pc.MinMaxCurve,this.orbitalOffsetY._random=t._random,this.orbitalOffsetZ=new pc.MinMaxCurve,this.orbitalOffsetZ._random=t._random,this.orbitalOffsetXMultiplier=1,this.orbitalOffsetYMultiplier=1,this.orbitalOffsetZMultiplier=1,this.radial=new pc.MinMaxCurve,this.radial._random=t._random,this.radialMultiplier=1,this.speedModifier=new pc.MinMaxCurve,this.speedModifier._random=t._random,this.speedModifierMultiplier=1}Object.defineProperty(r.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(r.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(r.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(r.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(r.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalX",{get:function(){return this._orbitalX},set:function(t){this._orbitalX=t}}),Object.defineProperty(r.prototype,"orbitalY",{get:function(){return this._orbitalY},set:function(t){this._orbitalY=t}}),Object.defineProperty(r.prototype,"orbitalZ",{get:function(){return this._orbitalZ},set:function(t){this._orbitalZ=t}}),Object.defineProperty(r.prototype,"orbitalXMultiplier",{get:function(){return this._orbitalXMultiplier},set:function(t){this._orbitalXMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalYMultiplier",{get:function(){return this._orbitalYMultiplier},set:function(t){this._orbitalYMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalZMultiplier",{get:function(){return this._orbitalZMultiplier},set:function(t){this._orbitalZMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalOffsetX",{get:function(){return this._orbitalOffsetX},set:function(t){this._orbitalOffsetX=t}}),Object.defineProperty(r.prototype,"orbitalOffsetY",{get:function(){return this._orbitalOffsetY},set:function(t){this._orbitalOffsetY=t}}),Object.defineProperty(r.prototype,"orbitalOffsetZ",{get:function(){return this._orbitalOffsetZ},set:function(t){this._orbitalOffsetZ=t}}),Object.defineProperty(r.prototype,"orbitalOffsetXMultiplier",{get:function(){return this._orbitalOffsetXMultiplier},set:function(t){this._orbitalOffsetXMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalOffsetYMultiplier",{get:function(){return this._orbitalOffsetYMultiplier},set:function(t){this._orbitalOffsetYMultiplier=t}}),Object.defineProperty(r.prototype,"orbitalOffsetZMultiplier",{get:function(){return this._orbitalOffsetZMultiplier},set:function(t){this._orbitalOffsetZMultiplier=t}}),Object.defineProperty(r.prototype,"radial",{get:function(){return this._radial},set:function(t){this._radial=t}}),Object.defineProperty(r.prototype,"radialMultiplier",{get:function(){return this._radialMultiplier},set:function(t){this._radialMultiplier=t}}),Object.defineProperty(r.prototype,"speedModifier",{get:function(){return this._speedModifier},set:function(t){this._speedModifier=t}}),Object.defineProperty(r.prototype,"speedModifierMultiplier",{get:function(){return this._speedModifierMultiplier},set:function(t){this._speedModifierMultiplier=t}}),Object.defineProperty(r.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),r.prototype.processInplace=function(r,s){this.x.mode==pc.MinMaxCurveMode.Curve?e=this.getLinearValue(r,s):r.velocityOverLifetimeValue?e.copy(r.velocityOverLifetimeValue):(e=this.getLinearValue(r,s),r.velocityOverLifetimeValue=new pc.Vec3,r.velocityOverLifetimeValue.copy(e));var o=this.radial.evaluate(r.lifePart);o>0&&(t.x=t.y=t.z=0,null!=this.m_ParticleSystem.shape&&this.m_ParticleSystem.shape.enabled&&t.copy(this.m_ParticleSystem.shape.position),i.copy(r.t),i.sub(t).normalize().scale(o)),n.copy(e),n.add(i),this._space==UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(n,n),r.totalSpeed.add(n).scale(this.speedModifierMultiplier)},r.prototype.getLinearValue=function(t,i){return e.x=this.x.evaluate(t.lifePart),e.y=this.y.evaluate(t.lifePart),e.z=this.z.evaluate(t.lifePart),e},pc.ParticleSystemVelocityOverLifetime=r}(),function(){var t=1;function e(t){this.m_ParticleSystem=t,this.enabled=!1,this.separateAxes=!1,this.strengthX=new pc.MinMaxCurve,this.strengthX._random=t._random,this.strengthY=new pc.MinMaxCurve,this.strengthY._random=t._random,this.strengthZ=new pc.MinMaxCurve,this.strengthZ._random=t._random,this.strengthXMultiplier=1,this.strengthYMultiplier=1,this.strengthZMultiplier=1,this.frequency=1,this.damping=!1,this.octaveCount=1,this.octaveMultiplier=1,this.octaveScale=1,this.quality=UnityEngine.ParticleSystemNoiseQuality.Low,this.scrollSpeed=new pc.MinMaxCurve,this.scrollSpeed._random=t._random,this.scrollSpeedMultiplier=1,this.remapEnabled=!1,this.remapX=new pc.MinMaxCurve,this.remapX._random=t._random,this.remapY=new pc.MinMaxCurve,this.remapY._random=t._random,this.remapZ=new pc.MinMaxCurve,this.remapZ._random=t._random,this.remapXMultiplier=1,this.remapYMultiplier=1,this.remapZMultiplier=1,this.positionAmount=new pc.MinMaxCurve,this.positionAmount._random=t._random,this.rotationAmount=new pc.MinMaxCurve,this.rotationAmount._random=t._random,this.sizeAmount=new pc.MinMaxCurve,this.sizeAmount._random=t._random,this.seed=null,this.scrollValue=0}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strengthX},set:function(t){this._strengthX=t}}),Object.defineProperty(e.prototype,"strengthX",{get:function(){return this._strengthX},set:function(t){this._strengthX=t}}),Object.defineProperty(e.prototype,"strengthY",{get:function(){return this._strengthY},set:function(t){this._strengthY=t}}),Object.defineProperty(e.prototype,"strengthZ",{get:function(){return this._strengthZ},set:function(t){this._strengthZ=t}}),Object.defineProperty(e.prototype,"strengthMultiplier",{get:function(){return this._strengthXMultiplier},set:function(t){this._strengthXMultiplier=t}}),Object.defineProperty(e.prototype,"strengthXMultiplier",{get:function(){return this._strengthXMultiplier},set:function(t){this._strengthXMultiplier=t}}),Object.defineProperty(e.prototype,"strengthYMultiplier",{get:function(){return this._strengthYMultiplier},set:function(t){this._strengthYMultiplier=t}}),Object.defineProperty(e.prototype,"strengthZMultiplier",{get:function(){return this._strengthZMultiplier},set:function(t){this._strengthZMultiplier=t}}),Object.defineProperty(e.prototype,"frequency",{get:function(){return this._frequency},set:function(t){this._frequency=t}}),Object.defineProperty(e.prototype,"damping",{get:function(){return this._damping},set:function(t){this._damping=t}}),Object.defineProperty(e.prototype,"octaveCount",{get:function(){return this._octaveCount},set:function(t){this._octaveCount=t}}),Object.defineProperty(e.prototype,"octaveMultiplier",{get:function(){return this._octaveMultiplier},set:function(t){this._octaveMultiplier=t}}),Object.defineProperty(e.prototype,"octaveScale",{get:function(){return this._octaveScale},set:function(t){this._octaveScale=t}}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t}}),Object.defineProperty(e.prototype,"scrollSpeed",{get:function(){return this._scrollSpeed},set:function(t){this._scrollSpeed=t}}),Object.defineProperty(e.prototype,"scrollSpeedMultiplier",{get:function(){return this._scrollSpeedMultiplier},set:function(t){this._scrollSpeedMultiplier=t}}),Object.defineProperty(e.prototype,"remapEnabled",{get:function(){return this._remapEnabled},set:function(t){this._remapEnabled=t}}),Object.defineProperty(e.prototype,"remap",{get:function(){return this._remapX},set:function(t){this._remapX=t}}),Object.defineProperty(e.prototype,"remapX",{get:function(){return this._remapX},set:function(t){this._remapX=t}}),Object.defineProperty(e.prototype,"remapY",{get:function(){return this._remapY},set:function(t){this._remapY=t}}),Object.defineProperty(e.prototype,"remapZ",{get:function(){return this._remapZ},set:function(t){this._remapZ=t}}),Object.defineProperty(e.prototype,"remapMultiplier",{get:function(){return this._remapXMultiplier},set:function(t){this._remapXMultiplier=t}}),Object.defineProperty(e.prototype,"remapXMultiplier",{get:function(){return this._remapXMultiplier},set:function(t){this._remapXMultiplier=t}}),Object.defineProperty(e.prototype,"remapYMultiplier",{get:function(){return this._remapYMultiplier},set:function(t){this._remapYMultiplier=t}}),Object.defineProperty(e.prototype,"remapZMultiplier",{get:function(){return this._remapZMultiplier},set:function(t){this._remapZMultiplier=t}}),Object.defineProperty(e.prototype,"positionAmount",{get:function(){return this._positionAmount},set:function(t){this._positionAmount=t}}),Object.defineProperty(e.prototype,"rotationAmount",{get:function(){return this._rotationAmount},set:function(t){this._rotationAmount=t}}),Object.defineProperty(e.prototype,"sizeAmount",{get:function(){return this._sizeAmount},set:function(t){this._sizeAmount=t}}),e.prototype.processInplace=function(e,i){var n=this.m_ParticleSystem._random;null===this.seed&&(this.seed=255*n.nextFloat()),this.scrollValue+=i*this.scrollSpeed.evaluate(this.m_ParticleSystem.lifePart);var r=this.seed+this.m_ParticleSystem._playTime;r=r*this.frequency+e._cacheIndex;var s=pc.noise.perlin2(r+0,this.scrollValue/255),o=pc.noise.perlin2(r+.33,this.scrollValue/255),a=pc.noise.perlin2(r+.66,this.scrollValue/255),u=new pc.Vec3(0,0,0);t=this.positionAmount.evaluate(e.lifePart);if(this.separateAxes)u.x=s*this.strengthXMultiplier*this.strengthX.evaluate(e.lifePart)*t*1,u.y=o*this.strengthYMultiplier*this.strengthY.evaluate(e.lifePart)*t*1,u.z=a*this.strengthZMultiplier*this.strengthZ.evaluate(e.lifePart)*t*1;else{var c=this.strength.evaluate(e.lifePart);u.x=s*c*t*1,u.y=o*c*t*1,u.z=a*c*t*1}this.damping&&u.scale(1/this.frequency),e.totalSpeed.add(u);var h=this.damping?s*this.sizeAmount.evaluate(e.lifePart)/this.frequency:s*this.sizeAmount.evaluate(e.lifePart);e.tmpScale.scale(1+.5*h)},pc.ParticleSystemNoise=e}(),function(){var t=new pc.Color;function e(t){this.m_ParticleSystem=t,this.enabled=!1,this.color=new pc.MinMaxGradient,this.color._random=t._random}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t}}),e.prototype.processInplace=function(e,i){this.color.mode==pc.MinMaxGradientMode.Gradient?this.color.evaluateInplace(e.lifePart,t,e.colorGradientState):e.colorOverLifetimeValue?t.copy(e.colorOverLifetimeValue):(this.color.evaluateInplace(e.lifePart,t,e.colorGradientState),e.colorOverLifetimeValue=new pc.Color,e.colorOverLifetimeValue.copy(t)),e.color.mul(t)},pc.ParticleSystemColorOverLifetime=e}(),function(){var t=0,e=0,i=new pc.Color;function n(t){this.m_ParticleSystem=t,this.enabled=!1,this.color=new pc.MinMaxGradient,this.color._random=t._random}Object.defineProperty(n.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t}}),Object.defineProperty(n.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),n.prototype.processInplace=function(n,r){if(this.color.mode==pc.MinMaxGradientMode.Gradient){if(this.range.x>this.range.y){var s=this.range.x;this.range.x=this.range.y,this.range.y=s}t=n.totalSpeed.length(),e=0,e=t>this.range.y?1:t<this.range.x?0:(t-this.range.x)/(this.range.y-this.range.x),this.color.evaluateInplace(e,i)}else n.colorBySpeedValue?i.copy(n.colorBySpeedValue):(this.color.evaluateInplace(e,i),n.colorBySpeedValue=new pc.Color,n.colorBySpeedValue.copy(i));n.color.mul(i)},pc.ParticleSystemColorBySpeed=n}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.size=new pc.MinMaxCurve,this.size._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.sizeMultiplier=1,this.separateAxes=!1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t}}),Object.defineProperty(t.prototype,"sizeMultiplier",{get:function(){return this._sizeMultiplier},set:function(t){this._sizeMultiplier=t}}),Object.defineProperty(t.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(t.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(t.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(t.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}});var e=new pc.Vec3;t.prototype.processInplace=function(t,i){this.x.mode==pc.MinMaxCurveMode.Curve?e=this.getValue(t,i):t.sizeOverLifetimeValue?e.copy(t.sizeOverLifetimeValue):(e=this.getValue(t,i),t.sizeOverLifetimeValue=new pc.Vec3,t.sizeOverLifetimeValue.copy(e)),t.tmpScale.mul(e)},t.prototype.getValue=function(t,i){if(e.copy(pc.Vec3.ONE),this.separateAxes)e.x*=this.x.evaluate(t.lifePart),e.y*=this.y.evaluate(t.lifePart),e.z*=this.z.evaluate(t.lifePart);else{var n=this.size.evaluate(t.lifePart);e.scale(n)}return e},pc.ParticleSystemSizeOverLifetime=t}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this._x=new pc.MinMaxCurve,this._x._random=t._random,this._y=new pc.MinMaxCurve,this._y._random=t._random,this._z=new pc.MinMaxCurve,this._z._random=t._random,this._size=new pc.MinMaxCurve,this._size._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t}}),Object.defineProperty(t.prototype,"sizeMultiplier",{get:function(){return this._sizeMultiplier},set:function(t){this._sizeMultiplier=t}}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(t.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(t.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(t.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(t.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),t.prototype.processInplace=function(t,e){if(this.range.x>this.range.y){var i=this.range.x;this.range.x=this.range.y,this.range.y=i}var n=0,r=t.totalSpeed.length();if(n=r>this.range.y?1:r<this.range.x?0:(r-this.range.x)/(this.range.y-this.range.x),this.separateAxes)t.tmpScale.x*=this.x.evaluate(n),t.tmpScale.y*=this.y.evaluate(n),t.tmpScale.z*=this.z.evaluate(n);else{var s=this.size.evaluate(n);t.tmpScale.x*=s,t.tmpScale.y*=s,t.tmpScale.z*=s}},pc.ParticleSystemSizeBySpeed=t}(),function(){var t=new pc.Vec3,e=new pc.Quat;function i(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(i.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(i.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(i.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(i.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),i.prototype.processInplace=function(e,i){this.x.mode==pc.MinMaxCurveMode.Curve?t=this.getValue(e):e.rotationOverLifetimeValue?t.copy(e.rotationOverLifetimeValue):(t=this.getValue(e),e.rotationOverLifetimeValue=new pc.Vec3,e.rotationOverLifetimeValue.copy(t)),e.angularVelocity.add(t)},i.prototype.getValue=function(i){return this.separateAxes?t.set(this.x.evaluate(i.lifePart)*pc.math.RAD_TO_DEG,this.y.evaluate(i.lifePart)*pc.math.RAD_TO_DEG,this.z.evaluate(i.lifePart)*pc.math.RAD_TO_DEG):(e.setFromAxisAngle(i.startRotationAxis,this.z.evaluate(i.lifePart)*pc.math.RAD_TO_DEG),e.getEulerAngles(t)),t},pc.ParticleSystemRotationOverLifetime=i}(),function(){var t,e,i,n=new pc.Quat,r=new pc.Vec3;function s(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(s.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(s.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(s.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(s.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(s.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(s.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(s.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(s.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(s.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),s.prototype._getRotationAmount=function(t,e){if(e.mode===pc.MinMaxCurveMode.Constant||e.mode===pc.MinMaxCurveMode.TwoConstants)return e.evaluate(0);var i=t.ownSpeed.length(),n=0;return i>this.range.y?n=1:i<this.range.x?n=0:i>=this.range.x&&i<=this.range.y&&(n=(i-this.range.x)/(this.range.y-this.range.x)),e.evaluate(n)*pc.math.DEG_TO_RAD},s.prototype.processInplace=function(s,o){t=e=0,i=this._getRotationAmount(s,this.z),this._separateAxes?(t=this._getRotationAmount(s,this.x),e=this._getRotationAmount(s,this.y),n.setFromEulerAngles(t,e,i)):n.setFromAxisAngle(s.startRotationAxis,i),n.getEulerAngles(r),s.angularVelocity.add(r)},pc.ParticleSystemRotationBySpeed=s}(),function(){function t(t,e,i){this._shapeModule=t,this._hemisphereMode=e,this._circleMode=i}t.prototype.applyTransformations=function(t,e){var i=this._shapeModule.m_ParticleSystem._random,n=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD,r=180*i.nextFloat()*pc.math.DEG_TO_RAD;t.x=Math.sin(r)*Math.cos(n),t.y=Math.sin(r)*Math.sin(n),t.z=Math.cos(r),this._hemisphereMode&&(t.z=Math.abs(t.z)),this._circleMode&&(t.z=0),t.normalize(),e.copy(t);var s=this._shapeModule.getPointInRadius(this._shapeModule.radius);t.scale(s)},pc.SphereShape=t}(),function(){function t(t){this._shapeModule=t}var e=new Array(3);t.prototype.applyTransformations=function(t,i){var n=this._shapeModule.m_ParticleSystem._random;switch(this._shapeModule.shapeType){case UnityEngine.ParticleSystemShapeType.Box:t.x=n.nextFloat()-.5,t.y=n.nextFloat()-.5,t.z=n.nextFloat()-.5;break;case UnityEngine.ParticleSystemShapeType.BoxShell:e[0]=n.nextFloat()-.5,e[1]=n.nextFloat()-.5,e[2]=n.nextFloat()-.5;var r=n.nextInteger()%3;e[r]=Math.round(n.nextFloat())-.5,t.x=e[0],t.y=e[1],t.z=e[2];break;case UnityEngine.ParticleSystemShapeType.Rectangle:t.x=n.nextFloat()-.5,t.y=n.nextFloat()-.5,t.z=0;break;case UnityEngine.ParticleSystemShapeType.BoxEdge:e[0]=n.nextFloat()-.5,e[1]=n.nextFloat()-.5,e[2]=n.nextFloat()-.5;for(var s=Math.floor(3*n.nextFloat()),o=0;o<3;o++)o!=s&&(e[o]=Math.round(n.nextFloat())-.5);t.x=e[0],t.y=e[1],t.z=e[2];break;case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:var a=this._shapeModule.circularSpawner.getNextPosition()-.5;return t.x=a*this._shapeModule.radius,t.y=0,t.z=0,void i.copy(pc.Vec3.UP)}i.copy(pc.Vec3.BACK)},pc.BoxShape=t}(),function(){function t(t){this._shapeModule=t,this._curValue=0,this._prevTime=0}Object.defineProperty(t.prototype,"radius",{get:function(){return this._shapeModule._radius}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._shapeModule._arcMode}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._shapeModule._arcSpread}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._shapeModule._arcSpeed}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._shapeModule._arcSpeedMultiplier}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._shapeModule._radiusMode}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._shapeModule._radiusSpread}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._shapeModule._radiusSpeed}}),t.prototype.roundToSpread=function(t,e){return 0==e?t%1:Math.floor(t/e)*e%1},t.prototype.pingPong=function(t,e){var i=Math.floor(t/e),n=t-e*i;return i%2==0?n:1-n},t.prototype.getNextPosition=function(){var t=this._shapeModule.m_ParticleSystem._random,e=1/this._shapeModule.m_ParticleSystem.emission.rateOverTime.evaluate(this._shapeModule.m_ParticleSystem.lifePart),i=this._shapeModule.m_ParticleSystem.lifetime;this._prevTime>i&&(i+=this._shapeModule.m_ParticleSystem.main.duration);var n=i-this._prevTime,r=0;n>e&&(r=n-e,n=e),this._prevTime=this._shapeModule.m_ParticleSystem.lifetime-r;var s=this._shapeModule._shapeType==UnityEngine.ParticleSystemShapeType.SingleSidedEdge,o=0,a=this._shapeModule.m_ParticleSystem.lifePart,u=s?this.radiusMode:this.arcMode,c=s?1:this.arcSpeed.evaluate(a)*(360/this._shapeModule.arc),h=s?this.radiusSpread:this.arcSpread;switch(u){case UnityEngine.ParticleSystemShapeMultiModeValue.Loop:this._curValue+=n*c,o=this.roundToSpread(this._curValue,h);break;case UnityEngine.ParticleSystemShapeMultiModeValue.PingPong:this._curValue+=n*c,o=this.pingPong(this._curValue,1),o=this.roundToSpread(o,h);break;case UnityEngine.ParticleSystemShapeMultiModeValue.BurstSpread:case UnityEngine.ParticleSystemShapeMultiModeValue.Random:default:o=t.nextFloat(),o=this.roundToSpread(o,h)}return o},t.prototype.reset=function(){this._curValue=0,this._prevTime=0},pc.CircularSpawner=t}(),function(){function t(t,e){this._shapeModule=t,this._useVolume=e||!1}t.prototype.applyTransformations=function(t,e){var i=this._shapeModule.m_ParticleSystem._random,n=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD;t.x=Math.cos(n),t.y=Math.sin(n),t.z=0;var r=1-this._shapeModule.radiusThickness,s=r+(1-r)*i.nextFloat(),o=s*this._shapeModule.radius,a=this._shapeModule.angle*s*pc.math.DEG_TO_RAD;if(0==a?(e.x=0,e.y=0,e.z=1):(e.x=t.x,e.y=t.y,e.z=Math.sqrt(t.x*t.x+t.y*t.y)/Math.tan(a),e.normalize()),t.scale(o),this._useVolume){var u=this._shapeModule.length*i.nextFloat();t.add(e.clone().scale(u))}},pc.ConeShape=t}(),function(){var t=new pc.Vec3,e=new pc.Vec3;function i(t){this._shapeModule=t}i.prototype.applyTransformations=function(i,n){var r=this._shapeModule.m_ParticleSystem._random,s=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD,o=360*r.nextFloat()*pc.math.DEG_TO_RAD,a=this._shapeModule.radius,u=this._shapeModule.getPointInRadius(this._shapeModule.donutRadius);t.x=a*Math.cos(s),t.y=a*Math.sin(s),t.z=0,e.x=(a+u*Math.cos(o))*Math.cos(s),e.y=(a+u*Math.cos(o))*Math.sin(s),e.z=u*Math.sin(o),n.copy(e).sub(t),i.copy(e)},pc.DonutShape=i}(),function(){function t(t){this.m_ParticleSystem=t,this._TRS=pc.Mat4.IDENTITY,this._TR=pc.Mat4.IDENTITY,this.enabled=!1,this.radiusSpeed=new pc.MinMaxCurve,this.radiusSpeed._random=t._random,this.radiusSpeedMultiplier=1,this.arcSpeed=new pc.MinMaxCurve,this.arcSpeed._random=t._random,this.arcSpeedMultiplier=1,this.circularSpawner=new pc.CircularSpawner(this)}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return this._shapeType},set:function(t){switch(this._shapeType=t,t){case UnityEngine.ParticleSystemShapeType.Cone:this.impl=new pc.ConeShape(this,!1);break;case UnityEngine.ParticleSystemShapeType.ConeVolume:this.impl=new pc.ConeShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Sphere:this.impl=new pc.SphereShape(this);break;case UnityEngine.ParticleSystemShapeType.Hemisphere:this.impl=new pc.SphereShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Circle:this.impl=new pc.SphereShape(this,!1,!0);break;case UnityEngine.ParticleSystemShapeType.Donut:this.impl=new pc.DonutShape(this);break;case UnityEngine.ParticleSystemShapeType.Box:case UnityEngine.ParticleSystemShapeType.BoxShell:case UnityEngine.ParticleSystemShapeType.BoxEdge:case UnityEngine.ParticleSystemShapeType.Rectangle:case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:default:this.impl=new pc.BoxShape(this)}}}),Object.defineProperty(t.prototype,"randomDirectionAmount",{get:function(){return this._randomDirectionAmount},set:function(t){this._randomDirectionAmount=t}}),Object.defineProperty(t.prototype,"sphericalDirectionAmount",{get:function(){return this._sphericalDirectionAmount},set:function(t){this._sphericalDirectionAmount=t}}),Object.defineProperty(t.prototype,"randomPositionAmount",{get:function(){return this._randomPositionAmount},set:function(t){this._randomPositionAmount=t}}),Object.defineProperty(t.prototype,"alignToDirection",{get:function(){return this._alignToDirection},set:function(t){this._alignToDirection=t}}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._radiusMode},set:function(t){this._radiusMode=t}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._radiusSpread},set:function(t){this._radiusSpread=t}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._radiusSpeed},set:function(t){this._radiusSpeed=t}}),Object.defineProperty(t.prototype,"radiusSpeedMultiplier",{get:function(){return this._radiusSpeedMultiplier},set:function(t){this._radiusSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"radiusThickness",{get:function(){return this._radiusThickness},set:function(t){this._radiusThickness=t}}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t}}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._length=t}}),Object.defineProperty(t.prototype,"boxThickness",{get:function(){return this._boxThickness},set:function(t){this._boxThickness=t}}),Object.defineProperty(t.prototype,"arc",{get:function(){return this._arc},set:function(t){this._arc=t}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._arcMode},set:function(t){this._arcMode=t}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._arcSpread},set:function(t){this._arcSpread=t}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._arcSpeed},set:function(t){this._arcSpeed=t}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._arcSpeedMultiplier},set:function(t){this._arcSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"donutRadius",{get:function(){return this._donutRadius},set:function(t){this._donutRadius=t}}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._position=t}}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._rotation=t}}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.trsDirty=!0,this._scale=t}}),Object.defineProperty(t.prototype,"TRS",{get:function(){if(this.trsDirty){var t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TRS=(new pc.Mat4).setTRS(this.position,t,this.scale),this.trsDirty=!1}return this._TRS}}),Object.defineProperty(t.prototype,"TR",{get:function(){if(this.trDirty){var t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TR=(new pc.Mat4).setTRS(this.position,t,new pc.Vec3(1,1,1)),this.trDirty=!1}return this._TR}}),Object.defineProperty(t.prototype,"trsDirty",{get:function(){return this._trsDirty},set:function(t){this._trsDirty=t}}),Object.defineProperty(t.prototype,"trDirty",{get:function(){return this._trDirty},set:function(t){this._trDirty=t}}),Object.defineProperty(t.prototype,"impl",{get:function(){return this._impl},set:function(t){this._impl=t}});var e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,r=new pc.Quat,s=new pc.Vec3,o=new pc.Vec3;t.prototype.applyNextTransform=function(t,a,u){this.impl.applyTransformations(e,i),this.randomizePosition(e),this._shapeType==UnityEngine.ParticleSystemShapeType.Cone?(this.impl.applyTransformations(s,o,0),this.randomizeDirection(i,o)):this.randomizeDirection(i),this.TRS.transformPoint(e,t),this.TRS.transformVector(i,u),u.normalize(),0==u.x&&0==u.y&&0==u.z&&(u.z=1);var c=Math.sign(this.m_ParticleSystem.main.startSpeed.evaluate(this.m_ParticleSystem.lifePart));this.spherizeDirection(t,u,this.position),u.scale(c),n.copy(this.rotationBetweenVectors(pc.Vec3.FORWARD,u)),r.copy(this.rotationBetweenVectors(pc.Vec3.UP,u)),this.m_ParticleSystem._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?a.copy(r):this.alignToDirection?(a.setFromMat4(this.TR),a.mul(n)):a.copy(pc.Quat.IDENTITY)};var a=new pc.Vec3;t.prototype.randomizePosition=function(t){var e=this.m_ParticleSystem._random;this.randomPositionAmount>0&&(a.x=e.nextFloat()-.5,a.y=e.nextFloat()-.5,a.z=e.nextFloat()-.5,a.scale(this.randomPositionAmount),t.add(a))};var u=new pc.Vec3;t.prototype.randomizeDirection=function(t,e){var i=this.m_ParticleSystem._random;this.randomDirectionAmount>0&&(e?u.copy(e):(u.x=i.nextFloat()-.5,u.y=i.nextFloat()-.5,u.z=i.nextFloat()-.5),u.normalize(),t.lerp(t,u,this.randomDirectionAmount)),t.normalize()};var c=new pc.Vec3;t.prototype.spherizeDirection=function(t,e,i){this.sphericalDirectionAmount>0&&(c.copy(t).sub(i).normalize(),e.lerp(e,c,this.sphericalDirectionAmount)),e.normalize()};var h=new pc.Quat,l=new pc.Vec3;t.prototype.rotationBetweenVectors=function(t,e){return l.cross(t,e),h.x=l.x,h.y=l.y,h.z=l.z,h.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),h.normalize()},t.prototype.getPointInRadius=function(t){var e=this.m_ParticleSystem._random,i=1-this.radiusThickness;return(i+(1-i)*e.nextFloat())*t},pc.ParticleSystemShape=t}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this.frameOverTime=new pc.MinMaxCurve,this.frameOverTime._random=t._random,this.frameOverTimeMultiplier=1,this.startFrame=new pc.MinMaxCurve,this.startFrame._random=t._random,this.startFrameMultiplier=1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},set:function(t){this._animation=t}}),Object.defineProperty(t.prototype,"cycleCount",{get:function(){return this._cycleCount},set:function(t){this._cycleCount=t}}),Object.defineProperty(t.prototype,"flipU",{get:function(){return this._flipU},set:function(t){this._flipU=t}}),Object.defineProperty(t.prototype,"flipV",{get:function(){return this._flipV},set:function(t){this._flipV=t}}),Object.defineProperty(t.prototype,"frameOverTime",{get:function(){return this._frameOverTime},set:function(t){this._frameOverTime=t}}),Object.defineProperty(t.prototype,"frameOverTimeMultiplier",{get:function(){return this._frameOverTimeMultiplier},set:function(t){this._frameOverTimeMultiplier=t}}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(t.prototype,"numTilesX",{get:function(){return this._numTilesX},set:function(t){this._numTilesX=t}}),Object.defineProperty(t.prototype,"numTilesY",{get:function(){return this._numTilesY},set:function(t){this._numTilesY=t}}),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this._rowIndex},set:function(t){this._rowIndex=t}}),Object.defineProperty(t.prototype,"spriteCount",{get:function(){return this._spriteCount}}),Object.defineProperty(t.prototype,"startFrame",{get:function(){return this._startFrame},set:function(t){this._startFrame=t}}),Object.defineProperty(t.prototype,"startFrameMultiplier",{get:function(){return this._startFrameMultiplier},set:function(t){this._startFrameMultiplier=t}}),Object.defineProperty(t.prototype,"useRandomRow",{get:function(){return this._useRandomRow},set:function(t){this._useRandomRow=t}}),t.prototype._processGridMode=function(t,e){var i=this.m_ParticleSystem._random,n=this.animation==UnityEngine.ParticleSystemAnimationType.WholeSheet?this._numTilesX*this._numTilesY:this._numTilesX;null===t.startFrame&&(t.startFrame=Math.floor(this.startFrame.evaluate(this.m_ParticleSystem.lifePart)*n));var r=Math.floor(this.frameOverTime.evaluate(t.lifePart)*n*this.cycleCount)+t.startFrame;this.animation==UnityEngine.ParticleSystemAnimationType.SingleRow?(t.texSheetAnimationInitialized||(t.texSheetRow=this.useRandomRow?i.nextInteger()%this.numTilesY:this.rowIndex,t.texSheetAnimationInitialized=!0),t.texSheetColumn=r%this.numTilesX):this.animation==UnityEngine.ParticleSystemAnimationType.WholeSheet&&(r%=this.numTilesX*this.numTilesY,t.texSheetRow=Math.floor(r/this.numTilesX),t.texSheetColumn=r%this.numTilesX)},t.prototype.processInplace=function(t,e){this.mode==UnityEngine.ParticleSystemAnimationMode.Grid?this._processGridMode(t,e):(this.mode,UnityEngine.ParticleSystemAnimationMode.Sprites)},pc.ParticleSystemTextureSheetAnimation=t}(),function(){var t=new pc.Vec3;function e(t){this.particleSystem=t,this.enabled=!1,this._curve=new pc.MinMaxCurve,this._curve._random=t._random,this._curveMultiplier=1}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t}}),Object.defineProperty(e.prototype,"curve",{get:function(){return this._curve},set:function(t){this._curve=t}}),Object.defineProperty(e.prototype,"curveMultiplier",{get:function(){return this._curveMultiplier},set:function(t){this._curveMultiplier=t}}),e.prototype.processInplace=function(e,i){if(this.particleSystem.main.simulationSpace==UnityEngine.ParticleSystemSimulationSpace.World){switch(t.copy(pc.Vec3.ONE),this._mode){case UnityEngine.ParticleSystemInheritVelocityMode.Initial:e.inheritVelocityValue||(e.inheritVelocityValue=new pc.Vec3,e.inheritVelocityValue.copy(this.particleSystem.currentVelocity)),t.copy(e.inheritVelocityValue);break;case UnityEngine.ParticleSystemInheritVelocityMode.Current:t.copy(this.particleSystem.currentVelocity)}t.scale(this._curve.evaluate(this.particleSystem.lifePart)),e.totalSpeed.add(t)}},pc.ParticleSystemInheritVelocity=e}(),function(){var t=new pc.Vec3;function e(t){this.m_ParticleSystem=t,this._enabled=!1,this._x=new pc.MinMaxCurve,this._x._random=t._random,this._y=new pc.MinMaxCurve,this._y._random=t._random,this._z=new pc.MinMaxCurve,this._z._random=t._random,this._xMultiplier=0,this._yMultiplier=0,this._zMultiplier=0,this._space=0,this._randomized=!1}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(e.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(e.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(e.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(e.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),Object.defineProperty(e.prototype,"randomized",{get:function(){return this._randomized},set:function(t){this._randomized=t}}),e.prototype.processInplace=function(e,i){this._x.mode===pc.MinMaxCurveMode.Curve||this._randomized?t=this.getForceValue(e):e.forceOverLifetimeValue?t.copy(e.forceOverLifetimeValue):(t=this.getForceValue(e,i),e.forceOverLifetimeValue=new pc.Vec3,e.forceOverLifetimeValue.copy(t)),this._space===UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(t,t),t.scale(i),e.ownSpeed.add(t),e.totalSpeed.add(t)},e.prototype.getForceValue=function(e){return t.x=this._x.evaluate(e.lifePart),t.y=this._y.evaluate(e.lifePart),t.z=this._z.evaluate(e.lifePart),t},pc.ParticleSystemForceOverLifetime=e}(),function(){var t=0,e=new pc.Vec3;function i(t){this.m_ParticleSystem=t,this._enabled=!0,this._limit=new pc.MinMaxCurve,this._limit._random=t._random,this._limitMultiplier=1,this._separateAxes=!1,this._limitX=new pc.MinMaxCurve,this._limitX._random=t._random,this._limitY=new pc.MinMaxCurve,this._limitY._random=t._random,this._limitZ=new pc.MinMaxCurve,this._limitZ._random=t._random,this._limitXMultiplier=1,this._limitYMultiplier=1,this._limitZMultiplier=1,this._space=0,this._dampen=0,this._drag=new pc.MinMaxCurve,this._drag._random=t._random,this._dragMultiplier=1,this._multiplyDragByParticleSize=!1,this._multiplyDragByParticleVelocity=!1}Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(i.prototype,"limit",{get:function(){return this._limit},set:function(t){this._limit=t}}),Object.defineProperty(i.prototype,"limitMultiplier",{get:function(){return this._limitMultiplier},set:function(t){this._limitMultiplier=t}}),Object.defineProperty(i.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(i.prototype,"limitX",{get:function(){return this._limitX},set:function(t){this._limitX=t}}),Object.defineProperty(i.prototype,"limitY",{get:function(){return this._limitY},set:function(t){this._limitY=t}}),Object.defineProperty(i.prototype,"limitZ",{get:function(){return this._limitZ},set:function(t){this.limitY=t}}),Object.defineProperty(i.prototype,"limitXMultiplier",{get:function(){return this._limitXMultiplier},set:function(t){this._limitXMultiplier=t}}),Object.defineProperty(i.prototype,"limitYMultiplier",{get:function(){return this._limitYMultiplier},set:function(t){this._limitYMultiplier=t}}),Object.defineProperty(i.prototype,"limitZMultiplier",{get:function(){return this._limitZMultiplier},set:function(t){this._limitZMultiplier=t}}),Object.defineProperty(i.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),Object.defineProperty(i.prototype,"dampen",{get:function(){return this._dampen},set:function(t){this._dampen=t}}),Object.defineProperty(i.prototype,"drag",{get:function(){return this._drag},set:function(t){this._drag=t}}),Object.defineProperty(i.prototype,"dragMultiplier",{get:function(){return this._dragMultiplier},set:function(t){this._dragMultiplier=t}}),Object.defineProperty(i.prototype,"multiplyDragByParticleSize",{get:function(){return this._multiplyDragByParticleSize},set:function(t){this._multiplyDragByParticleSize=t}}),Object.defineProperty(i.prototype,"multiplyDragByParticleVelocity",{get:function(){return this._multiplyDragByParticleVelocity},set:function(t){this._multiplyDragByParticleVelocity=t}}),i.prototype.applyDamp=function(t,e,i){var n=Math.abs(t),r=n-e;return Math.sign(t)*Math.min(r*this._dampen*i*(r/n)*30.61,n)},i.prototype.applyDragInplace=function(t,e,i){var n=1,r=1;this._multiplyDragByParticleSize&&this.multiplyDragByParticleVelocity?(r=t.totalSpeed.length(),n=this.getScaleModifier(t),t.ownSpeed.scale(1-e*n*r*i)):this._multiplyDragByParticleSize?(n=this.getScaleModifier(t),t.ownSpeed.x=Math.sign(t.ownSpeed.x)*Math.max(Math.abs(t.ownSpeed.x)-e*n*i,0),t.ownSpeed.y=Math.sign(t.ownSpeed.y)*Math.max(Math.abs(t.ownSpeed.y)-e*n*i,0),t.ownSpeed.z=Math.sign(t.ownSpeed.z)*Math.max(Math.abs(t.ownSpeed.z)-e*n*i,0)):this._multiplyDragByParticleVelocity?(r=t.totalSpeed.length(),t.ownSpeed.scale(1-e*r*i)):(t.ownSpeed.x=Math.sign(t.ownSpeed.x)*Math.max(Math.abs(t.ownSpeed.x)-e*i,0),t.ownSpeed.y=Math.sign(t.ownSpeed.y)*Math.max(Math.abs(t.ownSpeed.y)-e*i,0),t.ownSpeed.z=Math.sign(t.ownSpeed.z)*Math.max(Math.abs(t.ownSpeed.z)-e*i,0))},i.prototype.getScaleModifier=function(t){var e=Math.max(t.tmpScale.x,t.tmpScale.y,t.tmpScale.z);return Math.PI*e*e/4},i.prototype.processInplace=function(i,n){if(this.applyDragInplace(i,this.drag.evaluate(i.lifePart),n),e.x=this._separateAxes)e.x=this._limitX.evaluate(i.lifePart),e.y=this._limitY.evaluate(i.lifePart),e.z=this._limitZ.evaluate(i.lifePart);else{var r=this._limit.evaluate(i.lifePart);e.x=r,e.y=r,e.z=r}this._space==UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(e,e),Math.abs(i.totalSpeed.x)>e.x&&(t=-this.applyDamp(i.totalSpeed.x,e.x,n),i.ownSpeed.x+=t,i.totalSpeed.x+=t),Math.abs(i.totalSpeed.y)>e.y&&(t=-this.applyDamp(i.totalSpeed.y,e.y,n),i.ownSpeed.y+=t,i.totalSpeed.y+=t),Math.abs(i.totalSpeed.z)>e.z&&(t=-this.applyDamp(i.totalSpeed.z,e.z,n),i.ownSpeed.z+=t,i.totalSpeed.z+=t)},pc.ParticleSystemLimitVelocityOverLifetime=i}(),Object.assign(pc,function(){var t=function(t,e){const i=t.internalExecutionOrder-e.internalExecutionOrder;return 0!==i?i:t._scriptsExecutionOrder-e._scriptsExecutionOrder},e=function(){this._components=[],this._needsSort=!1};return Object.defineProperty(e.prototype,"length",{get:function(){return this._components.length}}),e.prototype.push=function(t){t._scriptsExecutionOrder=4294967296*(t.scriptsExecutionOrder+32768)+(t.sortingOrderInQueue+2147483648),0!==this._components.length&&t._scriptsExecutionOrder<this._components[this._components.length-1]._scriptsExecutionOrder&&(this._needsSort=!0),this._components.push(t)},e.prototype.getComponents=function(){return this._needsSort&&(this._needsSort=!1,this._components.sort(t)),this._components.slice()},e.prototype.delete=function(t){for(var e=0;e<this._components.length;e++)if(t===this._components[e]._id)return void this._components.splice(e,1)},e.prototype.clear=function(){this._components.length=0},{ComponentQueue:e}}()),Object.assign(pc,function(){var t=function(t,e){this.object=t,this.time=e,this.updatedAt=UnityEngine.Time.time,this.instant=!e||e<=0,this.secondPassProcess=!1,this.enabled=!0,this.instant&&this.prepare()};(t.prototype=Object.create(Object.prototype)).constructor=t,Object.assign(t.prototype,{prepare:function(){this.isValid&&(this.object.enabled=!1)},update:function(){if(!this.isValid||this.instant||this.time<=0)return;const t=UnityEngine.Time.time,e=t-this.updatedAt;this.updatedAt=t,this.time=this.time-e,this.time<=0&&(this.prepare(),this.secondPassProcess=!0)},execute:function(){this.isValid&&(this.object.onDestroy&&this.object.onDestroy(),this.object.destroy(),this.object=null)}}),Object.defineProperty(t.prototype,"isValid",{get:function(){return null!==this.object&&!this.object._destroyed}}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this.enabled&&(this.instant||this.time<=0)||!this.isValid}});var e=function(e,i){t.prototype.constructor.call(this,e,i)};(e.prototype=Object.create(t.prototype)).constructor=e,Object.assign(e.prototype,{prepare:function(){if(!this.isValid)return;let t=this.object.collectAllUnityComponents();for(let e=0;e<t.length;e++){t[e].enabled=!1}},execute:function(){if(!this.isValid)return;this.object._beingDestroyed=!0,this.object.enabled=!1;let t=this.object.collectAllUnityComponents();for(let e=0;e<t.length;e++){let i=t[e];i.onDestroy&&i.onDestroy()}this.object.destroy(),this.object=null}}),Object.defineProperty(e.prototype,"isValid",{get:function(){return null!==this.object&&!this.object._destroyed&&!this.object._beingDestroyed}});var i=function(e,i){t.prototype.constructor.call(this,e,i)};return(i.prototype=Object.create(t.prototype)).constructor=i,Object.assign(i.prototype,{prepare:function(){this.isValid},execute:function(){this.isValid&&(this.object.CallOnDisable(),this.object.CallOnDestroy(),this.object._destroyed=!0)}}),Object.defineProperty(i.prototype,"isValid",{get:function(){return!this.object._destroyed}}),{DestroyTask:t,DestroyEntityTask:e,DestroyScriptableObjectTask:i}}()),Object.assign(pc,function(){var t=function(t){pc.ComponentSystem.call(this,t),this.id="unitymanager",this.description="Supports Unity-like components.",this.callbacksDisabled=!1,this.fixedTimeStep=.02,this.maximumAllowedTimeStep=.1,this.timeScale=1,this.maximumParticleTimestep=.15,this._fixedAccumulator=0,this.schema=[],this.app.on("update",this.onUpdate,this),this.app.on("frameend",this.onFrameEnd,this),this.app.on("focus",this.onApplicationFocus,this),this.app.on("blur",this.onApplicationBlur,this),this.systems=[],this.destroyQueue=new Array(64),this.destroyQueueTmp=new Array(64),this.destroyQueueLength=0,this.destroyQueueProcessing=!1};return(t.prototype=Object.create(pc.ComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{registerSystem:function(t){this.systems.push(t)},onUpdate:function(t){if(this._invokeQueueOnSystems("onStart"),this._invokeQueueOnSystems("onBeforeUpdates",t),Math.abs(UnityEngine.Time.timeScale)>Number.EPSILON)for(this._fixedAccumulator=Math.min(this.maximumAllowedTimeStep,this._fixedAccumulator+t*UnityEngine.Time.timeScale);this._fixedAccumulator>=this.fixedTimeStep;)this._invokeQueueOnSystems("onFixedUpdate",this.fixedTimeStep),this._fixedAccumulator-=this.fixedTimeStep;this._invokeDestroyQueue(!1),this._invokeQueueOnSystems("onUpdate",t),this._invokeDestroyQueue(!0),this._invokeQueueOnSystems("onPostUpdate",t),this._invokeDestroyQueue(!1),this._invokeQueueOnSystems("onBeforeRender",t)},onFrameEnd:function(){this._invokeQueueOnSystems("onAfterRender",null)},onApplicationFocus:function(){this._invokeQueueOnSystems("onApplicationFocus",!0)},onApplicationBlur:function(){this._invokeQueueOnSystems("onApplicationFocus",!1)},_invokeQueueOnSystems:function(t,e){this.app.systems,this.app.counters;for(var i=0;i<this.systems.length;i++){var n=this.systems[i];this._triggerPerformanceSample(n,!0),n[t].call(n,e),this._triggerPerformanceSample(n,!1)}},_triggerPerformanceSample:function(t,e){var i=t.performanceSamplerSection;i&&(e?this.app.counters.startSection(i):this.app.counters.endSection(i))},disableCallbacks:function(){this.callbacksDisabled=!0},enableCallbacks:function(){this.callbacksDisabled=!1},invokeCallbacks:function(t){if(!t.isPrefab||null!=t.parent){this.callbacksDisabled=!1;var e=new pc.ComponentQueue;this._collectComponents(t,e),this._invokeQueue(e)}},_collectComponents:function(t,e){let i=t.collectAllUnityComponents();for(var n=0;n<i.length;n++){var r=i[n];(r.onAwake||r.onEnable||r.onDisable)&&e.push(r)}},_invokeQueue:function(t,e){if(0===t.length)return;let i=t.getComponents(!0);for(let t=0;t<i.length;t++){let n=i[t];n.entity._enabledInHierarchy&&(n.onInit&&n.onInit.call(n,e),n.onEnable&&n.enabled&&n.onEnable.call(n,e),n.onDisable&&!n.enabled&&n.onDisable.call(n,e))}},enqueueDestroy:function(t){t.isValid&&(this.destroyQueueProcessing&&(t.enabled=!1),this.destroyQueue[this.destroyQueueLength]=t,this.destroyQueueLength++)},_invokeDestroyQueue:function(t){if(0===this.destroyQueueLength)return;let e=0;if(this.destroyQueueProcessing=!0,t)for(let t=0;t<this.destroyQueueLength;t++)this.destroyQueue[t].update();for(let t=0;t<this.destroyQueueLength;t++){let i=this.destroyQueue[t];i.isReady?i.secondPassProcess||i.execute():(this.destroyQueueTmp[e]=i,e++)}for(let t=0;t<this.destroyQueueLength;t++){let e=this.destroyQueue[t];e.isReady&&e.secondPassProcess&&e.execute()}for(let t=0;t<this.destroyQueueLength;t++)this.destroyQueue[t].enabled=!0;let i=this.destroyQueue;this.destroyQueue=this.destroyQueueTmp,this.destroyQueueTmp=i,this.destroyQueueLength=e,this.destroyQueueProcessing=!1}}),{UnityComponentSystemManagerSystem:t}}()),Object.assign(pc,function(){var t=["rigidbody","collider","joint","rigidbody2D","collider2D","joint2D","uiBehaviour","monoBehaviour","animator","animation","particlesystem","particleSystemRenderer","reflectionprobe","videoPlayer","canvasRenderer","audiosourceunity","renderer","meshFilter"],e=function(e){pc.ComponentSystem.call(this,e),this.id="unity",this.description="Supports Unity-like components.",this.systemIds=t,this.creatingPrefabs=!1,this.schema=[],this._components={},this.app.systems.unitymanager.registerSystem(this),this.queues={onStart:new pc.ComponentQueue,onBeforeUpdates:new pc.ComponentQueue,onFixedUpdate:new pc.ComponentQueue,onUpdate:new pc.ComponentQueue,onPostUpdate:new pc.ComponentQueue,onBeforeRender:new pc.ComponentQueue,onAfterRender:new pc.ComponentQueue,onApplicationFocus:new pc.ComponentQueue}};return(e.prototype=Object.create(pc.ComponentSystem.prototype)).constructor=e,Object.assign(e.prototype,{addComponent:function(t,e){if(e._id)throw new Error("Component already belongs somewhere!");e._id=pc.guid.create(),e._entity=t,e.system=this,e.scriptsExecutionOrder=0,t._unityComponents[this.id].push(e),this._components[e._id]=e,e.onAttached(),t.enabled&&e.enabled&&e._onEntityStateChanged(!0)},removeComponent:function(t,e){this._onComponentDisabled(e);var i=t._unityComponents[e._system.id],n=i.indexOf(e);n<0||(i[n]=i[i.length-1],i.length-=1)},onStart:function(t){this._invokeQueue("onStart",t,!0)},onBeforeUpdates:function(t){this._invokeQueue("onBeforeUpdates",t)},onFixedUpdate:function(t){this._invokeQueue("onFixedUpdate",t)},onUpdate:function(t){this._invokeQueue("onUpdate",t)},onPostUpdate:function(t){this._invokeQueue("onPostUpdate",t)},onBeforeRender:function(t){this._invokeQueue("onBeforeRender",t)},onAfterRender:function(t){this._invokeQueue("onAfterRender",t)},onApplicationFocus:function(t){this._invokeQueue("onApplicationFocus",t)},_invokeQueue:function(t,e,i){if(0!==(r=this.queues[t]).length){var n=this.queues[t].processing,r=this.queues[t].getComponents();n||(this.queues[t].processing=!0),i&&this.queues[t].clear();for(var s=0;s<r.length;s++){var o=r[s];o.entity._enabledInHierarchy&&!o.callbackActivated(t)&&(o.rememberCallback(t),o[t].call(o,e))}i&&this.queues[t].length>0&&this._invokeQueue(t,e,i),n||(this.queues[t].processing=!1)}},_onComponentEnabled:function(t){for(var e=t._queuesToSubscribe(),i=0;i<e.length;i++)this.queues[e[i]].push(t)},_componentShouldStart:function(t){this.queues.onStart.push(t)},_onComponentDisabled:function(t){for(var e=t._queuesToSubscribe(),i=0;i<e.length;i++)this.queues[e[i]].delete(t._id);this.queues.onStart.delete(t._id)},_onEntityHierarchyStateChanged:function(e,i){for(var n=e._unityComponents,r=0;r<t.length;r++)for(var s=n[t[r]],o=0;o<s.length;o++)s[o]._onEntityStateChanged(i)}}),{UNITY_SYSTEM_IDS:t,UnityComponentSystem:e}}()),Object.assign(pc,function(){var t=0,e={},i=function(){this._enabled=!0,this._destroyed=!1,this.$id=0,this.internalExecutionOrder=0,this._sortingOrderInQueue=t++,this._activatedCallbacks={onAwake:!1,onEnable:!1,onStart:!1,onDisable:!0,onDestroy:!1}};return(i.prototype={}).constructor=i,i.prototype.toUnityObject=pc.Component.prototype.toUnityObject,i.addRequiredComponents=function(t,n,r){if(n){var s=Bridge.getTypeName(n);if(void 0!==(c=Deserializers.typeNameToIdMap[s])){var o;e.hasOwnProperty(c)?o=e[c]:((o=[]).push(c),i.getAllRequiredComponents(c,o),e[c]=o);for(var a=UnityEngine.Object.FromHandle(UnityEngine.GameObject,t),u=1;u<o.length;u++){var c=o[u],h=Bridge._getTypeByName(Deserializers.types[c]);if(!a.GetComponent(h)){var l=a.AddComponent(h);r.push(l.handle)}}}}},i.getAllRequiredComponents=function(t,e){var i=Deserializers.requiredComponents[t];if(i&&0!=i.length)for(var n=0;n<i.length;n++){var r=i[n];e.indexOf(r)>=0||(e.push(r),pc.UnityComponent.getAllRequiredComponents(r,e))}},Object.assign(i.prototype,{onInit:function(t){return!this._destroyed&&!this._activatedCallbacks.onAwake&&(this._activatedCallbacks.onAwake=!0,this._activatedCallbacks.onDestroy=!1,this.onAwake&&this.onAwake.call(this,t),!0)},onAttached:function(){},onEnable:function(){return!this._destroyed&&!this._activatedCallbacks.onEnable&&(this._activatedCallbacks.onEnable=!0,this._activatedCallbacks.onDisable=!1,this._system._onComponentEnabled(this),this.onStart&&!this._activatedCallbacks.onStart&&this._system._componentShouldStart(this),!0)},onDisable:function(){return!this._destroyed&&!this._activatedCallbacks.onDisable&&(this._activatedCallbacks.onDisable=!0,this._activatedCallbacks.onEnable=!1,this._system._onComponentDisabled(this),!0)},onDestroy:function(){return!this._destroyed&&!this._activatedCallbacks.onDestroy&&(this._activatedCallbacks.onDestroy=!0,!0)},rememberCallback:function(t){t in this._activatedCallbacks&&(this._activatedCallbacks[t]=!0)},callbackActivated:function(t){return this._activatedCallbacks[t]},_onEntityStateChanged:function(t){LunaUnity.Application.Instance.app.systems.unitymanager.callbacksDisabled||(t?this.onEnable():this.onDisable())},_queuesToSubscribe:function(){return[]},destroy:function(){this._system&&this._entity&&this._system.removeComponent(this._entity,this),this._destroyed=!0}}),Object.defineProperty(i.prototype,"sortingOrderInQueue",{get:function(){return parseInt(this.$id)},configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){var e=this._enabled&&this._entity&&this._entity.enabled,i=t&&this._entity&&this._entity.enabled;this._enabled=t,e===i||LunaUnity.Application.Instance.app.systems.unitymanager.callbacksDisabled||(i?this.onEnable():this.onDisable())}}),Object.defineProperty(i.prototype,"entity",{get:function(){return this._entity}}),Object.defineProperty(i.prototype,"system",{get:function(){return this._system},set:function(t){this._system=t}}),{UnityComponent:i}}()),Object.assign(pc,function(){var t=["OnMouseDown","OnMouseDrag","OnMouseEnter","OnMouseExit","OnMouseOver","OnMouseUp","OnMouseUpAsButton","OnTriggerEnter","OnTriggerStay","OnTriggerExit","OnCollisionEnter","OnCollisionStay","OnCollisionExit","OnTriggerEnter2D","OnTriggerStay2D","OnTriggerExit2D","OnCollisionEnter2D","OnCollisionStay2D","OnCollisionExit2D","UnityEngine$UI$IMaterialModifier$GetModifiedMaterial","UnityEngine$UI$IMeshModifier$ModifyMesh","UnityEngine$UI$IMeshModifier$ModifyMesh$1","OnPopulateMesh","UnityEngine$ICanvasRaycastFilter$IsRaycastLocationValid"],e=new Map;var i=function(i,n,r){pc.UnityComponent.prototype.constructor.call(this);var s=Bridge._getTypeByName(n);this.code=new s(this),this.scriptsExecutionOrder=0,this.internalExecutionOrder=100,this["__"+n]=this.code,this.code.handle=this,this.unityClass=s,this._enabled=void 0===r||!!r,this._events=[],this._canReceiveUpdates=!1,function(i){var n=i.code.constructor;if(!e.has(n)){for(var r=[],s=0;s<t.length;s++)n.prototype[t[s]]!==UnityEngine.UI.Graphic.prototype.OnPopulateMesh&&n.prototype[t[s]]&&r.push(t[s]);e.set(n,r)}}(this),this._addEventListeners()};return i.create=function(t){var e=Bridge._getTypeByName(t.type);return Bridge.isFunction(e)?new i(t.entity,t.type,t.enabled):null},(i.prototype=Object.create(pc.UnityComponent.prototype)).constructor=i,Object.assign(i.prototype,{storeMagicMethods:function(t){if(!t.isPrefab){var i=Bridge.as(this.code,UnityEngine.EventSystems.IEventSystemHandler);t._eventHanders||(t._eventHanders=[]),i&&t._eventHanders.push(i);var n=e.get(this.code.constructor);if(0!==n.length){null===t._magicMethods&&(t._magicMethods={});for(var r=0;r<n.length;r++){var s=t._magicMethods[n[r]]||[];s.push(this),t._magicMethods[n[r]]=s}}}},removeMagicMethods:function(t){var i=e.get(this.code.constructor);if(0!==i.length&&null!==t._magicMethods)for(var n=0;n<i.length;n++){var r=t._magicMethods[i[n]];if(r){var s=r.indexOf(this);s>=0&&(r[s]=r[r.length-1],r.length-=1)}}},configureForEntity:function(t){this.code.ConfigureForEntity&&this.code.ConfigureForEntity(t)},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this._invokeOverload("OnEnable"),pc.Application.getApplication()._noticeScriptComponent(this,!0),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this._invokeOverload("OnDisable"),pc.Application.getApplication()._noticeScriptComponent(this,!1),!0)},onDestroy:function(){return!!pc.UnityComponent.prototype.onDestroy.call(this)&&(this.stopAllCoroutines(),this._invokeOverload("DestroyInternal"),this._invokeOverload("OnDestroy"),!0)},onAwake:function(){this._invokeOverload("Awake")},onStart:function(){this._invokeOverload("Start"),this.hasCamera&&this.code.OnRenderImage&&this._entity.camera.postEffects.addEffect(this.code),this._canReceiveUpdates=!0},onUpdate:function(){this._invokeOverload("Update")},onFixedUpdate:function(){this._invokeOverload("FixedUpdate")},onPostUpdate:function(){this.code.LateUpdate()},onBeforeRender:function(){this.code.OnPreRender()},onAfterRender:function(){this.code.OnPostRender()},onApplicationFocus:function(t){this.code.OnApplicationFocus(t)},onPointerEnter:function(t){(this.code.OnPointerEnter||this.code.UnityEngine$EventSystems$IPointerEnterHandler$OnPointerEnter).call(this.code,t)},onPointerExit:function(t){(this.code.OnPointerExit||this.code.UnityEngine$EventSystems$IPointerExitHandler$OnPointerExit).call(this.code,t)},onPointerDown:function(t){(this.code.OnPointerDown||this.code.UnityEngine$EventSystems$IPointerDownHandler$OnPointerDown).call(this.code,t)},onPointerUp:function(t){(this.code.OnPointerUp||this.code.UnityEngine$EventSystems$IPointerUpHandler$OnPointerUp).call(this.code,t)},onPointerClick:function(t){(this.code.OnPointerClick||this.code.UnityEngine$EventSystems$IPointerClickHandler$OnPointerClick).call(this.code,t)},onBeginDrag:function(t){(this.code.onBeginDrag||this.code.UnityEngine$EventSystems$IBeginDragHandler$OnBeginDrag).call(this.code,t)},onDrag:function(t){(this.code.OnDrag||this.code.UnityEngine$EventSystems$IDragHandler$OnDrag).call(this.code,t)},onEndDrag:function(t){(this.code.OnEndDrag||this.code.UnityEngine$EventSystems$IEndDragHandler$OnEndDrag).call(this.code,t)},onDrag:function(t){(this.code.OnDrag||this.code.UnityEngine$EventSystems$IDragHandler$OnDrag).call(this.code,t)},addCoroutine:function(t){this._system.addCoroutine(t,this)},addFixedUpdateCoroutine:function(t){this._system.addFixedUpdateCoroutine(t,this)},addEndOfFrameCoroutine:function(t){this._system.addEndOfFrameCoroutine(t,this)},stopAllCoroutines:function(){this._system.stopAllCoroutines(this)},stopCoroutine:function(t){this._system.stopCoroutine(t,this)},checkCamera:function(){!this.hasCamera&&this._entity&&this._entity.camera instanceof pc.CameraComponent&&(this.hasCamera=!0,this.code.OnPreRender&&this._events.push("onBeforeRender"),this.code.OnPostRender&&this._events.push("onAfterRender"),this.code.OnRenderImage&&this._addRenderImageListener())},_addRenderImageListener:function(){this.code.render=function(t,e,i){var n=new UnityEngine.RenderTexture(t),r=null==e?null:new UnityEngine.RenderTexture(e);this.onRenderImage(n,r)}},_addEventListeners:function(){this.code.Update&&this._events.push("onUpdate"),this.code.FixedUpdate&&this._events.push("onFixedUpdate"),this.code.LateUpdate&&this._events.push("onPostUpdate"),this.code.OnPostRender&&this._events.push("onAfterRender"),this.code.OnApplicationFocus&&this._events.push("onApplicationFocus")},_queuesToSubscribe:function(){return this._events},_invokeOverload:function(t){try{var e=this.code.overloads[t+"()"]||t,i=this.code[e];if(void 0!==i){var n=i.call(this.code);n&&"Bridge.GeneratorEnumerator"===n.$$fullname&&new UnityEngine.Coroutine(n,this)}}catch(t){t=t.hasOwnProperty("errorStack")?t.errorStack:t,console.error(t),"undefined"!=typeof Sentry&&Sentry.captureException(t)}},onCanvasGroupChanged:function(){this._invokeOverload("OnCanvasGroupChanged")},onBeforeTransformParentChanged:function(){this._invokeOverload("OnBeforeTransformParentChanged")},onTransformParentChanged:function(){this._invokeOverload("OnTransformParentChanged")},onTransformChildrenChanged:function(){this._invokeOverload("OnTransformChildrenChanged")}}),{MonoBehaviourComponent:i}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponentSystem.call(this,t),this.id="monoBehaviour",this.performanceSamplerSection=pc.Counters.SCRIPTS,this.scriptsExecutionOrder=[],this._coroutines={onUpdate:{},onFixedUpdate:{},onAfterRender:{}}};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{addComponent:function(t,e){pc.UnityComponentSystem.prototype.addComponent.call(this,t,e),e.scriptsExecutionOrder=this.scriptsExecutionOrder[e.code.$$fullname]||0,e.storeMagicMethods(t)},removeComponent:function(t,e){pc.UnityComponentSystem.prototype.removeComponent.call(this,t,e),e.removeMagicMethods(t)},onBeforeUpdates:function(){UnityEngine.Input.OnMouseUpdate()},onUpdate:function(t){pc.UnityComponentSystem.prototype.onUpdate.call(this,t);var e=this._coroutines.onUpdate;for(var i in e){var n=e[i],r=n.length>0?n[0][1]:null;if(r&&r._entity._enabled){for(var s=0,o=-1,a=n.length-1;a>=0;--a){var u=n[a][0];u.Update(t),u.isDone?(s++,o<0&&(o=a)):o>=0&&(n[o--]=n[a])}s==n.length?delete e[i]:s>0&&n.splice(0,s)}else delete e[i]}},onFixedUpdate:function(t){pc.UnityComponentSystem.prototype.onFixedUpdate.call(this,t),this._updateCoroutines(this._coroutines.onFixedUpdate,this._handleFixedUpdate)},onAfterRender:function(t){pc.UnityComponentSystem.prototype.onAfterRender.call(this,t),this._updateCoroutines(this._coroutines.onAfterRender,this._handleEndOfFrame)},_updateCoroutines:function(t,e){for(var i in t){var n=t[i],r=n.length>0?n[0][1]:null;if(r&&r._entity._enabled){for(var s=n.length,o=s-1;o>=0;--o)e(n[o][0]);n.length==s?delete t[i]:n.splice(0,s)}else delete t[i]}},_handleFixedUpdate:function(t){t.HandleFixedUpdate()},_handleEndOfFrame:function(t){t.HandleEndOfFrame()},stopAllCoroutines:function(t){var e=this._coroutines.onUpdate[t._id];if(e)for(var i=0;i<e.length;++i){e[i][0].Cancel()}},stopCoroutine:function(t,e){var i=this._coroutines.onUpdate[e._id];if(i)for(var n=0;n<i.length;++n){var r=i[n][0];r.enumerator==t&&r.Cancel()}},addCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onUpdate)},addFixedUpdateCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onFixedUpdate)},addEndOfFrameCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onAfterRender)},_addCoroutineToQueue:function(t,e,i){i[e._id]||(i[e._id]=[]),i[e._id].push([t,e])}}),{MonoBehaviourSystem:t}}()),Object.assign(pc,function(){var t=function(t,e,i){pc.MonoBehaviourComponent.prototype.constructor.call(this,t,e,i)};return t.create=function(e){var i=Bridge._getTypeByName(e.type);return Bridge.isFunction(i)?new t(e.entity,e.type,e.enabled):null},(t.prototype=Object.create(pc.MonoBehaviourComponent.prototype)).constructor=t,Object.defineProperty(t.prototype,"sortingOrderInQueue",{get:function(){return this._sortingOrderInQueue},configurable:!0}),{UIBehaviourComponent:t}}()),Object.assign(pc,function(){var t=function(t){pc.MonoBehaviourSystem.call(this,t),this.id="uiBehaviour"};return(t.prototype=Object.create(pc.MonoBehaviourSystem.prototype)).constructor=t,{UIBehaviourSystem:t}}()),Object.assign(pc,function(){var t=0,e=function(){pc.UnityComponent.prototype.constructor.call(this),this.id=t++,this.model=new pc.Model,this._color=new pc.Color(1,1,1,1),this._groupAlpha=1,this.code=new UnityEngine.CanvasRenderer(this),this._parentCanvas=null,this._colorParameter={const:[1,1,1,1]},this._showMaskGraphics=!0,this._absoluteDepth=0,this._hasPopInstruction=!1,this._popMaterialCount=0,this._popMaterials=[],this.mesh=null,this.isCanvas=!1,this._cullTransparentMesh=!1,this.cull=!1};return(e.prototype=Object.create(pc.UnityComponent.prototype)).constructor=e,Object.defineProperty(e.prototype,"cullTransparentMesh",{get:function(){return this._cullTransparentMesh},set:function(t){this._cullTransparentMesh=t}}),Object.assign(e.prototype,{onEnable:function(){var t=this.findParentCanvas();this.reparentCanvas(t),pc.UnityComponent.prototype.onEnable.call(this)},onDisable:function(){this.reparentCanvas(null),pc.UnityComponent.prototype.onDisable.call(this)},onScreenChanged:function(t){this.reparentCanvas(t)},onCanvasGroupChanged:function(){this.setGroupAlpha(UnityEngine.CanvasGroup.ExtractAlpha(this.entity.element._canvasGroups))},onAttached:function(){var t=this._entity;t.element||t.addComponent("element",{type:pc.ELEMENTTYPE_GROUP,pivot:new pc.Vec2(.5,.5),anchor:new pc.Vec4(0,0,1,1),sizeDelta:new pc.Vec2(0,0),anchoredPosition:new pc.Vec2(0,0)});var e=t.element;e.on("set:stencillayer",this._onStencilLayerChange,this),e.on("set:draworder",this._onDrawOrderChange,this),this.model.element=e,this.model.entity=t},_onStencilLayerChange:function(t){if(this._ignoreMask)this.model.stencil=null;else{var e=this.entity.element;this.model.stencil=e._getStencilParameters(),this.model.masksChildren&&this.model.setParameter("UNITY_UI_ALPHACLIP",1)}},_onDrawOrderChange:function(t){var e=this._entity.element,i=e._nearestScreen;this.model.nearestScreen=i,this.model.element=e,this.model.drawOrder=t,i&&(this.model.sortingLayerIndex=i.sortingLayerIndex,this.model.sortingOrder=i.sortingOrder)},setTexture:function(t){t?this.model.setParameter("_MainTex",t):this.model.deleteParameter("_MainTex")},getTexture:function(){return this.model.getParameter("_MainTex")},setColor:function(t){this._color.equals(t)||(this._color.copy(t),this.applyColor())},getColor:function(){return this._color},setMaterial:function(t,e){var i=this.model.materials;i[e]=t,this.model.materials=i},getMaterial:function(t){return this.model.materials?this.model.materials[t]:null},setMaterialCount:function(t){var e=this.model.materials||[];e.length=t,this.model.materials=e},getMaterialCount:function(){return this.model.materials?this.model.materials.length:0},setMesh:function(t){this.model.mesh=t,this.cacheColors(t),this.applyColor()},cacheColors:function(t){if(t&&t.vertexBuffer.format.hasColor){var e=UnityEngine.Object.FromHandle(UnityEngine.Mesh,this.model._mesh);this.vertexColors=e.colors}},getMesh:function(){return this.model.mesh},findParentCanvas:function(){return pc.UIUtils.findParentScreen(this._entity)},addToParentCanvas:function(){this._parentCanvas&&!this._entity.isPrefab&&this._parentCanvas.canvasMeshInstance.addRenderer(this)},removeFromParentCanvas:function(){this._parentCanvas&&this._parentCanvas.canvasMeshInstance.removeRenderer(this)},reparentCanvas:function(t){if(!this.entity.enabled)return this.removeFromParentCanvas(),void(this._parentCanvas=null);if(t!=this._parentCanvas){this.removeFromParentCanvas();var e=this._parentCanvas?this._parentCanvas["__UnityEngine.Canvas"]:null;this._parentCanvas=t;var i=t?t["__UnityEngine.Canvas"]:null;this.enabled&&this.addToParentCanvas();var n=this.entity.element?this.entity.element["UnityEngine.UI.Graphic"]:null;this.entity.element._nearestScreen=t,n&&(n.m_canvas=i,n.OnCanvasChanged(e,i))}},setGroupAlpha:function(t){this._groupAlpha=t,this.applyColor()},applyColor:function(){var t=this.model.mesh;if(null!=t&&t.vertexBuffer.format.hasColor){this.model.deleteConstant("COLOR");var e=UnityEngine.Object.FromHandle(UnityEngine.Mesh,this.model._mesh),i=e.colors;if(0===i.length)return;for(var n=!0,r=0;r<this.vertexColors.length;r++)i[r].r=this.vertexColors[r].r*this._color.r,i[r].g=this.vertexColors[r].g*this._color.g,i[r].b=this.vertexColors[r].b*this._color.b,i[r].a=this.vertexColors[r].a*this._color.a*this._groupAlpha,i[r].a>=Number.EPSILON&&(n=!1);e.colors=i,this.cullTransparentMesh&&(this.cull=n)}else{var s=new pc.Color;s.copy(this._color),s.a*=this._groupAlpha,this._colorParameter=s.data,this.model.setConstant("COLOR",this._colorParameter)}},setPopMaterial:function(t,e){this._popMaterials[e]||this._popMaterialCount++,this._popMaterials[e]=t}}),Object.defineProperty(e.prototype,"showMaskGraphics",{get:function(){return this._showMaskGraphics},set:function(t){this._showMaskGraphics=t,this.model.setParameter("_ColorMask",t?15:0)}}),Object.defineProperty(e.prototype,"absoluteDepth",{get:function(){return this._absoluteDepth},set:function(t){this._absoluteDepth=t}}),Object.defineProperty(e.prototype,"hasPopInstruction",{get:function(){return this._hasPopInstruction},set:function(t){this._hasPopInstruction=t}}),Object.defineProperty(e.prototype,"popMaterialCount",{get:function(){return this._popMaterialCount},set:function(t){this._popMaterialCount=t}}),{CanvasRendererComponent:e}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponentSystem.call(this,t),this.id="canvasRenderer"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{CanvasRendererSystem:t}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponentSystem.call(this,t),this.id="particlesystem"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{ParticleSystemSystem:t}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponent.prototype.constructor.call(this),this._particleSystem=t.particleSystem,this._renderer=null};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{_fetchRenderer:function(){var t=this._entity._unityComponents.particleSystemRenderer[0];return null==t?null:(this._particleSystem.renderer=t._particleSystemRenderer,t)},_queuesToSubscribe:function(){return["onUpdate"]},onAttached:function(){this._particleSystem._entity=this._entity,this._renderer||(this._renderer=this._fetchRenderer())},onAwake:function(){this._particleSystem._entity=this._entity,this._renderer||(this._renderer=this._fetchRenderer())},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this._particleSystem.main.playOnAwake&&this._particleSystem.play(),this._renderer.enabled=!0,!0)},onDestroy:function(){return!!pc.UnityComponent.prototype.onDestroy.call(this)&&(this._renderer&&!this._renderer._destroyed&&(this._renderer.enabled&&(this._renderer.enabled=!1),this._renderer.destroy(),this._renderer=null),!0)},onUpdate:function(t){var e=this._entity.getWorldTransform(),i=this._entity.getLocalTransform();this._renderer||(this._renderer=this._fetchRenderer()),this._particleSystem.update(t,e,i),this._renderer.enabled&&this._renderer.update(this._particleSystem,t)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this._renderer&&(this._renderer.enabled=!1),this._particleSystem.stop(!0,UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear),!0)},onDestroy:function(){this._particleSystem._cache.dispose()}}),{ParticleSystemComponent:t}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponentSystem.call(this,t),this.id="particleSystemRenderer"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{ParticleSystemRendererSystem:t}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponent.prototype.constructor.call(this),this._particleSystemRenderer=t.particleSystemRenderer};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{onAttached:function(){pc.UnityComponent.prototype.onAttached.call(this),this._particleSystemRenderer.model&&(this._particleSystemRenderer.model.entity=this.entity)},update:function(t,e){this._particleSystemRenderer.update(t,e),this._particleSystemRenderer.render(t,e)},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(pc.Application.getApplication().scene.addRenderer(this),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(pc.Application.getApplication().scene.removeRenderer(this),!0)},getMeshInstancesForRender:function(){return this.model.meshInstances}}),Object.defineProperty(t.prototype,"model",{get:function(){return this._particleSystemRenderer?this._particleSystemRenderer.model:null}}),{ParticleSystemRendererComponent:t}}()),Object.assign(pc,function(){var t=function(t){pc.UnityComponentSystem.call(this,t),this.id="reflectionprobe"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{scheduleProbeUpdate:function(){this.needsProbeUpdate=!0},onBeforeRender:function(t){this.needsProbeUpdate&&this.refreshReflectionProbes(),this.needsProbeUpdate=!1,pc.UnityComponentSystem.prototype.onBeforeRender.call(this,t)},refreshReflectionProbes:function(){var t=this.app.systems.renderer._components;for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];i.enabled&&i.code&&i.code.UpdateReflectionProbes()}}}),{ReflectionProbeSystem:t}}()),Object.assign(pc,function(){var t=function(){pc.UnityComponent.call(this)};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this.code.OnEnable(),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this.code.OnDisable(),!0)},onTransformChanged:function(){this.code.OnReflectionProbeChanged()},onBeforeRender:function(t){this.code.OnBeforeRender()},_queuesToSubscribe:function(){return["onBeforeRender"]},refreshReflectionProbes:function(){this.system.scheduleProbeUpdate()}}),{ReflectionProbeComponent:t}}()),pc.extend(pc.BoundingBox,{ctor:pc.BoundingBox,$kind:"struct",equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)}}),pc.extend(pc.BoundingBox.prototype,{expand:function(t){this.halfExtents+=.5*t},sqrDistance:function(t){let e=Math.abs(t.x-(this.center.x-this.size.x)),i=Math.abs(t.x-(this.center.x+this.size.x)),n=Math.abs(t.y-(center.y-size.y)),r=Math.abs(t.y-(center.y+size.y)),s=Math.min(i,e),o=Math.min(r,n);return s*s+o*o},closestPoint:function(t){let e=t;return e.x=e.x<this.min.x?this.min.x:e.x,e.y=e.y<this.min.y?this.min.y:e.y,e.z=e.z<this.min.z?this.min.z:e.z,e.x=e.x>this.max.x?this.max.x:e.x,e.y=e.y>this.max.y?this.max.y:e.y,e.z=e.z>this.max.z?this.max.z:e.z,e},strictEquals:function(t){return t instanceof pc.BoundingBox&&this.equals(t)},equals:function(t){return this.center.equals(t.center)&&this.halfExtents.equals(t.halfExtents)},intersectRayDistance:function(t,e){let i=new pc.Vec3;return!!this._intersectsRay(t,i)&&(e.v=pc.Vec3.distance(t.origin,i),!0)},getHashCode:function(){return this.center.getHashCode()^this.halfExtents.getHashCode()<<2}}),Object.defineProperty(pc.BoundingBox.prototype,"min",{get:function(){return this.getMin()},set:function(t){this.setMinMax(t,this.getMax())}}),Object.defineProperty(pc.BoundingBox.prototype,"max",{get:function(){return this.getMax()},set:function(t){this.setMinMax(this.getMin(),t)}});