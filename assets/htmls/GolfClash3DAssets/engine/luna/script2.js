(function(t){"use strict";var e;void 0===e&&(e=function(){}),e.a=""}).call(this||window,window.__wpcc=window.__wpcc||{}),function(t){"use strict";var e=function(t=-0,e=-0,i=-0){this.x=t,this.y=e,this.z=i},i=function(t,e,i){t.x=e.x+i.x,t.y=e.y+i.y,t.z=e.z+i.z},s=function(t,e,i){t.x=e.x-i.x,t.y=e.y-i.y,t.z=e.z-i.z},n=function(t,e,i){t.x=e.x*i,t.y=e.y*i,t.z=e.z*i},o=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},r=function(t,e,i=1e-5){return t.l(e),t.normalize(i)},a=function(t,e){const i=t.x,s=t.y,n=t.z;t.x=s*e.z-n*e.y,t.y=n*e.x-i*e.z,t.z=i*e.y-s*e.x},h=function(t,e,i){const s=e.x,n=e.y;e=e.z;const o=i.x,r=i.y;i=i.z,t.x=n*i-e*r,t.y=e*o-s*i,t.z=s*r-n*o},m=function(t,e){const i=e.x-t.x,s=e.y-t.y;return i*i+s*s+(t=e.z-t.z)*t},c=function(t,e){return Math.sqrt(m(t,e))},l=function(t,e,i=1e-5){return Math.abs(t.x-e.x)<i&&Math.abs(t.y-e.y)<i&&Math.abs(t.z-e.z)<i},u=function(t=1e-5){return h(rs,uo,_o),rs.V(t)},_=function(t=-0,e=-0,i=-0,s=1){this.x=t,this.y=e,this.z=i,this.w=s,this.normalize()},p=function(t,e,i=1e-5){return Math.abs(t.x-e.x)<i&&Math.abs(t.y-e.y)<i&&Math.abs(t.z-e.z)<i&&Math.abs(t.w-e.w)<i},d=function(){this.L=this.K=this.H=this.F=this.C=this.s=this.m=this.j=this.B=this.h=this.g=this.f=this.v=this.c=this.b=this.a=0},f=function(t){t.a=1,t.b=0,t.c=0,t.v=0,t.f=0,t.g=1,t.h=0,t.B=0,t.j=0,t.m=0,t.s=1,t.C=0,t.F=0,t.H=0,t.K=0,t.L=1},y=function(t,e){const i=e.x,s=e.y,n=e.z;e.x=t.a*i+t.b*s+t.c*n+t.v,e.y=t.f*i+t.g*s+t.h*n+t.B,e.z=t.j*i+t.m*s+t.s*n+t.C},v=function(t,e,i){i.x=t.a*e.x+t.b*e.y+t.c*e.z,i.y=t.f*e.x+t.g*e.y+t.h*e.z,i.z=t.j*e.x+t.m*e.y+t.s*e.z},g=function(t,e){const i=t.a,s=t.f,n=t.j,o=t.F,r=t.b,a=t.g,h=t.m,m=t.H,c=t.c,l=t.h,u=t.s,_=t.K,p=t.v,d=t.B,f=t.C,y=i*a-s*r,v=i*h-n*r,g=i*m-o*r,x=s*h-n*a,b=s*m-o*a,A=n*m-o*h,w=c*d-l*p,B=c*f-u*p,M=c*(t=t.L)-_*p,C=l*f-u*d,z=l*t-_*d,I=u*t-_*f;var S=y*I-v*z+g*C+x*M-b*B+A*w;S&&(S=1/S,e.a=(a*I-h*z+m*C)*S,e.f=(-s*I+n*z-o*C)*S,e.j=(d*A-f*b+t*x)*S,e.F=(-l*A+u*b-_*x)*S,e.b=(-r*I+h*M-m*B)*S,e.g=(i*I-n*M+o*B)*S,e.m=(-p*A+f*g-t*v)*S,e.H=(c*A-u*g+_*v)*S,e.c=(r*z-a*M+m*w)*S,e.h=(-i*z+s*M-o*w)*S,e.s=(p*b-d*g+t*y)*S,e.K=(-c*b+l*g-_*y)*S,e.v=(-r*C+a*B-h*w)*S,e.B=(i*C-s*B+n*w)*S,e.C=(-p*x+d*v-f*y)*S,e.L=(c*x-l*v+u*y)*S)},x=function(){this.min=new e,this.max=new e},b=function(t,e,i){const s=e.min;e=e.max;const n=i.min;i=i.max,t.min.x=s.x<n.x?s.x:n.x,t.min.y=s.y<n.y?s.y:n.y,t.min.z=s.z<n.z?s.z:n.z,t.max.x=e.x>i.x?e.x:i.x,t.max.y=e.y>i.y?e.y:i.y,t.max.z=e.z>i.z?e.z:i.z},A=function(t){var e=Gh;t.min.add(e),t.max.add(e)},w=function(t,e){const i=t.min,s=e.min;return t=t.max,e=e.max,i.x<=e.x&&t.x>=s.x&&i.y<=e.y&&t.y>=s.y&&i.z<=e.z&&t.z>=s.z},B=function(t,e,i){return i<Number.EPSILON?w(t,e):Math.max(t.min.x-e.max.x,t.min.y-e.max.y,t.min.z-e.max.z,e.min.x-t.max.x,e.min.y-t.max.y,e.min.z-t.max.z)<i},M=function(t,e,i){let n=0;s(ds,i,e),i=ds.length(),ds.scale(1/i);var o=t.min.x,r=t.max.x;if(1e-5>Math.abs(ds.x)){if(e.x<o||e.x>r)return!1}else{var a=1/ds.x;if((o=(o-e.x)*a)>(r=(r-e.x)*a)&&(a=o,o=r,r=a),n=Math.max(n,o),n>(i=Math.min(i,r)))return!1}if(o=t.min.y,r=t.max.y,1e-5>Math.abs(ds.y)){if(e.y<o||e.y>r)return!1}else if(a=1/ds.y,(o=(o-e.y)*a)>(r=(r-e.y)*a)&&(a=o,o=r,r=a),n=Math.max(n,o),n>(i=Math.min(i,r)))return!1;if(o=t.min.z,r=t.max.z,1e-5>Math.abs(ds.z)){if(e.z<o||e.z>r)return!1}else if(t=1/ds.z,(o=(o-e.z)*t)>(e=(r-e.z)*t)&&(t=o,o=e,e=t),n=Math.max(n,o),n>(i=Math.min(i,e)))return!1;return!0},C=function(t){this.Y=t,this.g=new x,this.N=!1},z=function(t){this.name=t.name,this.b=t.bounciness,this.c=t.dynamicFriction,this.g=t.staticFriction,this.f=t.frictionCombine,this.a=t.bounceCombine},I=function(t=-0,e=-0,i=-0,s=-0,n=-0,o=-0,r=-0,a=-0,h=-0){this.data=[-0,-0,-0,-0,-0,-0,-0,-0,-0],this.data[0]=t,this.data[1]=s,this.data[2]=r,this.data[3]=e,this.data[4]=n,this.data[5]=a,this.data[6]=i,this.data[7]=o,this.data[8]=h},S=function(t,e){var i=e.x+e.x,s=e.y+e.y;const n=e.z+e.z,o=e.x*i,r=e.x*s,a=e.x*n,h=e.y*s,m=e.y*n,c=e.z*n;i*=e.w,s*=e.w,e=e.w*n,t.data[0]=1-(h+c),t.data[1]=r+e,t.data[2]=a-s,t.data[3]=r-e,t.data[4]=1-(o+c),t.data[5]=m+i,t.data[6]=a+s,t.data[7]=m-i,t.data[8]=1-(o+h)},L=function(t,e){const i=e.x,s=e.y,n=e.z;e.x=t.data[0]*i+t.data[3]*s+t.data[6]*n,e.y=t.data[1]*i+t.data[4]*s+t.data[7]*n,e.z=t.data[2]*i+t.data[5]*s+t.data[8]*n},P=function(t,e){e.data[0]=t.data[0],e.data[1]=t.data[3],e.data[2]=t.data[6],e.data[3]=t.data[1],e.data[4]=t.data[4],e.data[5]=t.data[7],e.data[6]=t.data[2],e.data[7]=t.data[5],e.data[8]=t.data[8]},k=function(t,e,i){const s=e.data[0],n=e.data[3],o=e.data[6],r=e.data[1],a=e.data[4],h=e.data[7],m=e.data[2],c=e.data[5];e=e.data[8];const l=i.data[0],u=i.data[3],_=i.data[6],p=i.data[1],d=i.data[4],f=i.data[7],y=i.data[2],v=i.data[5];i=i.data[8],t.data[0]=l*s+p*n+y*o,t.data[1]=l*r+p*a+y*h,t.data[2]=l*m+p*c+y*e,t.data[3]=u*s+d*n+v*o,t.data[4]=u*r+d*a+v*h,t.data[5]=u*m+d*c+v*e,t.data[6]=_*s+f*n+i*o,t.data[7]=_*r+f*a+i*h,t.data[8]=_*m+f*c+i*e},V=function(t,e){for(let i=0;9>i;i++)t.data[i]*=e},O=function(t,e,i){var s=Ms;s.set(0,0,0,i),0===t?s.x=e:1===t?s.y=e:s.z=e},T=function(){this.a=new I,this.b=new e,this.c=0,this.f=this.g=null},E=function(t,e){e.V()||(ys.set(0,-t.b.z,t.b.y,t.b.z,0,-t.b.x,-t.b.y,t.b.x,0),i(gs,t.b,e),gs.V()?(k(vs,ys,ys),V(vs,t.c),t.a.add(vs)):(vs.set(0,-gs.z,gs.y,gs.z,0,-gs.x,-gs.y,gs.x,0),ys.multiply(ys),vs.multiply(vs),ys.S(vs),V(ys,t.c),t.a.add(ys)),t.b.add(e),F(t))},F=function(t){t.g=null,t.f=null},q=function(t){t.f=new _;for(let e=0;24>e;e++){S(Bs,t.f),P(Bs,ws),ws.multiply(t.a),ws.multiply(Bs);var i=Math.abs(ws.data[7]),s=Math.abs(ws.data[6]),n=Math.abs(ws.data[3]);if(n=(1+(s=(1+(i=i>s&&i>n?0:s>n?1:2))%3))%3,0===ws.get(s,n)||Math.abs(ws.get(s,s)-ws.get(n,n))>2e6*Math.abs(2*ws.get(s,n)))break;s=(ws.get(s,s)-ws.get(n,n))/(2*ws.get(s,n)),1e3<(n=Math.abs(s))?O(i,1/(4*s),1):(n=1/(n+Math.sqrt(s*s+1)),n=1/Math.sqrt(n*n+1),O(i,Math.sqrt((1-n)/2)*Math.sign(s),Math.sqrt((1+n)/2))),t.f.multiply(Ms),t.f.normalize()}t.g=new e(ws.get(0,0),ws.get(1,1),ws.get(2,2))},D=function(t){t.a.set(0,0,0,0,0,0,0,0,0),t.b.set(0,0,0),t.c=0,F(t)},R=function(t,e,i,s){C.call(this,e),this.c=t,this.a=i||null,this.j=0,this._component=null,this.m=!1,this.N=s},j=function(t,i,s){this.a=t,this.f=new e(i.x,i.y,i.z),this.c=new _(s.x,s.y,s.z,s.w),this.c.normalize(),this.transform=new d,this.g=new d,this.b=new x,N(this)},N=function(t){t.transform.pa(t.c,t.f),g(t.transform,t.g),t.b.transform(t.a.g,t.transform)},J=function(t,e,i){return t<e?e:t>i?i:t},H=function(t,e,i){return i.i(e)-t.i(e)},U=function(t,e,i,o){return s(Ks,i,t),t=Ks.i(e),n(o,e,-t),o.add(i),t},Y=function(t,e,i,n){s(Fs,e,t),qs.l(Fs),1e-5>qs.normalize()?n.l(t):(s(Ds,i,t),n.l(qs),n.scale(Ds.i(qs)),e=Fs.i(n)/Fs.i(Fs),e=J(e,0,1),n.l(Fs),n.scale(e),n.add(t))},W=function(t,e,i,n,o){s(Cs,i,e),s(zs,n,e),s(Is,t,e);var r=Cs.i(Is),a=zs.i(Is);if(0>=r&&0>=a)o.l(e);else{s(Is,t,i);var h=Cs.i(Is),m=zs.i(Is);if(0<=h&&m<=h)o.l(i);else{var c=r*m-h*a;if(0>=c&&0<=r&&0>=h)c=r/(r-h),o.set(e.x+Cs.x*c,e.y+Cs.y*c,e.z+Cs.z*c);else{s(Is,t,n),t=Cs.i(Is);var l=zs.i(Is);0<=l&&t<=l?o.l(n):0>=(r=t*a-r*l)&&0<=a&&0>=l?(c=a/(a-l),o.set(e.x+zs.x*c,e.y+zs.y*c,e.z+zs.z*c)):0>=(a=h*l-t*m)&&0<=m-h&&0<=t-l?(e=(m-h)/(m-h+(t-l)),o.set(i.x+(n.x-i.x)*e,i.y+(n.y-i.y)*e,i.z+(n.z-i.z)*e)):(n=r/(i=a+r+c),c/=i,o.set(Cs.x*n+e.x+zs.x*c,Cs.y*n+e.y+zs.y*c,Cs.z*n+e.z+zs.z*c))}}}},G=function(t,e,i,o,r,a){s(Us,e,t),s(Ys,o,i),s(Ws,t,i),e=Us.i(Us);var h=Ys.i(Ys);const m=Ys.i(Ws);if(1e-5>=e&&1e-5>=h)return r.l(t),a.l(i),s(Gs,r,a),Gs.i(Gs);if(1e-5>=e){var c=0;h=J(m/h,0,1)}else if(o=Us.i(Ws),1e-5>=h)h=0,c=J(-o/e,0,1);else{const t=Us.i(Ys);0>(h=(t*(c=0!=(c=e*h-t*t)?J((t*m-o*h)/c,0,1):0)+m)/h)?(h=0,c=J(-o/e,0,1)):1<h&&(h=1,c=J((t-o)/e,0,1))}return n(r,Us,c),r.add(t),n(a,Ys,h),a.add(i),s(Gs,r,a),Gs.i(Gs)},K=function(t,e,i,n,o){s(Ps,i,e),s(ks,n,e),s(Vs,t,e),t=Ps.i(Ps),e=Ps.i(ks),i=ks.i(ks),n=Vs.i(Ps);const r=Vs.i(ks),a=Vs.i(Vs),h=t*i-e*e;1e-5>Math.abs(h)?1e-5>Math.abs(t)?(t=Math.sqrt(a/i),o.set(1-t,0,t)):(t=Math.sqrt(a/t),o.set(1-t,t,0)):(o.y=(i*n-e*r)/h,o.z=(t*r-e*n)/h,o.x=1-o.y-o.z)},Z=function(t,e){var i=rr,s=ir,o=sr,r=t.i(i);return t=s.i(i)-r,r=o.i(i)-r,-1e-5>t&&-1e-5>r?t>r?(e.l(s),t):(e.l(o),r):1e-5<t&&1e-5<r?t<r?(e.l(s),t):(e.l(o),r):(n(e,i,-r),e.add(o),0)},X=function(t,e,i,o,r=1e-5){var a=ko;return s(Zs,i,e),i=a.i(Zs),!(Math.abs(i)<r||(s(Xs,e,t),0>(t=-a.i(Xs)/i)||1<t||(n(o,Zs,t),o.add(e),0)))},$=function(t,e,i,r,a){return s($s,e,t),s(Qs,r,i),s(tn,i,t),h(en,tn,Qs),h(nn,$s,Qs),!(1e-5>(i=o(nn))||0>(e=en.i(nn)/i)||1<e||(h(sn,tn,$s),0>(i=sn.i(nn)/i)||1<i||(n(a,$s,e),a.add(t),0)))},Q=function(t,i,n,o){C.call(this,32),this.D=t,this.I=i,this.G=n,this.a=o,this.o=new e,s(on,this.I,this.D),s(rn,this.G,this.D),h(this.o,on,rn),this.o.normalize(),(t=this.g).min.x=Math.min(this.D.x,this.I.x,this.G.x),t.min.y=Math.min(this.D.y,this.I.y,this.G.y),t.min.z=Math.min(this.D.z,this.I.z,this.G.z),t.max.x=Math.max(this.D.x,this.I.x,this.G.x),t.max.y=Math.max(this.D.y,this.I.y,this.G.y),t.max.z=Math.max(this.D.z,this.I.z,this.G.z)},tt=function(){this.f=this.b=null,this.u=new e,this.a=0,this.o=new e,this.ea=new e,this.g=0},et=function(t){if(0!==t.length){var e=t.buffer[t.length-1];return t.length--,e}},it=function(t,e){t.buffer[e]=t.buffer[t.length-1],t.length--},st=function(t,e){-1!==(e=t.indexOf(e))&&it(t,e)},nt=function(t,e){t.ca.l(e.ca),t.da.l(e.da),t.u.l(e.u)},ot=function(t,e,i,r){if(s(vn,t.position,e.position),vn.V())return!1;vn.normalize(),bn.ra(t,e,vn),vn.scale(-1),An.ra(t,e,vn);let a=pn;a.J(bn,An),gn.set(1/0,1/0,1/0);let h=0;for(;15>h;){if(a.sa(xn),xn.V())return!1;if(a=a.ma(xn),o(xn)>o(gn))return a.X(gn,i,r),!0;if(gn.l(xn),n(vn,gn,-1),vn.normalize(),wn.ra(t,e,vn),gn.i(vn)+1e-4>=wn.u.i(vn))return a.X(gn,i,r),!0;a=a.fa(wn),h++}return a.sa(xn),a.ma(xn).X(gn,i,r),!0},rt=function(t,e,i){this.buffer=t,this.a=e,this.b=i},at=function(t){this.a=new x,this.g=this.f=null,this.j=0,this.b=t||null,this.c=null,this.h=0},ht=function(t){t.b?t.a.l(t.b.g):b(t.a,t.f.a,t.g.a)},mt=function(t,e){if(e===t)return 1/0;b(In,t.a,e.a);{e=(t=In).max.y-t.min.y;const i=t.max.z-t.min.z;t=(t.max.x-t.min.x)*(e+i)+e*i}return t},ct=function(t,e){const i=e.b-e.a;if(!(1>=i)){var s=e.get(0);for(t.c=s,t.h=mt(t,s),s=1;s<i;s++){const i=e.get(s),n=mt(t,i);t.h>n&&(t.c=i,t.h=n)}}},lt=function(t){return 153391689&((t=51130563&((t=50393103&((t=4278190335&(t^t<<16))^t<<8))^t<<4))^t<<2)},ut=function(t,e){return t.j-e.j},_t=function(t){return Math.round(Math.max(Math.pow(t,.5)/2*Math.pow(t,.5),1))},pt=function(t,e){var i=t.b-t.a;if(0!==i)if(4>i)dt(t,_t(4));else{if(0<e){var s=0,n=t.b-t.a;do{var o=Math.round((s+n)/2);0<(t.get(o).j&e)?n=o:s=o}while(1<n-s);s=n}else s=Math.ceil(i/2);for(o=t.a,n=t.a+s,t.a=o,t.b=n,i=new rt(t.buffer,t.a+s,t.a+i),pt(t,e>>>=1),pt(i,e),e=i.a;e<i.b;)t.buffer[t.b]=t.buffer[e],t.b++,e++;dt(t,_t(t.b-t.a))}},dt=function(t,e){let i=t.b-t.a;if(!(i<=e)){for(var s=0;s<i;s++)ct(t.get(s),t);for(;i>e;){s=t.get(0);for(var n=0,o=1;o<i;o++){var r=t.get(o);s.h>r.h&&(s=r,n=o)}if(o=s.c,(r=new at).f=s,r.g=o,ht(r),o=r,t.buffer[t.a+n]=o,-1===(n=(r=t).indexOf(s.c)))throw Error("Element not found");if(r.buffer[r.a+n]=r.buffer[r.b-1],r.b--,i--,i<=e)break;for(ct(o,t),n=0;n<i;n++)(o=t.get(n)).c!==s&&o.c!==s.c||ct(o,t)}}},ft=function(t){for(var e=[],i=new x,s=0;s<t.length;s++){b(i,i,t[s].g);var n=new at(t[s]);ht(n),e.push(n)}t=512/(i.max.x-i.min.x),s=512/(i.max.y-i.min.y),n=512/(i.max.z-i.min.z);for(let o=0;o<e.length;o++){const r=e[o];r.j=(lt(((r.a.max.z-r.a.min.z)/2+r.a.min.z+i.min.z)*n)<<2)+(lt(((r.a.max.y-r.a.min.y)/2+r.a.min.y+i.min.y)*s)<<1)+lt(((r.a.max.x-r.a.min.x)/2+r.a.min.x+i.min.x)*t)}e.sort(ut),i=new rt(e,0,e.length),2>=e.length?e=0:(e=e[e.length-1].j,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e-=e>>>1),pt(i,e),dt(i,1),this.a=e=i.get(0)},yt=function(t,e,i,s,n){for(R.call(this,t,8,s,n),this.b=e,this.s=i,this.h=this.f=null,(t=this.g).min.x=t.min.y=t.min.z=0,t.max.x=t.max.y=t.max.z=0,e=0;e<this.b.length;e++)t.min.x=Math.min(t.min.x,this.b[e].x),t.min.y=Math.min(t.min.y,this.b[e].y),t.min.z=Math.min(t.min.z,this.b[e].z),t.max.x=Math.max(t.max.x,this.b[e].x),t.max.y=Math.max(t.max.y,this.b[e].y),t.max.z=Math.max(t.max.z,this.b[e].z)},vt=function(t){if(t.f)return t.f;t.f=[];const e=t.b,i=t.s,s=t.f;for(let t=0;t<i.length;t+=3)s.push(new Q(e[i[t]],e[i[t+1]],e[i[t+2]],t/3|0));return t.f},gt=function(t){return t.h||(t.h=new ft(vt(t)).a),t.h},xt=function(t,e,s){i(Ln,e,t.v),t.oa(Ln),At(t,s,Pn),Pn.multiply(t.s),Mi(t,Pn)},bt=function(t){if(t.H!==Sh||!(1&t.a)||512&t.a)return!1;let e=!0;for(let i=0;i<t.b.a.length;i++){const s=t.b.a[i].a;if(8===s.Y)return!1;e=e&&s.N}return!e},At=function(t,e,i){t.aa().A(t.j,Sn),Sn.add(t.f),.001>(t=Sn.length())?Sn.scale(.5*e-e*e*e*.020833333333*t*t):Sn.scale(Math.sin(.5*t*e)/t),i.x=Sn.x,i.y=Sn.y,i.z=Sn.z,i.w=Math.cos(t*e*.5)},wt=function(t,e,i,o=!1){let a=i;n(kn,t.m,t.xa),kn.add(t.g),kn.scale(i),r(Vn,kn),Vn.scale(1e-4);const h=Oi(t);Tn.clear(),En.clear(),Fn.clear();for(var m=0;m<e.length;m++){var l=e[m],u=Tn;if(8===l.b.Y)for(var _=vt(l.b),p=0;p<_.length;p++){var d=_[p];Fn.buffer.length===Fn.length?Fn.add(new Wn):Fn.length++;var f=Fn.buffer[Fn.length-1];f.J(d,l),u.add(f)}else En.buffer.length===En.length?En.add(new Yn):En.length++,(_=En.buffer[En.length-1]).J(l),u.add(_)}for(e=Ci(t,i),m=0;m<Tn.length;m++)Tn.buffer[m].j(e)||(it(Tn,m),m--);for(;1e-5<a;){t:{for(e=h,m=a,l=o,o=Tn,u=kn,Dn.clear(),qn.l(u),u=qn.normalize(),_=0;_<o.length;_++){f=e,(d=p=o.buffer[_]).c=1/0,d.g=1/0;for(let t=0;t<f.length;t++){if(!d.h(f.buffer[t],Jn,Hn)){d.c=0,d.g=0;break}var y=c(Hn,Jn);y<d.c&&(d.c=y),s(Un,Hn,Jn),(y=Un.i(qn))<d.g&&(d.g=y)}if(p.f=p.c/u*m,(d=0===p.f)&&!l){o=p;break t}p.c>=u?(it(o,_),_--):d&&l&&Dn.add(p.a.id)}if(0<Dn.length)for(e=0;e<o.length;e++)-1!==Dn.indexOf(o.buffer[e].a.id)&&(it(o,e),e--);for(e=null,m=0;m<o.length;m++)l=o.buffer[m],(null===e||l.f<e.f)&&(e=l);o=e}if(!(e=o)){xt(t,kn,a);break}if(0===(o=e.f))return a!==i&&(t.a|=32),e.a;if(o>=a){xt(t,kn,a);break}for(On.l(kn),On.scale(o/a),On.add(Vn),xt(t,On,o),kn.S(On),e=0;e<h.length;e++)Ri(h.buffer[e]);a-=o,o=!1}return null},Bt=function(t,e){Rn.clear(),jn.clear();for(var i=0;i<t.length;i++){var s=t[i],n=bt(s);!n||32&s.a?n?(Ii(s,e),Vi(s)):n||jn.add(s):Rn.add(s)}if(0!==Rn.length)for(t=0;t<Rn.length;t++){i=Rn.buffer[t],Ii(i,e),i.m.set(0,0,0),i.j.set(0,0,0),s=Ci(i,e),n=[];for(let t=0;t<jn.length;t++){var o=jn.buffer[t];if(w(s,bi(o))){o=Oi(o);for(let t=0;t<o.length;t++){const e=o.buffer[t];!e.b.N&&w(s,e.j)&&n.push(e)}}}0===n.length?zi(i,e):(wt(i,n,e,!0),i.a&=-33,Vi(i))}},Mt=function(t,e){return t.buffer[0]-e.buffer[0]},Ct=function(t){var e=Kn;const i=t.min;return t=t.max,Math.min(i.x*e.x,t.x*e.x)+Math.min(i.y*e.y,t.y*e.y)+Math.min(i.z*e.z,t.z*e.z)},zt=function(t){var e=Kn;const i=t.min;return t=t.max,Math.max(i.x*e.x,t.x*e.x)+Math.max(i.y*e.y,t.y*e.y)+Math.max(i.z*e.z,t.z*e.z)},It=function(){this.buffer=[-0,-0,-0,-0,-0,-0],this.b=this.a=this.c=!1,this.body=null},St=function(){this.b=[],this.a=[],this.c=new _n,this.f=new _n},Lt=function(t,e,i){const s=[];for(let n=0;n<t.b.length;n++){const o=t.b[n];w(e,bi(o))&&0!=(o.b.f&i)&&s.push(o)}return s},Pt=function(){this.g=0,this.f=this.c=null,this.a=[],this.b=new _n},kt=function(t,e){t.a[e].F(),t.a[e]=t.a[t.a.length-1],t.a.pop()},Vt=function(t){for(;t.b.length;)et(t.b).F();for(;t.a.length;)t.a.pop().F()},Ot=function(t,e,i,n){let r=0;return s(Qn,t.b,e.b),s(to,i.b,n.b),a(Qn,to),r=Math.max(r,o(Qn)),s(Qn,t.b,i.b),s(to,e.b,n.b),a(Qn,to),r=Math.max(r,o(Qn)),s(Qn,t.b,n.b),s(to,e.b,i.b),a(Qn,to),Math.max(r,o(Qn))},Tt=function(t,e,i,s){return Math.max(m(t.f,e.f),m(t.f,i.f),m(t.f,s.f),m(e.f,i.f),m(e.f,s.f),m(i.f,s.f))},Et=function(t,e){if(1===t.c.b.a.length&&1===t.f.b.a.length)0===t.b.length?(e=Wi(e),Yi(e),e.m|=em,t.b.add(e)):((t=t.b.buffer[0]).s=e.s,t.m&sm&&(t.m&=~sm,t.m|=im));else{var i=!1;for(let s=t.b.length-1;0<=s;s--){const n=t.b.buffer[s];if(n.C===e.C&&n.B===e.B||n.B===e.C&&n.C===e.B){i=!0,n.s=e.s,n.m&sm&&(n.m&=~sm,n.m|=im);break}}i||(e=Wi(e),Yi(e),e.m|=em,t.b.add(e))}},Ft=function(){this.a=[],this.b=0,this.cache=new Map},qt=function(t,e){const i=t.a[e];t.a[e]=t.a[t.b-1],t.b--,t.cache.delete(i.g),Vt(i),lm(cm.Ca,i)},Dt=function(t,e){return Math.min(t.id,e.id)+(Math.max(t.id,e.id)<<16)},Rt=function(){this.a=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],this.b=[-0,-0,-0,-0,-0,-0]},jt=function(t,e,i,s){const n=e+i,o=e*e,r=o+i*n;t.b[0]=n+s,t.b[1]=r+s*t.b[0],t.b[2]=e*o+i*r+s*t.b[1],t.b[3]=t.b[1]+e*(t.b[0]+e),t.b[4]=t.b[1]+i*(t.b[0]+i),t.b[5]=t.b[1]+s*(t.b[0]+s)},Nt=function(t,e,i,s,n){R.call(this,t,4,i,n),this.H=s,this.h=e,this.F=this.C=this.s=this.b=this.v=this.f=null,Xt(this.g,this.h),this.B=null},Jt=function(t){return t.f||Gt(t),t.f},Ht=function(t){return t.b||Gt(t),t.b},Ut=function(t){return t.s||Gt(t),t.s},Yt=function(t){return t.C||Gt(t),t.s},Wt=function(t){return t.F||Gt(t),t.F},Gt=function(t){t.cb(),t.gb(),t.fb(),t.eb();{var e=t.f[0],i=t.f[0];let s=t.f[0],n=t.f[0],o=t.f[0],r=t.f[0];for(let a=1;a<t.f.length;a++){const h=t.f[a];h.position.x>e.position.x?e=h:h.position.x<i.position.x&&(i=h),h.position.y>s.position.y?s=h:h.position.y<n.position.y&&(n=h),h.position.z>o.position.z?o=h:h.position.z<r.position.z&&(r=h)}t.F=[e,i,s,n,o,r]}for(e=0;e<t.b.length;e++)(i=t.b[e]).f=null,i.c=[]},Kt=function(t,e){const i=(t=Zt(t,e)).position.i(e);let s=t.a[0],n=1/0;for(let r=0;r<t.a.length;r++){const a=t.a[r];var o=(a.c.a===t?a.a:a.c.a).position.i(e);(o=Math.abs(i-o))<n&&(n=o,s=a)}return s},Zt=function(t,e){var i=Wt(t);let s=(t=i[0]).position.i(e);for(var n=1;n<i.length;n++){var o=i[n],r=o.position.i(e);r>s&&(t=o,s=r)}do{for(i=!1,n=t,o=0;o<n.a.length;o++){const a=(r=n.a[o].a).position.i(e);a>s&&(s=a,t=r,i=!0)}}while(i);return t},Xt=function(t,e){t.min.x=t.min.y=t.min.z=1/0,t.max.x=t.max.y=t.max.z=-1/0;for(let i=0;i<e.length;i++)t.min.x=Math.min(t.min.x,e[i].x),t.min.y=Math.min(t.min.y,e[i].y),t.min.z=Math.min(t.min.z,e[i].z),t.max.x=Math.max(t.max.x,e[i].x),t.max.y=Math.max(t.max.y,e[i].y),t.max.z=Math.max(t.max.z,e[i].z)},$t=function(t){if(t.H)return null;if(!t.B){t.B=new Rt;var e=t.B,i=Ht(t);for(let t=0;t<i.length;t++){const m=i[t],c=m.a;let l=c.b;do{var n=c.c.a.position,o=l.a.position,r=l.c.a.position;if(s(so,o,n),s(no,r,n),h(oo,so,no),0>oo.i(m.o)){oo.scale(-1);var a=o;o=r,r=a}a=n.x;const t=o.x,i=r.x,u=n.y,_=o.y,p=r.y;n=n.z,o=o.z,r=r.z;const d=oo.x,f=oo.y,y=oo.z;jt(e,a,t,i),e.a[0]+=d*e.b[0],e.a[1]+=d*e.b[1],e.a[4]+=d*e.b[2],e.a[7]+=d*(u*e.b[3]+_*e.b[4]+p*e.b[5]),jt(e,u,_,p),e.a[2]+=f*e.b[1],e.a[5]+=f*e.b[2],e.a[8]+=f*(n*e.b[3]+o*e.b[4]+r*e.b[5]),jt(e,n,o,r),e.a[3]+=y*e.b[1],e.a[6]+=y*e.b[2],e.a[9]+=y*(a*e.b[3]+t*e.b[4]+i*e.b[5]),l=l.b}while(l.b!==c)}for(i=0;10>i;i++)e.a[i]*=io[i]}return t.B},Qt=function(t){const e=[];for(let i=0;i<t.b.length;i++){const s=t.b[i];if(s.g!==po){t.b[i]=t.b[t.b.length-1],t.b.pop(),i--;for(let t=0;t<s.c.length;t++)e.push(s.c[t])}}return e},te=function(t,e){var i=t.a;do{var s;if((s=ce(i.f,i.c.f.b)>-Number.EPSILON)&&(s=i.c,s=ce(s.f,s.c.f.b)>-Number.EPSILON),s&&i.f.o.i(i.c.f.o)>1-Number.EPSILON&&-1===e.indexOf(i.c.f)){{var n=i.c.f;n.g=fo;var o=i.c;e=i.g,s=i.b;let r=o.g;o=o.b;let a=e;for(;e.c.f===n;)if(e=e.g,o=o.b,e===a)throw Error("Degenerated face");for(a=s;s.c.f===n;)if(r=r.g,(s=s.b)===a)throw Error("Degenerated face");for(n=o;n!==r.b;n=n.b)n.f=t;t.a===i&&(t.a=s),r.b=s,s.g=r,e.b=o,o.g=e,le(t)}return!0}i=i.b}while(i!==t.a);return!1},ee=function(t){let e=null,i=-1/0;for(let s=0;s<t.b.length;s++){const n=t.b[s],o=n.h;null!==n.f&&o>i&&(i=o,e=n)}return e},ie=function(t,e,i,s,n){s.g=fo,s=null===i?i=s.a:i.b;do{const i=s.c.f;i.g===po&&(1e-10<ce(i,e)?ie(t,e,s.c,i,n):n.push(s)),s=s.b}while(i!==s)},se=function(t,e,i){const s=new me,n=new ae;return n.a=t,n.f=s,(t=new ae).a=e,t.f=s,(e=new ae).a=i,e.f=s,n.g=e,n.b=t,t.g=n,t.b=e,e.g=t,e.b=n,s.a=n,le(s),s},ne=function(t,e){let i=1e-10,s=null;for(let n=0;n<e.length;n++){const o=e[n],r=ce(o,t.position);r>i&&(i=r,s=o)}s&&(s.c.push(t),null===s.f||s.h<i)&&(s.f=t,s.h=i)},oe=function(t,e){for(let i=0;i<t.length;i++)if(Math.abs(t[i].i(e))>1-Number.EPSILON)return!0;return!1},re=function(t){this.position=t,this.a=[]},ae=function(){this.f=this.a=this.c=this.g=this.b=null},he=function(t,e){t.c=e,e.c=t},me=function(){this.a=null,this.o=new e,this.b=new e,this.j=0,this.c=[],this.f=null,this.h=0,this.g=po},ce=function(t,e){return t.o.i(e)-t.j},le=function(t){const e=t.a;t.o.set(0,0,0),t.b.l(e.a.position),s(uo,e.a.position,e.b.a.position);let i=e.b,n=1;for(;e!==i;){if(t.b.add(i.a.position),t.o.V()&&(s(_o,i.a.position,i.b.a.position),!u(Number.EPSILON))){h(t.o,_o,uo);var o=t.o;o.normalize(Number.EPSILON),o.normalize(Number.EPSILON)}n++,i=i.b}t.b.scale(1/n),t.j=t.o.i(t.b)},ue=function(t,e){for(t=t.a;0<e;)t=t.b,e--;return t},_e=function(t,e,i,s){let n=e,o=t;return t<e&&(n=t,o=e),t=s,e=i,i<s&&(t=i,e=s),o>t?e-n:0},pe=function(t,e,i,s,o,r=0){let a=i[0],h=1/0;for(let m=0;m<s;m++){const s=i[m];t.a(s,yo),e.a(s,vo);const c=_e(yo[1],yo[0],vo[1],vo[0]);if(c<=-r+Number.EPSILON)return o.l(s),0;const l=_e(-yo[0],-yo[1],-vo[0],-vo[1]);if(l<=-r+Number.EPSILON)return n(o,s,-1),0;c<h&&(h=c,a=s),l<h&&(h=l,n(o,s,-1),a=o)}return o.l(a),h},de=function(){this.c=[],this.f=0},fe=function(){this.c=null},ye=function(t,e){return t.c.T(e,xo),xo.i(e)},ve=function(){this.c=null,this.g=new d,this.f=new d},ge=function(t,e){return v(t.g,e,Ao),t.c.T(Ao,bo),y(t.f,bo),bo.i(e)},xe=function(){this.c=0,this.g=cm.Ja,this.f=null,this.a=new e,this.o=new e,this.b=0},be=function(){this.c=1,this.g=cm.Ia,this.f=null,this.j=new e,this.h=new e,this.a=new e,this.o=new e,this.b=0},Ae=function(){this.c=2,this.g=cm.Ka,this.f=null,this.a=new e,this.o=new e,this.b=0},we=function(t,e,i,s){K(e,t.D,t.I,t.G,Bo);const n=1e-5<Math.abs(Bo.x);var o=1e-5<Math.abs(Bo.y),r=1e-5<Math.abs(Bo.z),a=n?o||r:o&&r;return n&&o&&r?((o=Xi(cm.Ja)).J(t,e,i,s),o):a?(r=t.D,a=t.I,n?o||(a=t.G):r=t.G,(o=Xi(cm.Ia)).J(t,r,a,e,i,s),o):(e=t.D,o?e=t.I:r&&(e=t.G),(o=Xi(cm.Ka)).J(t,e,i,s),o)},Be=function(t,e){if(.99999<Math.abs(t.o.i(e.o)))return null;var i=t.D.i(t.o),s=e.D.i(t.o)-i,o=e.I.i(t.o)-i;if(i=e.G.i(t.o)-i,0<s&&0<o&&0<i||0>s&&0>o&&0>i)return null;n(Mo,t.o,-s),Mo.add(e.D),n(Co,t.o,-o),Co.add(e.I),n(zo,t.o,-i),zo.add(e.G);var r=c(Mo,Co),a=c(Co,zo),h=c(zo,Mo);const m=[];return r>a&&r>h?m.push(Mo,Co):a>r&&a>h?m.push(Co,zo):m.push(zo,Mo),Oe(t,m[0],m[1],Io[0],Io[1],0)&&Oe(e,Io[0],Io[1],So[0],So[1],0)?(h=e.D.i(e.o),a=t.D.i(e.o)-h,r=t.I.i(e.o)-h,h=t.G.i(e.o)-h,s=Math.abs(Math.min(s,o,i)),o=a,Math.abs(o)>Math.abs(r)&&(o=r),Math.abs(o)>Math.abs(h)&&(o=h),s-1e-5<(i=Math.abs(o))?(n(Lo,t.o,-1),[we(t,So[0],Lo,s),we(t,So[1],Lo,s)]):(n(Lo,e.o,-Math.sign(o)),[we(t,So[0],Lo,i),we(t,So[1],Lo,i)])):null},Me=function(t,i,s,n){n.La||(n.La=new Map),n.Ta||(n.Ta=new Map),n.ga||(n.ga=new d,n.ga.l(t.c),n.ga.multiply(s.transform)),t=[];const o=[];s=gt(s.b);do{var r=n.La.get(s);if(r||((r=new x).l(s.a),r.transform(r,n.ga),n.La.set(s,r)),w(r,i.g))if(s.b){if((r=n.Ta.get(s))||(r={D:new e,I:new e,G:new e,o:new e},n.ga.A(s.b.D,r.D),n.ga.A(s.b.I,r.I),n.ga.A(s.b.G,r.G),v(n.ga,s.b.o,r.o),n.Ta.set(s,r)),s=Be(i,r))for(r=0;r<s.length;r++)t.push(s[r]);s=o.pop()}else o.push(s.f),s=s.g;else s=o.pop()}while(s);return t},Ce=function(t,e,i,s){switch(Math.max(t,e)){case 1:return i*s;case 2:return Math.min(i,s);case 3:return Math.max(i,s);default:return(i+s)/2}},ze=function(t,i){for(;t.length<i;)t.push(new e)},Ie=function(t,i,n,o,r){let a=Vo;a.clear();for(var m=0;m<i;m++)a.add(t[m]);for(t=0;t<o;t++){i=n[t],s(Po,t===o-1?n[0]:n[t+1],i),h(ko,Po,r),ko.normalize(),m=ko.i(i);const l=a===Vo?Oo:Vo;l.clear();for(let t=0;t<a.length;t++){const s=a.buffer[t],n=t===a.length-1?a.buffer[0]:a.buffer[t+1];var c=ko.i(s)-m;const o=ko.i(n)-m;let r=!0;if(0<=c&&0<=o?l.add(n):0<=c&&0>o?(c=new e,r=X(i,s,n,c,Number.EPSILON),l.add(c)):0>c&&0<=o&&(c=new e,r=X(i,s,n,c,Number.EPSILON),l.add(c),l.add(n)),!r)return[]}a=l}for(n=[],o=0;o<a.length;o++)n.push(a.buffer[o]);return n},Se=function(t,e){const i=Ut(t.b);ze(e,i.length),t=t.h;for(let s=0;s<i.length;s++)t.A(i[s],e[s]);return e},Le=function(t,e){const i=Jt(t.b);ze(e,i.length);for(let s=0;s<i.length;s++)t.transform.A(i[s].position,e[s]);return e},Pe=function(t,e){let i=(e=Ht(e.b))[0],s=1/0;for(let n=0;n<e.length;n++){const o=e[n],r=m(o.o,t);r<s&&(i=o,s=r)}return i},ke=function(t,e){let i=(e=Ht(e.b))[0].o.i(t),s=e[0];for(let n=1;n<e.length;n++){const o=e[n].o.i(t);o<i&&(i=o,s=e[n])}return s},Ve=function(t,e){if(48>Jt(t.b).length){const i=Xi(cm.ia);return i.J(t,Le(t,e),Jt(t.b).length),i}return(e=Xi(cm.Z)).J(t),e},Oe=function(t,e,i,o,r,a){return n(To,t.o,a),s(o,e,To),s(r,i,To),!!(Te(t,t.D,t.I,o,r)&&Te(t,t.I,t.G,o,r)&&Te(t,t.G,t.D,o,r))&&(o.add(To),r.add(To),!0)},Te=function(t,e,i,n,o){s(Eo,i,e),a(Eo,t.o),Eo.normalize();var r=e.i(Eo);return t=n.i(Eo)-r,r=o.i(Eo)-r,!(0<t&&0<r||(0>=t&&0>=r||$(e,i,n,o,0<t&&0>r?n:o),0))},Ee=function(t,e,i,s,n){R.call(this,t,1,s,n),this.b=Math.max(e,1e-4),this.f=Math.max(Math.abs(i),1e-4),(t=this.g).min.x=t.min.z=-this.b,t.min.y=-this.f-this.b,t.max.x=t.max.z=this.b,t.max.y=this.f+this.b},Fe=function(t,e,i,s){R.call(this,t,16,i,s),this.b=Math.max(e,1e-4),(t=this.g).min.x=t.min.y=t.min.z=-this.b,t.max.x=t.max.y=t.max.z=this.b},qe=function(t,e,s){const o=t.j.b;n(t.b,t.c,t.h.b.b),t.b.add(e),n(t.a,t.c,-o.b),t.a.add(s),i(t.f,t.b,t.a),t.f.scale(.5),y(t.h.c,t.b),y(t.j.c,t.a)},De=function(t,e,s){n(t.b,t.c,t.h.b.b),t.b.add(e),t.a.l(s),i(t.f,t.b,t.a),t.f.scale(.5),y(t.h.c,t.b),y(t.j.c,t.a)},Re=function(t,e,i,o,r){o.l(t),r.l(e),t=U(i.a.a.position,i.o,t,cr),U(i.a.a.position,i.o,e,lr),e=i.a;let a=!0,m=!0,c=0;do{var l=e.c.a.position;const _=e.a.position;s(ur,_,l),h(_r,i.o,ur),_r.normalize();var u=l.i(_r);const p=cr.i(_r)-u;if(1e-5<p&&(a=!1),1e-5<(u=lr.i(_r)-u)&&(m=!1),Math.sign(p)===Math.sign(u))e=e.b;else if($(l,_,cr,lr,pr)){if(c++,n(l=0<p?o:r,i.o,t),l.add(pr),2===c)return!0;e=e.b}else e=e.b}while(e!==i.a);return 0!==c||a&&m},je=function(t,i,s){t.g.a&i.g.a&65536&&(t=t.b.c+(i.b.c<<16),(i=Wr.get(t))||(i=new e,Wr.set(t,i)),i.l(s))},Ne=function(t,e,i,s,n,o){ta.clear();const r=Yt(t.b),a=Yt(e.b);t=t.h,e=e.h,ze(Xr,r.length);for(var m=0;m<r.length;m++)t.A(r[m],Xr[m]);for(ze($r,a.length),t=0;t<a.length;t++)e.A(a[t],$r[t]);for(ze(Qr,r.length*a.length),t=0;t<r.length;t++)for(e=Xr[t],m=0;m<a.length;m++){const i=Qr[t*a.length+m];h(i,e,$r[m]),i.V()||(i.normalize(),ta.add(i))}return pe(i,s,ta.buffer,ta.length,n,o)},Je=function(t,e,i){const n=i.f;return i.transform.A(_a,pa),y(t.c,pa),t=e.D.i(e.o),0>=pa.i(e.o)-t?null:(W(pa,e.D,e.I,e.G,fa),t=c(pa,fa),(i=i.b.b-t)<=-n+Number.EPSILON?null:(s(da,fa,pa),da.normalize(),[we(e,fa,da,i)]))},He=function(t,e,i){var o=i.f;if(ya.set(0,i.b.f,0),va.set(0,-i.b.f,0),y(i.transform,ya),y(i.transform,va),y(t.c,ya),y(t.c,va),s(ga,ya,va),ga.normalize(),t=e.D.i(e.o),ya.i(e.o)<t||va.i(e.o)<t)return null;var r=e.D,a=e.I,h=e.G;t=G(r,a,ya,va,xa,Aa);var c=G(a,h,ya,va,Ss,Ls);return c+1e-5<t&&(t=c,xa.l(Ss),Aa.l(Ls)),(c=G(h,r,ya,va,Ss,Ls))+1e-5<t&&(t=c,xa.l(Ss),Aa.l(Ls)),W(ya,r,a,h,Ss),(c=m(ya,Ss))+1e-5<t&&(t=c,xa.l(Ss),Aa.l(ya)),W(va,r,a,h,Ss),(r=m(va,Ss))+1e-5<t&&(t=r,xa.l(Ss),Aa.l(va)),t=Math.sqrt(t),(i=i.b.b-t)<=-o+Number.EPSILON?null:(s(Ma,xa,Aa),Ma.normalize(),o=ga.i(e.o),1e-5>Math.abs(o)&&Oe(e,ya,va,wa,Ba,t)?(n(xa,e.o,-t),xa.add(wa),s(Ma,xa,wa),Ma.normalize(),o=we(e,xa,Ma,i),n(ba,e.o,-t),ba.add(Ba),s(Ca,ba,Ba),Ca.normalize(),e=we(e,ba,Ca,i),o.c<e.c?(lm(e.g,e),[o]):e.c<o.c?(lm(o.g,o),[e]):[o,e]):[we(e,xa,Ma,i)])},Ue=function(t,i,s){let n=0,o=s.a;do{Pa.length===n&&Pa.push(new e),t.transform.A(o.a.position,Pa[n]),y(i.c,Pa[n]),n++,o=o.b}while(o!==s.a);return n},Ye=function(t,e,i,s){const o=i.f;if(!s.Ra){s.Ra=Le(i,za),s.ob=Jt(i.b).length;for(var r=0;r<s.ob;r++)y(t.c,s.Ra[r])}if(!s.Qa)for(s.Qa=Se(i,Ia),s.nb=Ut(i.b).length,r=0;r<s.nb;r++)t.c.U(s.Qa[r]);var a=[e.D,e.G,e.I];48>=Jt(i.b).length?((r=Xi(cm.ia)).J(i,s.Ra,s.ob),mm[cm.ia].push(r)):((r=Xi(cm.wa)).J(i,t.transform,t.c),mm[cm.wa].push(r));var h=Xi(cm.ia);if(h.J(t,a,a.length),mm[cm.ia].push(h),0===(s=pe(h,r,s.Qa,s.nb,Sa,o)))return $i(),null;if(0===(r=pe(r,h,[e.o],1,La,o)))return $i(),null;if(s-1e-5<r){s=!0,r=Sa,Va.l(Sa),v(t.transform,Sa,Oa),i.c.U(Oa),h=Pe(Oa,i);var m=Ue(i,t,h);h=Pa,t=a,i=a.length}else s=!1,r=La,n(Va,La,-1),h=a,m=a.length,v(t.transform,e.o,Oa),i.c.U(Oa),a=ke(Oa,i),i=Ue(i,t,a),t=Pa;if(0===(t=Ie(t,i,h,m,r)).length)return $i(),null;for(i=[],a=h[0].i(r),h=0;h<t.length;h++){const c=(m=t[h]).i(r)-a;c>o||(s||(n(ka,r,c),m.add(ka)),m=we(e,m,Va,-c),i.push(m))}return $i(),i},We=function(t,e){return 1e-5<Math.abs(e.b-t.b)?e.b-t.b:t.c!==e.c?t.c-e.c:1e-5<Math.abs(t.a.x-e.a.x)?t.a.x-e.a.x:1e-5<Math.abs(t.a.y-e.a.y)?t.a.y-e.a.y:t.a.z-e.a.z},Ge=function(t,e,s,o,r){for(let a=0;a<s.length;a++){const h=s[a],m=Xi(cm.O);m.h=t,m.j=e,o&&(m.s=!0),v(t.transform,h.o,m.c),m.c.scale(-1),m.g=h.b,t.transform.A(h.a,m.b),n(m.a,h.o,h.b),m.a.add(m.b),i(m.f,m.b,m.a),m.f.scale(.5),m.b.l(h.a),y(m.j.c,m.a),r.add(m),lm(h.g,h)}},Ke=function(t,e,i,s,n){let o=t,r=e;8!==t.b.Y&&(o=e,r=t);var a=r.f;Ta.transform(r.j,o.c);var h={};t=[],e=[];var m=[],c=gt(o.b);do{if(B(c.a,Ta,a))if(c.b){var u=i(o,c.b,r,h);if(c=m.pop(),null!==u){for(var _=0;_<u.length;_++){const i=u[_];0===i.c?t.push(i):e.push(i)}if(s)break}}else m.push(c.f),c=c.g;else c=m.pop()}while(c);if(0!==t.length||0!==e.length)if(s)Ge(o,r,0!==t.length?t:e,s,n);else{if(e.sort(We),0!==e.length){for(i=new Set,a=0;a<t.length;a++)h=t[a],i.add(h.f.D),i.add(h.f.I),i.add(h.f.G);for(_=a=null,h=0;h<e.length;h++)u=(c=1===(m=e[h]).c?i.has(m.j)&&i.has(m.h):i.has(m.a))&&!!a&&1e-5>Math.abs(a.b-m.b),_=!!_&&1e-5>Math.abs(_.b-m.b)&&l(_.a,m.a)&&l(_.o,m.o),i.add(m.f.D),i.add(m.f.I),i.add(m.f.G),_||c&&!u?lm(m.g,m):(t.push(m),a=m),_=m}0!==t.length&&Ge(o,r,t,s,n)}},Ze=function(){this.a=new Ft,this.b=new _n},Xe=function(t,e,i,s){var n=e,o=i;if(8&(n.a|o.a))n=!1;else if(n.a&o.a&65536){var r=$a;n=!(0!==r.g.size&&r.g.has(Math.min(n.id,o.id)+(Math.max(n.id,o.id)<<16))||0===eo[(7&n.a)+(n.b.N?16:8)][(7&o.a)+(o.b.N?16:8)]||(n.b.f&o.b.j)===n.b.f&&(o.b.f&n.b.j)===o.b.f)}else n=!0;if(n)for(e.id>i.id&&(n=e,e=i,i=n),e=Oi(e),i=Oi(i),n=0;n<e.length;n++)for(o=e.buffer[n],r=0;r<i.length;r++)t.c(o,i.buffer[r],s)},$e=function(){this.b=Ki(35),this.g=null,this.a=this.f=this.c=0;const t=nm;t[this.b+3]=-1/0,t[this.b+4]=1/0},Qe=function(t,e,i){const s=nm;for(t=t.b+11;e<i;e++)s[t+e]=0},ti=function(){this.active=!1,this.a=null,this.j=!1,this.b=null,this.m=!1,this.H=this.C=this.B=-0,this.c=[],this.s=-0,this.L=this.F=1/0,this.h=this.g=1,this.f=null,this.v=!1},ei=function(t){t.active=!1,t.a=null,t.j=!1,t.b=null,t.m=!1,t.g=1,t.h=1,t.B=0,t.C=0,t.H=0;for(let e=0;e<t.c.length;e++)t.c[e].Xa();t.s=0,t.F=1/0,t.L=1/0,t.f=null},ii=function(t){t.a&&1&t.a.a&&t.a.M(!0),t.b&&1&t.b.a&&t.b.M(!0)},si=function(t){const e=t.a,i=t.b;e&&i&&_i(e,i,t.v)},ni=function(){ti.call(this),this.c.push(new $e),this.K=null},oi=function(){ti.call(this),this.c.push(new $e,new $e),this.K=null,this.P=0},ri=function(){this.c=new _n,this.b=new _n,this.a=new _n,this.f=10},ai=function(t,e){e.f=t,e.a&&hi(t,e,e.a),e.b&&hi(t,e,e.b)},hi=function(t,e,i){t=t.c,i=i.id,t.length<=i&&t.Sa(i+1,null);let s=t.buffer[i];null===s&&(s=new _n,t.buffer[i]=s),s.add(e)},mi=function(t,e){const i=e.a,s=e.b;t=t.c.buffer,i&&st(t[i.id],e),s&&st(t[s.id],e)},ci=function(){this.h=this.j=this.g=this.c=this.f=this.b=null},li=function(){this.a=new St,this.c=new Ze,this.m=new ci,this.b=new ri,this.f=[],this.s=new e(0,-9.8,0),this.j=new Uint32Array(32),this.h=new Set,this.g=new Set},ui=function(t,e){var i=$a;return 0!==i.h.size&&i.h.has(Math.min(t.c,e.c)+(Math.max(t.c,e.c)<<16))},_i=function(t,e,i){var s=$a;const n=Math.min(t.id,e.id);t=Math.max(t.id,e.id),i?s.g.add(n+(t<<16)):0!==s.g.size&&s.g.delete(n+(t<<16))},pi=function(t){C.call(this,2),this.body=t,this.a=[],this.N=!1,this.j=this.f=0,this.h=new e,this.c=new T,this.b=0},di=function(t){t.a.length=0,t.g.min.set(0,0,0),t.g.max.set(0,0,0),t.N=!1,t.f=0,t.j=0,D(t.c),t.b=0},fi=function(t,e){for(let i=0;i<t.a.length;i++)if(t.a[i].a.c===e)return t.a[i];return null},yi=function(t){return 4&t.b||2&t.b&&gi(t),t.h},vi=function(t){t.b|=1,t.b|=2},gi=function(t){t.b&=-3;var e=t.body;e=1&e.a?e.B:1/0,D(t.c);for(var i=0,s=0;s<t.a.length;s++)t.a[s].a.N||i++;if(0===i||1/0===e)(i=t.c.a).data[0]=i.data[4]=i.data[8]=1,t.c.c=e,t.h.set(0,0,0);else{for(i=0;i<t.a.length;i++)(s=t.a[i]).a.N||(s.a.ua(Ah),Ah.transform(s.c,s.f),t.c.add(Ah));t.c.scale(e),4&t.b?(n(wh,t.h,-1),E(t.c,wh)):(t.h.l(t.c.b),t=t.c,n(As,t.b,-1),E(t,As),F(t))}},xi=function(t,i){this.id=t,this.b=new pi(this),this.Fa=new x,this.C=new x,this.Za=-0,this.B=i||1/0,this.xa=1/i,this.a=17,this.H=Ih,this.F=new e,this.v=new e,this.s=new _(0,0,0,1),this.g=new e,this.L=new e,this.f=new e,this.K=new e,this.R=7+Number.EPSILON,this.ya=new d,f(this.ya),this.Ga=new d,f(this.Ga),this.P=new I,this.h=this.c=this.$a=this.bb=0,this.$=.1,this.m=new e,this.j=new e,this.Ha=Ki(6),this.cache=new Ph(this),this._fauxComponent=this._component=null},bi=function(t){return 8192&t.a?(t.a&=-8193,kh.pa(t.s,t.v),t.Fa.transform(function(t){if(!(1&t.b))return t.g;t.b&=-2;const e=t.g;if(e.min.x=e.min.y=e.min.z=1/0,e.max.x=e.max.y=e.max.z=-1/0,0===t.a.length)return e.min.x=e.min.y=e.min.z=0,e.max.x=e.max.y=e.max.z=0,e;for(let i=0;i<t.a.length;i++){const s=t.a[i];e.min.x=Math.min(e.min.x,s.b.min.x),e.min.y=Math.min(e.min.y,s.b.min.y),e.min.z=Math.min(e.min.z,s.b.min.z),e.max.x=Math.max(e.max.x,s.b.max.x),e.max.y=Math.max(e.max.y,s.b.max.y),e.max.z=Math.max(e.max.z,s.b.max.z)}return e}(t.b),kh),t.Fa):t.Fa},Ai=function(t){return 4096&t.a&&ki(t),t.ya},wi=function(t){return 4096&t.a&&ki(t),t.Ga},Bi=function(t,e){(!l(e,t.F)||2048&t.a)&&(t.F.l(e),t.s.A(t.na(),Oh),t.v.l(e),t.v.S(Oh),Ei(t))},Mi=function(t,e){p(e,t.s,Number.EPSILON)||(Th.l(t.W()),t.s.l(e),t.s.normalize(),Ti(t),Bi(t,Th))},Ci=function(t,e){if(t.H===Ih)return bi(t);if(16384&t.a){var s=Kh;n(s,t.m,t.xa),s.add(t.g),s.scale(e),At(t,e,Zh),e=t.W(),Xh.pa(Zh,is),s=bi(t),t.C.l(s),n(Gh,e,-1),A(t.C),t.C.transform(t.C,Xh),i(Gh,e,Kh),A(t.C),b(t.C,t.C,s),t.Za=Math.max(c(t.C.min,s.min),c(t.C.max,s.max)),t.a&=-16385}return t.C},zi=function(t,e){if(1&t.a||(t.a|=512),512&t.a)Vi(t);else{Ii(t,e);var i=!t.f.V();t.g.V()||(n(Dh,t.g,e),Dh.add(t.W()),Bi(t,Dh)),i&&(Rh.l(t.f),(i=Rh.length())*e>Math.PI/4&&(i=Math.PI/4/e),.001>i?Rh.scale(.5*e-e*e*e*.020833333333*i*i):Rh.scale(Math.sin(.5*i*e)/i),jh.x=Rh.x,jh.y=Rh.y,jh.z=Rh.z,jh.w=Math.cos(i*e*.5),jh.multiply(t.s),Mi(t,jh)),t.b.N||(i=!!(512&t.a),5e-6>.5*(o(t.g)+o(t.f))?0<t.$&&(t.$=Math.max(0,t.$-e)):t.M(!0),i||0!==t.$||(t.a|=512)),Vi(t),(e=t.f.length())>t.R&&t.f.scale(t.R/e)}},Ii=function(t,e){n(qh,t.m,t.xa),t.g.add(qh),t.aa().A(t.j,qh),t.f.add(qh);const i=Math.max(0,1-t.bb*e);t.g.scale(i),t.L.scale(i),e=Math.max(0,1-t.$a*e),t.f.scale(e),t.K.scale(e),t.a|=16384},Si=function(t){t.h&&(wi(t).U(t.f),t.f.x*=1&t.h?0:1,t.f.y*=2&t.h?0:1,t.f.z*=4&t.h?0:1,Ai(t).U(t.f));const e=t.f.length();e>t.R&&t.f.scale(t.R/e)},Li=function(t){t.c&&(t.g.x*=1&t.c?0:1,t.g.y*=2&t.c?0:1,t.g.z*=4&t.c?0:1)},Pi=function(t){t.g.set(0,0,0),t.f.set(0,0,0),t.m.set(0,0,0),t.j.set(0,0,0),t.a|=16384},ki=function(t){t.ya.pa(t.s,t.W()),g(t.ya,t.Ga),t.a&=-4097},Vi=function(t){t.m.set(0,0,0),t.j.set(0,0,0),t.g.S(t.L),t.f.S(t.K),t.L.set(0,0,0),t.K.set(0,0,0);const e=nm,i=t.Ha;for(let t=0;6>t;t++)e[i+t]=0;t.a=32&t.a?64|t.a:-65&t.a,t.a&=-33,t.a&=-129,t.a&=-257,t.a|=16384},Oi=function(t){if(32768&t.a)for(var e=t.cache;e.a.length;)Ji(et(e.a));return t.a&=-32769,65536&(t=t.cache).body.a?(t.a.length!==t.body.b.a.length&&Fi(t,t.a),t=t.a):(e=new _n,Fi(t,e),t=e),t},Ti=function(t){t.a|=2048,Ei(t)},Ei=function(t){t.a|=1024,t.a|=4096,t.a|=8192,t.a|=16384,t.a|=32768,t.M()},Fi=function(t,e){const i=t.body.b.a;for(let s=0;s<i.length;s++){const n=Xi(cm.za);Di(n,t.body,i[s]),e.add(n)}},qi=function(){this.g=null,this.id="",this.m=this.b=null,this.j=new x,this.position=new e,this.h=new _,this.transform=new d,this.c=new d,this.a=0,this.f=-0,this.cache=new $h(this)},Di=function(t,e,i){t.g=e,t.id=`${e.id}->${e.b.a.indexOf(i)}`,t.b=i.a,t.m=i,Ri(t)},Ri=function(t){var e=t.b;s(Qh,t.m.f,t.g.na()),Ai(t.g).A(Qh,t.position);var i=t.h,n=t.g.s,o=t.m.c;i.x=n.x*o.w+n.w*o.x+n.y*o.z-n.z*o.y,i.y=n.y*o.w+n.w*o.y+n.z*o.x-n.x*o.z,i.z=n.z*o.w+n.w*o.z+n.x*o.y-n.y*o.x,i.w=n.w*o.w-n.x*o.x-n.y*o.y-n.z*o.z,t.transform.pa(t.h,t.position),g(t.transform,t.c),t.j.transform(e.g,t.transform),t.a=t.g.a,e=t.g,t.f=2!==e.H?0:e.Za},ji=function(t){return(t=t.cache).b?t=t.b:65536&t.a.g.a?(t.b=Ve(t.a,t.g),t=t.b):t=Ve(t.a,t.g),t},Ni=function(t){return(t=t.cache).c?t=t.f:(65536&t.a.g.a&&(t.c=!0),t=Se(t.a,t.f)),t},Ji=function(t){var e=t.cache;null!==e.b&&(e.b.b(),e.b=null),e.c=!1,lm(cm.za,t)},Hi=function(){this.B=this.C=this.H=this.v=this.j=this.h=null,this.s=!1,this.f=new e,this.b=new e,this.a=new e,this.c=new e,this.P=this.R=this.g=0,this.L=this.K=null,this.m=0,this.$=new e},Ui=function(t){var e=t.v;t.v=t.H,t.H=e,e=t.C,t.C=t.B,t.B=e,e=t.b,t.b=t.a,t.a=e,t.c.scale(-1)},Yi=function(t){s(t.$,null==t.H?is:t.H.g,null==t.v?is:t.v.g)},Wi=function(t){const e=Xi(cm.O);return e.h=t.h,e.j=t.j,e.v=t.v,e.H=t.H,e.C=t.C,e.B=t.B,e.s=t.s,e.f.l(t.f),e.b.l(t.b),e.a.l(t.a),e.c.l(t.c),e.g=t.g,e.R=t.R,e.P=t.P,e.m=t.m,e},Gi=function(t,e){am[t][hm[t]-1]=e,hm[t]--},Ki=function(t){const e=om;if(t=e+t,nm.length>t)return om=t,e;throw Error("Pre-allocated buffer overflow: memory leak?")},Zi=function(t,e){if(rm.length!==t||am.length!==t)throw Error("Items should be initialized in ascending order");rm.push(e),am.push([]),hm.push(0),mm.push([])},Xi=function(t){const e=hm[t],i=am[t];if(e===i.length)for(let e=0;64>e;e++)i.push(rm[t]());return hm[t]++,i[e]},$i=function(){for(let t=0;t<mm.length;t++)for(;0!==mm[t].length;)Gi(t,mm[t].pop())},Qi=function(t,e){Object.keys(e).forEach(i=>{const s=e[i];s!==i&&Object.defineProperty(t,s,{get(){return this[i]},set(t){this[i]=t}})})},ts=function(t,e,i){if(t[i]!==e){if(t[i])throw Error('Name "'+i+'" was taken after minification');t[i]=e}},es=function(t){0>t.name.length&&(t.name="")};e.prototype={set:function(t,e,i){this.x=t,this.y=e,this.z=i},l:function(t){this.x=t.x,this.y=t.y,this.z=t.z},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},S:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},multiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z},scale:function(t){this.x*=t,this.y*=t,this.z*=t},length:function(){return Math.sqrt(o(this))},normalize:function(t=1e-5){const e=this.length();return e<t?this.z=this.y=this.x=0:(t=1/e,this.x*=t,this.y*=t,this.z*=t),e},i:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},V:function(t=1e-5){return Math.abs(this.x)<t&&Math.abs(this.y)<t&&Math.abs(this.z)<t}};var is=new e(0,0,0),ss=new e(1,0,0),ns=new e(0,1,0),os=new e(0,0,1),rs=new e;_.prototype={set:function(t,e,i,s){this.x=t,this.y=e,this.z=i,this.w=s},l:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},toString:function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},multiply:function(t){const e=this.x,i=this.y,s=this.z,n=this.w,o=t.x,r=t.y,a=t.z;t=t.w,this.x=e*t+n*o+i*a-s*r,this.y=i*t+n*r+s*o-e*a,this.z=s*t+n*a+e*r-i*o,this.w=n*t-e*o-i*r-s*a},normalize:function(){let t=this.length();1e-5>t?this.x=this.y=this.z=this.w=0:(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t)},a:function(t){var e=t.x;const i=t.y,s=t.z,n=this.x,o=this.y,r=this.z,a=this.w,h=a*e+o*s-r*i,m=a*i+r*e-n*s,c=a*s+n*i-o*e;e=-n*e-o*i-r*s,t.x=h*a+e*-n+m*-r-c*-o,t.y=m*a+e*-o+c*-n-h*-r,t.z=c*a+e*-r+h*-o-m*-n},A:function(t,e){var i=t.x;const s=t.y,n=t.z;t=this.x;const o=this.y,r=this.z,a=this.w,h=a*i+o*n-r*s,m=a*s+r*i-t*n,c=a*n+t*s-o*i;i=-t*i-o*s-r*n,e.x=h*a+i*-t+m*-r-c*-o,e.y=m*a+i*-o+c*-t-h*-r,e.z=c*a+i*-r+h*-o-m*-t},length:function(){const t=this.x,e=this.y,i=this.z,s=this.w;return Math.sqrt(t*t+e*e+i*i+s*s)},V:function(){return(0===this.x||1e-5>Math.abs(this.x))&&(0===this.y||1e-5>Math.abs(this.y))&&(0===this.z||1e-5>Math.abs(this.z))}};var as=new _;d.prototype={l:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.v=t.v,this.f=t.f,this.g=t.g,this.h=t.h,this.B=t.B,this.j=t.j,this.m=t.m,this.s=t.s,this.C=t.C,this.F=t.F,this.H=t.H,this.K=t.K,this.L=t.L},pa:function(t,e){var i=t.x+t.x,s=t.y+t.y;const n=t.z+t.z,o=t.x*i,r=t.x*s,a=t.x*n,h=t.y*s,m=t.y*n,c=t.z*n;i*=t.w,s*=t.w,t=t.w*n,this.a=1-(h+c),this.f=r+t,this.j=a-s,this.F=0,this.b=r-t,this.g=1-(o+c),this.m=m+i,this.H=0,this.c=a+s,this.h=m-i,this.s=1-(o+h),this.K=0,this.v=e.x,this.B=e.y,this.C=e.z,this.L=1},A:function(t,e){e.x=this.a*t.x+this.b*t.y+this.c*t.z+this.v,e.y=this.f*t.x+this.g*t.y+this.h*t.z+this.B,e.z=this.j*t.x+this.m*t.y+this.s*t.z+this.C},U:function(t){const e=t.x,i=t.y,s=t.z;t.x=this.a*e+this.b*i+this.c*s,t.y=this.f*e+this.g*i+this.h*s,t.z=this.j*e+this.m*i+this.s*s},multiply:function(t){const e=this.a,i=this.f,s=this.j,n=this.F,o=this.b,r=this.g,a=this.m,h=this.H,m=this.c,c=this.h,l=this.s,u=this.K,_=this.v,p=this.B,d=this.C,f=this.L;let y=t.a,v=t.f,g=t.j,x=t.F;this.a=y*e+v*o+g*m+x*_,this.f=y*i+v*r+g*c+x*p,this.j=y*s+v*a+g*l+x*d,this.F=y*n+v*h+g*u+x*f,y=t.b,v=t.g,g=t.m,x=t.H,this.b=y*e+v*o+g*m+x*_,this.g=y*i+v*r+g*c+x*p,this.m=y*s+v*a+g*l+x*d,this.H=y*n+v*h+g*u+x*f,y=t.c,v=t.h,g=t.s,x=t.K,this.c=y*e+v*o+g*m+x*_,this.h=y*i+v*r+g*c+x*p,this.s=y*s+v*a+g*l+x*d,this.K=y*n+v*h+g*u+x*f,y=t.v,v=t.B,g=t.C,x=t.L,this.v=y*e+v*o+g*m+x*_,this.B=y*i+v*r+g*c+x*p,this.C=y*s+v*a+g*l+x*d,this.L=y*n+v*h+g*u+x*f}},Object.defineProperty(d.prototype,"data",{get:function(){return[this.a,this.f,this.j,this.F,this.b,this.g,this.m,this.H,this.c,this.h,this.s,this.K,this.v,this.B,this.C,this.L]}}),x.prototype={l:function(t){this.min.x=t.min.x,this.min.y=t.min.y,this.min.z=t.min.z,this.max.x=t.max.x,this.max.y=t.max.y,this.max.z=t.max.z},transform:function(t,e){for(hs.set(0,0,0),e.A(hs,ms),cs[0]=t.min.x,cs[1]=t.min.y,cs[2]=t.min.z,ls[0]=t.max.x,ls[1]=t.max.y,ls[2]=t.max.z,us[0]=ms.x,us[1]=ms.y,us[2]=ms.z,_s[0]=ms.x,_s[1]=ms.y,_s[2]=ms.z,ps[0]=e.a,ps[1]=e.b,ps[2]=e.c,ps[3]=e.f,ps[4]=e.g,ps[5]=e.h,ps[6]=e.j,ps[7]=e.m,ps[8]=e.s,t=0;3>t;t++)for(e=0;3>e;e++){const i=ps[3*t+e]*cs[e],s=ps[3*t+e]*ls[e];i<s?(us[t]+=i,_s[t]+=s):(us[t]+=s,_s[t]+=i)}this.min.set(us[0],us[1],us[2]),this.max.set(_s[0],_s[1],_s[2])},Sa:function(t){0<t.x?this.max.x+=t.x:this.min.x+=t.x,0<t.y?this.max.y+=t.y:this.min.y+=t.y,0<t.z?this.max.z+=t.z:this.min.z+=t.z}};var hs=new e,ms=new e,cs=[-0,-0,-0],ls=[-0,-0,-0],us=[-0,-0,-0],_s=[-0,-0,-0],ps=[-0,-0,-0,-0,-0,-0,-0,-0,-0],ds=new e;I.prototype={set(t,e,i,s,n,o,r,a,h){this.data[0]=t,this.data[1]=s,this.data[2]=r,this.data[3]=e,this.data[4]=n,this.data[5]=a,this.data[6]=i,this.data[7]=o,this.data[8]=h},A:function(t,e){e.x=this.data[0]*t.x+this.data[3]*t.y+this.data[6]*t.z,e.y=this.data[1]*t.x+this.data[4]*t.y+this.data[7]*t.z,e.z=this.data[2]*t.x+this.data[5]*t.y+this.data[8]*t.z},add(t){for(let e=0;9>e;e++)this.data[e]+=t.data[e]},S(t){for(let e=0;9>e;e++)this.data[e]-=t.data[e]},multiply:function(t){const e=this.data[0],i=this.data[3],s=this.data[6],n=this.data[1],o=this.data[4],r=this.data[7],a=this.data[2],h=this.data[5],m=this.data[8],c=t.data[0],l=t.data[3],u=t.data[6],_=t.data[1],p=t.data[4],d=t.data[7],f=t.data[2],y=t.data[5];t=t.data[8],this.data[0]=c*e+_*i+f*s,this.data[1]=c*n+_*o+f*r,this.data[2]=c*a+_*h+f*m,this.data[3]=l*e+p*i+y*s,this.data[4]=l*n+p*o+y*r,this.data[5]=l*a+p*h+y*m,this.data[6]=u*e+d*i+t*s,this.data[7]=u*n+d*o+t*r,this.data[8]=u*a+d*h+t*m},get(t,e){return this.data[3*e+t]},l:function(t){for(let e=0;9>e;e++)this.data[e]=t.data[e]}},T.prototype={transform(t,e){S(fs,t),k(this.a,fs,this.a);{var i=fs;const t=i.data[3],e=i.data[6],s=i.data[1],n=i.data[4],o=i.data[7],r=i.data[2],a=i.data[5],h=i.data[8];i.data[0]=i.data[0],i.data[1]=t,i.data[2]=e,i.data[3]=s,i.data[4]=n,i.data[5]=o,i.data[6]=r,i.data[7]=a,i.data[8]=h}this.a.multiply(fs),t.a(this.b),F(this),E(this,e)},add(t){const e=this.c+t.c;n(xs,this.b,this.c),n(bs,t.b,t.c),i(this.b,xs,bs),this.b.scale(1/e),this.c=e,this.a.add(t.a),F(this)},scale(t){t/=this.c,V(this.a,t),this.c*=t,F(this)}};var fs=new I,ys=new I,vs=new I,gs=new e,xs=new e,bs=new e,As=new e,ws=new I,Bs=new I,Ms=new _;(R.prototype=Object.create(C.prototype)).ua=function(){throw Error("Not implemented")};var Cs=new e,zs=new e,Is=new e,Ss=new e,Ls=new e,Ps=new e,ks=new e,Vs=new e,Os=new e,Ts=new e,Es=new e,Fs=new e,qs=new e,Ds=new e,Rs=new e,js=new e,Ns=new e,Js=new e,Hs=new e,Us=new e,Ys=new e,Ws=new e,Gs=new e,Ks=new e,Zs=new e,Xs=new e,$s=new e,Qs=new e,tn=new e,en=new e,sn=new e,nn=new e;(Q.prototype=Object.create(C.prototype)).T=function(t,e){let i=-1/0,s=t.i(this.D);s>i&&(e.l(this.D),i=s),s=t.i(this.I),s>i&&(e.l(this.I),i=s),s=t.i(this.G),s>i&&e.l(this.G)};var on=new e,rn=new e,an=new e,hn=new e,mn=new e,cn=new e,ln=new e,un=new e;tt.prototype={c(){lm(cm.ha,this)}};var _n=class{constructor(){this.buffer=[],this.length=0}add(t){this.buffer.length>this.length?this.buffer[this.length]=t:this.buffer.push(t),this.length++}Sa(t,e){if(!(this.length>=t))if(this.buffer.length>=t)this.length=t;else for(this.length=this.buffer.length;this.length<t;)this.add(e)}fill(t){this.buffer.fill(t)}indexOf(t){for(let e=0;e<this.length;e++)if(this.buffer[e]===t)return e;return-1}clear(){this.length=0}},pn=null,dn=null,fn=null,yn=class{constructor(){this.ca=new e,this.da=new e,this.u=new e,this.a={ra:{Yb:new e}}}ra(t,e,i){const o=this.a.ra.Yb;t.T(i,this.ca),n(o,i,-1),e.T(o,this.da),s(this.u,this.ca,this.da)}};pn=new class{constructor(){this.a=new yn,this.b=new yn,this.c={sa:{yc:new e},X:{ea:new e,Va:new e}}}J(t,e){nt(this.a,t),nt(this.b,e)}sa(t){Y(this.a.u,this.b.u,is,t)}ma(){return this}X(t,e,i){const s=this.c.X.ea,o=this.c.X.Va,r=this.b.u,a=this.a.ca,h=this.a.da,m=this.b.ca,c=this.b.da;K(t,this.a.u,r,r,s),n(e,a,s.x),n(o,m,s.y),e.add(o),n(i,h,s.x),n(o,c,s.y),i.add(o)}fa(t){const e=dn;return e.J(this.a,this.b,t),e}},dn=new class{constructor(){this.a=new yn,this.b=new yn,this.c=new yn,this.o=new e,this.f={J:{Na:new e,Nb:new e},ma:{ea:new e},X:{ea:new e,Va:new e},fa:{Na:new e,Gb:new e,Ob:new e,Pb:new e}}}J(t,e,i){const n=this.f.J.Na,o=this.f.J.Nb;nt(this.a,t),nt(this.b,e),nt(this.c,i),s(n,e.u,t.u),s(o,i.u,t.u),h(this.o,n,o)}sa(t){W(is,this.a.u,this.b.u,this.c.u,t)}ma(t){var e=this.f.ma.ea;K(t,this.a.u,this.b.u,this.c.u,e),t=1e-5<Math.abs(e.x);var i=1e-5<Math.abs(e.y);return e=1e-5<Math.abs(e.z),t&&i&&e?this:(e=pn,t?i?(t=this.a,i=this.b):(t=this.a,i=this.c):(t=this.b,i=this.c),e.J(t,i),e)}X(t,e,i){const s=this.f.X.ea,o=this.f.X.Va,r=this.a.ca,a=this.a.da,h=this.b.ca,m=this.b.da,c=this.c.ca,l=this.c.da;K(t,this.a.u,this.b.u,this.c.u,s),n(e,r,s.x),n(o,h,s.y),e.add(o),n(o,c,s.z),e.add(o),n(i,a,s.x),n(o,m,s.y),i.add(o),n(o,l,s.z),i.add(o)}fa(t){var e=this.f.fa.Na;const i=this.f.fa.Gb;var n=this.f.fa.Ob,o=this.f.fa.Pb;const r=this.a.u,a=this.b.u;var m=this.c.u;return 1e-5>Math.abs(r.i(this.o)-t.u.i(this.o))?(s(e,r,a),s(i,m,r),s(n,a,m),h(o,this.o,e),o.normalize(),e=1e-5<H(a,o,t.u),h(o,this.o,n),o.normalize(),n=1e-5<H(m,o,t.u),nt(e?this.c:n?this.a:this.b,t),this):(n=fn,o=this.a,m=this.b,e=this.c,t.u.i(this.o)>o.u.i(this.o)?n.J(o,m,e,t):n.J(o,m,t,e),n)}},fn=new class{constructor(){this.a=new yn,this.g=new yn,this.b=new yn,this.f=new yn,this.c=-1}J(t,e,i,s){nt(this.a,t),nt(this.g,e),nt(this.b,i),nt(this.f,s),t=this.a.u,e=this.g.u,i=this.b.u,s=this.f.u,t=!(l(t,e)||l(t,i)||l(t,s)||l(e,i)||l(e,s)||l(i,s)),this.c=-1}sa(t){{var e=this.a.u,i=this.g.u,n=this.b.u,o=this.f.u;s(Ns,i,o),s(Js,e,o),s(Hs,n,o);let a=-1;var r=!0;let c=1/0;h(Rs,Hs,Js),Rs.i(o)<=Rs.i(is)&&(W(is,o,n,e,js),(r=m(is,js))<c&&(t.l(js),c=r,a=0),r=!1),h(Rs,Ns,Hs),Rs.i(o)<=Rs.i(is)&&(W(is,o,i,n,js),(r=m(is,js))<c&&(t.l(js),c=r,a=1),r=!1),h(Rs,Js,Ns),Rs.i(o)<=Rs.i(is)&&(W(is,o,e,i,js),(o=m(is,js))<c&&(t.l(js),c=o,a=2),r=!1),s(Ns,n,e),s(Js,i,e),h(Rs,Ns,Js),Rs.i(e)<=Rs.i(is)&&(W(is,e,n,i,js),m(is,js)<c&&(t.l(js),a=3),r=!1),r&&t.l(is),t=a}this.c=t}ma(t){let e,i,s;0===this.c?(e=this.f,i=this.b,s=this.a):1===this.c?(e=this.f,i=this.g,s=this.b):(2===this.c?(e=this.f,i=this.a):(e=this.a,i=this.b),s=this.g);const n=dn;return n.J(e,i,s),n.ma(t)}X(){throw Error("Cannot extract coordinates from 3-simplex: should be simplified to 2-simplex first")}fa(){throw Error("Cannot extend 3-simplex: should be simplified to 2-simplex first")}};var vn=new e,gn=new e,xn=new e,bn=new yn,An=new yn,wn=new yn,Bn=new class{constructor(){this.position=new e}J(t){this.position.l(t)}T(t,e){e.l(this.position)}},Mn=new e,Cn=new class{constructor(){this.position=new e,this.b=new e,this.a=new e}J(t,e){i(this.position,t,e),this.position.scale(.5),this.b.l(t),this.a.l(e)}T(t,e){this.b.i(t)>(t=this.a.i(t))?e.l(this.b):e.l(this.a)}},zn=new class{constructor(){this.D=new e,this.I=new e,this.G=new e,this.position=new e}J(t,e,s){this.D.l(t),this.I.l(e),this.G.l(s),i(this.position,this.D,this.I),this.position.add(this.G),this.position.scale(1/3)}T(t,e){const i=this.D.i(t),s=this.I.i(t);t=this.G.i(t),i>s&&i>t?e.l(this.D):s>t?e.l(this.I):e.l(this.G)}};rt.prototype.get=function(t){if(t>=this.b-this.a)throw Error("Slice overflow");return this.buffer[this.a+t]},rt.prototype.indexOf=function(t){for(let e=0;e<this.b-this.a;e++)if(this.get(e)===t)return e;return-1},at.prototype={};var In=new x;(yt.prototype=Object.create(R.prototype)).v=function(){const t=new yt(this.c,this.b,this.s,this.a,this.N);return t.j=this.j,t.f=vt(this),t.h=gt(this),t},yt.prototype.T=function(){throw Error("Not implemented for the mesh shape")},yt.prototype.va=function(t,e){let i=null;const o=[gt(this)];for(;0<o.length;){var r=o.pop();if(M(r.a,t,e))if(r.b){r=r.b;var a=t,m=e;s(an,r.I,r.D),s(hn,r.G,r.D),h(mn,an,hn),s(cn,m,a);var c=-cn.i(mn);if(0>=c)r=null;else if(s(ln,a,r.D),0>(m=ln.i(mn)/c)||1<m)r=null;else{h(un,ln,cn);var l=hn.i(un)/c;1.00001<l+(c=-an.i(un)/c)||0>l||0>c?r=null:((l=Xi(cm.ha)).b=r,l.a=m*cn.length(),n(l.u,cn,m),l.u.add(a),l.o.l(r.o),K(l.u,r.D,r.I,r.G,l.ea),l.g=r.a,r=l)}r&&(!i||i.a>r.a)&&(i=r)}else o.push(r.f,r.g)}return i};var Sn=new e,Ln=new e,Pn=new _,kn=new e,Vn=new e,On=new e,Tn=new _n,En=new _n,Fn=new _n,qn=new e,Dn=new _n,Rn=new _n,jn=new _n,Nn=class{constructor(){this.g=this.c=1/0,this.a=null,this.f=1/0}},Jn=new e,Hn=new e,Un=new e,Yn=class extends Nn{J(t){this.a=t}h(t,e,i){return ot(t,this.a,e,i)}j(t){return w(this.a.j,t)}},Wn=class extends Nn{constructor(){super(),this.D=new e,this.I=new e,this.G=new e,this.b=new x}J(t,e){e.transform.A(t.D,this.D),e.transform.A(t.I,this.I),e.transform.A(t.G,this.G),this.b.min.x=Math.min(this.D.x,this.I.x,this.G.x),this.b.min.y=Math.min(this.D.y,this.I.y,this.G.y),this.b.min.z=Math.min(this.D.z,this.I.z,this.G.z),this.b.max.x=Math.max(this.D.x,this.I.x,this.G.x),this.b.max.y=Math.max(this.D.y,this.I.y,this.G.y),this.b.max.z=Math.max(this.D.z,this.I.z,this.G.z),this.a=e}h(t,e,i){return zn.J(this.D,this.I,this.G),ot(t,zn,e,i)}j(t){return w(this.b,t)}};It.prototype={J(t){this.body=t}},St.prototype.g=function(t){this.c.clear(),this.f.clear();for(var e=0;e<this.a.length;e++){var i=this.a[e],s=t,n=i.body;i.a=bt(n);var o=Ci(n,s);s=o.min,o=o.max;var r=i.buffer;r[0]=s.x,r[1]=s.y,r[2]=s.z,r[3]=o.x,r[4]=o.y,r[5]=o.z,i.c=!!(4&n.a),i.b=!!(512&n.a),i.a=bt(n)}for(this.a.sort(Mt),n=0;n<this.a.length;n++){i=this.a[n];var a=n+1;e=t,s=this.a,o=this.c,r=i.buffer[3];const m=o.length;for(i.a&&(a=0);a<s.length;a++){const t=s[a];if(i!==t){if(t.buffer[0]>=r)break;var h;if(!(h=i.b&&t.b)&&!(h=!i.a&&t.a)&&!(h=i.c&&t.c)){{h=i.buffer;const e=t.buffer;h=h[1]<e[4]&&h[4]>e[1]&&h[2]<e[5]&&h[5]>e[2]}h=!h}h||(o.add(i.body),o.add(t.body))}}i.a&&m!==o.length&&this.h(i.body,e,m,o.length)}},St.prototype.h=function(t,e,i,s){Gn.clear();const n=r(Kn,t.g)*e;if(!(1e-5>n)){e=[];var o=bi(t),a=Ct(o),h=(o=zt(o))-a;if(!(1e-5>h)){for(var m=this.c.buffer;i<s;i+=2){const t=m[i+1];var c=bi(t),l=Ct(c);const s=zt(c);c=.1*Math.max(h,s-l);{var u=a;let t=s;a<l&&(u=l,t=o),u=Math.max(0,u-t)}1e-5<(l=n-u-Math.max(0,Math.min(o,s)-Math.max(a,l)))&&l>c?e.push(t):Gn.add(t)}if(0<e.length){for(s=0;s<Gn.length;s++)e.push(Gn.buffer[s]);e.push(t),this.f.add(e)}}}};var Gn=new _n,Kn=new e,Zn=new e,Xn=new e,$n=new e,Qn=new e,to=new e;const eo={9:{9:2,10:2,12:2,17:1,18:1,20:1},10:{9:2,10:0,12:0,17:1,18:1,20:1},12:{9:2,10:0,12:0,17:1,18:1,20:0},17:{9:1,10:1,12:1,17:1,18:1,20:1},18:{9:1,10:1,12:1,17:1,18:1,20:1},20:{9:1,10:1,12:0,17:1,18:1,20:0}};Rt.prototype={};var io=[1/6,1/24,1/24,1/24,1/60,1/60,1/60,1/120,1/120,1/120],so=new e,no=new e,oo=new e;Nt.prototype=Object.create(R.prototype),t.k=Nt.prototype,t.k.T=function(t,e){if(this.H){const i=this.g.max;e.set(0>t.x?-i.x:i.x,0>t.y?-i.y:i.y,0>t.z?-i.z:i.z)}else t=Zt(this,t),e.l(t.position)},t.k.xb=function(){const t=new Nt(this.c,this.h,this.a,this.H,this.N);return t.j=this.j,t.f=Jt(this),this.v||Gt(this),t.v=this.v,t.b=Ht(this),t.s=Ut(this),t.C=Yt(this),t.F=Wt(this),t.B=$t(this),t},t.k.va=function(t,e){s(ao,e,t),e=0;let i=null;var o=!0;const r=Ht(this);for(let s=0;s<r.length;s++){const n=r[s],a=ce(n,t),h=n.o.i(ao),m=-a/h;if(0<a&&(o=!1),!(1e-5<h))if(-1e-5>h)m>e&&(e=m,i=n);else if(1e-5<a)return null}return o||!i||0>e||1<e?null:((o=Xi(cm.ha)).b=this,o.a=e*ao.length(),n(o.u,ao,e),o.u.add(t),o.o.l(i.o),o)},t.k.ua=function(t){if(this.H){var e=this.g.max,i=e.x,s=e.y,n=e.z;D(t);var o=1/3*(e=8*i*s*n);i*=i,s*=s,n*=n,t.a.set((s+n)*o,0,0,0,(i+n)*o,0,0,0,(i+s)*o),t.c=e}else e=$t(this),D(t),t.a.data[0]=e.a[5]+e.a[6],t.a.data[4]=e.a[4]+e.a[6],t.a.data[8]=e.a[4]+e.a[5],t.a.data[1]=t.a.data[3]=-e.a[7],t.a.data[5]=t.a.data[7]=-e.a[8],t.a.data[2]=t.a.data[6]=-e.a[9],o=e.a[0],t.b.set(e.a[1]/o,e.a[2]/o,e.a[3]/o),t.c=o},t.k.cb=function(){let t=null,e=null;for(var i=0;i<ho.length;i++){for(var n=1/0,o=-1/0,r=0;r<this.h.length;r++){var a=this.h[r].i(ho[i]);a<n?(t=this.h[r],n=a):a>o&&(e=this.h[r],o=a)}if(null!==t&&null!==e&&o>n)break;e=t=null}if(null===t||null===e)throw Error("Degenerate point cloud, either 1D or 2D");for(i=null,n=-1/0,o=0;o<this.h.length;o++)if((r=this.h[o])!==t&&r!==e){a=r;var m=t,c=e;s(Os,m,c),s(Ts,m,a),s(Es,c,a),(a=0>=(a=Ts.i(Os))?Ts.i(Ts):a>=(m=Os.i(Os))?Es.i(Es):Ts.i(Ts)-a*a/m)>n&&(n=a,i=r)}if(null===i||Math.abs(n)<Number.EPSILON)throw Error("Degenerate point cloud in 2D");for(s(co,t,e),s(lo,i,e),h(mo,co,lo),mo.normalize(Number.EPSILON),o=e.i(mo),n=null,r=-1/0,a=0;a<this.h.length;a++)(m=this.h[a])!==t&&m!==e&&m!==i&&(c=Math.abs(mo.i(m)-o))>r&&(r=c,n=m);if(null===n||Math.abs(r)<Number.EPSILON)throw Error("Degenerate point cloud in 2D");r=new re(t),a=new re(e),m=new re(i),c=new re(n);const l=0>n.i(mo)-o;if(o=this.b=[],l)for(o.push(se(r,a,m)),o.push(se(c,a,r)),o.push(se(c,m,a)),o.push(se(c,r,m)),r=0;3>r;r++)a=(r+1)%3,he(ue(o[r+1],1),ue(o[a+1],0)),he(ue(o[r+1],2),ue(o[0],a));else for(o.push(se(r,m,a)),o.push(se(c,r,a)),o.push(se(c,a,m)),o.push(se(c,m,r)),r=0;3>r;r++)he(ue(o[r+1],0),ue(o[(r+1)%3+1],1)),he(ue(o[r+1],2),ue(o[0],(3-r)%3));for(o=0;o<this.h.length;o++)(r=this.h[o])!==t&&r!==e&&r!==i&&r!==n&&ne(new re(r),this.b)},t.k.gb=function(){for(var t=ee(this);null!==t;){var e=t.f,i=t;(t=i.c)[t.indexOf(e)]=t[t.length-1],t.pop(),t=[],ie(this,e.position,null,i,t);t:if(3>t.length)i=!1;else{for(i=0;i<t.length;i++){var s=t[i],n=i===t.length-1?t[0]:t[i+1];if(s.c.a!==(0===i?t[t.length-1]:t[i-1]).a||s.a!==n.c.a){i=!1;break t}}i=!0}i=[],n=s=null;for(let r=0;r<t.length;r++){var o=t[r];const a=se(e,o.c.a,o.a);i.push(a),he(ue(a,2),o.c),o=a.a,null!==s?he(o.b,s):n=o,s=o}for(he(n.b,s),e=i,t=0;t<e.length;t++){i=e[t];do{s=te(i,e)}while(s);this.b.push(i)}for(t=Qt(this),i=0;i<t.length;i++)ne(t[i],e);t=ee(this)}},t.k.fb=function(){for(let t=0;t<this.b.length;t++)te(this.b[t],[])&&(Qt(this),t=0)},t.k.eb=function(){this.s=[],this.f=[],this.v=[],this.C=[],this.h=[];for(let i=0;i<this.b.length;i++){const n=this.b[i];let o=n.a;oe(this.s,n.o)||this.s.push(n.o);do{if(-1===this.v.indexOf(o)){this.v.push(o);const i=new e;s(i,o.a.position,o.c.a.position);var t=i;t.normalize(Number.EPSILON),t.normalize(Number.EPSILON),oe(this.C,i)||this.C.push(i),o.c.a.a.push(o)}t=o.a,-1===this.f.indexOf(t)&&(this.f.push(t),this.h.push(t.position)),o=o.b}while(o!==n.a)}};var ro=new x,ao=new e,ho=[ss,ns,os],mo=new e,co=new e,lo=new e,uo=new e,_o=new e,po=0,fo=1;const yo=[-0,-0],vo=[-0,-0];de.prototype.J=function(t,e,i){this.c=e,this.f=i},de.prototype.a=function(t,e){const i=this.c,s=this.f;let n=i[0].i(t),o=n;for(let e=1;e<s;e++){const s=i[e].i(t);s>n?n=s:s<o&&(o=s)}e[0]=o,e[1]=n},de.prototype.b=function(){lm(cm.ia,this)},fe.prototype.J=function(t){this.c=t},fe.prototype.a=function(t,e){n(go,t,-1),e[0]=-ye(this,go),e[1]=ye(this,t)},fe.prototype.b=function(){lm(cm.Z,this)};var go=new e,xo=new e;ve.prototype.J=function(t,e,i){this.c=t,this.g.l(e),this.f.l(i)},ve.prototype.a=function(t,e){n(wo,t,-1),e[0]=-ge(this,wo),e[1]=ge(this,t)},ve.prototype.b=function(){lm(cm.wa,this)};var bo=new e,Ao=new e,wo=new e;xe.prototype.J=function(t,e,i,s){this.f=t,this.a.l(e),this.o.l(i),this.b=s},be.prototype.J=function(t,e,i,s,n,o){this.f=t,this.j=e,this.h=i,this.a.l(s),this.o.l(n),this.b=o},Ae.prototype.J=function(t,e,i,s){this.f=t,this.a=e,this.o.l(i),this.b=s};var Bo=new e,Mo=new e,Co=new e,zo=new e,Io=[new e,new e],So=[new e,new e],Lo=new e,Po=new e,ko=new e,Vo=new _n,Oo=new _n,To=new e,Eo=new e;(Ee.prototype=Object.create(R.prototype)).ua=function(t){{var e=this.b,i=this.f;D(t);const s=4/3*Math.PI*e*e*e+Math.PI*e*e*2*i,n=Math.PI*e*e,o=n*(8/15*e*e*e+i*e*e*1.5+4/3*i*e*i+2/3*i*i*i);t.a.set(o,0,0,0,n*(8/15*e*e*e+i*e*e),0,0,0,o),t.c=s}},Ee.prototype.T=function(t,e){r(Jo,t),n(e,Jo,this.b),e.y+=Math.sign(t.y)*this.f},Ee.prototype.va=function(t,e){if(Fo.set(0,this.f,0),qo.set(0,-this.f,0),Y(Fo,qo,t,jo),c(t,jo)<=this.b)return null;if(s(Do,e,t),e=Do.normalize(),1e-5>Math.abs(e))return null;t:{var i=this.b,o=Do,r=Fo,a=qo;s(Ro,a,r),s(jo,t,r),r=Ro.i(Ro);var h=Ro.i(o);const e=Ro.i(jo);var m=o.i(jo),l=jo.i(jo),u=r-h*h;if(0<=(l=(m=r*m-e*h)*m-u*(r*l-e*e-i*i*r))){if(0<(h=e+(u=(-m-Math.sqrt(l))/u)*h)&&h<r){i=u;break t}if(0>=h?No.l(jo):s(No,t,a),0<(l=(m=o.i(No))*m-(i=No.i(No)-i*i))){i=-m-Math.sqrt(l);break t}}i=-1}return 0>i||i>e?null:((e=Xi(cm.ha)).b=this,n(e.u,Do,i),e.u.add(t),e.a=i,e.o.x=e.u.x,e.o.z=e.u.z,e.o.y=e.u.y<-this.f?e.u.y+this.f:e.u.y>this.f?e.u.y-this.f:0,e.o.scale(1/this.b),e)};var Fo=new e,qo=new e,Do=new e,Ro=new e,jo=new e,No=new e,Jo=new e;(Fe.prototype=Object.create(R.prototype)).ua=function(t){{var e=this.b;D(t);const i=4/3*Math.PI*e*e*e;e=i*e*e*.4,t.a.set(e,0,0,0,e,0,0,0,e),t.c=i}},Fe.prototype.T=function(t,e){r(Uo,t),n(e,Uo,this.b)},Fe.prototype.va=function(t,e){if(s(Ho,e,t),e=Ho.normalize(),1e-5>Math.abs(e))return null;const i=t.i(Ho);var a=o(t)-this.b*this.b;if(Math.abs(i)<this.b||0<=i&&0<=a)return null;if(0>(a=i*i-a))return null;const h=Math.sqrt(a);return 0>(a=-i-h)&&(a=-i+h),a>e?null:((e=Xi(cm.ha)).b=this,n(e.u,Ho,a),e.u.add(t),e.a=a,r(e.o,e.u),e)};var Ho=new e,Uo=new e,Yo=new e,Wo=new e,Go=new e,Ko=new e,Zo=new e,Xo=new e,$o=new e,Qo=new e,tr=new e,er=new e,ir=new e,sr=new e,nr=new e,or=new e,rr=new e,ar=new e,hr=new e,mr=new e,cr=new e,lr=new e,ur=new e,_r=new e,pr=new e,dr=new e,fr=new e,yr=new e,vr=new e,gr=new e,xr=new e,br=new e,Ar=new e,wr=new e,Br=new e,Mr=new e,Cr=new e,zr=new e,Ir=new e,Sr=new e,Lr=[],Pr=new e,kr=new e,Vr=new e,Or=new _,Tr=new e,Er=new e,Fr=new e,qr=new e,Dr=new e,Rr=new e,jr=new e,Nr=new e,Jr=new e,Hr=new e,Ur=new e,Yr=new e;const Wr=new Map;var Gr=new e,Kr=[],Zr=[],Xr=[],$r=[],Qr=[],ta=new _n,ea=new e,ia=new e,sa=new e,na=new e,oa=new e,ra=new e,aa=new e,ha=new e,ma=new e,ca=new e,la=new e,ua=new e,_a=new e,pa=new e,da=new e,fa=new e,ya=new e,va=new e,ga=new e,xa=new e,ba=new e,Aa=new e,wa=new e,Ba=new e,Ma=new e,Ca=new e,za=[],Ia=[],Sa=new e,La=new e,Pa=[],ka=new e,Va=new e,Oa=new e,Ta=new x;const Ea={16:function(t,e,o,r){var a=t.f+e.f;const h=t.position,m=e.position;s(Ko,m,h);const c=Ko.length(),l=t.b.b+e.b.b;c-a>=l||((a=Xi(cm.O)).h=t,a.j=e,o?a.s=!0:(1e-5>c?a.c.set(0,1,0):n(a.c,Ko,1/c),a.g=l-c,n(a.b,a.c,t.b.b),n(a.a,a.c,-e.b.b),i(a.f,a.b,a.a),a.f.add(h),a.f.add(m),a.f.scale(.5)),r.add(a))},17:function(t,e,n,o){var r=t.f+e.f;let a=t,h=e;16!==t.b.Y&&(a=e,h=t),Yo.set(0,h.b.f,0),Wo.set(0,-h.b.f,0),y(h.transform,Yo),y(h.transform,Wo),Y(Yo,Wo,a.position,Go),t=c(Go,a.position),(t=a.b.b+h.b.b-t)<=-r+Number.EPSILON||((r=Xi(cm.O)).h=a,r.j=h,n?r.s=!0:(r.g=t,s(r.c,Go,a.position),n=r.c.length(),1e-5>Math.abs(n)?r.c.set(0,1,0):r.c.scale(1/n),r.b.l(r.c),r.b.scale(a.b.b),r.b.add(a.position),r.a.l(r.c),r.a.scale(-h.b.b),r.a.add(Go),i(r.f,r.b,r.a),r.f.scale(.5),y(a.c,r.b),y(h.c,r.a)),o.add(r))},20:function(t,e,o,a){var h=t,m=e;if(16!==t.b.Y&&(h=e,m=t),t=m,Bn.J(h.position),ot(t,Bn,Zo,Mn))e=h.f+m.f,s($o,Zo,h.position),(t=r(Qo,$o,Number.EPSILON))+Number.EPSILON>=h.b.b+e||((e=Xi(cm.O)).h=h,e.j=m,o?e.s=!0:(e.g=h.b.b-t,e.c.l(Qo),n(e.b,Qo,h.b.b),e.b.add(h.position),e.a.l(Zo),i(e.f,e.b,e.a),e.f.scale(.5),y(h.c,e.b),y(m.c,e.a)),a.add(e));else{if((t=Xi(cm.O)).h=h,t.j=m,o)t.s=!0;else{(o=Xi(cm.Z)).J(h),mm[cm.Z].push(o),(e=Xi(cm.Z)).J(m),mm[cm.Z].push(e);var c=Ni(m);if(0===(o=pe(o,e,c,c.length,Xo)))throw Error("Center of the sphere is inside the complex hull, but SAT thinks that they do not overlap.");t.g=o,n(t.c,Xo,-1),n(t.b,t.c,h.b.b),t.b.add(h.position),n(t.a,Xo,o-h.b.b),t.a.add(h.position),i(t.f,t.b,t.a),t.f.scale(.5),y(h.c,t.b),y(m.c,t.a),$i()}a.add(t)}},1:function(t,e,i,o){var r=t.f+e.f;tr.set(0,t.b.f,0),er.set(0,-t.b.f,0),y(t.transform,tr),y(t.transform,er),ir.set(0,e.b.f,0),sr.set(0,-e.b.f,0),y(e.transform,ir),y(e.transform,sr);var a=Math.sqrt(G(tr,er,ir,sr,nr,or)),h=t.b.b+e.b.b;a>h+r||((r=Xi(cm.O)).h=t,r.j=e,i?(r.s=!0,o.add(r)):(1e-5>a?r.c.set(0,1,0):(s(r.c,or,nr),r.c.normalize()),r.g=h-a,s(rr,er,tr),rr.normalize(),s(ar,sr,ir),ar.normalize(),i=rr,(i=.99999<(i=Math.abs(i.i(ar)))&&1.00001>i)?(i=Z(tr,hr),a=-Z(er,mr),0>i||0>a?(qe(r,nr,or),o.add(r)):((h=Xi(cm.O)).h=t,h.j=e,h.c.l(r.c),h.g=r.g,0===i?qe(r,tr,hr):(n(nr,rr,i),nr.add(tr),qe(r,nr,hr)),0===a?qe(h,er,mr):(n(nr,rr,-a),nr.add(er),qe(h,nr,mr)),o.add(r),o.add(h))):(qe(r,nr,or),o.add(r))))},5:function(t,e,i,o){var r=t,h=e;if(1!==t.b.Y&&(r=e,h=t),Jr.set(0,r.b.f,0),Hr.set(0,-r.b.f,0),y(r.transform,Jr),y(r.transform,Hr),t=h,Cn.J(Jr,Hr),ot(t,Cn,Ur,Yr)){if(t=h,e=r.f+t.f,Y(Jr,Hr,Ur,kr),s(Vr,Ur,kr),h=Vr.normalize(Number.EPSILON),!((h=r.b.b-h)<=-e+Number.EPSILON))if((e=Xi(cm.O)).h=r,e.j=t,i)e.s=!0,o.add(e);else if(e.g=h,e.c.l(Vr),s(Nr,Hr,Jr),Nr.normalize(),i=Nr.i(Vr),.01<Math.abs(i))De(e,kr,Ur),o.add(e);else{{var m=(i=t.h).x,c=i.y,u=i.z;const e=i.w;0==(m=m*m+c*c+u*u+e*e)?Or.x=Or.y=Or.z=Or.w=0:(m=-1/m,Or.x=i.x*m,Or.y=i.y*m,Or.z=i.z*m,Or.w=i.w*-m)}for(Or.A(Vr,Tr),Tr.scale(-1),i=null,m=Ht(t.b),c=0;c<m.length;c++)if(u=m[c],l(u.o,Tr,.01)){i=u;break}null===i?(De(e,kr,Ur),o.add(e)):(t.c.A(Jr,Er),t.c.A(Hr,Fr),i=Re(Er,Fr,i,qr,Dr),t.transform.A(qr,Rr),t.transform.A(Dr,jr),i?((i=Xi(cm.O)).h=r,i.j=t,i.c.l(e.c),i.g=e.g,n(e.a,Vr,r.b.b-h),e.a.add(Rr),n(i.a,Vr,r.b.b-h),i.a.add(jr),De(e,Rr,e.a),De(i,jr,i.a),o.add(e),o.add(i)):(De(e,kr,Ur),o.add(e)))}}else if(t=r,r=h,i)(h=Xi(cm.O)).h=t,h.j=r,h.s=!0,o.add(h);else{for(s(Sr,Jr,Hr),Sr.normalize(),i=Ni(r),h=Ut(r.b).length,e=Yt(r.b),ze(Lr,h+e.length),m=0;m<i.length;m++)Lr[m].l(i[m]);for(i=0;i<e.length;i++)m=Lr[h],r.h.A(e[i],m),a(m,Sr),m.normalize(),m.V()||h++;if((e=Xi(cm.Z)).J(t),mm[cm.Z].push(e),i=ji(r),0===(h=pe(e,i,Lr,h,Ir)))throw Error("Inner segment of the capsule overlaps convex hull, but SAT does not think so.");if(v(r.c,Ir,Pr),null!==(c=Pe(Pr,r)))s(br,Jr,Hr),br.normalize(),e=Jr.i(Ir)<Hr.i(Ir)?Jr:Hr,i=Xi(cm.O),m=Xi(cm.O),i.h=m.h=t,i.j=m.j=r,i.g=m.g=h,n(i.c,Ir,-1),n(m.c,Ir,-1),n(i.a,i.c,-(h-t.b.b)),m.a.l(i.a),t=br.i(i.c),.01<Math.abs(t)?(i.a.add(e),De(i,e,i.a),m.F(),o.add(i)):(r.c.A(Jr,Ar),r.c.A(Hr,wr),t=Re(Ar,wr,c,Br,Mr),r.transform.A(Br,Cr),r.transform.A(Mr,zr),t?(i.a.add(Cr),m.a.add(zr),De(i,Cr,i.a),De(m,zr,m.a),o.add(i),o.add(m)):(i.a.add(e),De(i,e,i.a),m.F(),o.add(i)));else{if(v(r.c,Ir,Pr),null===(e=Kt(r.b,Pr)))throw Error("Deep contact: cannot find reference face nor reference edge");if(r.transform.A(e.c.a.position,dr),r.transform.A(e.a.position,fr),n(yr,Ir,-(h-t.b.b)),vr.l(yr),yr.add(dr),vr.add(fr),!$(Jr,Hr,yr,vr,gr))throw Error("Cannot find an intersection between shifted edge and inner segment");(e=Xi(cm.O)).h=t,e.j=r,n(e.c,Ir,-1),e.g=h,n(xr,Ir,h-t.b.b),xr.add(gr),De(e,gr,xr),o.add(e)}$i()}},4:function(t,s,o,r){var a,h=t.f+s.f,m=Yt(t.b).length,c=Yt(s.b).length,l=Ut(t.b).length,u=Ut(s.b).length,_=ji(t),p=ji(s),d=t.g.a&s.g.a&65536&&Wr.get(t.b.c+(s.b.c<<16))||null;if((a=null===d)||(_.a(d,yo),p.a(d,vo),a=!(Math.max(0,Math.min(yo[1],vo[1])-Math.max(yo[0],vo[0]))<=Number.EPSILON)),a)if(d=Ni(t),0===(l=pe(p,_,d,l,ha,h)))je(t,s,ha);else if(d=Ni(s),0===(d=pe(_,p,d,u,ma,h)))je(t,s,ma);else{if(u=0,1024>m*c&&0===(u=Ne(t,s,_,p,ca,h)))return void je(t,s,ca);if(o)(h=Xi(cm.O)).h=t,h.j=s,h.s=!0,r.add(h);else if(0===u||Math.abs(l)-1e-5<Math.abs(u)||Math.abs(d)-1e-5<Math.abs(u)){if(c=t,m=s,o=ha,l>=d+1e-5&&(c=s,m=t,o=ma),v(c.c,o,ua),null===(p=Pe(ua,c)))throw Error("Cannot find reference face");v(m.c,o,ua),_=ke(ua,m),t=c,s=m,m=p,c=_,t.h.A(m.o,Gr),_=0,p=m.a;do{Kr.length===_&&Kr.push(new e),t.transform.A(p.a.position,Kr[_]),_++,p=p.b}while(p!==m.a);l=0,p=c.a;do{Zr.length===l&&Zr.push(new e),s.transform.A(p.a.position,Zr[l]),l++,p=p.b}while(p!==c.a);if(0!==(c=Ie(Zr,l,Kr,_,Gr)).length)for(t.transform.A(m.b,aa),m=aa.i(o),_=0;_<c.length;_++)(l=(p=c[_]).i(o)-m)>=h||(l=-l,(u=Xi(cm.O)).h=t,u.j=s,u.g=l,u.c.l(o),n(u.b,o,l),u.b.add(p),u.a.l(p),i(u.f,u.b,u.a),u.f.scale(.5),y(u.h.c,u.b),y(u.j.c,u.a),r.add(u));$i()}else v(t.c,ca,la),la.scale(-1),h=Kt(t.b,la),v(s.c,ca,la),o=Kt(s.b,la),m=u,t.transform.A(h.a.position,ea),t.transform.A(h.c.a.position,ia),s.transform.A(o.a.position,sa),s.transform.A(o.c.a.position,na),n(oa,ca,m),ea.add(oa),ia.add(oa),$(ea,ia,sa,na,ra)?((h=Xi(cm.O)).h=t,h.j=s,h.g=m,n(h.c,ca,-1),n(h.b,oa,-1),h.b.add(ra),h.a.l(ra),i(h.f,h.b,h.a),h.f.scale(.5),y(h.h.c,h.b),y(h.j.c,h.a),$i(),r.add(h)):$i()}},24:function(t,e,i,s){Ke(t,e,Je,i,s)},9:function(t,e,i,s){Ke(t,e,He,i,s)},12:function(t,e,i,s){Ke(t,e,Ye,i,s)},8:function(t,e,i,s){Ke(t,e,Me,i,s)}};Ze.prototype.c=function(t,e,i){if(B(t.j,e.j,t.f+e.f)){var s=eo[(7&t.a)+(t.b.N?16:8)][(7&e.a)+(e.b.N?16:8)];if(0!==s&&!($a.j[t.b.j]&1<<e.b.j||ui(t.b,e.b))){s=1===s;var n=Ea[t.b.Y|e.b.Y],o=n;if(n=i.length,o(t,e,s,i),n!==(t=i.length))for(e=n;e<t;e++)(s=i.buffer[e]).C=s.h.b,s.B=s.j.b,n=s.h,y(n.m.transform,s.b),s.b.S(n.g.na()),s.v=n.g,s.h=null,n=s.j,y(n.m.transform,s.a),s.a.S(n.g.na()),s.H=n.g,s.j=null,s.v.id<s.H.id||Ui(s),s.s||(n=s.C,o=s.B,s.R=null===n.a&&null===o.a?0:null===n.a?Ce(0,o.a.a,0,o.a.b):null===o.a?Ce(n.a.a,0,n.a.b,0):Ce(n.a.a,o.a.a,n.a.b,o.a.b),n=s.C,o=s.B,s.P=null===n.a&&null===o.a?.6:null===n.a?Ce(0,o.a.f,.6,o.a.c):null===o.a?Ce(n.a.f,0,n.a.c,.6):Ce(n.a.f,o.a.f,n.a.c,o.a.c))}}},Ze.prototype.f=function(t,e){var o=t.c;t=t.f;for(var r=0;r<this.a.b;r++){var a=this.a.a[r];if(a.c.a&a.f.a&65536){for(var h=!!(a.c.a&a.f.a&512),m=0;m<a.b.length;m++){var l=a.b.buffer[m];l.m&=~(em|im|sm),l.m|=h?im:sm}if(!h)for(h=0;h<a.a.length;h++){l=(m=a.a[h]).v;var u=m.H,_=m.C,p=m.B;_.m&&p.m?_.N||p.N||ui(_,p)?(kt(a,h),h--):(Ai(l).A(m.b,Zn),Ai(u).A(m.a,Xn),i(m.f,Zn,Xn),m.f.scale(.5),s($n,Zn,Xn),m.g=$n.i(m.c),-5e-4>m.g?(kt(a,h),h--):(n($n,m.c,Math.abs(m.g)),s($n,Zn,$n),s($n,Xn,$n),5e-4<(l=$n.length())/Math.abs(m.g)&&5e-4<l?(kt(a,h),h--):Et(a,m))):(kt(a,h),h--)}}else Vt(a)}for(a=0;a<t.length;a++){for(h=(r=t.buffer[a]).pop(),m=[],l=0;l<r.length;l++)for(u=Oi(r[l]),_=0;_<u.length;_++)(p=u.buffer[_]).b.N||m.push(p);0!==m.length&&wt(h,m,e)}for(this.b.clear(),e=0;e<o.length;e+=2)32&((t=o.buffer[e]).a|t.a)||Xe(this,t,o.buffer[e+1],this.b);for(o=0;o<this.b.length;o++)if(t=this.b.buffer[o],a=this.a,r=t.v,h=t.H,(e=a.cache.get(Dt(r,h)))||((e=Xi(cm.Ca)).c=r,e.f=h,(r=e).g=Dt(r.c,r.f),a.cache.set(r.g,r),a.a.length>a.b?a.a[a.b]=r:a.a.push(r),a.b++),Et(e,t),!t.s)if(4>e.a.length)e.a.push(t);else{h=e,a=-1,l=(m=t).g,u=1/0,r=-1,_=h.a[0].g,p=!0;for(var d=0;4>d;d++){var f=h.a[d];if(f.g+1e-5>l&&(l=f.g,a=d),m.g>f.g+1e-5){var y=m.g-f.g;const t=c(m.f,f.f);t<y+1e-5&&t<u&&(u=t,r=d)}p&&1e-5<Math.abs(f.g-_)&&(p=!1)}p&&-1!==a&&(a=-2),f=!1,1e-5>(l=Ot(h.a[0],h.a[1],h.a[2],h.a[3]))&&(f=!0,l=Tt(h.a[0],h.a[1],h.a[2],h.a[3])),y=Ot(m,h.a[1],h.a[2],h.a[3]),f&&1e-5<y&&(l=0,a=-1),p=_=u=d=0,0!==a&&(d=f?Tt(m,h.a[1],h.a[2],h.a[3]):y),1!==a&&(u=f?Tt(m,h.a[0],h.a[2],h.a[3]):Ot(m,h.a[0],h.a[2],h.a[3])),2!==a&&(_=f?Tt(m,h.a[0],h.a[1],h.a[3]):Ot(m,h.a[0],h.a[1],h.a[3])),3!==a&&(p=f?Tt(m,h.a[0],h.a[1],h.a[2]):Ot(m,h.a[0],h.a[1],h.a[2])),h=0,u>(m=d)&&(h=1,m=u),_>m&&(h=2,m=_),p>m&&(h=3,m=p),-1===(a=-1===a?h:1e-5>Math.abs(l-m)&&-1!==r?r:m>l+1e-5?h:-1)?t.F():(e.a[a].F(),e.a[a]=t)}for(o=0;o<this.a.b;o++)0===(e=this.a.a[o]).a.length&&0===e.b.length&&(qt(this.a,o),o--)},t.k=$e.prototype,t.k.Xa=function(){const t=nm,e=this.b,i=e+11;for(let e=0;12>e;e++)t[i+e]=0;t[e+2]=0,t[e+7]=0,t[e+8]=0,t[e+9]=0,t[e]=0,t[e+5]=0,t[e+3]=-1/0,t[e+4]=1/0,t[e+6]=0,t[e+10]=0,this.g=null,this.f=this.c=this.a=0},t.k.Xb=function(t){this.a=t?1|this.a:-2&this.a},t.k.ka=function(t,e,i,s,n,o){const r=nm,a=this.b+11;r[a]=t,r[a+1]=e,r[a+2]=i,r[a+3]=s,r[a+4]=n,r[a+5]=o},t.k.Rb=function(){return nm[this.b+7]},t.k.ic=function(t){nm[this.b+7]=t},t.k.lc=function(t){nm[this.b+5]=t},t.k.qc=function(t){nm[this.b+3]=t},t.k.rc=function(t){nm[this.b+4]=t},t.k.la=function(t,e,i,s,n,o){const r=nm,a=this.b+11;r[a+6]=t,r[a+7]=e,r[a+8]=i,r[a+9]=s,r[a+10]=n,r[a+11]=o},t.k.tb=function(){Qe(this,6,12)},t.k.fc=function(){Qe(this,0,6)},t.k.tb=function(){Qe(this,6,12)},t.k.ac=function(){nm[this.b+9]=0},t.k.ib=function(t){const e=nm;var i=this.b;const s=i+11;if(i+=23,2&this.a){var n=t.B;e[i]=n*e[s],e[i+1]=n*e[s+1],e[i+2]=n*e[s+2],Fa.x=e[s+3],Fa.y=e[s+4],Fa.z=e[s+5],L(t.a.aa(),Fa),e[i+3]=Fa.x/t.g,e[i+4]=Fa.y/t.g,e[i+5]=Fa.z/t.g}else e[i]=e[i+1]=e[i+2]=0,e[i+3]=e[i+4]=e[i+5]=0;4&this.a?(n=t.C,e[i+6]=n*e[s+6],e[i+7]=n*e[s+7],e[i+8]=n*e[s+8],Fa.x=e[s+9],Fa.y=e[s+10],Fa.z=e[s+11],L(t.b.aa(),Fa),e[i+9]=Fa.x/t.h,e[i+10]=Fa.y/t.h,e[i+11]=Fa.z/t.h):(e[i+6]=e[i+7]=e[i+8]=0,e[i+9]=e[i+10]=e[i+11]=0)},t.k.jb=function(t){const e=nm,i=this.b,s=i+11,n=i+23;e[i+2]=1/(e[s]*e[n]+e[s+1]*e[n+1]+e[s+2]*e[n+2]+e[s+3]*e[n+3]+e[s+4]*e[n+4]+e[s+5]*e[n+5]+e[s+6]*e[n+6]+e[s+7]*e[n+7]+e[s+8]*e[n+8]+e[s+9]*e[n+9]+e[s+10]*e[n+10]+e[s+11]*e[n+11]+e[i+5]/t)},t.k.kb=function(t,e){if(2&this.a){var i=t.B,s=t.a,n=s.g,o=s.f;s=s.m,Da[0]=n.x+i*s.x,Da[1]=n.y+i*s.y,Da[2]=n.z+i*s.z,qa.l(t.a.j),L(t.a.aa(),qa),Da[3]=o.x+qa.x/t.g,Da[4]=o.y+qa.y/t.g,Da[5]=o.z+qa.z/t.g}else Da[0]=0,Da[1]=0,Da[2]=0,Da[3]=0,Da[4]=0,Da[5]=0;4&this.a?(i=t.C,n=(s=t.b).g,o=s.f,s=s.m,Da[6]=n.x+i*s.x,Da[7]=n.y+i*s.y,Da[8]=n.z+i*s.z,qa.l(t.b.j),L(t.b.aa(),qa),Da[9]=o.x+qa.x/t.h,Da[10]=o.y+qa.y/t.h,Da[11]=o.z+qa.z/t.h):(Da[6]=0,Da[7]=0,Da[8]=0,Da[9]=0,Da[10]=0,Da[11]=0),n=(t=nm)[n=(i=this.b)+11]*Da[0]+t[n+1]*Da[1]+t[n+2]*Da[2]+t[n+3]*Da[3]+t[n+4]*Da[4]+t[n+5]*Da[5]+t[n+6]*Da[6]+t[n+7]*Da[7]+t[n+8]*Da[8]+t[n+9]*Da[9]+t[n+10]*Da[10]+t[n+11]*Da[11],e=((o=t[i+7])-n-t[i+5]*t[i+9])/e,1&this.a&&0<o?(n=J(o/(o-n),0,1),t[i+10]=n):t[i+10]=0,t[i]=e},t.k.pb=function(t){const e=nm,i=this.b+11;if(2&this.a){const s=t.a;s.c&&(e[i]*=1&s.c?0:1,e[i+1]*=2&s.c?0:1,e[i+2]*=4&s.c?0:1),64&s.a?(e[i+3]=0,e[i+4]=0,e[i+5]=0):s.h&&(Ra.set(e[i+3],e[i+4],e[i+5]),wi(s).U(Ra),Ra.x*=1&s.h?0:1,Ra.y*=2&s.h?0:1,Ra.z*=4&s.h?0:1,Ai(s).U(Ra),e[i+3]=Ra.x,e[i+4]=Ra.y,e[i+5]=Ra.z)}4&this.a&&((t=t.b).c&&(e[i+6]*=1&t.c?0:1,e[i+7]*=2&t.c?0:1,e[i+8]*=4&t.c?0:1),64&t.a?(e[i+9]=0,e[i+10]=0,e[i+11]=0):t.h&&(Ra.set(e[i+9],e[i+10],e[i+11]),wi(t).U(Ra),Ra.x*=1&t.h?0:1,Ra.y*=2&t.h?0:1,Ra.z*=4&t.h?0:1,Ai(t).U(Ra),e[i+9]=Ra.x,e[i+10]=Ra.y,e[i+11]=Ra.z))},t.k.lb=function(t){const e=nm;this.g=t,this.a=t.j?2|this.a:-3&this.a,this.a=t.m?4|this.a:-5&this.a,this.c=t.a.Ha,this.f=t.b?t.b.Ha:0,e[this.b+1]=t.H};var Fa=new e,qa=new e,Da=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],Ra=new e;t.k=ti.prototype,t.k.Ma=function(){this.active=!0,ii(this),si(this)},t.k.ja=function(){if(this.active=!1,ii(this),this.v){var t=this.a,e=this.b;t&&e&&_i(t,e,!1)}},t.k.hb=function(){return!0},t.k.jc=function(t){if(this.a!==t){var e=this.a;if(this.a=t,e&&e.M(!0),t&&t.M(!0),si(this),e&&this.b&&_i(e,this.b,!1),this.f){var i=this.f;e&&st(i.c.buffer[e.id],this),t&&hi(i,this,t)}}},t.k.kc=function(t){if(this.b!==t){var e=this.b;if(this.b=t,e&&e.M(!0),t&&t.M(!0),si(this),e&&this.a&&_i(e,this.a,!1),this.f){var i=this.f;e&&st(i.c.buffer[e.id],this),t&&hi(i,this,t)}}},t.k.mc=function(t){this.v!==t&&(this.v=t,si(this),ii(this))},ti.prototype.update=function(){throw Error("Not implemented")},ti.prototype.R=function(){this.j=!!(1&this.a.a)&&1/0!==this.a.B,this.m=null!==this.b&&!!(1&this.b.a)&&1/0!==this.b.B;let t=0;if(this.j){var e=this.a.B*this.g;this.B=1/e,t+=e}this.m&&(e=this.b.B*this.h,this.C=1/e,t+=e),this.H=1/t},(ni.prototype=Object.create(ti.prototype)).hb=function(){var t=!1,e=!1;const i=this.K.c;return this.j&&this.a.c&&(t=!!(1&(t=this.a.c))&&.99999<Math.abs(i.x)||!!(2&t)&&.99999<Math.abs(i.y)||!!(4&t)&&.99999<Math.abs(i.z)),this.m&&this.b.c&&(e=!!(1&(e=this.b.c))&&.99999<Math.abs(i.x)||!!(2&e)&&.99999<Math.abs(i.y)||!!(4&e)&&.99999<Math.abs(i.z)),!t&&!e},ni.prototype.ja=function(){ti.prototype.ja.call(this),null!==this.f&&mi(this.f,this)},ni.prototype.update=function(t){const e=nm,i=this.c[0],s=i.b;var n=this.K;const o=n.c,r=this.a,h=this.b;this.j?(Ai(r).A(n.b,ja),ja.S(r.W()),a(ja,o),i.ka(-o.x,-o.y,-o.z,-ja.x,-ja.y,-ja.z)):i.ka(0,0,0,0,0,0),this.m?(Ai(h).A(n.a,ja),ja.S(h.W()),a(ja,o),i.la(o.x,o.y,o.z,ja.x,ja.y,ja.z)):i.la(0,0,0,0,0,0);var m=n.R;const c=n.g,l=0>c;let u=0;this.j&&(0<m||l)&&(r.Pa(n.b,ja),u+=ja.i(o)),this.m&&(0<m||l)&&(h.Pa(n.a,ja),u-=ja.i(o)),n=0<m&&2<u,l?(n?e[s+7]=u*m:(-.05>(m=c/t)&&(m*=.8),e[s+7]=m),i.a&=-2):(t=15*c,n?(e[s+7]=Math.max(u*m,t),i.a&=-2):(e[s+7]=t,i.a|=1))};var ja=new e;(oi.prototype=Object.create(ti.prototype)).ja=function(){ti.prototype.ja.call(this),null!==this.f&&mi(this.f,this)},oi.prototype.update=function(){var t=this.c[0];const e=this.c[1],i=nm,s=t.b,n=e.b,o=this.K;var r=this.a,a=this.b;Ai(r).A(o.b,Na),Na.S(r.W()),Ai(a).A(o.a,Ja),Ja.S(a.W()),r=o.c,a=Ha;var m=Ua;if(.7071067811865476<Math.abs(r.z)){var c=-r.y*r.y+r.z*r.z,l=1/Math.sqrt(c);a.set(0,-r.z*l,r.y*l),m.set(c*l,-r.x*a.z,r.x*a.y)}else c=r.x*r.x+r.y*r.y,l=1/Math.sqrt(c),a.set(-r.y*l,r.x*l,0),m.set(-r.z*a.y,r.z*a.x,c*l);this.j?(h(Ya,Na,Ha),t.ka(-Ha.x,-Ha.y,-Ha.z,-Ya.x,-Ya.y,-Ya.z),h(Ya,Na,Ua),e.ka(-Ua.x,-Ua.y,-Ua.z,-Ya.x,-Ya.y,-Ya.z)):(t.ka(0,0,0,0,0,0),e.ka(0,0,0,0,0,0)),this.m?(h(Ya,Ja,Ha),t.la(Ha.x,Ha.y,Ha.z,Ya.x,Ya.y,Ya.z),h(Ya,Ja,Ua),e.la(Ua.x,Ua.y,Ua.z,Ya.x,Ya.y,Ya.z)):(t.la(0,0,0,0,0,0),e.la(0,0,0,0,0,0)),t=2*o.P,i[s+6]=t,i[n+6]=t,t=4/this.P*19.6/this.H,i[s+3]=-t,i[n+3]=-t,i[s+7]=0,i[n+7]=0};var Na=new e,Ja=new e,Ha=new e,Ua=new e,Ya=new e;t.k=ri.prototype,t.k.sb=function(t){for(let o=0;o<t.b;o++){const r=t.a[o];for(let t=0;t<r.a.length;t++){const o=r.a[t];var e=null===o.K,i=0<o.P&&null===o.L&&-.01<o.g;if(!e&&i&&(mi(this,o.K),ai(this,o.K)),e){var s=Xi(cm.Ba);{var n=o;ei(e=s),e.a=n.v,e.b=n.H,e.K=n,n=nm;const t=e.c[0].b;n[t+3]=0,n[t+4]=1/0,ti.prototype.Ma.call(e)}ai(this,s),o.K=s}i&&(i=s=Xi(cm.Da),e=o,ei(i),i.a=e.v,i.b=e.H,i.K=e,ti.prototype.Ma.call(i),ai(this,s),o.L=s),o.L&&(o.L.P=r.a.length)}}},t.k.qb=function(t,e){this.b.clear(),this.a.clear(),this.a.add(0);for(let n=0;n<t.length;n++){var i=t[n];if(1&i.a&&!(128&i.a)&&(Wa.clear(),Ga.clear(),Wa.add(i),this.Oa(i,Wa,Ga,!0),0!==Ga.length)){i=!0;for(var s=0;s<Wa.length;s++){const t=Wa.buffer[s];1&t.a||(t.a&=-129),512&t.a||(i=!1)}if(!i){for(i=0;i<Wa.length;i++)1&(s=Wa.buffer[i]).a&&s.M();for(i=this.b.length,s=0;s<Ga.length;s++)this.rb(Ga.buffer[s],e);i!==(s=this.b.length)&&this.a.add(s)}}}1===this.a.length&&this.a.clear()},t.k.Oa=function(t,e,i,s){if(t.a|=128,t.a|=256,!(this.c.buffer.length<=t.id)){var n=this.c.buffer[t.id];if(n&&0!==n.length){var o=e.length;for(let s=0;s<n.length;s++){const o=n.buffer[s];if(!o.active)continue;const r=o.a===t?o.b:o.a;r?256&r.a||(128&r.a||(e.add(r),r.a|=128),i.add(o)):i.add(o)}if(s)for(t=o;t<e.length;t++)1&(s=e.buffer[t]).a&&!(256&s.a)&&this.Oa(s,e,i,!1)}}},t.k.rb=function(t,e){if(t.s=0,t.R(),t.hb()){t.update(e);var i=nm;for(let s=0;s<t.c.length;s++){const n=t.c[s],o=n.b;i[o+8]=0,n.lb(t),n.pb(t),n.ib(t),n.jb(e),n.kb(t,e),i[o+2]<1/1e-5&&this.b.add(n)}}},t.k.vb=function(t){if(0!==this.a.length)for(let e=0;e<this.a.length-1;e++)this.wb(t,this.a.buffer[e],this.a.buffer[e+1])},t.k.wb=function(t,e,i){const s=nm;t=1/t;const n=this.b.buffer;for(var o=e;o<i;o++){var r=n[o],a=r.b,h=s[a+9];if(s[a+8]=h,0!==h){var m=r.c,c=r.f;a+=23,2&(r=r.a)&&(s[m]+=h*s[a],s[m+1]+=h*s[a+1],s[m+2]+=h*s[a+2],s[m+3]+=h*s[a+3],s[m+4]+=h*s[a+4],s[m+5]+=h*s[a+5]),4&r&&(s[c]+=h*s[a+6],s[c+1]+=h*s[a+7],s[c+2]+=h*s[a+8],s[c+3]+=h*s[a+9],s[c+4]+=h*s[a+10],s[c+5]+=h*s[a+11])}}for(o=0;o<this.f;o++){for(h=0,m=-0,c=e;c<i;c++){var l=n[c];r=!!(2&(a=l.a)),a=!!(4&a);const e=l.c,i=l.f;var u=(l=l.b)+11;const o=l+23;var _=s[l];const d=s[l+1];var p=s[l+2];const f=s[l+6];let y=s[l+3],v=s[l+4];0!==f&&(y=Math.max(y,-m*f),v=-y);const g=s[l+5];let x=-0;r&&(x+=s[u]*s[e]+s[u+1]*s[e+1]+s[u+2]*s[e+2]+s[u+3]*s[e+3]+s[u+4]*s[e+4]+s[u+5]*s[e+5]),a&&(x+=s[u+6]*s[i]+s[u+7]*s[i+1]+s[u+8]*s[i+2]+s[u+9]*s[i+3]+s[u+10]*s[i+4]+s[u+11]*s[i+5]),u=s[l+8],_=J(.99*(_-x)*p+u,y,v),s[l+8]=_,p=_-u,h=Math.max(h,Math.abs(p)*d),g&&(s[l]-=g*p*t),0===f&&(m=_),r&&(s[e]+=p*s[o],s[e+1]+=p*s[o+1],s[e+2]+=p*s[o+2],s[e+3]+=p*s[o+3],s[e+4]+=p*s[o+4],s[e+5]+=p*s[o+5]),a&&(s[i]+=p*s[o+6],s[i+1]+=p*s[o+7],s[i+2]+=p*s[o+8],s[i+3]+=p*s[o+9],s[i+4]+=p*s[o+10],s[i+5]+=p*s[o+11])}if(1e-4>=h)break}},t.k.Ya=function(t){const e=this.b.buffer,i=this.b.length,s=nm;for(let l=0;l<i;l++){var r=e[l];const i=r.g;var a=r.b;const u=a+11,_=s[a+10];var h=s[a+8];if(s[a+9]=h*(1-_),a=r.a,r=i.F!==Number.POSITIVE_INFINITY,2&a){var m=i.B,c=m*h*t;const e=h*t,a=i.a;Ka.x=c*s[u],Ka.y=c*s[u+1],Ka.z=c*s[u+2],a.g.add(Ka),0!==_&&(n(Za,Ka,_),a.L.add(Za)),r&&(Ka.scale(1/(m*t)),i.s+=o(Ka)),Za.x=e*s[u+3],Za.y=e*s[u+4],Za.z=e*s[u+5],a.aa().A(Za,Xa),Xa.scale(1/i.g),a.f.add(Xa),0!==_&&(Xa.scale(_),a.K.add(Xa))}4&a&&(m=(a=i.C)*h*t,h*=t,c=i.b,Ka.x=m*s[u+6],Ka.y=m*s[u+7],Ka.z=m*s[u+8],c.g.add(Ka),0!==_&&(n(Za,Ka,_),c.L.add(Za)),r&&(Ka.scale(1/(a*t)),i.s+=o(Ka)),Za.x=h*s[u+9],Za.y=h*s[u+10],Za.z=h*s[u+11],c.aa().A(Za,Xa),Xa.scale(1/i.h),c.f.add(Xa),0!==_&&(Xa.scale(_),c.K.add(Xa))),r&&Math.sqrt(i.s)>i.F&&(i.active=!1)}};var Wa=new _n,Ga=new _n,Ka=new e,Za=new e,Xa=new e;ci.prototype.a=function(t){for(let e=0;e<t.b;e++){const i=t.a[e];for(let t=0;t<i.b.length;t++){const e=i.b.buffer[t];e.m&em?e.s?this.g(e):this.b(e):e.m&im?e.s?this.j(e):this.f(e):e.m&sm&&(e.C.m&&e.B.m&&(e.s?this.h(e):this.c(e)),e.F(),it(i.b,t),t--)}}};let $a=null;t.k=li.prototype,t.k.Fb=function(t){const e=this.f;for(var i=0;i<e.length;i++){var s=e[i],o=!!(1&s.a)&&1/0!==s.B;16&s.a&&o&&(n(ph,this.s,s.B*t),s.m.add(ph)),(o=s).c&&(o.m.x*=1&o.c?0:1,o.m.y*=2&o.c?0:1,o.m.z*=4&o.c?0:1),s.h&&(wi(s).U(s.j),s.j.x*=1&s.h?0:1,s.j.y*=2&s.h?0:1,s.j.z*=4&s.h?0:1,Ai(s).U(s.j))}for(this.a.g(t),this.c.f(this.a,t),this.b.sb(this.c.a),this.b.qb(this.a.b,t),this.b.vb(t),this.b.Ya(t),i=0;i<e.length;i++)s=e[i],bt(s)||zi(s,t);Bt(e,t)},t.k.Qb=function(){this.m.a(this.c.a)},t.k.Lb=function(t){if(65536&t.a)throw Error("The body already belongs to a physics world!");t.a|=65536,t.ba(),this.f.push(t);{var e=this.a;e.b.push(t);const i=Xi(cm.Ea);i.J(t),e.a.push(i)}},t.k.dc=function(t){for(var e=0;e<this.f.length;e++)if(this.f[e]===t){this.f.splice(e,1),e=this.a;for(var i=t,s=0;s<e.b.length;s++)if(e.b[s]===i){e.b[s]=e.b[e.b.length-1],e.b.pop();break}for(s=0;s<e.a.length;s++)if(e.a[s].body===i){lm(cm.Ea,e.a[s]),e.a[s]=e.a[e.a.length-1],e.a.pop();break}break}for(t.a&=-65537,e=this.c,i=0;i<e.a.b;i++)((s=e.a.a[i]).c===t||s.f===t)&&(qt(e.a,i),i--)},t.k.Db=function(t){ai(this.b,t)},t.k.Eb=function(t){mi(this.b,t)},t.k.tc=function(t,e,i,s){return 0!==(t=this.Ua(t,e,1,i,s)).length&&(t[0].c(),!0)},t.k.bc=function(t,e,i,s){if(0===(t=this.Ua(t,e,Number.MAX_SAFE_INTEGER,i,s)).length)return null;for(e=t[0],i=1;i<t.length;i++)(s=t[i]).a<e.a?(e.c(),e=s):s.c();return e},t.k.Ua=function(t,e,i,s,n){Qa.set(t.x,t.y,t.z),th.set(e.x,e.y,e.z);{t=this.a,e=Qa;var o=th;const r=[];for(let a=0;a<t.b.length;a++){const h=t.b[a];if(0!=(h.b.f&s)&&M(bi(h),e,o)&&(h.ab(e,o,i,s,n,r),r.length>=i))break}for(;r.length>i;)r.pop().c();i=r}return i},t.k.sc=function(t,e,i,s,n,o){if(0===(t=this.ub(t,e,i,s,Number.MAX_SAFE_INTEGER,n,o)).length)return null;for(e=t[0],i=1;i<t.length;i++)(s=t[i]).a<e.a?(e.c(),e=s):s.c();return e},t.k.ub=function(t,e,i,o,r,a,h){rh.set(e.x,e.y,e.z,e.w),ah.set(i.x,i.y,i.z),hh.set(o.x,o.y,o.z),s(mh,hh,ah),o=ah;var m=rh;for(i=mh,ch||(ch=new xi(-1,1)),(e=ch).oa(o),e.ta(m),di(e.b),e.b.qa(t,is,as),e.g.l(i),e.H=Sh,e.ba(),t=Oi(e).buffer[0],lh.l(bi(e)),lh.Sa(i),i=i.length(),o=Lt(this.a,lh,a),a=[],m=0;m<o.length;m++)for(var l=Oi(o[m]),u=0;u<l.length;u++){var _=l.buffer[u];!h&&_.b.N||a.push(_)}for(o=[],l=1,_h.l(e.v);1e-5<l&&o.length<r&&0<a.length&&(m=wt(e,a,l,!0),Ri(t),null!==m);)if(u=a.indexOf(m),a[u]=a[a.length-1],a.pop(),uh.clear(),this.c.c(t,m,uh),0===uh.length);else{for(u=Wi(uh.buffer[0]),_=0;_<uh.length;_++)uh.buffer[_].F();u.s&&!h?u.F():(u.v!==e&&Ui(u),l=Xi(cm.ha),n(l.o,u.c,-1),l.u.l(u.f),l.b=m.g,l.f=u.B,l.a=c(_h,e.v),o.push(l),u.F(),l=1-l.a/i)}return o},t.k.Ub=function(t,e,i,s,n){eh.set(e.x,e.y,e.z),ih.set(i.x,i.y,i.z,i.w),i=eh;var o=ih;for(sh||(sh=new xi(-1,1)),oh.clear(),(e=sh).oa(i),e.ta(o),di(e.b),e.b.qa(t,is,as),e.ba(),t=Lt(this.a,bi(e),s),s=[],i=0;i<t.length;i++)if(nh.clear(),Xe(this.c,e,t[i],nh),0!==nh.length)for(o=0;o<nh.length;o++){const t=nh.buffer[o],i=t.v===e?t.B:t.C;oh.has(i.c)||t.s&&!n||(s.push(i),oh.add(i.c)),t.F()}return s},t.k.Tb=function(t,e,i,s,n,o){dh.set(e.x,e.y,e.z),fh.set(i.x,i.y,i.z,i.w),yh.set(n.x,n.y,n.z),vh.set(o.x,o.y,o.z,o.w);{i=dh,n=fh,o=yh;var r=vh;gh||(gh=new xi(-1,1)),xh||(xh=new xi(-1,1)),bh.clear();const a=xh;if((e=gh).oa(i),e.ta(n),a.oa(o),a.ta(r),di(e.b),e.b.qa(t,is,as),e.ba(),di(a.b),a.b.qa(s,is,as),a.ba(),w(bi(e),bi(a)))if(Xe(this.c,e,a,bh),0===bh.length)t=null;else{for(t=1;t<bh.length;t++)bh.buffer[t].F();(t=bh.buffer[0]).v===e&&Ui(t)}else t=null}return t},t.k.Zb=function(){for(let t=0;t<this.f.length;t++)this.f[t].b.Aa()},t.k.oc=function(t,e,i){const s=Math.min(t.c,e.c);t=Math.max(t.c,e.c),i?this.h.add(s+(t<<16)):0!==this.h.size&&this.h.delete(s+(t<<16))};var Qa=new e,th=new e,eh=new e,ih=new _,sh=null,nh=new _n,oh=new Set,rh=new _,ah=new e,hh=new e,mh=new e,ch=null,lh=new x,uh=new _n,_h=new e,ph=new e,dh=new e,fh=new _,yh=new e,vh=new _,gh=null,xh=null,bh=new _n;pi.prototype=Object.create(C.prototype),t.k=pi.prototype,t.k.qa=function(t,e,i){const s=fi(this,t.c);s?(s.a.m=!1,s.a=t,s.f.l(e),s.c.l(i),s.c.normalize(),N(s)):this.a.push(new j(t,e,i)),t.m=!0,this.Aa(),this.Wa(),vi(this)},t.k.uc=function(t,e,i){if(!(t=fi(this,t)))throw Error("Cannot find shape");t.f.l(e),t.c.l(i),t.c.normalize(),N(t),vi(this)},t.k.cc=function(t){const e=this.a;for(let i=0;i<e.length;i++){const s=e[i];if(s.a.c===t){s.a.m=!1,e[i]=e[e.length-1],e.pop();break}}this.Aa(),this.Wa(),vi(this)},t.k.Aa=function(){const t=$a.j;this.f=0,this.j=4294967295;for(let e=0;e<this.a.length;e++){const i=this.a[e].a;this.f|=1<<i.j,this.j&=t[i.j]}},t.k.Wa=function(){this.N=!1;for(let t=0;t<this.a.length;t++)if(this.a[t].a.N){this.N=!0;break}};var Ah=new T,wh=new e,Bh=new e,Mh=new e,Ch=new e,zh=new e;Object.defineProperty(xi.prototype,"mass",{get(){return this.B},set(t){1e-5>Math.abs(this.B-t)||(this.B=t,this.xa=1/t,this.ba())}}),Object.defineProperty(xi.prototype,"isDynamic",{get(){return!!(1&this.a)}}),Object.defineProperty(xi.prototype,"isKinematic",{get(){return!!(2&this.a)},set(t){t===!!(2&this.a)||t&&4&this.a||(t?(this.a|=2,this.a&=-2,Pi(this)):(this.a&=-3,4&this.a||(this.a|=1)),this.ba())}}),Object.defineProperty(xi.prototype,"isStatic",{get(){return!!(4&this.a)},set(t){t!==!!(4&this.a)&&(t?(this.a|=4,this.a&=-2,this.a&=-3,Pi(this)):(this.a&=-5,2&this.a||(this.a|=1)),this.ba())}}),Object.defineProperty(xi.prototype,"useGravity",{get(){return!!(16&this.a)},set(t){t!==!!(16&this.a)&&(this.a=t?16|this.a:-17&this.a,this.M(!0))}}),Object.defineProperty(xi.prototype,"disableCollisions",{get(){return!!(8&this.a)},set(t){t!==!!(8&this.a)&&(this.a=t?8|this.a:-9&this.a,this.M(!0))}}),Object.defineProperty(xi.prototype,"isSleeping",{get(){return!!(512&this.a)},set(t){this.a=t?512|this.a:-513&this.a}}),Object.defineProperty(xi.prototype,"positionLockX",{get(){return!!(1&this.c)},set(t){t!==!!(1&this.c)&&(this.c=t?1|this.c:-2&this.c,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"positionLockY",{get(){return!!(2&this.c)},set(t){t!==!!(2&this.c)&&(this.c=t?2|this.c:-3&this.c,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"positionLockZ",{get(){return!!(4&this.c)},set(t){t!==!!(4&this.c)&&(this.c=t?4|this.c:-5&this.c,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"rotationLockX",{get(){return!!(1&this.h)},set(t){t!==!!(1&this.h)&&(this.h=t?1|this.h:-2&this.h,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"rotationLockY",{get(){return!!(2&this.h)},set(t){t!==!!(2&this.h)&&(this.h=t?2|this.h:-3&this.h,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"rotationLockZ",{get(){return!!(4&this.h)},set(t){t!==!!(4&this.h)&&(this.h=t?4|this.h:-5&this.h,Li(this),Si(this),this.M(!0))}}),Object.defineProperty(xi.prototype,"_body",{set(){}}),Object.defineProperty(xi.prototype,"_entity",{set(){}}),t.k=xi.prototype,t.k.na=function(){return yi(this.b)},t.k.aa=function(){if(!(1024&this.a))return this.P;if(1&this.a&&1/0!==this.B){var t=Yh,e=wi(this);t.data[0]=e.a,t.data[1]=e.f,t.data[2]=e.j,t.data[3]=e.b,t.data[4]=e.g,t.data[5]=e.m,t.data[6]=e.c,t.data[7]=e.h,t.data[8]=e.s,P(Yh,Wh),Wh.multiply(function(t){return 2&t.b&&gi(t),t.c.a}(this.b)),k(this.P,Wh,Yh);{e=(t=this.P).data[0];const s=t.data[3],n=t.data[6],o=t.data[1],r=t.data[4],a=t.data[7],h=t.data[2],m=t.data[5],c=t.data[8],l=c*r-a*m,u=-c*o+a*h,_=m*o-r*h;var i=e*l+s*u+n*_;i&&(i=1/i,t.data[0]=l*i,t.data[1]=u*i,t.data[2]=_*i,t.data[3]=(-c*s+n*m)*i,t.data[4]=(c*e-n*h)*i,t.data[5]=(-m*e+s*h)*i,t.data[6]=(a*s-n*r)*i,t.data[7]=(-a*e+n*o)*i,t.data[8]=(r*e-s*o)*i)}}else(t=this.P).data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=1,t.data[5]=0,t.data[6]=0,t.data[7]=0,t.data[8]=1;return this.a&=-1025,this.P},t.k.yb=function(){var t=this.b;return 2&t.b&&gi(t),(t=t.c).g||q(t),t.g},t.k.zb=function(){var t=this.b;return 2&t.b&&gi(t),(t=t.c).f||q(t),t.f},t.k.Vb=function(){return this.v},t.k.oa=function(t){l(this.v,t,Number.EPSILON)||(this.v.l(t),Ti(this))},t.k.W=function(){return 2048&this.a?(this.s.A(this.na(),Vh),this.F.l(this.v),this.F.add(Vh),this.a&=-2049,this.F):this.F},t.k.Ab=function(){return this.s},t.k.ta=function(t){p(t,this.s,Number.EPSILON)||(this.s.l(t),this.s.normalize(),Ti(this))},t.k.Bb=function(t,e){l(this.v,t,Number.EPSILON)&&p(this.s,e,Number.EPSILON)||(this.v.l(t),this.s.l(e),this.s.normalize(),Ti(this))},t.k.Wb=function(t,e){e.x=this.s.x,e.y=this.s.y,e.z=this.s.z,e.w=this.s.w,t.x=this.v.x,t.y=this.v.y,t.z=this.v.z},t.k.$b=function(t){var e=this.b;l(e.h,t)||(e.b|=4,e.b|=2,e.h.l(t)),Ti(this)},t.k.ec=function(){var t=this.b;t.b&=-5,t.b|=2,Ti(this)},t.k.ab=function(t,e,s,n,o,r){wi(this).A(t,Eh),wi(this).A(e,Fh),t=this.b,s-=r.length;var a=Eh,h=Fh;for(e=yi(t),i(Bh,a,e),i(Mh,h,e),a=[],h=0;h<t.a.length;h++){const i=t.a[h];if(0!=(n&1<<i.a.j)&&(!i.a.N||o)){i.g.A(Bh,Ch),i.g.A(Mh,zh);var m=i.a;if(M(m.g,Ch,zh)&&(null!==(m=m.va(Ch,zh))&&(m.f=i.a,y(i.transform,m.u),m.u.S(e),a.push(m)),a.length>=s))break}}for(n=a,o=0;o<n.length;o++)(t=n[o]).b=this,y(Ai(this),t.u),Ai(this).U(t.o),r.push(t)},t.k.Kb=function(t){this.g.x+=t.x,this.g.y+=t.y,this.g.z+=t.z,Li(this),this.a|=16384,this.M(!0)},t.k.Jb=function(t){this.m.x+=t.x,this.m.y+=t.y,this.m.z+=t.z,this.a|=16384,this.M(!0)},t.k.Hb=function(t){this.j.x+=t.x,this.j.y+=t.y,this.j.z+=t.z,this.a|=16384,this.M(!0)},t.k.hc=function(t){this.f.l(t),Si(this),this.M(!0)},t.k.Ib=function(t){this.f.x+=t.x,this.f.y+=t.y,this.f.z+=t.z,this.a|=16384,this.M(!0)},t.k.pc=function(t){this.g.l(t),Li(this),this.M(!0)},t.k.Mb=function(t,e){Nh.set(t.x,t.y,t.z),Jh.set(e.x,e.y,e.z),Hh.l(Jh),Hh.S(this.W()),a(Hh,Nh),this.m.add(Nh),this.j.add(Hh),this.a|=16384,this.M(!0)},t.k.Pa=function(t,e){Ai(this).A(t,e),this.mb(e,e)},t.k.mb=function(t,e){s(Uh,t,this.W()),h(e,this.f,Uh),e.add(this.g)},t.k.Sb=function(t,i){var s=fi(this.b,t.c);return t=Xi(cm.za),Di(t,this,s),s=new e,Bn.J(i),ot(t,Bn,s,Mn)||s.l(i),Ji(t),s},t.k.M=function(t=!1){this.a&=-513,t&&(this.$=.1)},t.k.ba=function(){this.a|=2048,this.a|=1024,this.a|=4096,this.a|=8192,this.a|=16384,this.a|=32768,vi(this.b),this.M()};var Ih=0,Sh=1,Lh={xc:Ih,vc:Sh,wc:2},Ph=class{constructor(t){this.body=t,this.a=new _n}},kh=new d,Vh=new e,Oh=new e,Th=new e,Eh=new e,Fh=new e,qh=new e,Dh=new e,Rh=new e,jh=new _,Nh=new e,Jh=new e,Hh=new e;new pc.Vec3;var Uh=new e,Yh=new I,Wh=new I,Gh=new e,Kh=new e,Zh=new _,Xh=new d,$h=class{constructor(t){this.a=t,this.b=null,this.f=[],this.c=!1,this.g=[]}};qi.prototype.T=function(t,e){v(this.c,t,tm),this.b.T(tm,e),y(this.transform,e)};var Qh=new e,tm=new e,em=1,im=2,sm=4;Hi.prototype.F=function(){null!==this.K&&(this.K.ja(),lm(cm.Ba,this.K),this.K=null),null!==this.L&&(this.L.ja(),lm(cm.Da,this.L),this.L=null),this.H=this.v=this.j=this.h=null,this.P=this.R=0,this.s=!1,this.m=0,this.$.set(0,0,0),lm(cm.O,this)};const nm=new Float64Array(524288);let om=0;const rm=[],am=[],hm=[],mm=[];var cm={Cb:0,O:1,Ca:2,Ba:3,Da:4,ha:5,za:6,ia:7,Z:8,wa:9,Ja:10,Ia:11,Ka:12,Ea:13},lm=Gi;Zi(cm.Cb,()=>new e),Zi(cm.O,()=>new Hi),Zi(cm.Ca,()=>new Pt),Zi(cm.Ba,()=>new ni),Zi(cm.Da,()=>new oi),Zi(cm.ha,()=>new tt),Zi(cm.za,()=>new qi),Zi(cm.ia,()=>new de),Zi(cm.Z,()=>new fe),Zi(cm.wa,()=>new ve),Zi(cm.Ja,()=>new xe),Zi(cm.Ia,()=>new be),Zi(cm.Ka,()=>new Ae),Zi(cm.Ea,()=>new It);const um={EPSILON:1e-5,RigidBody:xi,ConvexHullShape:Nt,SphereShape:Fe,CapsuleShape:Ee,MeshShape:yt,AABB:x,Vector3:e,PhysicMaterial:z,Constraint:ti,ConstraintRow:$e,World:li,RayIntersection:tt,ContactDetails:Hi,Quaternion:_,Matrix4:d};"undefined"!=typeof window&&(window.Goblin=um),Qi(e.prototype,{x:"x",y:"y",z:"z"}),ts(e.prototype,e.prototype.set,"set"),ts(e.prototype,e.prototype.normalize,"normalize"),ts(e.prototype,e.prototype.l,"copy"),ts(e.prototype,e.prototype.i,"dot"),Qi(_.prototype,{x:"x",y:"y",z:"z",w:"w"}),ts(_.prototype,_.prototype.set,"set"),ts(_.prototype,_.prototype.a,"transformVector3"),ts(d.prototype,d.prototype.U,"rotateVector3"),ts(d.prototype,d.prototype.pa,"makeTransform"),ts(I.prototype,I.prototype.A,"transformVector3Into"),Qi(x.prototype,{min:"min",max:"max"}),ts(x.prototype,x.prototype.transform,"transform"),ts(li,(function(){if($a)throw Error("It is a really bad idea to initialize two worlds in the same time");return $a=new li}),"initialize"),Qi(li.prototype,{s:"gravity",b:"solver",m:"eventEmitter",j:"collision_matrix"}),ts(li.prototype,li.prototype.Lb,"addRigidBody"),ts(li.prototype,li.prototype.dc,"removeRigidBody"),ts(li.prototype,li.prototype.Db,"addConstraint"),ts(li.prototype,li.prototype.Eb,"removeConstraint"),ts(li.prototype,li.prototype.Fb,"step"),ts(li.prototype,li.prototype.Qb,"emitEvents"),ts(li.prototype,li.prototype.Zb,"onCollisionMatrixUpdated"),ts(li.prototype,li.prototype.tc,"testRayIntersectPc"),ts(li.prototype,li.prototype.bc,"rayIntersectPc"),ts(li.prototype,li.prototype.Ua,"rayIntersectAllPc"),ts(li.prototype,li.prototype.sc,"shapeCastPc"),ts(li.prototype,li.prototype.ub,"shapeCastAllPc"),ts(li.prototype,li.prototype.Ub,"getIntersectingShapesPc"),ts(li.prototype,li.prototype.Tb,"getContactPc"),ts(li.prototype,li.prototype.oc,"setIgnoreCollision"),Qi(ri.prototype,{f:"max_iterations"}),ts(xi,Lh,"CollisionDetectionMode"),Qi(xi.prototype,{b:"shape",f:"angular_velocity",R:"maxAngularVelocity",g:"linear_velocity",bb:"linear_damping",$a:"angular_damping",H:"collisionDetectionMode"}),ts(xi.prototype,xi.prototype.Wb,"getTransform"),ts(xi.prototype,xi.prototype.Bb,"setTransform"),ts(xi.prototype,xi.prototype.Vb,"getPosition"),ts(xi.prototype,xi.prototype.W,"getCOMAdjustedPosition"),ts(xi.prototype,xi.prototype.oa,"setPosition"),ts(xi.prototype,xi.prototype.Ab,"getRotation"),ts(xi.prototype,xi.prototype.ta,"setRotation"),ts(xi.prototype,xi.prototype.ba,"onShapeUpdated"),ts(xi.prototype,xi.prototype.Jb,"addLinearImpulse"),ts(xi.prototype,xi.prototype.Kb,"addLinearVelocity"),ts(xi.prototype,xi.prototype.Hb,"addAngularImpulse"),ts(xi.prototype,xi.prototype.Ib,"addAngularVelocity"),ts(xi.prototype,xi.prototype.hc,"setAngularVelocity"),ts(xi.prototype,xi.prototype.pc,"setLinearVelocity"),ts(xi.prototype,xi.prototype.Mb,"applyImpulseAtWorldPoint"),ts(xi.prototype,xi.prototype.Pa,"getVelocityInLocalPoint"),ts(xi.prototype,xi.prototype.mb,"getVelocityInGlobalPoint"),ts(xi.prototype,xi.prototype.ab,"rayIntersect"),ts(xi.prototype,xi.prototype.Sb,"getClosestPointOnShape"),ts(xi.prototype,xi.prototype.M,"wakeUp"),ts(xi.prototype,xi.prototype.aa,"getInverseInertiaTensorWorldFrame"),ts(xi.prototype,xi.prototype.yb,"getDiagonalizedInertiaTensor"),ts(xi.prototype,xi.prototype.zb,"getDiagonalizedInertiaTensorRotation"),ts(xi.prototype,xi.prototype.na,"getCenterOfMass"),ts(xi.prototype,xi.prototype.$b,"overrideCenterOfMass"),ts(xi.prototype,xi.prototype.ec,"resetCenterOfMass"),ts(Lh,Ih,"Discrete"),ts(Lh,Sh,"ContinuousConservativeAdvancement"),ts(Lh,2,"ContinuousSpeculative"),Qi(C.prototype,{N:"isTrigger",g:"aabb"}),Qi(R.prototype,{c:"uid",a:"material",j:"layer"}),Qi(pi.prototype,{a:"child_shapes"}),ts(pi.prototype,pi.prototype.Aa,"updateLayersMasks"),ts(pi.prototype,pi.prototype.Wa,"updateIsTriggerFlag"),ts(pi.prototype,pi.prototype.qa,"addChildShape"),ts(pi.prototype,pi.prototype.uc,"updateShapeTransform"),ts(pi.prototype,pi.prototype.cc,"removeChildShape"),Qi(j.prototype,{a:"shape",b:"aabb"}),ts(Nt,(function(t,i,s,n,o,r){return i=Math.max(i,1e-4),s=Math.max(s,1e-4),n=Math.max(n,1e-4),new Nt(t,[new e(i,s,n),new e(i,s,-n),new e(-i,s,-n),new e(-i,s,n),new e(i,-s,n),new e(i,-s,-n),new e(-i,-s,-n),new e(-i,-s,n)],o,!0,r)}),"fromAABB"),ts(Nt,(function(t){Xt(ro,t);let i=ro.max.x-ro.min.x,s=ro.max.y-ro.min.y,n=ro.max.z-ro.min.z;if(!(1e-6<i&&1e-6<s&&1e-6<n&&3<t.length)){var o=1/0;1e-6<i&&i<o&&(o=i),1e-6<s&&s<o&&(o=s),1e-6<n&&n<o&&(o=n),1/0===o?n=s=i=.01:(i=1e-6>i?.05*o:i/2,s=1e-6>s?.05*o:s/2,n=1e-6>n?.05*o:n/2),o=(ro.min.x+ro.max.x)/2;var r=(ro.min.y+ro.max.y)/2,a=(ro.min.z+ro.max.z)/2;t.length=0,t.push(new e(i+o,s+r,n+a),new e(i+o,s+r,-n+a),new e(-i+o,s+r,-n+a),new e(-i+o,s+r,n+a),new e(i+o,-s+r,n+a),new e(i+o,-s+r,-n+a),new e(-i+o,-s+r,-n+a),new e(-i+o,-s+r,n+a))}}),"approximateByAABBIfNecessary"),ts(Nt.prototype,Nt.prototype.xb,"getShallowCopy"),ts(yt.prototype,yt.prototype.v,"getShallowCopy"),Qi(tt.prototype,{b:"object",f:"shape",u:"point",o:"normal",a:"distance",g:"triangleIndex",ea:"barycentricCoordinates"}),ts(tt.prototype,tt.prototype.c,"dispose"),Qi(z.prototype,{name:"name",b:"bounciness",c:"dynamicFriction",g:"staticFriction",f:"frictionCombine",a:"bounceCombine"}),Qi(ti.prototype,{a:"object_a",b:"object_b",c:"rows",j:"objectAIsDynamic",m:"objectBIsDynamic",v:"disablesCollisionBetweenObjects",F:"breakForce",L:"breakTorque",g:"massScaleA",h:"massScaleB"}),ts(ti.prototype,ti.prototype.Ma,"activate"),ts(ti.prototype,ti.prototype.ja,"deactivate"),ts(ti.prototype,ti.prototype.jc,"setBodyA"),ts(ti.prototype,ti.prototype.kc,"setBodyB"),ts(ti.prototype,ti.prototype.mc,"setDisableCollisionFlag"),ts($e.prototype,$e.prototype.Xa,"reset"),ts($e.prototype,$e.prototype.Xb,"markAsPositional"),ts($e.prototype,$e.prototype.ka,"setJacobianA"),ts($e.prototype,$e.prototype.la,"setJacobianB"),ts($e.prototype,$e.prototype.Rb,"getBias"),ts($e.prototype,$e.prototype.ic,"setBias"),ts($e.prototype,$e.prototype.lc,"setCFM"),ts($e.prototype,$e.prototype.qc,"setLowerLimit"),ts($e.prototype,$e.prototype.rc,"setUpperLimit"),ts($e.prototype,$e.prototype.fc,"resetJacobianA"),ts($e.prototype,$e.prototype.tb,"resetJacobianB"),ts($e.prototype,$e.prototype.ac,"preventWarmStart"),Qi(Hi.prototype,{v:"bodyA",H:"bodyB",C:"shape_a",B:"shape_b",f:"contact_point",c:"contact_normal",g:"penetration_depth",$:"relativeVelocity"}),ts(Hi.prototype,Hi.prototype.F,"dispose"),Qi(ci.prototype,{b:"_onCollisionContactEnter",f:"_onCollisionContactStay",c:"_onCollisionContactExit",g:"_onTriggerContactEnter",j:"_onTriggerContactStay",h:"_onTriggerContactExit"}),es(St.prototype.g),es(St.prototype.h),es(Ze.prototype.f),es(Ze.prototype.c),es(ci.prototype.a),es(ri.prototype.sb),es(ri.prototype.qb),es(ri.prototype.Oa),es(ri.prototype.rb),es(ri.prototype.vb),es(ri.prototype.wb),es(ri.prototype.Ya),es(ti.prototype.R),es($e.prototype.ib),es($e.prototype.jb),es($e.prototype.kb),es($e.prototype.pb),es($e.prototype.lb),es(Bt),es(Nt.prototype.cb),es(Nt.prototype.gb),es(Nt.prototype.fb),es(Nt.prototype.eb),es(Ne)}.call(this||window,window.__wpcc=window.__wpcc||{});
/*!
 * 
 * Planck.js v0.3.1
 * 
 * Copyright (c) 2016-2018 Ali Shakiba http://shakiba.me/planck.js
 * Copyright (c) 2006-2013 Erin Catto  http://www.gphysics.com
 * 
 * This software is provided 'as-is', without any express or implied
 * warranty.  In no event will the authors be held liable for any damages
 * arising from the use of this software.
 * 
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 * 
 * 1. The origin of this software must not be misrepresented; you must not
 * claim that you wrote the original software. If you use this software
 * in a product, an acknowledgment in the product documentation would be
 * appreciated but is not required.
 * 2. Altered source versions must be plainly marked as such, and must not be
 * misrepresented as being the original software.
 * 3. This notice may not be removed or altered from any source distribution.
 * 
 */
var planck=function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=44)}([function(t,e,i){var s=!1;t.exports=r;var n=i(2),o=i(1);function r(t,e){if(!(this instanceof r))return new r(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),s&&r.assert(this)}r.zero=function(){var t=Object.create(r.prototype);return t.x=0,t.y=0,t},r.ZERO=r.zero(),r.neo=function(t,e){var i=Object.create(r.prototype);return i.x=t,i.y=e,i},r.clone=function(t){return s&&r.assert(t),r.neo(t.x,t.y)},r.prototype.toString=function(){return JSON.stringify(this)},r.isValid=function(t){return t&&o.isFinite(t.x)&&o.isFinite(t.y)},r.assert=function(t){if(s&&!r.isValid(t))throw new Error("Invalid Vec2!")},r.prototype.clone=function(){return r.clone(this)},r.prototype.setZero=function(){return this.x=0,this.y=0,this},r.prototype.set=function(t,e){return"object"==typeof t?(s&&r.assert(t),this.x=t.x,this.y=t.y):(s&&o.assert(t),s&&o.assert(e),this.x=t,this.y=e),this},r.prototype.wSet=function(t,e,i,s){return void 0!==i||void 0!==s?this.setCombine(t,e,i,s):this.setMul(t,e)},r.prototype.setCombine=function(t,e,i,n){s&&o.assert(t),s&&r.assert(e),s&&o.assert(i),s&&r.assert(n);var a=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x=a,this.y=h,this},r.prototype.setMul=function(t,e){s&&o.assert(t),s&&r.assert(e);var i=t*e.x,n=t*e.y;return this.x=i,this.y=n,this},r.prototype.add=function(t){return s&&r.assert(t),this.x+=t.x,this.y+=t.y,this},r.prototype.wAdd=function(t,e,i,s){return void 0!==i||void 0!==s?this.addCombine(t,e,i,s):this.addMul(t,e)},r.prototype.addCombine=function(t,e,i,n){s&&o.assert(t),s&&r.assert(e),s&&o.assert(i),s&&r.assert(n);var a=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x+=a,this.y+=h,this},r.prototype.addMul=function(t,e){s&&o.assert(t),s&&r.assert(e);var i=t*e.x,n=t*e.y;return this.x+=i,this.y+=n,this},r.prototype.wSub=function(t,e,i,s){return void 0!==i||void 0!==s?this.subCombine(t,e,i,s):this.subMul(t,e)},r.prototype.subCombine=function(t,e,i,n){s&&o.assert(t),s&&r.assert(e),s&&o.assert(i),s&&r.assert(n);var a=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x-=a,this.y-=h,this},r.prototype.subMul=function(t,e){s&&o.assert(t),s&&r.assert(e);var i=t*e.x,n=t*e.y;return this.x-=i,this.y-=n,this},r.prototype.sub=function(t){return s&&r.assert(t),this.x-=t.x,this.y-=t.y,this},r.prototype.mul=function(t){return s&&o.assert(t),this.x*=t,this.y*=t,this},r.prototype.length=function(){return r.lengthOf(this)},r.prototype.lengthSquared=function(){return r.lengthSquared(this)},r.prototype.normalize=function(){var t=this.length();if(t<o.EPSILON)return 0;var e=1/t;return this.x*=e,this.y*=e,t},r.prototype.normal=function(){var t=this.length();if(t<o.EPSILON)return this;var e=1/t;return this.x*=e,this.y*=e,this},r.prototype.rot=function(t){var e=this.x,i=this.y;return this.x=t.c*e-t.s*i,this.y=t.s*e+t.c*i,this},r.prototype.rotate=function(t,e){var i=this.x,s=this.y;return this.x=t*i-e*s,this.y=e*i+t*s,this},r.prototype.rotT=function(t){var e=this.x,i=this.y;return this.x=t.c*e+t.s*i,this.y=-t.s*e+t.c*i,this},r.prototype.closeTo=function(t){var e=this.x-t.x;if(e>o.EPSILON||e<-o.EPSILON)return!1;var i=this.y-t.y;return-o.EPSILON<=i&&i<=o.EPSILON},r.prototype.closeToValues=function(t,e){var i=this.x-t;if(i>o.EPSILON||i<-o.EPSILON)return!1;var s=this.y-e;return-o.EPSILON<=s&&s<=o.EPSILON},r.lengthOf=function(t){return s&&r.assert(t),o.sqrt(t.x*t.x+t.y*t.y)},r.lengthSquared=function(t){return s&&r.assert(t),t.x*t.x+t.y*t.y},r.distance=function(t,e){s&&r.assert(t),s&&r.assert(e);var i=t.x-e.x,n=t.y-e.y;return o.sqrt(i*i+n*n)},r.distanceSquared=function(t,e){s&&r.assert(t),s&&r.assert(e);var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},r.areEqual=function(t,e){return s&&r.assert(t),s&&r.assert(e),t==e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},r.skew=function(t){return s&&r.assert(t),r.neo(-t.y,t.x)},r.dot=function(t,e){return s&&r.assert(t),s&&r.assert(e),t.x*e.x+t.y*e.y},r.cross=function(t,e){return"number"==typeof e?(s&&r.assert(t),s&&o.assert(e),r.neo(e*t.y,-e*t.x)):"number"==typeof t?(s&&o.assert(t),s&&r.assert(e),r.neo(-t*e.y,t*e.x)):(s&&r.assert(t),s&&r.assert(e),t.x*e.y-t.y*e.x)},r.addCross=function(t,e,i){return"number"==typeof i?(s&&r.assert(e),s&&o.assert(i),r.neo(i*e.y+t.x,-i*e.x+t.y)):"number"==typeof e?(s&&o.assert(e),s&&r.assert(i),r.neo(-e*i.y+t.x,e*i.x+t.y)):void(s&&n.assert(!1))},r.add=function(t,e){return s&&r.assert(t),s&&r.assert(e),r.neo(t.x+e.x,t.y+e.y)},r.wAdd=function(t,e,i,s){return void 0!==i||void 0!==s?r.combine(t,e,i,s):r.mul(t,e)},r.combine=function(t,e,i,s){return r.zero().setCombine(t,e,i,s)},r.sub=function(t,e){return s&&r.assert(t),s&&r.assert(e),r.neo(t.x-e.x,t.y-e.y)},r.mul=function(t,e,i){return"object"==typeof t?(s&&r.assert(t),s&&o.assert(e),i?i.set(t.x*e,t.y*e):r.neo(t.x*e,t.y*e)):"object"==typeof e?(s&&o.assert(t),s&&r.assert(e),i?i.set(t*e.x,t*e.y):r.neo(t*e.x,t*e.y)):void 0},r.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},r.neg=function(t){return s&&r.assert(t),r.neo(-t.x,-t.y)},r.abs=function(t){return s&&r.assert(t),r.neo(o.abs(t.x),o.abs(t.y))},r.mid=function(t,e,i){s&&r.assert(t),s&&r.assert(e);var n=.5*(t.x+e.x),o=.5*(t.y+e.y);return i?i.set(n,o):r.neo(n,o)},r.upper=function(t,e){return s&&r.assert(t),s&&r.assert(e),r.neo(o.max(t.x,e.x),o.max(t.y,e.y))},r.lower=function(t,e){return s&&r.assert(t),s&&r.assert(e),r.neo(o.min(t.x,e.x),o.min(t.y,e.y))},r.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var i=o.invSqrt(e);this.x*=i*t,this.y*=i*t}return this},r.clamp=function(t,e){return(t=r.neo(t.x,t.y)).clamp(e),t},r.scaleFn=function(t,e){return function(i){return r.neo(i.x*t,i.y*e)}},r.translateFn=function(t,e){return function(i){return r.neo(i.x+t,i.y+e)}}},function(t,e,i){i(2);var s=i(6),n=Math,o=t.exports=s(n);o.EPSILON=1e-9,o.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},o.assert=function(t){},o.invSqrt=function(t){return 1/n.sqrt(t)},o.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},o.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},o.mod=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},o.clamp=function(t,e,i){return t<e?e:t>i?i:t},o.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:n.random()*(e-t)+t}},function(t,e,i){e.debug=function(){},e.assert=function(t,e,i){}},function(t,e,i){t.exports=o;i(2);var s=i(0),n=i(4);function o(t,e){if(!(this instanceof o))return new o(t,e);this.p=s.zero(),this.q=n.identity(),void 0!==t&&this.p.set(t),void 0!==e&&this.q.set(e)}o.clone=function(t){var e=Object.create(o.prototype);return e.p=s.clone(t.p),e.q=n.clone(t.q),e},o.neo=function(t,e){var i=Object.create(o.prototype);return i.p=s.clone(t),i.q=n.clone(e),i},o.identity=function(){var t=Object.create(o.prototype);return t.p=s.zero(),t.q=n.identity(),t},o.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},o.prototype.set=function(t,e){void 0===e?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},o.isValid=function(t){return t&&s.isValid(t.p)&&n.isValid(t.q)},o.assert=function(t){},o.mul=function(t,e){if(Array.isArray(e)){for(var i=[],r=0;r<e.length;r++)i[r]=o.mul(t,e[r]);return i}if("x"in e&&"y"in e){var a=t.q.c*e.x-t.q.s*e.y+t.p.x,h=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(a,h)}if("p"in e&&"q"in e){var m=o.identity();return m.q=n.mulRot(t.q,e.q),m.p=s.add(n.mulVec2(t.q,e.p),t.p),m}},o.mulAll=function(t,e){for(var i=[],s=0;s<e.length;s++)i[s]=o.mul(t,e[s]);return i},o.mulFn=function(t){return function(e){return o.mul(t,e)}},o.mulVec2=function(t,e,i){var n=t.q.c*e.x-t.q.s*e.y+t.p.x,o=t.q.s*e.x+t.q.c*e.y+t.p.y;return i?i.set(n,o):s.neo(n,o)},o.mulXf=function(t,e){var i=o.identity();return i.q=n.mulRot(t.q,e.q),i.p=s.add(n.mulVec2(t.q,e.p),t.p),i},o.mulT=function(t,e){if("x"in e&&"y"in e){var i=e.x-t.p.x,r=e.y-t.p.y,a=t.q.c*i+t.q.s*r,h=-t.q.s*i+t.q.c*r;return s.neo(a,h)}if("p"in e&&"q"in e){var m=o.identity();return m.q.set(n.mulTRot(t.q,e.q)),m.p.set(n.mulTVec2(t.q,s.sub(e.p,t.p))),m}},o.mulTVec2=function(t,e,i){var n=e.x-t.p.x,o=e.y-t.p.y,r=t.q.c*n+t.q.s*o,a=-t.q.s*n+t.q.c*o;return i?i.set(r,a):s.neo(r,a)},o.mulTXf=function(t,e){var i=o.identity();return i.q.set(n.mulTRot(t.q,e.q)),i.p.set(n.mulTVec2(t.q,s.sub(e.p,t.p))),i}},function(t,e,i){t.exports=o;i(2);var s=i(0),n=i(1);function o(t){if(!(this instanceof o))return new o(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}o.neo=function(t){var e=Object.create(o.prototype);return e.setAngle(t),e},o.clone=function(t){var e=Object.create(o.prototype);return e.s=t.s,e.c=t.c,e},o.identity=function(){var t=Object.create(o.prototype);return t.s=0,t.c=1,t},o.isValid=function(t){return t&&n.isFinite(t.s)&&n.isFinite(t.c)},o.assert=function(t){},o.prototype.setIdentity=function(){this.s=0,this.c=1},o.prototype.set=function(t){"object"==typeof t?(this.s=t.s,this.c=t.c):(this.s=n.sin(t),this.c=n.cos(t))},o.prototype.setCS=function(t,e){this.c=t,this.s=e},o.prototype.setAngle=function(t){this.s=n.sin(t),this.c=n.cos(t)},o.prototype.getAngle=function(){return n.atan2(this.s,this.c)},o.prototype.getXAxis=function(){return s.neo(this.c,this.s)},o.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},o.mul=function(t,e){if("c"in e&&"s"in e){var i=o.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},o.mulRot=function(t,e){var i=o.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i},o.mulVec2=function(t,e){return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},o.mulSub=function(t,e,i){var n=t.c*(e.x-i.x)-t.s*(e.y-i.y),o=t.s*(e.x-i.y)+t.c*(e.y-i.y);return s.neo(n,o)},o.mulT=function(t,e){if("c"in e&&"s"in e){var i=o.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},o.mulTRot=function(t,e){var i=o.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i},o.mulTVec2=function(t,e){return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},function(t,e,i){var s=e;s.maxManifoldPoints=2,s.maxPolygonVertices=12,s.aabbExtension=.1,s.aabbMultiplier=2,s.linearSlop=.005,s.linearSlopSquared=s.linearSlop*s.linearSlop,s.angularSlop=2/180*Math.PI,s.polygonRadius=2*s.linearSlop,s.maxSubSteps=8,s.maxTOIContacts=32,s.maxTOIIterations=20,s.maxDistnceIterations=20,s.velocityThreshold=1,s.maxLinearCorrection=.2,s.maxAngularCorrection=8/180*Math.PI,s.maxTranslation=2,s.maxTranslationSquared=s.maxTranslation*s.maxTranslation,s.maxRotation=.5*Math.PI,s.maxRotationSquared=s.maxRotation*s.maxRotation,s.baumgarte=.2,s.toiBaugarte=.75,s.timeToSleep=.5,s.linearSleepTolerance=.01,s.linearSleepToleranceSqr=Math.pow(s.linearSleepTolerance,2),s.angularSleepTolerance=2/180*Math.PI,s.angularSleepToleranceSqr=Math.pow(s.angularSleepTolerance,2)},function(t,e){if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function i(){}t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return i.prototype=t,new i}}},function(t,e,i){Object.prototype.propertyIsEnumerable;t.exports=function(t,e){for(var i in null==t&&(t={}),e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);if("function"==typeof Object.getOwnPropertySymbols)for(var s=Object.getOwnPropertySymbols(e),n=0;n<s.length;n++){var o=s[n];e.propertyIsEnumerable(o)&&void 0===t[i]&&(t[o]=e[o])}return t}},function(t,e,i){var s=!1;t.exports=o;i(2);var n=i(1);function o(t,e,i){if(!(this instanceof o))return new o(t,e,i);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),s&&o.assert(this)}o.neo=function(t,e,i){var s=Object.create(o.prototype);return s.x=t,s.y=e,s.z=i,s},o.clone=function(t){return s&&o.assert(t),o.neo(t.x,t.y,t.z)},o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&n.isFinite(t.x)&&n.isFinite(t.y)&&n.isFinite(t.z)},o.assert=function(t){if(s&&!o.isValid(t))throw new Error("Invalid Vec3!")},o.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},o.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},o.areEqual=function(t,e){return s&&o.assert(t),s&&o.assert(e),t==e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},o.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o.cross=function(t,e){return new o(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},o.add=function(t,e){return new o(t.x+e.x,t.y+e.y,t.z+e.z)},o.sub=function(t,e){return new o(t.x-e.x,t.y-e.y,t.z-e.z)},o.mul=function(t,e){return new o(e*t.x,e*t.y,e*t.z)},o.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},o.neg=function(t){return new o(-t.x,-t.y,-t.z)}},function(t,e,i){t.exports=n;i(2),i(1);var s=i(0);function n(t,e,i,n){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,i),this.ey=s.neo(e,n)):(this.ex=s.zero(),this.ey=s.zero())}n.prototype.toString=function(){return JSON.stringify(this)},n.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},n.assert=function(t){},n.prototype.set=function(t,e,i,s){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof s?(this.ex.set(t,i),this.ey.set(e,s)):"object"==typeof t&&"object"==typeof e?(this.ex.set(t),this.ey.set(e)):"object"==typeof t&&(this.ex.set(t.ex),this.ey.set(t.ey))},n.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},n.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},n.prototype.getInverse=function(){var t=this.ex.x,e=this.ey.x,i=this.ex.y,s=this.ey.y,o=t*s-e*i;0!=o&&(o=1/o);var r=new n;return r.ex.x=o*s,r.ey.x=-o*e,r.ex.y=-o*i,r.ey.y=o*t,r},n.prototype.solve=function(t){var e=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,r=e*o-i*n;0!=r&&(r=1/r);var a=s.zero();return a.x=r*(o*t.x-i*t.y),a.y=r*(e*t.y-n*t.x),a},n.mul=function(t,e){if(e&&"x"in e&&"y"in e){var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}if(e&&"ex"in e&&"ey"in e)return new n(s.mul(t,e.ex),s.mul(t,e.ey))},n.mulVec2=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,n)},n.mulMat22=function(t,e){return new n(s.mul(t,e.ex),s.mul(t,e.ey))},n.mulT=function(t,e){return e&&"x"in e&&"y"in e?s.neo(s.dot(e,t.ex),s.dot(e,t.ey)):e&&"ex"in e&&"ey"in e?new n(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey))):void 0},n.mulTVec2=function(t,e){return s.neo(s.dot(e,t.ex),s.dot(e,t.ey))},n.mulTMat22=function(t,e){return new n(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))},n.abs=function(t){return new n(s.abs(t.ex),s.abs(t.ey))},n.add=function(t,e){return new n(s.add(t.ex+e.ex),s.add(t.ey+e.ey))}},function(t,e,i){var s=!1;t.exports=m;var n=i(2),o=i(1),r=i(0),a=i(4),h=i(3);function m(t,e){s&&n.assert(void 0===t),s&&n.assert(void 0===e),this.localCenter=r.zero(),this.c=r.zero(),this.a=0,this.alpha0=0,this.c0=r.zero(),this.c1=r.zero(),this.a0=0}m.prototype.setTransform=function(t){var e=h.mulVec2(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},m.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);var i=h.mulVec2(e,this.localCenter);this.c.set(i),this.c0.set(i)},m.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(a.mulVec2(t.q,this.localCenter))},m.prototype.advance=function(t){s&&n.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},m.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)},m.prototype.normalize=function(){var t=o.mod(this.a0,-o.PI,+o.PI);this.a-=this.a0-t,this.a0=t},m.prototype.clone=function(){var t=new m;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t},m.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)}},function(t,e,i){t.exports=o;i(2),i(1);var s=i(0),n=i(8);function o(t,e,i){"object"==typeof t&&null!==t?(this.ex=n.clone(t),this.ey=n.clone(e),this.ez=n.clone(i)):(this.ex=n(),this.ey=n(),this.ez=n())}o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&n.isValid(t.ex)&&n.isValid(t.ey)&&n.isValid(t.ez)},o.assert=function(t){},o.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},o.prototype.solve33=function(t){var e=n.dot(this.ex,n.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=new n;return i.x=e*n.dot(t,n.cross(this.ey,this.ez)),i.y=e*n.dot(this.ex,n.cross(t,this.ez)),i.z=e*n.dot(this.ex,n.cross(this.ey,t)),i},o.prototype.solve22=function(t){var e=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,r=e*o-i*n;0!=r&&(r=1/r);var a=s.zero();return a.x=r*(o*t.x-i*t.y),a.y=r*(e*t.y-n*t.x),a},o.prototype.getInverse22=function(t){var e=this.ex.x,i=this.ey.x,s=this.ex.y,n=this.ey.y,o=e*n-i*s;0!=o&&(o=1/o),t.ex.x=o*n,t.ey.x=-o*i,t.ex.z=0,t.ex.y=-o*s,t.ey.y=o*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},o.prototype.getSymInverse33=function(t){var e=n.dot(this.ex,n.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=this.ex.x,s=this.ey.x,o=this.ez.x,r=this.ey.y,a=this.ez.y,h=this.ez.z;t.ex.x=e*(r*h-a*a),t.ex.y=e*(o*a-s*h),t.ex.z=e*(s*a-o*r),t.ey.x=t.ex.y,t.ey.y=e*(i*h-o*o),t.ey.z=e*(o*s-i*a),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*r-s*s)},o.mul=function(t,e){if(e&&"z"in e&&"y"in e&&"x"in e){var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,o=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,r=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new n(i,o,r)}if(e&&"y"in e&&"x"in e){i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}},o.mulVec3=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,s=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,o=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new n(i,s,o)},o.mulVec2=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,n)},o.add=function(t,e){return new o(n.add(t.ex+e.ex),n.add(t.ey+e.ey),n.add(t.ez+e.ez))}},function(t,e,i){t.exports=function(){this.v=s.zero(),this.w=0};var s=i(0)},function(t,e,i){t.exports=o;var s=i(0),n=i(4);function o(){this.c=s.zero(),this.a=0}o.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(s.sub(this.c,n.mulVec2(t.q,e))),t}},function(t,e,i){i(5);var s=i(1),n=i(0);function o(t,e){if(!(this instanceof o))return new o(t,e);this.lowerBound=n.zero(),this.upperBound=n.zero(),"object"==typeof t&&this.lowerBound.set(t),"object"==typeof e&&this.upperBound.set(e)}t.exports=o,o.prototype.isValid=function(){return o.isValid(this)},o.prototype.containsPoints=function(t,e,i){if(void 0===this.radius||void 0===this.vertex1||void 0===this.vertex2&&void 0!==i)return!1;var n=this.radius-t;return-s.EPSILON<=n&&n<=s.EPSILON&&this.vertex1.closeTo(e)&&(this.vertex2===i||this.vertex2.closeTo(i))},o.prototype.storePoints=function(t,e,i){void 0===this.vertex1?this.vertex1=n.clone(e):this.vertex1.set(e),void 0===i?this.vertex2=i:void 0===this.vertex2?this.vertex2=n.clone(i):this.vertex2.set(i),this.radius=t},o.isValid=function(t){var e=n.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&n.isValid(t.lowerBound)&&n.isValid(t.upperBound)},o.assert=function(t){},o.prototype.getCenter=function(){return n.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},o.prototype.getExtents=function(){return n.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},o.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},o.prototype.combine=function(t,e){var i=t.lowerBound,n=t.upperBound,o=e.lowerBound,r=e.upperBound,a=s.min(i.x,o.x),h=s.min(i.y,o.y),m=s.max(r.x,n.x),c=s.max(r.y,n.y);this.lowerBound.set(a,h),this.upperBound.set(m,c)},o.prototype.combinePoints=function(t,e){this.lowerBound.set(s.min(t.x,e.x),s.min(t.y,e.y)),this.upperBound.set(s.max(t.x,e.x),s.max(t.y,e.y))},o.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},o.prototype.contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},o.prototype.extend=function(t){o.extend(this,t)},o.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},o.testOverlap=function(t,e){return!(e.lowerBound.x>t.upperBound.x||e.lowerBound.y>t.upperBound.y||t.lowerBound.x>e.upperBound.x||t.lowerBound.y>e.upperBound.y)},o.areEqual=function(t,e){return n.areEqual(t.lowerBound,e.lowerBound)&&n.areEqual(t.upperBound,e.upperBound)},o.diff=function(t,e){var i=s.max(0,s.min(t.upperBound.x,e.upperBound.x)-s.max(e.lowerBound.x,t.lowerBound.x)),n=s.max(0,s.min(t.upperBound.y,e.upperBound.y)-s.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*n},o.prototype.rayCast=function(t,e){for(var i=-1/0,o=1/0,r=e.p1,a=n.sub(e.p2,e.p1),h=n.abs(a),m=n.zero(),c="x";null!==c;c="x"===c?"y":null)if(h.x<s.EPSILON){if(r[c]<this.lowerBound[c]||this.upperBound[c]<r[c])return!1}else{var l=1/a[c],u=(this.lowerBound[c]-r[c])*l,_=(this.upperBound[c]-r[c])*l,p=-1;if(u>_){var d=u;u=_,_=d,p=1}if(u>i&&(m.setZero(),m[c]=p,i=u),i>(o=s.min(o,_)))return!1}return!(i<0||e.maxFraction<i)&&(t.fraction=i,t.normal=m,!0)},o.prototype.toString=function(){return JSON.stringify(this)}},function(t,e,i){var s=!1;t.exports=r;var n=i(2);function o(){this.other=null,this.joint=null,this.prev=null,this.next=null}function r(t,e,i){e=t.bodyA||e,i=t.bodyB||i,s&&n.assert(e),s&&n.assert(i),s&&n.assert(e!=i),this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=i,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new o,this.m_edgeB=new o,this.m_islandFlag=!1,this.m_activeFlag=t.active,this.m_userData=t.userData}r.prototype.isActive=function(){return this.m_activeFlag&&this.m_bodyA.isActive()&&this.m_bodyB.isActive()},r.prototype.setActive=function(t){this.m_activeFlag=t},r.prototype.getType=function(){return this.m_type},r.prototype.getBodyA=function(){return this.m_bodyA},r.prototype.setBodyA=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyA=t,this.connectBodyA(),this.connectBodyA(),this.refilter()},r.prototype.connectBodyA=function(){var t=this.m_edgeA;t.joint=this,t.other=this.m_bodyB,t.prev=null;var e=this.m_bodyA,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},r.prototype.disconnectBodyA=function(){var t=this.m_bodyA,e=this.m_edgeA;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},r.prototype.getBodyB=function(){return this.m_bodyB},r.prototype.setBodyB=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyB=t,this.connectBodyA(),this.connectBodyB(),this.refilter()},r.prototype.connectBodyB=function(){var t=this.m_edgeB;t.joint=this,t.other=this.m_bodyA,t.prev=null;var e=this.m_bodyB,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},r.prototype.disconnectBodyB=function(){var t=this.m_bodyB,e=this.m_edgeB;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},r.prototype.refilter=function(){if(!this.m_collideConnected)for(var t=this.m_bodyB.getContactList();t;t=t.next)this.m_bodyA.equals(t.other)&&t.contact.flagForFiltering()},r.prototype.getNext=function(){return this.m_next},r.prototype.getUserData=function(){return this.m_userData},r.prototype.setUserData=function(t){this.m_userData=t},r.prototype.getCollideConnected=function(){return this.m_collideConnected},r.prototype.setCollideConnected=function(t){this.m_collideConnected=t},r.prototype.getAnchorA=function(){},r.prototype.getAnchorB=function(){},r.prototype.getReactionForce=function(t,e){},r.prototype.getReactionTorque=function(t){},r.prototype.shiftOrigin=function(t){},r.prototype.initVelocityConstraints=function(t){},r.prototype.solveVelocityConstraints=function(t){},r.prototype.solvePositionConstraints=function(t){}},function(t,e,i){t.exports=s;i(1);function s(){this.m_type,this.m_radius}s.isValid=function(t){return!!t},s.prototype.getRadius=function(){return this.m_radius},s.prototype.getType=function(){return this.m_type},s.prototype._clone=function(){},s.prototype.getChildCount=function(){},s.prototype.testPoint=function(t,e){},s.prototype.rayCast=function(t,e,i,s){},s.prototype.computeAABB=function(t,e,i){},s.prototype.setAABB=function(t,e,i){},s.prototype.resetAABB=function(t,e,i){return null},s.prototype.computeMass=function(t,e){},s.prototype.computeDistanceProxy=function(t){}},function(t,e,i){i(2);var s=i(1),n=i(0),o=i(3),r=i(9),a=i(4),h=i(5),m=i(18),c=i(21);function l(t){this.contact=t,this.prev,this.next,this.other}function u(t,e,i,s,o){this.m_nodeA=new l(this),this.m_nodeB=new l(this),this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=s,this.m_evaluateFcn=o,this.m_manifold=new m,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=p(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=d(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=n.zero(),this.v_normalMass=new r,this.v_K=new r,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=n.zero(),this.p_localPoint=n.zero(),this.p_localCenterA=n.zero(),this.p_localCenterB=n.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}function _(){this.rA=n.zero(),this.rB=n.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function p(t,e){return s.sqrt(t*e)}function d(t,e){return t>e?t:e}t.exports=u,u.prototype.initConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,s=e.getShape(),o=i.getShape(),r=e.getBody(),a=i.getBody(),h=this.getManifold(),m=h.pointCount;this.v_invMassA=r.m_invMass,this.v_invMassB=a.m_invMass,this.v_invIA=r.m_invI,this.v_invIB=a.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=m,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=r.m_invMass,this.p_invMassB=a.m_invMass,this.p_invIA=r.m_invI,this.p_invIB=a.m_invI,this.p_localCenterA=n.clone(r.m_sweep.localCenter),this.p_localCenterB=n.clone(a.m_sweep.localCenter),this.p_radiusA=s.m_radius,this.p_radiusB=o.m_radius,this.p_type=h.type,this.p_localNormal=n.clone(h.localNormal),this.p_localPoint=n.clone(h.localPoint),this.p_pointCount=m;for(var c=0;c<m;++c){var l=h.points[c],u=this.v_points[c]=new _;t.warmStarting?(u.normalImpulse=t.dtRatio*l.normalImpulse,u.tangentImpulse=t.dtRatio*l.tangentImpulse):(u.normalImpulse=0,u.tangentImpulse=0),u.rA.setZero(),u.rB.setZero(),u.normalMass=0,u.tangentMass=0,u.velocityBias=0,this.p_localPoints[c]=n.clone(l.localPoint)}},u.prototype.getManifold=function(){return this.m_manifold},u.prototype.getWorldManifold=function(t){var e=this.m_fixtureA.getBody(),i=this.m_fixtureB.getBody(),s=this.m_fixtureA.getShape(),n=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),s.m_radius,i.getTransform(),n.m_radius)},u.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},u.prototype.isEnabled=function(){return this.m_enabledFlag},u.prototype.isTouching=function(){return this.m_touchingFlag},u.prototype.getNext=function(){return this.m_next},u.prototype.getFixtureA=function(){return this.m_fixtureA},u.prototype.getFixtureB=function(){return this.m_fixtureB},u.prototype.getChildIndexA=function(){return this.m_indexA},u.prototype.getChildIndexB=function(){return this.m_indexB},u.prototype.flagForFiltering=function(){this.m_filterFlag=!0},u.prototype.setFriction=function(t){this.m_friction=t},u.prototype.getFriction=function(){return this.m_friction},u.prototype.resetFriction=function(){this.m_friction=p(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},u.prototype.setRestitution=function(t){this.m_restitution=t},u.prototype.getRestitution=function(){return this.m_restitution},u.prototype.resetRestitution=function(){this.m_restitution=d(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},u.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},u.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},u.prototype.evaluate=function(t,e,i){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,i,this.m_fixtureB,this.m_indexB)},u.prototype.update=function(t){this.m_enabledFlag=!0;var e=!1,i=this.m_touchingFlag,s=this.m_fixtureA.isSensor(),n=this.m_fixtureB.isSensor(),o=s||n,r=this.m_fixtureA.getBody(),a=this.m_fixtureB.getBody(),h=r.getTransform(),l=a.getTransform();if(o){var u=this.m_fixtureA.getShape(),_=this.m_fixtureB.getShape();e=c.testOverlap(u,this.m_indexA,_,this.m_indexB,h,l),this.m_manifold.pointCount=0}else{var p=this.m_manifold;this.m_manifold=new m,this.evaluate(this.m_manifold,h,l),e=this.m_manifold.pointCount>0;for(var d=0;d<this.m_manifold.pointCount;++d){var f=this.m_manifold.points[d];f.normalImpulse=0,f.tangentImpulse=0;for(var y=0;y<p.pointCount;++y){var v=p.points[y];if(v.id.key==f.id.key){f.normalImpulse=v.normalImpulse,f.tangentImpulse=v.tangentImpulse;break}}}e!=i&&(r.setAwake(!0),a.setAwake(!0))}this.m_touchingFlag=e,0==i&&1==e&&t&&t.beginContact(this),1==i&&0==e&&t&&t.endContact(this),0==o&&e&&t&&t.preSolve(this,p)},u.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},u.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,!0,e,i)},u.prototype._solvePositionConstraint=function(t,e,i,r){var c=this.m_fixtureA,l=this.m_fixtureB,u=c.getBody(),_=l.getBody(),p=(u.c_velocity,_.c_velocity,u.c_position),d=_.c_position,f=n.clone(this.p_localCenterA),y=n.clone(this.p_localCenterB),v=0,g=0;e&&u!=i&&u!=r||(v=this.p_invMassA,g=this.p_invIA);var x=0,b=0;e&&_!=i&&_!=r||(x=this.p_invMassB,b=this.p_invIB);for(var A=n.clone(p.c),w=p.a,B=n.clone(d.c),M=d.a,C=0,z=0;z<this.p_pointCount;++z){var I,S,L,P=o.identity(),k=o.identity();switch(P.q.set(w),k.q.set(M),P.p=n.sub(A,a.mulVec2(P.q,f)),k.p=n.sub(B,a.mulVec2(k.q,y)),this.p_type){case m.e_circles:var V=o.mulVec2(P,this.p_localPoint),O=o.mulVec2(k,this.p_localPoints[0]);(I=n.sub(O,V)).normalize(),S=n.combine(.5,V,.5,O),L=n.dot(n.sub(O,V),I)-this.p_radiusA-this.p_radiusB;break;case m.e_faceA:I=a.mulVec2(P.q,this.p_localNormal);var T=o.mulVec2(P,this.p_localPoint),E=o.mulVec2(k,this.p_localPoints[z]);L=n.dot(n.sub(E,T),I)-this.p_radiusA-this.p_radiusB,S=E;break;case m.e_faceB:I=a.mulVec2(k.q,this.p_localNormal);T=o.mulVec2(k,this.p_localPoint),E=o.mulVec2(P,this.p_localPoints[z]);L=n.dot(n.sub(E,T),I)-this.p_radiusA-this.p_radiusB,S=E,I.mul(-1)}var F=n.sub(S,A),q=n.sub(S,B);C=s.min(C,L);var D=e?h.toiBaugarte:h.baumgarte,R=h.linearSlop,j=h.maxLinearCorrection,N=s.clamp(D*(L+R),-j,0),J=n.cross(F,I),H=n.cross(q,I),U=v+x+g*J*J+b*H*H,Y=U>0?-N/U:0,W=n.mul(Y,I);A.subMul(v,W),w-=g*n.cross(F,W),B.addMul(x,W),M+=b*n.cross(q,W)}return p.c.set(A),p.a=w,d.c.set(B),d.a=M,C},u.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),r=i.getBody(),m=s.c_velocity,c=r.c_velocity,l=s.c_position,u=r.c_position,_=this.p_radiusA,p=this.p_radiusB,d=this.getManifold(),f=this.v_invMassA,y=this.v_invMassB,v=this.v_invIA,g=this.v_invIB,x=n.clone(this.p_localCenterA),b=n.clone(this.p_localCenterB),A=n.clone(l.c),w=l.a,B=n.clone(m.v),M=m.w,C=n.clone(u.c),z=u.a,I=n.clone(c.v),S=c.w,L=o.identity(),P=o.identity();L.q.set(w),P.q.set(z),L.p.setCombine(1,A,-1,a.mulVec2(L.q,x)),P.p.setCombine(1,C,-1,a.mulVec2(P.q,b));var k=d.getWorldManifold(null,L,_,P,p);this.v_normal.set(k.normal);for(var V=0;V<this.v_pointCount;++V){var O=this.v_points[V],T=k.points[V];O.worldPoint=T,O.separation=k.separations[V],O.rA.set(n.sub(T,A)),O.rB.set(n.sub(T,C));var E=n.cross(O.rA,this.v_normal),F=n.cross(O.rB,this.v_normal),q=f+y+v*E*E+g*F*F;O.normalMass=q>0?1/q:0;var D=n.cross(this.v_normal,1),R=n.cross(O.rA,D),j=n.cross(O.rB,D),N=f+y+v*R*R+g*j*j;O.tangentMass=N>0?1/N:0,O.velocityBias=0;var J=n.dot(this.v_normal,I)+n.dot(this.v_normal,n.cross(S,O.rB))-n.dot(this.v_normal,B)-n.dot(this.v_normal,n.cross(M,O.rA));J<-h.velocityThreshold&&(O.velocityBias=-this.v_restitution*J)}if(2==this.v_pointCount&&t.blockSolve){var H=this.v_points[0],U=this.v_points[1],Y=n.cross(H.rA,this.v_normal),W=n.cross(H.rB,this.v_normal),G=n.cross(U.rA,this.v_normal),K=n.cross(U.rB,this.v_normal),Z=f+y+v*Y*Y+g*W*W,X=f+y+v*G*G+g*K*K,$=f+y+v*Y*G+g*W*K;Z*Z<1e3*(Z*X-$*$)?(this.v_K.ex.set(Z,$),this.v_K.ey.set($,X),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}l.c.set(A),l.a=w,m.v.set(B),m.w=M,u.c.set(C),u.a=z,c.v.set(I),c.w=S},u.prototype.warmStartConstraint=function(t){for(var e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),o=i.getBody(),r=s.c_velocity,a=o.c_velocity,h=(s.c_position,o.c_position,this.v_invMassA),m=this.v_invIA,c=this.v_invMassB,l=this.v_invIB,u=n.clone(r.v),_=r.w,p=n.clone(a.v),d=a.w,f=this.v_normal,y=n.cross(f,1),v=0;v<this.v_pointCount;++v){var g=this.v_points[v],x=n.combine(g.normalImpulse,f,g.tangentImpulse,y);_-=m*n.cross(g.rA,x),u.subMul(h,x),d+=l*n.cross(g.rB,x),p.addMul(c,x)}r.v.set(u),r.w=_,a.v.set(p),a.w=d},u.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,i=0;i<this.v_pointCount;++i)e.points[i].normalImpulse=this.v_points[i].normalImpulse,e.points[i].tangentImpulse=this.v_points[i].tangentImpulse},u.prototype.solveVelocityConstraint=function(t){for(var e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body,o=e.c_velocity,a=(e.c_position,i.c_velocity),h=(i.c_position,this.v_invMassA),m=this.v_invIA,c=this.v_invMassB,l=this.v_invIB,u=n.clone(o.v),_=o.w,p=n.clone(a.v),d=a.w,f=this.v_normal,y=n.cross(f,1),v=this.v_friction,g=0;g<this.v_pointCount;++g){var x=this.v_points[g];(C=n.zero()).addCombine(1,p,1,n.cross(d,x.rB)),C.subCombine(1,u,1,n.cross(_,x.rA)),x.relativeVelocity||(x.relativeVelocity=C);var b=n.dot(C,y)-this.v_tangentSpeed,A=x.tangentMass*-b,w=v*x.normalImpulse;A=(z=s.clamp(x.tangentImpulse+A,-w,w))-x.tangentImpulse,x.tangentImpulse=z;var B=n.mul(A,y);u.subMul(h,B),_-=m*n.cross(x.rA,B),p.addMul(c,B),d+=l*n.cross(x.rB,B)}if(1==this.v_pointCount||0==t.blockSolve)for(var M=0;M<this.v_pointCount;++M){var C;x=this.v_points[M];(C=n.zero()).addCombine(1,p,1,n.cross(d,x.rB)),C.subCombine(1,u,1,n.cross(_,x.rA));var z,I=n.dot(C,f);A=-x.normalMass*(I-x.velocityBias);A=(z=s.max(x.normalImpulse+A,0))-x.normalImpulse,x.normalImpulse=z;B=n.mul(A,f);u.subMul(h,B),_-=m*n.cross(x.rA,B),p.addMul(c,B),d+=l*n.cross(x.rB,B)}else{var S=this.v_points[0],L=this.v_points[1],P=n.neo(S.normalImpulse,L.normalImpulse),k=n.zero().add(p).add(n.cross(d,S.rB)).sub(u).sub(n.cross(_,S.rA)),V=n.zero().add(p).add(n.cross(d,L.rB)).sub(u).sub(n.cross(_,L.rA)),O=n.dot(k,f),T=n.dot(V,f),E=n.neo(O-S.velocityBias,T-L.velocityBias);E.sub(r.mulVec2(this.v_K,P));for(;;){var F=r.mulVec2(this.v_normalMass,E).neg();if(F.x>=0&&F.y>=0){var q=n.sub(F,P),D=n.mul(q.x,f),R=n.mul(q.y,f);u.subCombine(h,D,h,R),_-=m*(n.cross(S.rA,D)+n.cross(L.rA,R)),p.addCombine(c,D,c,R),d+=l*(n.cross(S.rB,D)+n.cross(L.rB,R)),S.normalImpulse=F.x,L.normalImpulse=F.y;break}if(F.x=-S.normalMass*E.x,F.y=0,O=0,T=this.v_K.ex.y*F.x+E.y,F.x>=0&&T>=0){q=n.sub(F,P),D=n.mul(q.x,f),R=n.mul(q.y,f);u.subCombine(h,D,h,R),_-=m*(n.cross(S.rA,D)+n.cross(L.rA,R)),p.addCombine(c,D,c,R),d+=l*(n.cross(S.rB,D)+n.cross(L.rB,R)),S.normalImpulse=F.x,L.normalImpulse=F.y;break}if(F.x=0,F.y=-L.normalMass*E.y,O=this.v_K.ey.x*F.y+E.x,T=0,F.y>=0&&O>=0){q=n.sub(F,P),D=n.mul(q.x,f),R=n.mul(q.y,f);u.subCombine(h,D,h,R),_-=m*(n.cross(S.rA,D)+n.cross(L.rA,R)),p.addCombine(c,D,c,R),d+=l*(n.cross(S.rB,D)+n.cross(L.rB,R)),S.normalImpulse=F.x,L.normalImpulse=F.y;break}if(F.x=0,F.y=0,O=E.x,T=E.y,O>=0&&T>=0){q=n.sub(F,P),D=n.mul(q.x,f),R=n.mul(q.y,f);u.subCombine(h,D,h,R),_-=m*(n.cross(S.rA,D)+n.cross(L.rA,R)),p.addCombine(c,D,c,R),d+=l*(n.cross(S.rB,D)+n.cross(L.rB,R)),S.normalImpulse=F.x,L.normalImpulse=F.y;break}break}}o.v.set(u),o.w=_,a.v.set(p),a.w=d};var f=[];u.addType=function(t,e,i){f[t]=f[t]||{},f[t][e]=i},u.create=function(t,e,i,s){var n,o,r=t.getType(),a=i.getType();if(o=f[r]&&f[r][a])n=new u(t,e,i,s,o);else{if(!(o=f[a]&&f[a][r]))return null;n=new u(i,s,t,e,o)}t=n.getFixtureA(),i=n.getFixtureB(),e=n.getChildIndexA(),s=n.getChildIndexB();var h=t.getBody(),m=i.getBody();return n.m_nodeA.contact=n,n.m_nodeA.other=m,n.m_nodeA.prev=null,n.m_nodeA.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=n.m_nodeA),h.m_contactList=n.m_nodeA,n.m_nodeB.contact=n,n.m_nodeB.other=h,n.m_nodeB.prev=null,n.m_nodeB.next=m.m_contactList,null!=m.m_contactList&&(m.m_contactList.prev=n.m_nodeB),m.m_contactList=n.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(h.setAwake(!0),m.setAwake(!0)),n},u.destroy=function(t,e){var i=t.m_fixtureA,s=t.m_fixtureB,n=i.getBody(),o=s.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==i.isSensor()&&0==s.isSensor()&&(n.setAwake(!0),o.setAwake(!0));var r=i.getType(),a=s.getType(),h=f[r][a].destroyFcn;"function"==typeof h&&h(t)}},function(t,e,i){i(2);var s=i(0),n=i(3),o=i(1),r=i(4);function a(){this.type,this.localNormal=s.zero(),this.localPoint=s.zero(),this.points=[new h,new h],this.pointCount=0}function h(){this.localPoint=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new m}function m(){this.cf=new c}function c(){this.indexA,this.indexB,this.typeA,this.typeB}function l(){this.normal,this.points=[],this.separations=[]}t.exports=a,t.exports.clipSegmentToLine=function(t,e,i,n,o){var r=0,h=s.dot(i,e[0].v)-n,m=s.dot(i,e[1].v)-n;h<=0&&t[r++].set(e[0]);m<=0&&t[r++].set(e[1]);if(h*m<0){var c=h/(h-m);t[r].v.setCombine(1-c,e[0].v,c,e[1].v),t[r].id.cf.indexA=o,t[r].id.cf.indexB=e[0].id.cf.indexB,t[r].id.cf.typeA=a.e_vertex,t[r].id.cf.typeB=a.e_face,++r}return r},t.exports.clipVertex=_,t.exports.getPointStates=function(t,e,i,s){for(var n=0;n<i.pointCount;++n){var o=i.points[n].id;t[n]=u.removeState;for(var r=0;r<s.pointCount;++r)if(s.points[r].id.key==o.key){t[n]=u.persistState;break}}for(n=0;n<s.pointCount;++n){o=s.points[n].id;e[n]=u.addState;for(r=0;r<i.pointCount;++r)if(i.points[r].id.key==o.key){e[n]=u.persistState;break}}},t.exports.PointState=u,a.e_circles=0,a.e_faceA=1,a.e_faceB=2,a.e_vertex=0,a.e_face=1,Object.defineProperty(m.prototype,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0}),m.prototype.set=function(t){this.cf.set(t.cf)},c.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB},a.prototype.getWorldManifold=function(t,e,i,h,m){if(0!=this.pointCount){var c=(t=t||new l).normal,u=t.points,_=t.separations;switch(this.type){case a.e_circles:c=s.neo(1,0);var p=n.mulVec2(e,this.localPoint),d=n.mulVec2(h,this.points[0].localPoint),f=s.sub(d,p);s.lengthSquared(f)>o.EPSILON*o.EPSILON&&(c.set(f),c.normalize()),u[0]=s.mid(p,d),_[0]=-m-i,u.length=1,_.length=1;break;case a.e_faceA:c=r.mulVec2(e.q,this.localNormal);for(var y=n.mulVec2(e,this.localPoint),v=0;v<this.pointCount;++v){var g=n.mulVec2(h,this.points[v].localPoint),x=s.clone(g).addMul(i-s.dot(s.sub(g,y),c),c),b=s.clone(g).subMul(m,c);u[v]=s.mid(x,b),_[v]=s.dot(s.sub(b,x),c)}u.length=this.pointCount,_.length=this.pointCount;break;case a.e_faceB:c=r.mulVec2(h.q,this.localNormal);for(y=n.mulVec2(h,this.localPoint),v=0;v<this.pointCount;++v){g=n.mulVec2(e,this.points[v].localPoint),b=s.combine(1,g,m-s.dot(s.sub(g,y),c),c),x=s.combine(1,g,-i,c);u[v]=s.mid(x,b),_[v]=s.dot(s.sub(x,b),c)}u.length=this.pointCount,_.length=this.pointCount,c.mul(-1)}return t.normal=c,t.points=u,t.separations=_,t}};var u={nullState:0,addState:1,persistState:2,removeState:3};function _(){this.v=s.zero(),this.id=new m}_.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)}},function(t,e,i){var s=!1;t.exports=g;var n=i(2),o=i(6),r=(i(7),i(1)),a=i(3),h=i(4),m=i(0),c=(i(14),i(5)),l=i(16),u=new m,_=new m,p=new m,d=new m,f=new m,y=new m,v=new h;function g(t){if(!(this instanceof g))return new g(t);g._super.call(this),this.m_type=g.TYPE,this.m_radius=c.polygonRadius,this.m_edgeRadius=0,this.m_centroid=m.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,this.m_outsidePoint=new m(1,1),t&&t.length&&this._set(t)}g._super=l,g.prototype=o(g._super.prototype),g.TYPE="polygon",g.prototype.setRadius=function(t){this.m_radius=c.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},g.prototype.getRadius=function(){return this.m_edgeRadius},g.prototype.getVertex=function(t){return s&&n.assert(0<=t&&t<this.m_count),this.m_vertices[t]},g.prototype._clone=function(){var t=new g;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid),t.m_outsidePoint.set(this.m_outsidePoint);for(var e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},g.prototype.getChildCount=function(){return 1},g.prototype._set=function(t){if(s&&n.assert(3<=t.length&&t.length<=c.maxPolygonVertices),t.length<3)this._setAsBox(1,1);else{for(var e=r.min(t.length,c.maxPolygonVertices),i=[],o=0,a=0;a<e;++a){for(var h=t[a],l=!0,u=0;u<o;++u)if(h.x===i[u].x&&h.y===i[u].y){l=!1;break}l&&(i[o++]=h)}if((e=o)<3)return s&&n.assert(!1),void this._setAsBox(1,1);var _=0,p=i[0].x;for(a=1;a<e;++a){var d=i[a].x;(d>p||d==p&&i[a].y<i[_].y)&&(_=a,p=d)}for(var f=[],y=0,v=_;;){f[y]=v;var g=0;for(u=1;u<e;++u)if(g!=v){var x=m.sub(i[g],i[f[y]]),b=(h=m.sub(i[u],i[f[y]]),m.cross(x,h));b<0&&(g=u),0==b&&h.lengthSquared()>x.lengthSquared()&&(g=u)}else g=u;if(++y,v=g,g==_)break}if(y<3)return s&&n.assert(!1),void this._setAsBox(1,1);if(this.m_count=y,y>0){var A=-1/0,w=A;for(a=0;a<y;++a)(h=this.m_vertices[a]=i[f[a]]).x>A&&(A=h.x),h.y>w&&(w=h.y);this.m_outsidePoint.x=A+1,this.m_outsidePoint.y=w+1}for(a=0;a<y;++a){var B=a,M=a+1<y?a+1:0,C=m.sub(this.m_vertices[M],this.m_vertices[B]);s&&n.assert(C.lengthSquared()>r.EPSILON*r.EPSILON),this.m_normals[a]=m.cross(C,1),this.m_normals[a].normalize()}this.m_centroid=function(t,e){s&&n.assert(e>=3);for(var i=m.zero(),o=0,a=m.zero(),h=0;h<e;++h){var c=a,l=t[h],u=h+1<e?t[h+1]:t[0],_=m.sub(l,c),p=m.sub(u,c),d=.5*m.cross(_,p);o+=d,i.addMul(d*(1/3),c),i.addMul(d*(1/3),l),i.addMul(d*(1/3),u)}return s&&n.assert(o>r.EPSILON),i.mul(1/o),i}(this.m_vertices,y)}},g.prototype._setAsBox=function(t,e,i,s){if(this.m_vertices[3]?(this.m_vertices[0].set(-t,-e),this.m_vertices[1].set(t,-e),this.m_vertices[2].set(t,e),this.m_vertices[3].set(-t,e)):(this.m_vertices[0]=m.neo(-t,-e),this.m_vertices[1]=m.neo(t,-e),this.m_vertices[2]=m.neo(t,e),this.m_vertices[3]=m.neo(-t,e)),this.m_normals[3]?(this.m_normals[0].set(0,-1),this.m_normals[1].set(1,0),this.m_normals[2].set(0,1),this.m_normals[3].set(-1,0)):(this.m_normals[0]=m.neo(0,-1),this.m_normals[1]=m.neo(1,0),this.m_normals[2]=m.neo(0,1),this.m_normals[3]=m.neo(-1,0)),this.m_count=4,m.isValid(i)&&(i.x<-r.EPSILON||r.EPSILON<i.x||i.y<-r.EPSILON||r.EPSILON<i.y)){s=s||0,this.m_centroid.set(i),v.set(s);for(var n,o=-1/0,a=o,h=0;h<this.m_count;++h)n=this.m_vertices[h]=this.m_vertices[h].rot(v).add(i),this.m_normals[h]=this.m_normals[h].rot(v),n.x>o&&(o=n.x),n.y>a&&(a=n.y);this.m_outsidePoint.x=o+1,this.m_outsidePoint.y=a+1}else this.m_outsidePoint.x=this.m_outsidePoint.y=(t>e?t:e)+1},g.prototype.testPoint=function(t,e){for(var i=u.set(e).sub(t.p).rotT(t.q),s=0;s<this.m_count;++s){if(m.dot(this.m_normals[s],_.set(i).sub(this.m_vertices[s]))>0)return!1}return!0},g.prototype.rayCast=function(t,e,i,s){_.set(e.p1),p.set(e.p2),_=_.sub(i.p).rotT(i.q),p=p.sub(i.p).rotT(i.q),y=y.set(p).sub(_);var n=m.dot(y,y)<=r.EPSILON;n&&(y=y.set(this.m_outsidePoint).sub(_));for(var o,a,h=e.maxFraction,c=h,l=-1,v=0,g=this.m_count,x=0;x<g;++x){d.set(this.m_vertices[x]);var b=this.m_normals[x],A=m.dot(b,u.set(d).sub(_)),w=m.dot(b,y);if(!(-r.EPSILON<=w&&w<=r.EPSILON)){var B=A/w;u.set(y).mul(B).add(_),f.set(this.m_vertices[x+1<this.m_count?x+1:0]);var M=m.dot(d.sub(u),f.sub(u)),C=M<r.EPSILON;if(C){if(o=0,a=h,(C=B>=0)&&(M>-r.EPSILON?w<0?v-=.5:v+=.5:v+=1),w<0&&C){if(o<=a)return!n&&(t.fraction=B,t.normal=y.set(this.m_normals[x]).rot(i.q),!0);o=B}else{if(!(w>0&&B<a))continue;a=B}o<=a&&B<=c&&(l=x,c=B)}}}return v<0&&(v=-v),r.abs(v%2-1)<r.EPSILON?(t.fraction=0,t.normal=n?m.ZERO:y.neg().normal().rot(i.q),!0):l>=0&&!n&&(t.fraction=c,t.normal=y.set(this.m_normals[l]).rot(i.q),!0)},g.prototype.computeAABB=function(t,e,i){for(var s=1/0,n=1/0,o=-1/0,h=-1/0,m=0;m<this.m_count;++m){var c=a.mulVec2(e,this.m_vertices[m],d);s=r.min(s,c.x),o=r.max(o,c.x),n=r.min(n,c.y),h=r.max(h,c.y)}t.lowerBound.set(s,n),t.upperBound.set(o,h),t.extend(this.m_radius)},g.prototype.setAABB=g.prototype.computeAABB,g.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},g.prototype.computeMass=function(t,e){s&&n.assert(this.m_count>=3);for(var i=m.zero(),o=0,a=0,h=m.zero(),c=0;c<this.m_count;++c)h.add(this.m_vertices[c]);h.mul(1/this.m_count);for(c=0;c<this.m_count;++c){var l=m.sub(this.m_vertices[c],h),u=c+1<this.m_count?m.sub(this.m_vertices[c+1],h):m.sub(this.m_vertices[0],h),_=m.cross(l,u),p=.5*_;o+=p,i.addCombine(p*(1/3),l,p*(1/3),u);var d=l.x,f=l.y,y=u.x,v=u.y;a+=1/3*.25*_*(d*d+y*d+y*y+(f*f+v*f+v*v))}t.mass=e*o,s&&n.assert(o>r.EPSILON),i.mul(1/o),t.center.setCombine(1,i,1,h),t.I=e*a,t.I+=t.mass*(m.dot(t.center,t.center)-m.dot(i,i))},g.prototype.validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,i=t<this.m_count-1?e+1:0,s=this.m_vertices[e],n=m.sub(this.m_vertices[i],s),o=0;o<this.m_count;++o)if(o!=e&&o!=i){var r=m.sub(this.m_vertices[o],s);if(m.cross(n,r)<0)return!1}return!0},g.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},,function(t,e,i){t.exports=u,t.exports.Input=m,t.exports.Output=c,t.exports.Proxy=_,t.exports.Cache=l;var s=i(5),n=(i(2),i(29)),o=i(1),r=i(0),a=(i(8),i(9),i(11),i(4)),h=(i(10),i(3));i(12),i(13);function m(){this.proxyA=new _,this.proxyB=new _,this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1}function c(){this.pointA=r.zero(),this.pointB=r.zero(),this.distance,this.iterations}function l(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function u(t,e,i){++n.gjkCalls;var m=i.proxyA,c=i.proxyB,l=i.transformA,u=i.transformB,_=new d;_.readCache(e,m,l,c,u);for(var p=_.m_v,f=s.maxDistnceIterations,y=[],v=[],g=0,x=0;x<f;){g=_.m_count;for(var b=0;b<g;++b)y[b]=p[b].indexA,v[b]=p[b].indexB;if(_.solve(),3==_.m_count)break;(I=_.getClosestPoint()).lengthSquared();var A=_.getSearchDirection();if(A.lengthSquared()<o.EPSILON*o.EPSILON)break;var w=p[_.m_count];w.indexA=m.getSupport(a.mulTVec2(l.q,r.neg(A))),w.wA=h.mulVec2(l,m.getVertex(w.indexA)),w.indexB=c.getSupport(a.mulTVec2(u.q,A)),w.wB=h.mulVec2(u,c.getVertex(w.indexB)),w.w=r.sub(w.wB,w.wA),++x,++n.gjkIters;var B=!1;for(b=0;b<g;++b)if(w.indexA==y[b]&&w.indexB==v[b]){B=!0;break}if(B)break;++_.m_count}if(n.gjkMaxIters=o.max(n.gjkMaxIters,x),_.getWitnessPoints(t.pointA,t.pointB),t.distance=r.distance(t.pointA,t.pointB),t.iterations=x,_.writeCache(e),i.useRadii){var M=m.m_radius,C=c.m_radius;if(i.overlap||t.distance>M+C&&t.distance>o.EPSILON){t.distance-=M+C;var z=r.sub(t.pointB,t.pointA);z.normalize(),t.pointA.addMul(M,z),t.pointB.subMul(C,z)}else{var I=r.mid(t.pointA,t.pointB);t.pointA.set(I),t.pointB.set(I),t.distance=0}}}function _(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function p(){this.indexA,this.indexB,this.wA=r.zero(),this.wB=r.zero(),this.w=r.zero(),this.a}function d(){this.m_v1=new p,this.m_v2=new p,this.m_v3=new p,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}n.gjkCalls=0,n.gjkIters=0,n.gjkMaxIters=0,m.prototype.clear=function(){this.proxyA.clear(),this.proxyB.clear(),this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1},c.prototype.clear=function(){this.pointA.setZero(),this.pointB.setZero(),this.distance=0,this.iterations=0},l.prototype.clear=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},_.prototype.clear=function(){this.m_buffer.length=0,this.m_vertices=[],this.m_count=0,this.m_radius=0},_.prototype.getVertexCount=function(){return this.m_count},_.prototype.getVertex=function(t){return this.m_vertices[t]},_.prototype.getSupport=function(t){for(var e=0,i=r.dot(this.m_vertices[0],t),s=0;s<this.m_count;++s){var n=r.dot(this.m_vertices[s],t);n>i&&(e=s,i=n)}return e},_.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},_.prototype.set=function(t,e){t.computeDistanceProxy(this,e)},p.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=r.clone(t.wA),this.wB=r.clone(t.wB),this.w=r.clone(t.w),this.a=t.a},d.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},d.prototype.readCache=function(t,e,i,s,n){this.m_count=t.count;for(var a=0;a<this.m_count;++a){(_=this.m_v[a]).indexA=t.indexA[a],_.indexB=t.indexB[a];var m=e.getVertex(_.indexA),c=s.getVertex(_.indexB);_.wA=h.mulVec2(i,m),_.wB=h.mulVec2(n,c),_.w=r.sub(_.wB,_.wA),_.a=0}if(this.m_count>1){var l=t.metric,u=this.getMetric();(u<.5*l||2*l<u||u<o.EPSILON)&&(this.m_count=0)}if(0==this.m_count){var _;(_=this.m_v[0]).indexA=0,_.indexB=0;m=e.getVertex(0),c=s.getVertex(0);_.wA=h.mulVec2(i,m),_.wB=h.mulVec2(n,c),_.w=r.sub(_.wB,_.wA),_.a=1,this.m_count=1}},d.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},d.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return r.neg(this.m_v1.w);case 2:var t=r.sub(this.m_v2.w,this.m_v1.w);return r.cross(t,r.neg(this.m_v1.w))>0?r.cross(1,t):r.cross(t,1);default:return r.zero()}},d.prototype.getClosestPoint=function(){switch(this.m_count){case 0:return r.zero();case 1:return r.clone(this.m_v1.w);case 2:return r.combine(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w);case 3:default:return r.zero()}},d.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.set(t)}},d.prototype.getMetric=function(){switch(this.m_count){case 0:case 1:return 0;case 2:return r.distance(this.m_v1.w,this.m_v2.w);case 3:return r.cross(r.sub(this.m_v2.w,this.m_v1.w),r.sub(this.m_v3.w,this.m_v1.w));default:return 0}},d.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3()}},d.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=r.sub(e,t),s=-r.dot(t,i);if(s<=0)return this.m_v1.a=1,void(this.m_count=1);var n=r.dot(e,i);if(n<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);var o=1/(n+s);this.m_v1.a=n*o,this.m_v2.a=s*o,this.m_count=2},d.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,s=r.sub(e,t),n=r.dot(t,s),o=r.dot(e,s),a=-n,h=r.sub(i,t),m=r.dot(t,h),c=r.dot(i,h),l=-m,u=r.sub(i,e),_=r.dot(e,u),p=r.dot(i,u),d=-_,f=r.cross(s,h),y=f*r.cross(e,i),v=f*r.cross(i,t),g=f*r.cross(t,e);if(a<=0&&l<=0)return this.m_v1.a=1,void(this.m_count=1);if(o>0&&a>0&&g<=0){var x=1/(o+a);return this.m_v1.a=o*x,this.m_v2.a=a*x,void(this.m_count=2)}if(c>0&&l>0&&v<=0){var b=1/(c+l);return this.m_v1.a=c*b,this.m_v3.a=l*b,this.m_count=2,void this.m_v2.set(this.m_v3)}if(o<=0&&d<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(c<=0&&p<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(p>0&&d>0&&y<=0){var A=1/(p+d);return this.m_v2.a=p*A,this.m_v3.a=d*A,this.m_count=2,void this.m_v1.set(this.m_v3)}var w=1/(y+v+g);this.m_v1.a=y*w,this.m_v2.a=v*w,this.m_v3.a=g*w,this.m_count=3},u.testOverlap=function(t,e,i,s,n,r){var a=u.getInput();a.clear(),a.proxyA.set(t,e),a.proxyB.set(i,s),a.transformA=n,a.transformB=r,a.useRadii=!0;var h=u.getCache();h.clear();var m=u.getOutput();return m.clear(),u(m,h,a),m.distance<10*o.EPSILON},u.getInput=function(){return u._input=u._input||new m},u.getCache=function(){return u._cache=u._cache||new l},u.getOutput=function(){return u._output=u._output||new c}},function(t,e,i){t.exports=h;i(2);var s=i(6),n=(i(7),i(1)),o=(i(3),i(4)),r=i(0),a=(i(14),i(5),i(16));i(17),i(19),i(24),i(23);function h(t,e){if(!(this instanceof h))return new h(t,e);h._super.call(this),this.m_type=h.TYPE,this.m_p=r.zero(),this.m_radius=1,"object"==typeof t&&r.isValid(t)?(this.m_p.set(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}h._super=a,h.prototype=s(h._super.prototype),h.TYPE="circle",h.prototype.getRadius=function(){return this.m_radius},h.prototype.setRadius=function(t){this.m_radius=t},h.prototype.getCenter=function(){return this.m_p},h.prototype.getVertex=function(t){return this.m_p},h.prototype.getVertexCount=function(t){return 1},h.prototype._clone=function(){var t=new h;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},h.prototype.getChildCount=function(){return 1},h.prototype.testPoint=function(t,e){var i=r.add(t.p,o.mulVec2(t.q,this.m_p)),s=r.sub(e,i);return r.dot(s,s)<=this.m_radius*this.m_radius},h.prototype.rayCast=function(t,e,i,s){var a=r.add(i.p,o.mulVec2(i.q,this.m_p)),h=r.sub(e.p1,a),m=r.dot(h,h)-this.m_radius*this.m_radius,c=r.sub(e.p2,e.p1);if(m<0)return t.fraction=0,t.normal=c.neg().normal(),!0;var l=r.dot(h,c),u=r.dot(c,c),_=l*l-u*m;if(_<0||u<n.EPSILON)return!1;var p=-(l+n.sqrt(_));return 0<=p&&p<=e.maxFraction*u&&(p/=u,t.fraction=p,t.normal=r.add(h,r.mul(p,c)).normal(),!0)},h.prototype.computeAABB=function(t,e,i){var s=r.add(e.p,o.mulVec2(e.q,this.m_p));t.lowerBound.set(s.x-this.m_radius,s.y-this.m_radius),t.upperBound.set(s.x+this.m_radius,s.y+this.m_radius)},h.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p)},h.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_p)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p),t)},h.prototype.computeMass=function(t,e){t.mass=e*n.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+r.dot(this.m_p,this.m_p))},h.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},function(t,e,i){t.exports=f;var s=i(6),n=(i(7),i(5)),o=i(16),r=i(1),a=i(3),h=i(4),m=i(0),c=(i(14),new m),l=new m,u=new m,_=new m,p=new m,d=new m;function f(t,e,i){if(!(this instanceof f))return new f(t,e,i);f._super.call(this),this.m_type=f.TYPE,this.m_vertex1=t?m.clone(t):m.zero(),this.m_vertex2=e?m.clone(e):m.zero(),this.setRadius(i),this.m_vertex0=m.zero(),this.m_vertex3=m.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0}f._super=o,f.prototype=s(f._super.prototype),f.TYPE="edge",f.prototype.setRadius=function(t){this.m_radius=n.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},f.prototype.getRadius=function(){return this.m_edgeRadius},f.prototype.setVertex1=function(t,e){this.m_vertex1.set(t,e),this.m_noAlignRot=!0},f.prototype.setVertex2=function(t,e){this.m_vertex2.set(t,e),this.m_noAlignRot=!0},f.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},f.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},f.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0,this},f.prototype._clone=function(){var t=new f;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t.m_edgeRadius=this.m_edgeRadius,t},f.prototype.getChildCount=function(){return 1},f.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0)return!1;e=l.set(e).sub(t.p).rotT(t.q),this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new m).set(this.m_vertex2))),e=this._alignPoint(e);var i=this.m_alignedV2,s=this.m_edgeRadius;if(e.y>i.y){var n=e.x-i.x,o=e.y-i.y;return n*n+o*o<=s*s}return e.y<0?e.x*e.x+e.y*e.y<=s*s:-s<=e.x&&e.x<=s},f.prototype._getAlignRot=function(){var t=this.m_alignRot=this.m_alignRot||new h;this.m_noAlignRot=!1;var e=this.m_vertex1,i=this.m_vertex2,s=d.set(i).sub(e).length();return s<=r.EPSILON?t:(t.c=d.y/s,t.s=d.x/s,t)},f.prototype._alignPoint=function(t){return t.sub(this.m_vertex1).rot(this.m_alignRot)},f.prototype.rayCast=function(t,e,i,s){if(this.m_edgeRadius>0)return this.rayCastWithRadius(t,e,i);_=_.set(this.m_vertex1);var n=p=(p=p.set(this.m_vertex2)).sub(_),o=c=c.set(n.y,-n.x),a=o.normalize();if(a<=r.EPSILON)return!1;l=l.set(e.p1).sub(i.p).rotT(i.q),u=u.set(e.p2).sub(i.p).rotT(i.q),d=d.set(u).sub(l);var h=m.dot(o,d);if(h<=r.EPSILON)return!1;u=u.set(_).sub(l);var f=m.dot(o,u),y=f/h;if(y<0||e.maxFraction<y)return!1;var v=a*a;d=d.mul(y);var g=l=l.add(d);g=g.sub(_);var x=m.dot(g,n)/v;return!(x<0||1<x)&&(t.fraction=y,t.normal=f>0?o.rot(i.q).neg():o.rot(i.q),!0)},f.prototype.rayCastWithRadius=function(t,e,i){var s=(c=c.set(e.p2).sub(e.p1)).normalize();if(r.EPSILON>=s&&s>=-r.EPSILON)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=c.neg(),!0);var n=this.m_edgeRadius,o=function(t,e,i,s,n){var o=_,a=p,h=d;o.set(s).sub(i),a.set(t).sub(i);var c=m.dot(o,o),l=m.dot(o,e),u=m.dot(o,a),f=m.dot(e,a),y=m.dot(a,a),v=c-l*l,g=c*f-u*l,x=c*y-u*u-n*n*c,b=g*g-v*x;if(b>=0){var A=(-g-r.sqrt(b))/v,w=u+A*l;if(w>0&&w<c)return A;if(w<=0?h.set(a):h.set(t).sub(s),g=m.dot(e,h),x=m.dot(h,h)-n*n,(b=g*g-x)>0)return-g-r.sqrt(b)}return 1/0}(e.p1,c,this.m_vertex1,this.m_vertex2,n);if(o>s)return!1;if(o<=0)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=c.neg(),!0);this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new m).set(this.m_vertex2)));var a=this.m_alignedV2.y;return(c=this._alignPoint(c.mul(o).add(e.p1))).y>a?c.y-=a:c.y>0&&(c.y=0),t.normal=c.mul(1/n).rotT(this.m_alignRot).rot(i.q),t.fraction=o/s,!0},f.prototype.computeAABB=function(t,e,i){var s=a.mulVec2(e,this.m_vertex1),n=a.mulVec2(e,this.m_vertex2);t.combinePoints(s,n),t.extend(this.m_radius)},f.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2)},f.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_vertex1,this.m_vertex2)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2),t)},f.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},f.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=c;i(2);var s,n=i(6),o=(i(7),i(1),i(3)),r=(i(4),i(0)),a=(i(14),i(5)),h=i(16),m=i(23);function c(t,e,i){if(!(this instanceof c))return new c(t,e,i);c._super.call(this),this.m_type=c.TYPE,this.m_radius=a.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,i>0?(this.m_edgeRadius=i,this.m_radius+=i):this.m_edgeRadius=0,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}c._super=h,c.prototype=n(c._super.prototype),c.TYPE="chain",c.prototype._createLoop=function(t){this.m_vertices.length=0,this.m_count=t.length+1;for(var e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},c.prototype._createChain=function(t){this.m_count=this.m_vertices.length=t.length;for(var e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},c.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},c.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},c.prototype.setRadius=function(t){this.m_radius=a.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},c.prototype.getRadius=function(){return this.m_edgeRadius},c.prototype._clone=function(){var t=new c;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},c.prototype.getChildCount=function(){return this.m_count>0?this.m_count-1:0},c.prototype.getChildEdge=function(t,e){t.m_type=m.TYPE,t.m_radius=this.m_radius,t.m_edgeRadius=this.m_edgeRadius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},c.prototype.getVertex=function(t){return t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},c.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0||this.m_count<2)return!1;var i=this.m_vertices;if(s?(s._set(i[0],i[1]),s.setRadius(this.m_edgeRadius)):s=new m(i[0],i[1],this.m_edgeRadius),s.testPoint(t,e))return!0;for(var n=this.m_count,o=2;o<n;++o)if(s._set(i[o-1],i[o]),s.testPoint(t,e))return!0;return!1},c.prototype.rayCast=function(t,e,i,n){return s?(s._set(this.getVertex(n),this.getVertex(n+1)),s.setRadius(this.m_edgeRadius)):s=new m(this.getVertex(n),this.getVertex(n+1),this.m_edgeRadius),s.rayCast(t,e,i,0)},c.prototype.computeAABB=function(t,e,i){var s=o.mulVec2(e,this.getVertex(i)),n=o.mulVec2(e,this.getVertex(i+1));t.combinePoints(s,n),t.extend(this.m_radius)},c.prototype.setAABB=function(t,e,i){var s=this.getVertex(i),n=this.getVertex(i+1),r=this.m_radius;t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r)},c.prototype.resetAABB=function(t,e,i){var s=this.getVertex(i),n=this.getVertex(i+1),r=this.m_radius;return t.containsPoints(r,s,n)?null:(t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r),t)},c.prototype.computeMass=function(t,e){t.mass=0,t.center=r.zero(),t.I=0},c.prototype.computeDistanceProxy=function(t,e){t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=h;var s=i(6),n=i(5),o=i(0),r=i(23),a=i(1);function h(t,e,i){if(!(this instanceof h))return new h(t,e,i);h._super.call(this,t,e,i),this.m_type=h.TYPE}h._super=r,h.prototype=s(h._super.prototype),h.TYPE="capsule",h.prototype.computeMass=function(t,e){var i=t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),s=this.m_vertex1.x-i.x,n=this.m_vertex1.y-i.y,o=a.sqrt(s*s+n*n),r=this.m_radius,h=r*r,m=a.PI*h,c=e*m,l=.5*c,u=3/8*r,_=u+o,p=.5*(.5*c*h)-l*u*u+l*_*_,d=2*e*o,f=d*(h+o*o)/3;t.mass=c+d,t.I=f+2*p},h.prototype.initCollisionData=function(){this.m_vertices||(this.m_vertices=[new o,new o,new o,new o],this.m_normals=[new o,new o,new o,new o],this.m_centroid=new o,this.m_count=4);var t=this.m_vertices,e=this.m_normals,i=.01*n.polygonRadius,s=e[1].set(this.m_vertex2).sub(this.m_vertex1).normal(),r=e[0].set(s.y,-s.x);t[0].set(this.m_vertex1).addMul(-i,s).addMul(i,r),t[1].set(this.m_vertex2).addMul(i,s).addMul(i,r),t[2].set(this.m_vertex2).addMul(i,s).addMul(-i,r),t[3].set(this.m_vertex1).addMul(-i,s).addMul(-i,r),e[2].set(r).mul(-1),e[3].set(s).mul(-1),this.m_centroid.set(this.m_vertex1).add(this.m_vertex2).mul(.5)}},function(t,e,i){t.exports=c;var s,n=i(6),o=i(0),r=(i(14),i(5)),a=i(16),h=i(19),m=i(38);function c(t){if(!(this instanceof c))return new c(t);c._super.call(this),this.m_type=c.TYPE,this.m_radius=r.polygonRadius,this.m_polygons=[],this.m_count=0,t&&t.length&&this._set(t)}c._super=a,c.prototype=n(c._super.prototype),c.TYPE="composite_polygon",c.prototype._clone=function(){var t=new c;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count;for(var e=0;e<this.m_count;e++)t.m_polygons.push(this.m_polygons[e].clone());return t},c.prototype.getChildCount=function(){return this.m_count},c.prototype.getChildPolygon=function(t){return this.m_polygons[t]},c.prototype._set=function(t){var e=m.tesselate({contours:t,windingRule:m.WINDING_ODD,elementType:m.POLYGONS,polySize:8,vertexSize:2}),i=e.vertices,s=e.elements,n=s.length;this.m_polygons=new Array(e.elementCount);for(var r=0,a=0;r<n;r+=8){for(var c=[],l=0;l<8;++l){var u=s[r+l];u<0||c.push(new o(i[2*u],i[2*u+1]))}this.m_polygons[a++]=new h(c)}this.m_count=this.m_polygons.length},c.prototype.testPoint=function(t,e){for(var i=0;i<this.m_count;++i)if(this.m_polygons[i].testPoint(t,e))return!0;return!1},c.prototype.rayCast=function(t,e,i,s){return this.m_polygons[s].rayCast(t,e,i,0)},c.prototype.computeAABB=function(t,e,i){this.m_polygons[i].computeAABB(t,e,0)},c.prototype.setAABB=c.prototype.computeAABB,c.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},c.prototype.computeMass=function(t,e){var i=this.m_count;if(1!=i){var n=t.center.setZero(),r=t.mass=0,a=t.I=0;if(!(i<1)){s=s||{center:new o,mass:0,I:0};for(var h=0;h<i;++h){this.m_polygons[h].computeMass(s,e);var m=s.mass,c=s.center;n.addMul(m,c),r+=m,a+=s.I+m*o.dot(c,c)}r>0?n.mul(1/r):(n.setZero(),r=0),a>0&&(a-=r*o.dot(n,n)),a<0&&(a=0),t.mass=r,t.I=a}}else this.m_polygons[0].computeMass(t,e)},c.prototype.computeDistanceProxy=function(t,e){this.m_polygons[e].computeDistanceProxy(t)}},,,function(t,e,i){e.toString=function(t){t="string"==typeof t?t:"\n";var e="";for(var i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},function(t,e,i){var s=!1,n=1e-4;t.exports=g;var o=i(2),r=i(7),a=i(0),h=i(4),m=i(1),c=i(10),l=i(3),u=i(12),_=i(13),p=i(33),d=(i(16),i(34),g.STATIC="static"),f=g.KINEMATIC="kinematic",y=g.DYNAMIC="dynamic",v={type:d,position:a.zero(),angle:0,linearVelocity:a.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,fixedX:!1,fixedY:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null,defaultMass:1};function g(t,e){e=r(e,v),s&&o.assert(a.isValid(e.position)),s&&o.assert(a.isValid(e.linearVelocity)),s&&o.assert(m.isFinite(e.angle)),s&&o.assert(m.isFinite(e.angularVelocity)),s&&o.assert(m.isFinite(e.angularDamping)&&e.angularDamping>=0),s&&o.assert(m.isFinite(e.linearDamping)&&e.linearDamping>=0),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_fixedXFlag=e.fixedX,this.m_fixedYFlag=e.fixedY,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_dirtyTransformFlag=!0,this.m_userData=e.userData,this.m_type=e.type,this.m_defaultMass=e.defaultMass>n?e.defaultMass:n,this.m_mass=this.m_defaultMass,this.m_invMass=this.m_type==y?1/this.m_mass:0,this.m_blankFixturesFlag=!0,this.m_I=0,this.m_invI=0,this.m_xf=l.identity(),this.m_xf.p=a.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new c,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new u,this.c_position=new _,this.m_force=a.zero(),this.m_torque=0,this.m_linearVelocity=a.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,this.m_layer=0,this.m_layerMask=0}function x(){this.mass=0,this.center=a.zero(),this.I=0}g.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},g.prototype.getWorld=function(){return this.m_world},g.prototype.getNext=function(){return this.m_next},g.prototype.setUserData=function(t){this.m_userData=t},g.prototype.getUserData=function(){return this.m_userData},g.prototype.getFixtureList=function(){return this.m_fixtureList},g.prototype.getJointList=function(){return this.m_jointList},g.prototype.getContactList=function(){return this.m_contactList},g.prototype.isStatic=function(){return this.m_type==d},g.prototype.isDynamic=function(){return this.m_type==y},g.prototype.isKinematic=function(){return this.m_type==f},g.prototype.setStatic=function(){return this.setType(d),this},g.prototype.setDynamic=function(){return this.setType(y),this},g.prototype.setKinematic=function(){return this.setType(f),this},g.prototype.getType=function(){return this.m_type},g.prototype.setType=function(t){if(s&&o.assert(t===d||t===f||t===y),s&&o.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==d&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var i=e;e=e.next,this.m_world.destroyContact(i.contact)}this.m_contactList=null;for(var n=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)for(var a=r.m_proxyCount,h=0;h<a;++h)n.touchProxy(r.m_proxies[h].proxyId)}},g.prototype.isBullet=function(){return this.m_bulletFlag},g.prototype.setBullet=function(t){this.m_bulletFlag=!!t},g.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},g.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},g.prototype.isAwake=function(){return this.m_awakeFlag},g.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},g.prototype.isActive=function(){return this.m_activeFlag},g.prototype.setActive=function(t){if(s&&o.assert(0==this.isWorldLocked()),t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag)for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.createProxies(e,this.m_xf);else{for(e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.destroyProxies(e);for(var n=this.m_contactList;n;){var r=n;n=n.next,this.m_world.destroyContact(r.contact)}this.m_contactList=null}},g.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},g.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},g.prototype.isFixedX=function(){return this.m_fixedXFlag},g.prototype.setFixedX=function(t){this.m_fixedXFlag!=t&&(this.m_fixedXFlag=!!t,this.m_linearVelocity.x=0)},g.prototype.isFixedY=function(){return this.m_fixedYFlag},g.prototype.setFixedY=function(t){this.m_fixedYFlag!=t&&(this.m_fixedYFlag=!!t,this.m_linearVelocity.y=0)},g.prototype.getTransform=function(){return this.m_xf},g.prototype.setTransform=function(t,e){if(s&&o.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);for(var i=this.m_world.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.synchronize(i,this.m_xf,this.m_xf);this.setAwake(!0),this.m_dirtyTransformFlag=!0}},g.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1),this.m_dirtyTransformFlag=!0},g.prototype.dirtifyTransform=function(t){this.m_dirtyTransformFlag=t},g.prototype.isDirtyTransform=function(){return this.m_dirtyTransformFlag},g.prototype.synchronizeFixtures=function(){var t=l.identity();this.m_sweep.getTransform(t,0);for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,t,this.m_xf)},g.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},g.prototype.getPosition=function(){return this.m_xf.p},g.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},g.prototype.getAngle=function(){return this.m_sweep.a},g.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},g.prototype.getWorldCenter=function(){return this.m_sweep.c},g.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},g.prototype.setLocalCenter=function(t){if(this.m_localCenter){if(!t)return this.m_localCenter=t,void this.resetMassData();if(this.m_localCenter.closeTo(t))return}if(t){if(this.m_localCenter=t=a.clone(t),this.isStatic()||this.isKinematic())return this.m_sweep.setLocalCenter(t,this.m_xf),void(this.m_sweep.a0=this.m_sweep.a);var e=a.clone(this.m_sweep.c),i=a.clone(this.m_sweep.localCenter);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I+=this.m_mass*(a.dot(i,i)-a.dot(t,t)),s&&o.assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),this.m_linearVelocity.add(a.cross(this.m_angularVelocity,a.sub(this.m_sweep.c,e)))}else this.m_localCenter=t},g.prototype.getLinearVelocity=function(){return this.m_linearVelocity},g.prototype.getLinearVelocityFromWorldPoint=function(t){var e=a.sub(t,this.m_sweep.c);return a.add(this.m_linearVelocity,a.cross(this.m_angularVelocity,e))},g.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},g.prototype.setLinearVelocity=function(t){this.m_type!=d&&(a.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))},g.prototype.getAngularVelocity=function(){return this.m_angularVelocity},g.prototype.setAngularVelocity=function(t){this.m_type!=d&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},g.prototype.getLinearDamping=function(){return this.m_linearDamping},g.prototype.setLinearDamping=function(t){this.m_linearDamping=t},g.prototype.getAngularDamping=function(){return this.m_angularDamping},g.prototype.setAngularDamping=function(t){this.m_angularDamping=t},g.prototype.getGravityScale=function(){return this.m_gravityScale},g.prototype.setGravityScale=function(t){this.m_gravityScale=t},g.prototype.getMass=function(){return this.m_mass},g.prototype.fixturesAreBlank=function(){return this.m_blankFixturesFlag},g.prototype.getInertia=function(){return this.m_I+this.m_mass*a.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},g.prototype.setInertia=function(t){this.m_Inertia=t;var e=this.m_mass*a.dot(this.m_sweep.localCenter,this.m_sweep.localCenter);this.m_I=t-=e,t>0&&0==this.m_fixedRotationFlag?this.m_invI=1/t:(this.m_I=0,this.m_invI=0,this.m_Inertia=e)},g.prototype.getDefaultMass=function(){return this.m_defaultMass},g.prototype.setDefaultMass=function(t){this.m_defaultMass=t>n?t:n},g.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)},g.prototype.resetMassData=function(){if(this.m_I=0,this.m_invI=0,this.m_invMass=0,this.m_localCenter||this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_localCenter||(this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a),void(this.m_mass=this.m_defaultMass);s&&o.assert(this.isDynamic()),this.m_mass=0;for(var t=this.m_localCenter||a.zero(),e=this.m_fixtureList;e;e=e.m_next)if(0!=e.m_density){var i=new x;e.getMassData(i);var r=i.mass,h=i.center;this.m_mass+=r,this.m_localCenter||t.addMul(r,h),this.m_I+=i.I+r*a.dot(h,h)}if(this.m_mass>n?(this.m_invMass=1/this.m_mass,this.m_localCenter||t.mul(this.m_invMass),this.m_blankFixturesFlag=!1):(this.m_mass=1,this.m_invMass=1,this.m_blankFixturesFlag=!0),!this.m_localCenter){var m=a.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t,this.m_xf)}this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*a.dot(t,t),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I):0==this.m_fixedRotationFlag?(this.m_I=1,this.m_invI=1):(this.m_I=0,this.m_invI=0),this.m_localCenter||this.m_linearVelocity.add(a.cross(this.m_angularVelocity,a.sub(this.m_sweep.c,m)))},g.prototype.setMassData=function(t){if(s&&o.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type==y&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=this.m_defaultMass),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*a.dot(t.center,t.center),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I),!this.m_localCenter)){var e=a.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(a.cross(this.m_angularVelocity,a.sub(this.m_sweep.c,e)))}},g.prototype.applyForce=function(t,e,i){this.m_type==y&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=a.cross(a.sub(e,this.m_sweep.c),t)))},g.prototype.applyForceToCenter=function(t,e){this.m_type==y&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},g.prototype.applyTorque=function(t,e){this.m_type==y&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},g.prototype.applyLinearImpulse=function(t,e,i){this.m_type==y&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*a.cross(a.sub(e,this.m_sweep.c),t)))},g.prototype.applyLinearImpulseToCenter=function(t,e){this.m_type==y&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_linearVelocity.addMul(this.m_invMass,t))},g.prototype.applyAngularImpulse=function(t,e){this.m_type==y&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},g.prototype.setLayer=function(t){this.m_layer=t},g.prototype.setLayerMask=function(t){this.m_layerMask=t},g.prototype.shouldCollide=function(t){if(this.m_world.collision_matrix[this.m_layer]&t.m_layerMask)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other.equals(t)&&0==e.joint.m_collideConnected)return!1;return!0},g.prototype.createFixture=function(t,e){if(s&&o.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;var i=new p(this,t,e);if(this.m_activeFlag&&i.isActive()){var n=this.m_world.m_broadPhase;i.createProxies(n,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,i.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=i.isActive(),i},g.prototype.destroyFixture=function(t){if(s&&o.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){s&&o.assert(t.m_body==this);var e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else for(var i=this.m_fixtureList;null!=i;){if(i.m_next===t){i.m_next=t.m_next,e=!0;break}i=i.m_next}s&&o.assert(e);for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var a=r.getFixtureA(),h=r.getFixtureB();t!=a&&t!=h||this.m_world.destroyContact(r)}if(this.m_activeFlag){var m=this.m_world.m_broadPhase;t.destroyProxies(m)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},g.prototype.getWorldPoint=function(t,e){return l.mulVec2(this.m_xf,t,e)},g.prototype.getWorldVector=function(t){return h.mulVec2(this.m_xf.q,t)},g.prototype.getLocalPoint=function(t,e){return l.mulTVec2(this.m_xf,t,e)},g.prototype.getLocalVector=function(t){return h.mulTVec2(this.m_xf.q,t)},g.prototype.equals=function(t){return this===t}},function(t,e,i){var s=!1;t.exports=function(t,e){var i=r.now();++a.toiCalls,t.state=v.e_unknown,t.t=e.tMax;var m=e.proxyA,c=e.proxyB,l=e.sweepA,f=e.sweepB;l.normalize(),f.normalize();var x=e.tMax,b=m.m_radius+c.m_radius,A=h.max(n.linearSlop,b-3*n.linearSlop),w=.25*n.linearSlop;s&&o.assert(A>w);var B=0,M=n.maxTOIIterations,C=0,z=new y;t.cache=z;var I=new p;for(I.proxyA=e.proxyA,I.proxyB=e.proxyB,I.useRadii=!1;;){var S=u.identity(),L=u.identity();l.getTransform(S,B),f.getTransform(L,B),I.transformA=S,I.transformB=L;var P=new d;if(_(P,z,I),P.distance<=0){t.state=v.e_overlapped,t.t=0;break}if(P.distance<A+w){t.state=v.e_touching,t.t=B;break}var k=new g;k.initialize(z,m,l,c,f,B);for(var V=!1,O=x,T=0;;){var E=k.findMinSeparation(O);k.indexA,k.indexB;if(E>A+w){t.state=v.e_separated,t.t=x,V=!0;break}if(E>A-w){B=O;break}var F=k.evaluate(B);k.indexA,k.indexB;if(F<A-w){t.state=v.e_failed,t.t=B,V=!0;break}if(F<=A+w){t.state=v.e_touching,t.t=B,V=!0;break}for(var q=0,D=B,R=O;;){var j;j=1&q?D+(A-F)*(R-D)/(E-F):.5*(D+R),++q,++a.toiRootIters;var N=k.evaluate(j);k.indexA,k.indexB;if(h.abs(N-A)<w){O=j;break}if(N>A?(D=j,F=N):(R=j,E=N),50==q)break}if(a.toiMaxRootIters=h.max(a.toiMaxRootIters,q),++T==n.maxPolygonVertices)break}if(++C,++a.toiIters,V)break;if(C==M){t.state=v.e_failed,t.t=B;break}}a.toiMaxIters=h.max(a.toiMaxIters,C);var J=r.diff(i);a.toiMaxTime=h.max(a.toiMaxTime,J),a.toiTime+=J},t.exports.Input=function(){this.proxyA=new f,this.proxyB=new f,this.sweepA=new l,this.sweepB=new l,this.tMax},t.exports.Output=v;var n=i(5),o=i(2),r=i(47),a=i(29),h=i(1),m=i(0),c=(i(8),i(9),i(11),i(4)),l=i(10),u=i(3),_=(i(12),i(13),i(21)),p=_.Input,d=_.Output,f=_.Proxy,y=_.Cache;function v(){this.state,this.t,this.cache}v.e_unknown=0,v.e_failed=1,v.e_overlapped=2,v.e_touching=3,v.e_separated=4,a.toiTime=0,a.toiMaxTime=0,a.toiCalls=0,a.toiIters=0,a.toiMaxIters=0,a.toiRootIters=0,a.toiMaxRootIters=0;function g(){this.m_proxyA=new f,this.m_proxyB=new f,this.m_sweepA,this.m_sweepB,this.m_type,this.m_localPoint=m.zero(),this.m_axis=m.zero()}g.prototype.initialize=function(t,e,i,n,r,a){this.m_proxyA=e,this.m_proxyB=n;var h=t.count;s&&o.assert(0<h&&h<3),this.m_sweepA=i,this.m_sweepB=r;var l=u.identity(),_=u.identity();if(this.m_sweepA.getTransform(l,a),this.m_sweepB.getTransform(_,a),1==h){this.m_type=1;var p=this.m_proxyA.getVertex(t.indexA[0]),d=this.m_proxyB.getVertex(t.indexB[0]),f=u.mulVec2(l,p),y=u.mulVec2(_,d);return this.m_axis.setCombine(1,y,-1,f),w=this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;var v=n.getVertex(t.indexB[0]),g=n.getVertex(t.indexB[1]);this.m_axis=m.cross(m.sub(g,v),1),this.m_axis.normalize();var x=c.mulVec2(_.q,this.m_axis);this.m_localPoint=m.mid(v,g);y=u.mulVec2(_,this.m_localPoint),p=e.getVertex(t.indexA[0]),f=u.mulVec2(l,p);return(w=m.dot(f,x)-m.dot(y,x))<0&&(this.m_axis=m.neg(this.m_axis),w=-w),w}this.m_type=2;var b=this.m_proxyA.getVertex(t.indexA[0]),A=this.m_proxyA.getVertex(t.indexA[1]);this.m_axis=m.cross(m.sub(A,b),1),this.m_axis.normalize();x=c.mulVec2(l.q,this.m_axis);this.m_localPoint=m.mid(b,A);var w;f=u.mulVec2(l,this.m_localPoint),d=this.m_proxyB.getVertex(t.indexB[0]),y=u.mulVec2(_,d);return(w=m.dot(y,x)-m.dot(f,x))<0&&(this.m_axis=m.neg(this.m_axis),w=-w),w},g.prototype.compute=function(t,e){var i=u.identity(),n=u.identity();switch(this.m_sweepA.getTransform(i,e),this.m_sweepB.getTransform(n,e),this.m_type){case 1:if(t){var r=c.mulTVec2(i.q,this.m_axis),a=c.mulTVec2(n.q,m.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(r),this.indexB=this.m_proxyB.getSupport(a)}var h=this.m_proxyA.getVertex(this.indexA),l=this.m_proxyB.getVertex(this.indexB),_=u.mulVec2(i,h),p=u.mulVec2(n,l);return m.dot(p,this.m_axis)-m.dot(_,this.m_axis);case 2:var d=c.mulVec2(i.q,this.m_axis);_=u.mulVec2(i,this.m_localPoint);if(t){a=c.mulTVec2(n.q,m.neg(d));this.indexA=-1,this.indexB=this.m_proxyB.getSupport(a)}l=this.m_proxyB.getVertex(this.indexB),p=u.mulVec2(n,l);return m.dot(p,d)-m.dot(_,d);case 3:d=c.mulVec2(n.q,this.m_axis),p=u.mulVec2(n,this.m_localPoint);if(t){r=c.mulTVec2(i.q,m.neg(d));this.indexB=-1,this.indexA=this.m_proxyA.getSupport(r)}h=this.m_proxyA.getVertex(this.indexA),_=u.mulVec2(i,h);return m.dot(_,d)-m.dot(p,d);default:return s&&o.assert(!1),t&&(this.indexA=-1,this.indexB=-1),0}},g.prototype.findMinSeparation=function(t){return this.compute(!0,t)},g.prototype.evaluate=function(t){return this.compute(!1,t)}},,function(t,e,i){t.exports=c;i(2);var s=i(7),n=i(1),o=i(0),r=i(14),a=i(21),h={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,active:!0,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function m(t,e){this.aabb=new r,this.fixture=t,this.childIndex=e,this.proxyId=null}function c(t,e,i){if(e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=s(i,h),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_activeFlag=i.active,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0,this.m_activeFlag)for(var n=this.m_proxyCount=this.m_shape.getChildCount(),o=0;o<n;++o)this.m_proxies[o]=new m(this,o);this.m_userData=i.userData}c.prototype.getType=function(){return this.m_shape.getType()},c.prototype.getShape=function(){return this.m_shape},c.prototype.isSensor=function(){return this.m_isSensor},c.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},c.prototype.getUserData=function(){return this.m_userData},c.prototype.setUserData=function(t){this.m_userData=t},c.prototype.getBody=function(){return this.m_body},c.prototype.getNext=function(){return this.m_next},c.prototype.getDensity=function(){return this.m_density},c.prototype.setDensity=function(t){this.m_density=t},c.prototype.getFriction=function(){return this.m_friction},c.prototype.setFriction=function(t){this.m_friction=t},c.prototype.getRestitution=function(){return this.m_restitution},c.prototype.setRestitution=function(t){this.m_restitution=t},c.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},c.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},c.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},c.prototype.getAABB=function(t){return this.m_proxies[t].aabb},c.prototype.getProxyId=function(t){return this.m_proxies[t].proxyId},c.prototype.getProxyCount=function(){return this.m_proxyCount},c.prototype.createProxies=function(t,e){if(this.m_activeFlag){var i;t=t||this.m_body.getWorld().m_broadPhase,e=e||this.m_body.getTransform(),this.m_proxyCount=this.m_shape.getChildCount();for(var s=this.m_proxies.length,o=0,r=n.min(this.m_proxyCount,s);o<r;++o)null===(i=this.m_proxies[o]).proxyId?(this.m_shape.setAABB(i.aabb,e,o),i.proxyId=t.createProxy(i.aabb,i)):this.m_shape.resetAABB(i.aabb,e,o)&&(t.destroyProxy(i.proxyId),i.proxyId=t.createProxy(i.aabb,i));if(s>this.m_proxyCount){for(;o<s;++o)this.m_proxies[o].proxyId&&t.destroyProxy(this.m_proxies[o].proxyId);this.m_proxies.length=this.m_proxyCount}else if(s<this.m_proxyCount)for(s=this.m_proxies.length=this.m_proxyCount;o<s;++o)i=this.m_proxies[o]=new m(this,o),this.m_shape.setAABB(i.aabb,e,o),i.proxyId=t.createProxy(i.aabb,i);this.refilter()}},c.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var i=this.m_proxies[e];t.destroyProxy(i.proxyId),i.proxyId=null}this.m_proxyCount=0},c.prototype.synchronize=function(t,e,i){if(this.m_activeFlag)for(var s=0;s<this.m_proxyCount;++s){var n=this.m_proxies[s],a=new r,h=new r;this.m_shape.computeAABB(a,e,n.childIndex),this.m_shape.computeAABB(h,i,n.childIndex),n.aabb.combine(a,h);var m=o.sub(i.p,e.p);t.moveProxy(n.proxyId,n.aabb,m)}},c.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},c.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},c.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},c.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},c.prototype.refilter=function(){if(null!=this.m_body&&this.m_activeFlag){for(var t=this.m_body.getContactList();t;){var e=t.contact,i=e.getFixtureA(),s=e.getFixtureB();i!=this&&s!=this||e.flagForFiltering(),t=t.next}var n=this.m_body.getWorld();if(null!=n)for(var o=n.m_broadPhase,r=0;r<this.m_proxyCount;++r)o.touchProxy(this.m_proxies[r].proxyId)}},c.prototype.shouldCollide=function(t){return t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex?t.m_filterGroupIndex>0:0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)},c.prototype.isActive=function(){return this.m_activeFlag},c.prototype.setActive=function(t){if(t!=this.m_activeFlag){this.m_activeFlag=!!t;var e=this.m_body;this.m_activeFlag?this.createProxies(e.getWorld().m_broadPhase,e.getTransform()):this.destroyProxies(e.getWorld().m_broadPhase)}},c.prototype.queryOverlaps=function(t){if(this.m_activeFlag&&0!=this.m_proxyCount){var e=this.m_body.getWorld();if(null!=e){this._reportOverlap==c.prototype._reportOverlap&&(this._reportOverlap=this._reportOverlap.bind(this)),this._overlaps={},this._overlapCallback=t,this._transform=this.m_body.getTransform();for(var i=0;i<this.m_proxyCount;++i)this._childIndex=i,e.queryAABB(this.m_proxies[i].aabb,this._reportOverlap);this._transform=this._childIndex=this._overlaps=this._overlapCallback=t=null}}},c.prototype._reportOverlap=function(t,e){if(t==this)return!0;var i=t.m_proxies[0].proxyId;return!(!this._overlaps[i]&&a.testOverlap(this.m_shape,this._childIndex,t.m_shape,e.childIndex,this._transform,t.m_body.getTransform()))||(this._overlaps[i]=!0,this._overlapCallback(t))}},function(t,e,i){t.exports=A;var s,n,o,r,a,h,m,c=i(7),l=(i(2),i(0)),u=i(3),_=i(45),p=i(36),d=i(48),f=i(30),y=i(17),v=i(14),g=i(21),x=i(22),b={gravity:l.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function A(t){if(!(this instanceof A))return new A(t);t&&l.isValid(t)&&(t={gravity:t}),t=c(t,b),this.m_solver=new d(this),this.m_broadPhase=new _,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=l.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this),this.collision_matrix=new Uint32Array(32)}A.prototype.getBodyList=function(){return this.m_bodyList},A.prototype.getJointList=function(){return this.m_jointList},A.prototype.getContactList=function(){return this.m_contactList},A.prototype.getBodyCount=function(){return this.m_bodyCount},A.prototype.getJointCount=function(){return this.m_jointCount},A.prototype.getContactCount=function(){return this.m_contactCount},A.prototype.setGravity=function(t){this.m_gravity=t},A.prototype.getGravity=function(){return this.m_gravity},A.prototype.isLocked=function(){return this.m_locked},A.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)},A.prototype.getAllowSleeping=function(){return this.m_allowSleep},A.prototype.setWarmStarting=function(t){this.m_warmStarting=t},A.prototype.getWarmStarting=function(){return this.m_warmStarting},A.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},A.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},A.prototype.setSubStepping=function(t){this.m_subStepping=t},A.prototype.getSubStepping=function(){return this.m_subStepping},A.prototype.setAutoClearForces=function(t){this.m_clearForces=t},A.prototype.getAutoClearForces=function(){return this.m_clearForces},A.prototype.getVelocityIterations=function(){return this.m_velocityIterations},A.prototype.setVelocityIterations=function(t){this.m_velocityIterations=t},A.prototype.getPositionIterations=function(){return this.m_positionIterations},A.prototype.setPositionIterations=function(t){this.m_positionIterations=t},A.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},A.prototype.queryAABB=function(t,e){r=e,this.m_broadPhase.query(t,this._queryAABBCallback),r=null},A.prototype._queryAABBCallback=function(t,e){return r(e.fixture,e)},A.prototype.queryCircle=function(t,e,i){(o=o||new x).setRadius(e),(n=n||new u).p.set(t),s=s||new v,o.computeAABB(s,n),h={},a=i,this.queryAABB(s,this._queryCircleCallback),h=a=null},A.prototype._queryCircleCallback=function(t,e){var i=t.m_proxies[0].proxyId;return!(!h[i]&&g.testOverlap(o,0,t.m_shape,e.childIndex,n,t.m_body.getTransform()))||(h[i]=!0,a(t))},A.prototype.circleCast=function(t,e,i,s,n){(m=m||new p(this)).castCircle(t,e,i,s,n)},A.prototype.boxCast=function(t,e,i,s,n,o,r){(m=m||new p(this)).castBox(t,e,i,s,n,o,r)},A.prototype.capsuleCast=function(t,e,i,s,n,o,r,a){(m=m||new p(this)).castCapsule(t,e,i,s,n,o,r,a)},A.prototype.rayCast=function(t,e,i){h={},a=i,this.m_broadPhase.rayCast(null,this._raycastCallback,t,e,1),h=a=null},A.prototype._raycastCallback=function(t,e,i){var s=i.fixture,n=s.getProxyId(0);if(h[n])return t.maxFraction;var o=i.childIndex,r={};if(s.rayCast(r,t,o)){h[n]=!0;var m=r.fraction,c=t.p1.mul(1-m).add(t.p2.mul(m));return a(s,c,r.normal,m)}return t.maxFraction},A.prototype.getDistance=function(t,e){for(var i=t.getShape(),s=e.getShape(),n=t.getBody().getTransform(),o=e.getBody().getTransform(),r=t.getProxyCount(),a=e.getProxyCount(),h=new g.getInput,m=new g.getCache,c=new g.getOutput,l=new g.Output,u=1/0,_=l.pointA,p=l.pointB,d=0;d<r;++d)for(var f=0;f<a;++f)m.clear(),c.clear(),h.clear(),h.proxyA.set(i,d),h.proxyB.set(s,f),h.transformA=n,h.transformB=o,h.useRadii=!0,h.overlap=!0,g(c,m,h),c.distance<u&&(u=c.distance,_.set(c.pointA),p.set(c.pointB));return u==1/0?null:(l.distance=u,l)},A.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},A.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},A.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},A.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},A.prototype.shiftOrigin=function(t){if(!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var i=this.m_jointList;i;i=i.m_next)i.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},A.prototype.createBody=function(t,e){if(this.isLocked())return null;t&&l.isValid(t)&&(t={position:t,angle:e});var i=new f(this,t);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i},A.prototype.createDynamicBody=function(t,e){return t?l.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},A.prototype.createKinematicBody=function(t,e){return t?l.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},A.prototype.destroyBody=function(t){if(!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;for(var s=t.m_contactList;s;){var n=s;s=s.next,this.destroyContact(n.contact),t.m_contactList=s}t.m_contactList=null;for(var o=t.m_fixtureList;o;){var r=o;o=o.m_next,this.publish("remove-fixture",r),r.destroyProxies(this.m_broadPhase),t.m_fixtureList=o}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}},A.prototype.createJoint=function(t){return this.isLocked()?null:(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.connectBodyA(),t.connectBodyB(),t.refilter(),t)},A.prototype.destroyJoint=function(t){this.isLocked()||(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next),t.disconnectBodyA(),t.disconnectBodyB(),--this.m_jointCount,t.refilter(),this.publish("remove-joint",t))};var w=new d.TimeStep;A.prototype.step=function(t,e,i){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,w.reset(t),w.velocityIterations=e,w.positionIterations=i,w.warmStarting=this.m_warmStarting,w.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(w);for(var s=this.m_bodyList;s;s=s.getNext())0!=s.m_islandFlag&&(s.isStatic()||s.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(w),this.m_clearForces&&this.clearForces(),this.m_locked=!1},A.prototype.getLastTimeStep=function(){return w.dt},A.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},A.prototype.createContact=function(t,e){var i=t.fixture,s=e.fixture,n=t.childIndex,o=e.childIndex,r=i.getBody(),a=s.getBody();if(r!=a){for(var h=a.getContactList();h;){if(h.other==r){var m=h.contact.getFixtureA(),c=h.contact.getFixtureB(),l=h.contact.getChildIndexA(),u=h.contact.getChildIndexB();if(m==i&&c==s&&l==n&&u==o)return;if(m==s&&c==i&&l==o&&u==n)return}h=h.next}if(0!=a.shouldCollide(r)&&0!=s.shouldCollide(i)){var _=y.create(i,n,s,o);null!=_&&(_.m_prev=null,null!=this.m_contactList&&(_.m_next=this.m_contactList,this.m_contactList.m_prev=_),this.m_contactList=_,++this.m_contactCount)}}},A.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var i=t.getFixtureA();if(i.isActive()){var s=t.getFixtureB();if(s.isActive()){var n=i.getBody();if(n.isActive()){var o=s.getBody();if(o.isActive()){var r=t.getChildIndexA(),a=t.getChildIndexB();if(t.m_filterFlag){if(r>=i.m_proxies.length){this.destroyContact(t);continue}if(a>=s.m_proxies.length){this.destroyContact(t);continue}if(0==o.shouldCollide(n)){this.destroyContact(t);continue}if(0==s.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}if(0!=!n.isStatic()||0!=!o.isStatic()){var h=i.m_proxies[r].proxyId,m=s.m_proxies[a].proxyId;0!=this.m_broadPhase.testOverlap(h,m)?n.isKinematic()||o.isKinematic()?(n.isAwake()||n.setAwake(!0),o.isAwake()||o.setAwake(!0),t.update(this)):(n.isAwake()||o.isAwake())&&t.update(this):this.destroyContact(t)}}else this.destroyContact(t)}else this.destroyContact(t)}else this.destroyContact(t)}else this.destroyContact(t)}},A.prototype.destroyContact=function(t){y.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},A.prototype._listeners=null,A.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e?this:(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),this)},A.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;var i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;var s=i.indexOf(e);return s>=0&&i.splice(s,1),this},A.prototype.publish=function(t,e,i,s){var n=this._listeners&&this._listeners[t];if(!n||!n.length)return 0;for(var o=0;o<n.length;o++)n[o].call(this,e,i,s);return n.length},A.prototype.beginContact=function(t){this.publish("begin-contact",t)},A.prototype.endContact=function(t){this.publish("end-contact",t)},A.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},A.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},function(t,e,i){var s=i(5),n=(i(2),i(46)),o=i(0),r=i(1),a=i(14);function h(t){this.id=t,this.aabb=new a,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function m(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new n({create:function(){return new h}})}t.exports=m,h.prototype.isLeaf=function(){return null==this.child1},m.prototype.getUserData=function(t){var e=this.m_nodes[t];return e.userData},m.prototype.getFatAABB=function(t){var e=this.m_nodes[t];return e.aabb},m.prototype.allocateNode=function(){var t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},m.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},m.prototype.createProxy=function(t,e){var i=this.allocateNode();return i.aabb.set(t),a.extend(i.aabb,s.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},m.prototype.destroyProxy=function(t){var e=this.m_nodes[t];this.removeLeaf(e),this.freeNode(e)},m.prototype.moveProxy=function(t,e,i){var n=this.m_nodes[t];return!n.aabb.contains(e)&&(this.removeLeaf(n),n.aabb.set(e),e=n.aabb,a.extend(e,s.aabbExtension),i.x<0?e.lowerBound.x+=i.x*s.aabbMultiplier:e.upperBound.x+=i.x*s.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*s.aabbMultiplier:e.upperBound.y+=i.y*s.aabbMultiplier,this.insertLeaf(n),!0)},m.prototype.insertLeaf=function(t){if(null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var e=t.aabb,i=this.m_root;0==i.isLeaf();){var s=i.child1,n=i.child2,o=i.aabb.getPerimeter(),h=new a;h.combine(i.aabb,e);var m,c,l=h.getPerimeter(),u=2*l,_=2*(l-o);if(s.isLeaf()){(d=new a).combine(e,s.aabb),m=d.getPerimeter()+_}else{(d=new a).combine(e,s.aabb);var p=s.aabb.getPerimeter();m=d.getPerimeter()-p+_}if(n.isLeaf()){(d=new a).combine(e,n.aabb),c=d.getPerimeter()+_}else{var d;(d=new a).combine(e,n.aabb);p=n.aabb.getPerimeter();c=d.getPerimeter()-p+_}if(u<m&&u<c)break;i=m<c?s:n}var f=i,y=f.parent,v=this.allocateNode();for(v.parent=y,v.userData=null,v.aabb.combine(e,f.aabb),v.height=f.height+1,null!=y?(y.child1==f?y.child1=v:y.child2=v,v.child1=f,v.child2=t,f.parent=v,t.parent=v):(v.child1=f,v.child2=t,f.parent=v,t.parent=v,this.m_root=v),i=t.parent;null!=i;){s=(i=this.balance(i)).child1,n=i.child2;i.height=1+r.max(s.height,n.height),i.aabb.combine(s.aabb,n.aabb),i=i.parent}},m.prototype.removeLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,s=i.parent;if(e=i.child1==t?i.child2:i.child1,null!=s){s.child1==i?s.child1=e:s.child2=e,e.parent=s,this.freeNode(i);for(var n=s;null!=n;){var o=(n=this.balance(n)).child1,a=n.child2;n.aabb.combine(o.aabb,a.aabb),n.height=1+r.max(o.height,a.height),n=n.parent}}else this.m_root=e,e.parent=null,this.freeNode(i)}else this.m_root=null},m.prototype.balance=function(t){var e=t;if(e.isLeaf()||e.height<2)return t;var i=e.child1,s=e.child2,n=s.height-i.height;if(n>1){var o=s.child1,a=s.child2;return s.child1=e,s.parent=e.parent,e.parent=s,null!=s.parent?s.parent.child1==t?s.parent.child1=s:s.parent.child2=s:this.m_root=s,o.height>a.height?(s.child2=o,e.child2=a,a.parent=e,e.aabb.combine(i.aabb,a.aabb),s.aabb.combine(e.aabb,o.aabb),e.height=1+r.max(i.height,a.height),s.height=1+r.max(e.height,o.height)):(s.child2=a,e.child2=o,o.parent=e,e.aabb.combine(i.aabb,o.aabb),s.aabb.combine(e.aabb,a.aabb),e.height=1+r.max(i.height,o.height),s.height=1+r.max(e.height,a.height)),s}if(n<-1){var h=i.child1,m=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,h.height>m.height?(i.child2=h,e.child1=m,m.parent=e,e.aabb.combine(s.aabb,m.aabb),i.aabb.combine(e.aabb,h.aabb),e.height=1+r.max(s.height,m.height),i.height=1+r.max(e.height,h.height)):(i.child2=m,e.child1=h,h.parent=e,e.aabb.combine(s.aabb,h.aabb),i.aabb.combine(e.aabb,m.aabb),e.height=1+r.max(s.height,h.height),i.height=1+r.max(e.height,m.height)),i}return e},m.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},m.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;for(var t,e=this.m_root.aabb.getPerimeter(),i=0,s=u.allocate().preorder();t=s.next();)t.height<0||(i+=t.aabb.getPerimeter());return u.release(s),i/e},m.prototype.computeHeight=function(t){var e;if((e=void 0!==t?this.m_nodes[t]:this.m_root).isLeaf())return 0;var i=ComputeHeight(e.child1),s=ComputeHeight(e.child2);return 1+r.max(i,s)},m.prototype.validateStructure=function(t){if(null!=t){this.m_root;var e=t.child1,i=t.child2;t.isLeaf()||(this.validateStructure(e),this.validateStructure(i))}},m.prototype.validateMetrics=function(t){if(null!=t){var e=t.child1,i=t.child2;if(!t.isLeaf()){var s=this.m_nodes[e].height,n=this.m_nodes[i].height,o=(r.max(s,n),new a);o.combine(e.aabb,i.aabb),this.validateMetrics(e),this.validateMetrics(i)}}},m.prototype.validate=function(){ValidateStructure(this.m_root),ValidateMetrics(this.m_root)},m.prototype.getMaxBalance=function(){for(var t,e=0,i=u.allocate().preorder();t=i.next();)if(!(t.height<=1)){var s=r.abs(t.child2.height-t.child1.height);e=r.max(e,s)}return u.release(i),e},m.prototype.rebuildBottomUp=function(){for(var t,e=[],i=0,s=u.allocate().preorder();t=s.next();)t.height<0||(t.isLeaf()?(t.parent=null,e[i]=t,++i):this.freeNode(t));for(u.release(s);i>1;){for(var n=1/0,o=-1,h=-1,m=0;m<i;++m)for(var c=e[m].aabb,l=m+1;l<i;++l){var _=e[l].aabb,p=new a;p.combine(c,_);var d=p.getPerimeter();d<n&&(o=m,h=l,n=d)}var f=e[o],y=e[h],v=this.allocateNode();v.child1=f,v.child2=y,v.height=1+r.max(f.height,y.height),v.aabb.combine(f.aabb,y.aabb),v.parent=null,f.parent=v,y.parent=v,e[h]=e[i-1],e[o]=v,--i}this.m_root=e[0],this.validate()},m.prototype.shiftOrigin=function(t){for(var e,i=u.allocate().preorder();e=i.next();){var s=e.aabb;s.lowerBound.x-=t.x,s.lowerBound.y-=t.y,s.upperBound.x-=t.x,s.upperBound.y-=t.y}u.release(i)},m.prototype.query=function(t,e){var i=l.allocate();for(i.push(this.m_root);i.length>0;){var s=i.pop();if(null!=s)if(a.testOverlap(s.aabb,t))if(s.isLeaf()){if(0==e(s.id,s.userData))return}else i.push(s.child1),i.push(s.child2)}l.release(i)},m.prototype.rayCast=function(t,e,i,s,n){i=i||t.p1,s=s||t.p2;var h=o.sub(s,i);h.normalize();var m=o.cross(1,h),u=o.abs(m);n=n>=0?n:t.maxFraction;var _=new a,p=o.combine(1-n,i,n,s);_.combinePoints(i,p);var d=l.allocate(),f=c.allocate();for(d.push(this.m_root);d.length>0;){var y=d.pop();if(null!=y&&0!=a.testOverlap(y.aabb,_)){var v=y.aabb.getCenter(),g=y.aabb.getExtents();if(!(r.abs(o.dot(m,o.sub(i,v)))-o.dot(u,g)>0))if(y.isLeaf()){f.p1=o.clone(i),f.p2=o.clone(s),f.maxFraction=n;var x=e(f,y.id,y.userData);if(0==x)return;x>0&&(n=x,p=o.combine(1-n,i,n,s),_.combinePoints(i,p))}else d.push(y.child1),d.push(y.child2)}}l.release(d),c.release(f)};var c=new n({create:function(){return{}},release:function(t){}}),l=new n({create:function(){return[]},release:function(t){t.length=0}}),u=new n({create:function(){return new _},release:function(t){t.close()}});function _(){var t=[],e=[];return{preorder:function(i){return t.length=0,t.push(i),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){var i=t.length-1,s=t[i];if(0===e[i])return e[i]=1,s;if(1===e[i]&&(e[i]=2,s.child1))return t.push(s.child1),e.push(1),s.child1;if(2===e[i]&&(e[i]=3,s.child2))return t.push(s.child2),e.push(1),s.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},function(t,e,i){var s=i(31),n=s.Input,o=s.Output,r=(s.SeparationFunction,i(3)),a=(i(4),i(0)),h=i(14),m=i(1),c=i(22),l=i(37),u=i(25);function _(t){this.world=t,this.shape,this.distance,this.currentDistance,this.callback,this.proxies,this.xfA=new r,this.cA=new a,this.fraction=1,this.scale=1,this.canReduceAaab=!0,this.aabbStart=new h,this.aabbEnd=new h,this.aabb=new h,this.handleFixture=this.handleFixture.bind(this),this.circle,this.box,this.capsule}function p(t,e,i,n,r){var a=new o;if(s(a,t),a.state===o.e_touching||a.state===o.e_overlapped){var h=new f,m=h.evaluate(a.cache,t.proxyA,t.sweepA,t.proxyB,t.sweepB,a.t);this.normal=a.state===o.e_touching?h.m_normalB:h.m_normalB.neg(),this.centroid=h.m_centroid,i*=a.t,this.distance=i,this.fraction=i/n,this.point=h.m_type===d?h.m_pointA.addMul(-.5*(m+r),this.normal):h.m_pointB.addMul(.5*(m-r),this.normal),this.fixture=e}}t.exports=_,_.prototype.castCircle=function(t,e,i,s,n){this.circle?this.circle.setRadius(e):this.circle=new c(e),this.execute(this.circle,t,0,i,s,n)},_.prototype.castBox=function(t,e,i,s,n,o,r){this.box?this.box._setAsBox(e,i):this.box=new l(e,i),this.execute(this.box,t,s,n,o,r)},_.prototype.castCapsule=function(t,e,i,s,n,o,r,a){this.capsule?(this.capsule.setVertex1(e),this.capsule.setVertex2(i),this.capsule.setRadius(s)):this.capsule=new u(e,i,s),this.execute(this.capsule,t,n,o,r,a)},_.prototype.execute=function(t,e,i,s,n,o){this.shape=t,this.callback=o;var r=this.xfA;r.p.set(e),r.q.setAngle(i);var a=s.normalize();this.scale=a>0?a:1,this.distance=n,this.fraction=1,this.canReduceAaab=!0,this.proxies={};var h=this.aabbStart,m=this.aabbEnd,c=this.aabb;for(t.computeAABB(h,r,0);this.canReduceAaab;)this.canReduceAaab=!1,this.currentDistance=this.fraction*n,this.cA.set(e).addMul(this.currentDistance,s),r.p.set(this.cA),t.computeAABB(m,r,0),c.combine(h,m),r.p.set(e),this.world.queryAABB(c,this.handleFixture);this.callback=this.proxies=null},_.prototype.handleFixture=function(t,e){var i=e.proxyId;if(this.proxies[i])return!0;this.proxies[i]=!0;var s=this.getIntersection(t,e.childIndex);if(!s.fixture)return!0;var n=this.callback(s,s.distance/this.distance);return!(n<this.fraction)||(this.fraction=n,this.canReduceAaab=!0,!1)},_.prototype.getIntersection=function(t,e){var i=new n;i.sweepA.setTransform(this.xfA),i.sweepA.c.set(this.cA),i.proxyA.set(this.shape,0),i.sweepB.setTransform(t.m_body.getTransform());var s=t.getShape();return i.proxyB.set(s,e),i.tMax=1,new p(i,t,this.currentDistance,this.scale,this.shape.m_radius-s.m_radius)};var d=3;function f(){this.m_type,this.m_normalB,this.m_pointA,this.m_pointB,this.m_centroid}f.prototype.evaluate=function(t,e,i,s,n,o){var h=r.identity(),c=r.identity();if(i.getTransform(h,o),n.getTransform(c,o),this.m_centroid=h.p,1===t.count){this.m_type=1;var l=e.getVertex(t.indexA[0]),u=s.getVertex(t.indexB[0]),_=r.mulVec2(h,l),p=r.mulVec2(c,u);return this.m_normalB=a.combine(1,_,-1,p),this.m_pointA=_,this.m_pointB=p,this.m_normalB.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=d;var f=s.getVertex(t.indexB[0]),y=s.getVertex(t.indexB[1]);(x=a.sub(y,f)).set(x.y,-x.x).normalize();var v=x.rot(c.q),g=(u=a.mid(f,y),p=r.mulVec2(c,u,u),l=e.getVertex(t.indexA[0]),_=r.mulVec2(h,l),a.dot(_,v)-a.dot(p,v));return this.m_pointA=_,this.m_pointB=p,g<0?(this.m_normalB=v.neg(),g=-g):this.m_normalB=v,g}if(t.indexB[0]==t.indexB[1]){this.m_type=2;var x,b=e.getVertex(t.indexA[0]),A=e.getVertex(t.indexA[1]);(x=a.sub(A,b)).set(x.y,-x.x).normalize();v=x.rot(h.q),l=a.mid(b,A),_=r.mulVec2(h,l,l),u=s.getVertex(t.indexB[0]),p=r.mulVec2(c,u),g=a.dot(p,v)-a.dot(_,v);return this.m_pointA=_,this.m_pointB=p,g<0?(this.m_normalB=v,g=-g):this.m_normalB=v.neg(),g}this.m_type=d;var w=r.mulVec2(h,e.getVertex(t.indexA[0])),B=r.mulVec2(h,e.getVertex(t.indexA[1])),M=r.mulVec2(c,s.getVertex(t.indexB[0])),C=r.mulVec2(c,s.getVertex(t.indexB[1])),z=(_=a.mid(w,B),p=a.mid(M,C),a.mid(_,p)),I=B.sub(w),S=z.clone().sub(w),L=a.dot(I,I);this.m_pointA=L<m.EPSILON?w:I.mul(a.dot(S,I)/L).add(w);var P=C.sub(M),k=z.clone().sub(M),V=a.dot(P,P);return this.m_pointB=V<m.EPSILON?M:P.mul(a.dot(k,P)/V).add(M),this.m_normalB=z.set(this.m_pointA).sub(this.m_pointB),(g=this.m_normalB.normalize())<=m.EPSILON&&this.m_normalB.set(0,1),g}},function(t,e,i){t.exports=o;i(2);var s=i(6),n=i(19);function o(t,e,i,s){if(!(this instanceof o))return new o(t,e,i,s);o._super.call(this),this._setAsBox(t,e,i,s)}o._super=n,o.prototype=s(o._super.prototype),o.TYPE="polygon"},function(t,e,i){"use strict";var s={},n={};t.exports=s,s.WINDING_ODD=0,s.WINDING_NONZERO=1,s.WINDING_POSITIVE=2,s.WINDING_NEGATIVE=3,s.WINDING_ABS_GEQ_TWO=4,s.POLYGONS=0,s.CONNECTED_POLYGONS=1,s.BOUNDARY_CONTOURS=2,s.tesselate=function(t){for(var e=t.debug||!1,i=new y,n=0;n<t.contours.length;n++)i.addContour(t.vertexSize||2,t.contours[n]);return i.tesselate(t.windingRule||s.WINDING_ODD,t.elementType||s.POLYGONS,t.polySize||3,t.vertexSize||2,t.normal||[0,0,1]),{vertices:i.vertices,vertexIndices:i.vertexIndices,vertexCount:i.vertexCount,elements:i.elements,elementCount:i.elementCount,mesh:e?i.mesh:void 0}};var o=function(t){if(!t)throw"Assertion Failed!"};function r(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}function a(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}function h(t){this.next=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Org=null,this.Lface=null,this.activeRegion=null,this.winding=0,this.side=t}function m(){var t=new r,e=new a,i=new h(0),s=new h(1);t.next=t.prev=t,t.anEdge=null,e.next=e.prev=e,e.anEdge=null,e.trail=null,e.marked=!1,e.inside=!1,i.next=i,i.Sym=s,i.Onext=null,i.Lnext=null,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,s.next=s,s.Sym=i,s.Onext=null,s.Lnext=null,s.Org=null,s.Lface=null,s.winding=0,s.activeRegion=null,this.vHead=t,this.fHead=e,this.eHead=i,this.eHeadSym=s}function c(){this.key=null,this.next=null,this.prev=null}function l(t,e){this.head=new c,this.head.next=this.head,this.head.prev=this.head,this.frame=t,this.leq=e}function u(){this.handle=null}function _(){this.key=null,this.node=null}function p(t,e){var i;for(this.size=0,this.max=t,this.nodes=[],this.nodes.length=t+1,i=0;i<this.nodes.length;i++)this.nodes[i]=new u;for(this.handles=[],this.handles.length=t+1,i=0;i<this.handles.length;i++)this.handles[i]=new _;this.initialized=!1,this.freeList=0,this.leq=e,this.nodes[1].handle=1,this.handles[1].key=null}function d(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}h.prototype={get Rface(){return this.Sym.Lface},set Rface(t){this.Sym.Lface=t},get Dst(){return this.Sym.Org},set Dst(t){this.Sym.Org=t},get Oprev(){return this.Sym.Lnext},set Oprev(t){this.Sym.Lnext=t},get Lprev(){return this.Onext.Sym},set Lprev(t){this.Onext.Sym=t},get Dprev(){return this.Lnext.Sym},set Dprev(t){this.Lnext.Sym=t},get Rprev(){return this.Sym.Onext},set Rprev(t){this.Sym.Onext=t},get Dnext(){return this.Sym.Onext.Sym},set Dnext(t){this.Sym.Onext.Sym=t},get Rnext(){return this.Sym.Lnext.Sym},set Rnext(t){this.Sym.Lnext.Sym=t}},m.prototype={makeEdge_:function(t){var e=new h(0),i=new h(1);t.Sym.side<t.side&&(t=t.Sym);var s=t.Sym.next;return i.next=s,s.Sym.next=e,e.next=t,t.Sym.next=i,e.Sym=i,e.Onext=e,e.Lnext=i,e.Org=null,e.Lface=null,e.winding=0,e.activeRegion=null,i.Sym=e,i.Onext=i,i.Lnext=e,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,e},splice_:function(t,e){var i=t.Onext,s=e.Onext;i.Sym.Lnext=e,s.Sym.Lnext=t,t.Onext=s,e.Onext=i},makeVertex_:function(t,e,i){var s=t;o(null!==s);var n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e;var r=e;do{r.Org=s,r=r.Onext}while(r!==e)},makeFace_:function(t,e,i){var s=t;o(null!==s);var n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e,s.trail=null,s.marked=!1,s.inside=i.inside;var r=e;do{r.Lface=s,r=r.Lnext}while(r!==e)},killEdge_:function(t){t.Sym.side<t.side&&(t=t.Sym);var e=t.next,i=t.Sym.next;e.Sym.next=i,i.Sym.next=e},killVertex_:function(t,e){var i=t.anEdge,s=i;do{s.Org=e,s=s.Onext}while(s!==i);var n=t.prev,o=t.next;o.prev=n,n.next=o},killFace_:function(t,e){var i=t.anEdge,s=i;do{s.Lface=e,s=s.Lnext}while(s!==i);var n=t.prev,o=t.next;o.prev=n,n.next=o},makeEdge:function(){var t=new r,e=new r,i=new a,s=this.makeEdge_(this.eHead);return this.makeVertex_(t,s,this.vHead),this.makeVertex_(e,s.Sym,this.vHead),this.makeFace_(i,s,this.fHead),s},splice:function(t,e){var i=!1,s=!1;if(t!==e){if(e.Org!==t.Org&&(s=!0,this.killVertex_(e.Org,t.Org)),e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(e,t),!s){var n=new r;this.makeVertex_(n,e,t.Org),t.Org.anEdge=t}if(!i){var o=new a;this.makeFace_(o,e,t.Lface),t.Lface.anEdge=t}}},delete:function(t){var e=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var s=new a;this.makeFace_(s,t,t.Lface)}e.Onext===e?(this.killVertex_(e.Org,null),this.killFace_(e.Lface,null)):(t.Lface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),this.killEdge_(t)},addEdgeVertex:function(t){var e=this.makeEdge_(t),i=e.Sym;this.splice_(e,t.Lnext),e.Org=t.Dst;var s=new r;return this.makeVertex_(s,i,e.Org),e.Lface=i.Lface=t.Lface,e},splitEdge:function(t,e){var i=this.addEdgeVertex(t).Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i},connect:function(t,e){var i=!1,s=this.makeEdge_(t),n=s.Sym;if(e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(s,t.Lnext),this.splice_(n,e),s.Org=t.Dst,n.Org=e.Org,s.Lface=n.Lface=t.Lface,t.Lface.anEdge=n,!i){var o=new a;this.makeFace_(o,s,t.Lface)}return s},zapFace:function(t){var e,i,s,n,o,r=t.anEdge;i=r.Lnext;do{i=(e=i).Lnext,e.Lface=null,null===e.Rface&&(e.Onext===e?this.killVertex_(e.Org,null):(e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),(s=e.Sym).Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(e))}while(e!=r);n=t.prev,(o=t.next).prev=n,n.next=o},countFaceVerts_:function(t){var e=t.anEdge,i=0;do{i++,e=e.Lnext}while(e!==t.anEdge);return i},mergeConvexFaces:function(t){var e,i,s,o,r;for(e=this.fHead.next;e!==this.fHead;e=e.next)if(e.inside)for(r=(i=e.anEdge).Org;s=i.Lnext,(o=i.Sym)&&o.Lface&&o.Lface.inside&&this.countFaceVerts_(e)+this.countFaceVerts_(o.Lface)-2<=t&&n.vertCCW(i.Lprev.Org,i.Org,o.Lnext.Lnext.Org)&&n.vertCCW(o.Lprev.Org,o.Org,i.Lnext.Lnext.Org)&&(s=o.Lnext,this.delete(o),i=null,o=null),!i||i.Lnext.Org!==r;)i=s;return!0},check:function(){var t,e,i,s,n,r,a=this.fHead,h=this.vHead,m=this.eHead;for(e=a,e=a;(t=e.next)!==a;e=t){o(t.prev===e),n=t.anEdge;do{o(n.Sym!==n),o(n.Sym.Sym===n),o(n.Lnext.Onext.Sym===n),o(n.Onext.Sym.Lnext===n),o(n.Lface===t),n=n.Lnext}while(n!==t.anEdge)}for(o(t.prev===e&&null===t.anEdge),s=h,s=h;(i=s.next)!==h;s=i){o(i.prev===s),n=i.anEdge;do{o(n.Sym!==n),o(n.Sym.Sym===n),o(n.Lnext.Onext.Sym===n),o(n.Onext.Sym.Lnext===n),o(n.Org===i),n=n.Onext}while(n!==i.anEdge)}for(o(i.prev===s&&null===i.anEdge),r=m,r=m;(n=r.next)!==m;r=n)o(n.Sym.next===r.Sym),o(n.Sym!==n),o(n.Sym.Sym===n),o(null!==n.Org),o(null!==n.Dst),o(n.Lnext.Onext.Sym===n),o(n.Onext.Sym.Lnext===n);o(n.Sym.next===r.Sym&&n.Sym===this.eHeadSym&&n.Sym.Sym===n&&null===n.Org&&null===n.Dst&&null===n.Lface&&null===n.Rface)}},n.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},n.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},n.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},n.edgeGoesLeft=function(t){return n.vertLeq(t.Dst,t.Org)},n.edgeGoesRight=function(t){return n.vertLeq(t.Org,t.Dst)},n.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},n.edgeEval=function(t,e,i){o(n.vertLeq(t,e)&&n.vertLeq(e,i));var s=e.s-t.s,r=i.s-e.s;return s+r>0?s<r?e.t-t.t+(t.t-i.t)*(s/(s+r)):e.t-i.t+(i.t-t.t)*(r/(s+r)):0},n.edgeSign=function(t,e,i){o(n.vertLeq(t,e)&&n.vertLeq(e,i));var s=e.s-t.s,r=i.s-e.s;return s+r>0?(e.t-i.t)*s+(e.t-t.t)*r:0},n.transEval=function(t,e,i){o(n.transLeq(t,e)&&n.transLeq(e,i));var s=e.t-t.t,r=i.t-e.t;return s+r>0?s<r?e.s-t.s+(t.s-i.s)*(s/(s+r)):e.s-i.s+(i.s-t.s)*(r/(s+r)):0},n.transSign=function(t,e,i){o(n.transLeq(t,e)&&n.transLeq(e,i));var s=e.t-t.t,r=i.t-e.t;return s+r>0?(e.s-i.s)*s+(e.s-t.s)*r:0},n.vertCCW=function(t,e,i){return t.s*(e.t-i.t)+e.s*(i.t-t.t)+i.s*(t.t-e.t)>=0},n.interpolate=function(t,e,i,s){return(t=t<0?0:t)<=(i=i<0?0:i)?0===i?(e+s)/2:e+t/(t+i)*(s-e):s+i/(t+i)*(e-s)},n.intersect=function(t,e,i,s,o){var r,a,h;n.vertLeq(t,e)||(h=t,t=e,e=h),n.vertLeq(i,s)||(h=i,i=s,s=h),n.vertLeq(t,i)||(h=t,t=i,i=h,h=e,e=s,s=h),n.vertLeq(i,e)?n.vertLeq(e,s)?((r=n.edgeEval(t,i,e))+(a=n.edgeEval(i,e,s))<0&&(r=-r,a=-a),o.s=n.interpolate(r,i.s,a,e.s)):((r=n.edgeSign(t,i,e))+(a=-n.edgeSign(t,s,e))<0&&(r=-r,a=-a),o.s=n.interpolate(r,i.s,a,s.s)):o.s=(i.s+e.s)/2,n.transLeq(t,e)||(h=t,t=e,e=h),n.transLeq(i,s)||(h=i,i=s,s=h),n.transLeq(t,i)||(h=t,t=i,i=h,h=e,e=s,s=h),n.transLeq(i,e)?n.transLeq(e,s)?((r=n.transEval(t,i,e))+(a=n.transEval(i,e,s))<0&&(r=-r,a=-a),o.t=n.interpolate(r,i.t,a,e.t)):((r=n.transSign(t,i,e))+(a=-n.transSign(t,s,e))<0&&(r=-r,a=-a),o.t=n.interpolate(r,i.t,a,s.t)):o.t=(i.t+e.t)/2},l.prototype={min:function(){return this.head.next},max:function(){return this.head.prev},insert:function(t){return this.insertBefore(this.head,t)},search:function(t){var e=this.head;do{e=e.next}while(null!==e.key&&!this.leq(this.frame,t,e.key));return e},insertBefore:function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq(this.frame,t.key,e));var i=new c;return i.key=e,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},delete:function(t){t.next.prev=t.prev,t.prev.next=t.next}},p.prototype={floatDown_:function(t){var e,i,s,n=this.nodes,r=this.handles;for(e=n[t].handle;;){if((s=t<<1)<this.size&&this.leq(r[n[s+1].handle].key,r[n[s].handle].key)&&++s,o(s<=this.max),i=n[s].handle,s>this.size||this.leq(r[e].key,r[i].key)){n[t].handle=e,r[e].node=t;break}n[t].handle=i,r[i].node=t,t=s}},floatUp_:function(t){var e,i,s,n=this.nodes,o=this.handles;for(e=n[t].handle;;){if(i=n[s=t>>1].handle,0===s||this.leq(o[i].key,o[e].key)){n[t].handle=e,o[e].node=t;break}n[t].handle=i,o[i].node=t,t=s}},init:function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},min:function(){return this.handles[this.nodes[1].handle].key},insert:function(t){var e,i;if(2*(e=++this.size)>this.max){var s,n;for(this.max*=2,n=this.nodes.length,this.nodes.length=this.max+1,s=n;s<this.nodes.length;s++)this.nodes[s]=new u;for(n=this.handles.length,this.handles.length=this.max+1,s=n;s<this.handles.length;s++)this.handles[s]=new _}return 0===this.freeList?i=e:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[e].handle=i,this.handles[i].node=e,this.handles[i].key=t,this.initialized&&this.floatUp_(e),i},extractMin:function(){var t=this.nodes,e=this.handles,i=t[1].handle,s=e[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,e[t[1].handle].node=1,e[i].key=null,e[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),s},delete:function(t){var e,i=this.nodes,s=this.handles;o(t>=1&&t<=this.max&&null!==s[t].key),i[e=s[t].node].handle=i[this.size].handle,s[i[e].handle].node=e,--this.size,e<=this.size&&(e<=1||this.leq(s[i[e>>1].handle].key,s[i[e].handle].key)?this.floatDown_(e):this.floatUp_(e)),s[t].key=null,s[t].node=this.freeList,this.freeList=t}};var f={};function y(){this.mesh=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=s.WINDING_ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}f.regionBelow=function(t){return t.nodeUp.prev.key},f.regionAbove=function(t){return t.nodeUp.next.key},f.debugEvent=function(t){},f.addWinding=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},f.edgeLeq=function(t,e,i){var s=t.event,o=e.eUp,r=i.eUp;return o.Dst===s?r.Dst===s?n.vertLeq(o.Org,r.Org)?n.edgeSign(r.Dst,o.Org,r.Org)<=0:n.edgeSign(o.Dst,r.Org,o.Org)>=0:n.edgeSign(r.Dst,s,r.Org)<=0:r.Dst===s?n.edgeSign(o.Dst,s,o.Org)>=0:n.edgeEval(o.Dst,s,o.Org)>=n.edgeEval(r.Dst,s,r.Org)},f.deleteRegion=function(t,e){e.fixUpperEdge&&o(0===e.eUp.winding),e.eUp.activeRegion=null,t.dict.delete(e.nodeUp)},f.fixUpperEdge=function(t,e,i){o(e.fixUpperEdge),t.mesh.delete(e.eUp),e.fixUpperEdge=!1,e.eUp=i,i.activeRegion=e},f.topLeftRegion=function(t,e){var i,s=e.eUp.Org;do{e=f.regionAbove(e)}while(e.eUp.Org===s);if(e.fixUpperEdge){if(null===(i=t.mesh.connect(f.regionBelow(e).eUp.Sym,e.eUp.Lnext)))return null;f.fixUpperEdge(t,e,i),e=f.regionAbove(e)}return e},f.topRightRegion=function(t){var e=t.eUp.Dst;do{t=f.regionAbove(t)}while(t.eUp.Dst===e);return t},f.addRegionBelow=function(t,e,i){var s=new d;return s.eUp=i,s.nodeUp=t.dict.insertBefore(e.nodeUp,s),s.fixUpperEdge=!1,s.sentinel=!1,s.dirty=!1,i.activeRegion=s,s},f.isWindingInside=function(t,e){switch(t.windingRule){case s.WINDING_ODD:return 0!=(1&e);case s.WINDING_NONZERO:return 0!==e;case s.WINDING_POSITIVE:return e>0;case s.WINDING_NEGATIVE:return e<0;case s.WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return o(!1),!1},f.computeWinding=function(t,e){e.windingNumber=f.regionAbove(e).windingNumber+e.eUp.winding,e.inside=f.isWindingInside(t,e.windingNumber)},f.finishRegion=function(t,e){var i=e.eUp,s=i.Lface;s.inside=e.inside,s.anEdge=i,f.deleteRegion(t,e)},f.finishLeftRegions=function(t,e,i){for(var s,n=null,o=e,r=e.eUp;o!==i;){if(o.fixUpperEdge=!1,(s=(n=f.regionBelow(o)).eUp).Org!=r.Org){if(!n.fixUpperEdge){f.finishRegion(t,o);break}s=t.mesh.connect(r.Lprev,s.Sym),f.fixUpperEdge(t,n,s)}r.Onext!==s&&(t.mesh.splice(s.Oprev,s),t.mesh.splice(r,s)),f.finishRegion(t,o),r=n.eUp,o=n}return r},f.addRightEdges=function(t,e,i,s,r,a){var h,m,c,l,u=!0;c=i;do{o(n.vertLeq(c.Org,c.Dst)),f.addRegionBelow(t,e,c.Sym),c=c.Onext}while(c!==s);for(null===r&&(r=f.regionBelow(e).eUp.Rprev),m=e,l=r;(c=(h=f.regionBelow(m)).eUp.Sym).Org===l.Org;)c.Onext!==l&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(l.Oprev,c)),h.windingNumber=m.windingNumber-c.winding,h.inside=f.isWindingInside(t,h.windingNumber),m.dirty=!0,!u&&f.checkForRightSplice(t,m)&&(f.addWinding(c,l),f.deleteRegion(t,m),t.mesh.delete(l)),u=!1,m=h,l=c;m.dirty=!0,o(m.windingNumber-c.winding===h.windingNumber),a&&f.walkDirtyRegions(t,m)},f.spliceMergeVertices=function(t,e,i){t.mesh.splice(e,i)},f.vertexWeights=function(t,e,i){var s=n.vertL1dist(e,t),o=n.vertL1dist(i,t),r=.5*o/(s+o),a=.5*s/(s+o);t.coords[0]+=r*e.coords[0]+a*i.coords[0],t.coords[1]+=r*e.coords[1]+a*i.coords[1],t.coords[2]+=r*e.coords[2]+a*i.coords[2]},f.getIntersectData=function(t,e,i,s,n,o){e.coords[0]=e.coords[1]=e.coords[2]=0,e.idx=-1,f.vertexWeights(e,i,s),f.vertexWeights(e,n,o)},f.checkForRightSplice=function(t,e){var i=f.regionBelow(e),s=e.eUp,o=i.eUp;if(n.vertLeq(s.Org,o.Org)){if(n.edgeSign(o.Dst,s.Org,o.Org)>0)return!1;n.vertEq(s.Org,o.Org)?s.Org!==o.Org&&(t.pq.delete(s.Org.pqHandle),f.spliceMergeVertices(t,o.Oprev,s)):(t.mesh.splitEdge(o.Sym),t.mesh.splice(s,o.Oprev),e.dirty=i.dirty=!0)}else{if(n.edgeSign(s.Dst,o.Org,s.Org)<0)return!1;f.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(s.Sym),t.mesh.splice(o.Oprev,s)}return!0},f.checkForLeftSplice=function(t,e){var i,s=f.regionBelow(e),r=e.eUp,a=s.eUp;if(o(!n.vertEq(r.Dst,a.Dst)),n.vertLeq(r.Dst,a.Dst)){if(n.edgeSign(r.Dst,a.Dst,r.Org)<0)return!1;f.regionAbove(e).dirty=e.dirty=!0,i=t.mesh.splitEdge(r),t.mesh.splice(a.Sym,i),i.Lface.inside=e.inside}else{if(n.edgeSign(a.Dst,r.Dst,a.Org)>0)return!1;e.dirty=s.dirty=!0,i=t.mesh.splitEdge(a),t.mesh.splice(r.Lnext,a.Sym),i.Rface.inside=e.inside}return!0},f.checkForIntersect=function(t,e){var i,s,a=f.regionBelow(e),h=e.eUp,m=a.eUp,c=h.Org,l=m.Org,u=h.Dst,_=m.Dst,p=new r;if(o(!n.vertEq(_,u)),o(n.edgeSign(u,t.event,c)<=0),o(n.edgeSign(_,t.event,l)>=0),o(c!==t.event&&l!==t.event),o(!e.fixUpperEdge&&!a.fixUpperEdge),c===l)return!1;if(Math.min(c.t,u.t)>Math.max(l.t,_.t))return!1;if(n.vertLeq(c,l)){if(n.edgeSign(_,c,l)>0)return!1}else if(n.edgeSign(u,l,c)<0)return!1;return f.debugEvent(t),n.intersect(u,c,_,l,p),o(Math.min(c.t,u.t)<=p.t),o(p.t<=Math.max(l.t,_.t)),o(Math.min(_.s,u.s)<=p.s),o(p.s<=Math.max(l.s,c.s)),n.vertLeq(p,t.event)&&(p.s=t.event.s,p.t=t.event.t),i=n.vertLeq(c,l)?c:l,n.vertLeq(i,p)&&(p.s=i.s,p.t=i.t),n.vertEq(p,c)||n.vertEq(p,l)?(f.checkForRightSplice(t,e),!1):!n.vertEq(u,t.event)&&n.edgeSign(u,t.event,p)>=0||!n.vertEq(_,t.event)&&n.edgeSign(_,t.event,p)<=0?_===t.event?(t.mesh.splitEdge(h.Sym),t.mesh.splice(m.Sym,h),e=f.topLeftRegion(t,e),h=f.regionBelow(e).eUp,f.finishLeftRegions(t,f.regionBelow(e),a),f.addRightEdges(t,e,h.Oprev,h,h,!0),!0):u===t.event?(t.mesh.splitEdge(m.Sym),t.mesh.splice(h.Lnext,m.Oprev),a=e,e=f.topRightRegion(e),s=f.regionBelow(e).eUp.Rprev,a.eUp=m.Oprev,m=f.finishLeftRegions(t,a,null),f.addRightEdges(t,e,m.Onext,h.Rprev,s,!0),!0):(n.edgeSign(u,t.event,p)>=0&&(f.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(h.Sym),h.Org.s=t.event.s,h.Org.t=t.event.t),n.edgeSign(_,t.event,p)<=0&&(e.dirty=a.dirty=!0,t.mesh.splitEdge(m.Sym),m.Org.s=t.event.s,m.Org.t=t.event.t),!1):(t.mesh.splitEdge(h.Sym),t.mesh.splitEdge(m.Sym),t.mesh.splice(m.Oprev,h),h.Org.s=p.s,h.Org.t=p.t,h.Org.pqHandle=t.pq.insert(h.Org),f.getIntersectData(t,h.Org,c,u,l,_),f.regionAbove(e).dirty=e.dirty=a.dirty=!0,!1)},f.walkDirtyRegions=function(t,e){for(var i,s,n=f.regionBelow(e);;){for(;n.dirty;)e=n,n=f.regionBelow(n);if(!e.dirty&&(n=e,null===(e=f.regionAbove(e))||!e.dirty))return;if(e.dirty=!1,i=e.eUp,s=n.eUp,i.Dst!==s.Dst&&f.checkForLeftSplice(t,e)&&(n.fixUpperEdge?(f.deleteRegion(t,n),t.mesh.delete(s),s=(n=f.regionBelow(e)).eUp):e.fixUpperEdge&&(f.deleteRegion(t,e),t.mesh.delete(i),i=(e=f.regionAbove(n)).eUp)),i.Org!==s.Org)if(i.Dst===s.Dst||e.fixUpperEdge||n.fixUpperEdge||i.Dst!==t.event&&s.Dst!==t.event)f.checkForRightSplice(t,e);else if(f.checkForIntersect(t,e))return;i.Org===s.Org&&i.Dst===s.Dst&&(f.addWinding(s,i),f.deleteRegion(t,e),t.mesh.delete(i),e=f.regionAbove(n))}},f.connectRightVertex=function(t,e,i){var s,o=i.Onext,r=f.regionBelow(e),a=e.eUp,h=r.eUp,m=!1;a.Dst!==h.Dst&&f.checkForIntersect(t,e),n.vertEq(a.Org,t.event)&&(t.mesh.splice(o.Oprev,a),e=f.topLeftRegion(t,e),o=f.regionBelow(e).eUp,f.finishLeftRegions(t,f.regionBelow(e),r),m=!0),n.vertEq(h.Org,t.event)&&(t.mesh.splice(i,h.Oprev),i=f.finishLeftRegions(t,r,null),m=!0),m?f.addRightEdges(t,e,i.Onext,o,o,!0):(s=n.vertLeq(h.Org,a.Org)?h.Oprev:a,s=t.mesh.connect(i.Lprev,s),f.addRightEdges(t,e,s,s.Onext,s.Onext,!1),s.Sym.activeRegion.fixUpperEdge=!0,f.walkDirtyRegions(t,e))},f.connectLeftDegenerate=function(t,e,i){var s,r,a,h,m;return s=e.eUp,n.vertEq(s.Org,i)?(o(!1),void f.spliceMergeVertices(t,s,i.anEdge)):n.vertEq(s.Dst,i)?(o(!1),e=f.topRightRegion(e),r=h=(a=(m=f.regionBelow(e)).eUp.Sym).Onext,m.fixUpperEdge&&(o(r!==a),f.deleteRegion(t,m),t.mesh.delete(a),a=r.Oprev),t.mesh.splice(i.anEdge,a),n.edgeGoesLeft(r)||(r=null),void f.addRightEdges(t,e,a.Onext,h,r,!0)):(t.mesh.splitEdge(s.Sym),e.fixUpperEdge&&(t.mesh.delete(s.Onext),e.fixUpperEdge=!1),t.mesh.splice(i.anEdge,s),void f.sweepEvent(t,i))},f.connectLeftVertex=function(t,e){var i,s,o,r,a,h,m=new d;if(m.eUp=e.anEdge.Sym,i=t.dict.search(m).key,s=f.regionBelow(i))if(r=i.eUp,a=s.eUp,0!==n.edgeSign(r.Dst,e,r.Org))if(o=n.vertLeq(a.Dst,r.Dst)?i:s,i.inside||o.fixUpperEdge){if(o===i)h=t.mesh.connect(e.anEdge.Sym,r.Lnext);else h=t.mesh.connect(a.Dnext,e.anEdge).Sym;o.fixUpperEdge?f.fixUpperEdge(t,o,h):f.computeWinding(t,f.addRegionBelow(t,i,h)),f.sweepEvent(t,e)}else f.addRightEdges(t,i,e.anEdge,e.anEdge,null,!0);else f.connectLeftDegenerate(t,i,e)},f.sweepEvent=function(t,e){t.event=e,f.debugEvent(t);for(var i=e.anEdge;null===i.activeRegion;)if((i=i.Onext)===e.anEdge)return void f.connectLeftVertex(t,e);var s=f.topLeftRegion(t,i.activeRegion);o(null!==s);var n=f.regionBelow(s),r=n.eUp,a=f.finishLeftRegions(t,n,null);a.Onext===r?f.connectRightVertex(t,s,a):f.addRightEdges(t,s,a.Onext,r,r,!0)},f.addSentinel=function(t,e,i,s){var n=new d,o=t.mesh.makeEdge();o.Org.s=i,o.Org.t=s,o.Dst.s=e,o.Dst.t=s,t.event=o.Dst,n.eUp=o,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=t.dict.insert(n)},f.initEdgeDict=function(t){t.dict=new l(t,f.edgeLeq);var e=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],s=t.bmin[0]-e,n=t.bmax[0]+e,o=t.bmin[1]-i,r=t.bmax[1]+i;f.addSentinel(t,s,n,o),f.addSentinel(t,s,n,r)},f.doneEdgeDict=function(t){for(var e,i=0;null!==(e=t.dict.min().key);)e.sentinel||(o(e.fixUpperEdge),o(1==++i)),o(0===e.windingNumber),f.deleteRegion(t,e)},f.removeDegenerateEdges=function(t){var e,i,s,o=t.mesh.eHead;for(e=o.next;e!==o;e=i)i=e.next,s=e.Lnext,n.vertEq(e.Org,e.Dst)&&e.Lnext.Lnext!==e&&(f.spliceMergeVertices(t,s,e),t.mesh.delete(e),s=(e=s).Lnext),s.Lnext===e&&(s!==e&&(s!==i&&s!==i.Sym||(i=i.next),t.mesh.delete(s)),e!==i&&e!==i.Sym||(i=i.next),t.mesh.delete(e))},f.initPriorityQ=function(t){var e,i,s,o=0;for(i=(s=t.mesh.vHead).next;i!==s;i=i.next)o++;for(o+=8,e=t.pq=new p(o,n.vertLeq),i=(s=t.mesh.vHead).next;i!==s;i=i.next)i.pqHandle=e.insert(i);return i===s&&(e.init(),!0)},f.donePriorityQ=function(t){t.pq=null},f.removeDegenerateFaces=function(t,e){var i,s,n;for(i=e.fHead.next;i!==e.fHead;i=s)s=i.next,n=i.anEdge,o(n.Lnext!==n),n.Lnext.Lnext===n&&(f.addWinding(n.Onext,n),t.mesh.delete(n));return!0},f.computeInterior=function(t){var e,i;if(f.removeDegenerateEdges(t),!f.initPriorityQ(t))return!1;for(f.initEdgeDict(t);null!==(e=t.pq.extractMin());){for(;null!==(i=t.pq.min())&&n.vertEq(i,e);)i=t.pq.extractMin(),f.spliceMergeVertices(t,e.anEdge,i.anEdge);f.sweepEvent(t,e)}return t.event=t.dict.min().key.eUp.Org,f.debugEvent(t),f.doneEdgeDict(t),f.donePriorityQ(t),!!f.removeDegenerateFaces(t,t.mesh)&&(t.mesh.check(),!0)},y.prototype={dot_:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},normalize_:function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];o(e>0),e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},longAxis_:function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},computeNormal_:function(t){var e,i,s,n,o,r,a,h=[0,0,0],m=[0,0,0],c=[0,0,0],l=[0,0,0],u=[0,0,0],_=[null,null,null],p=[null,null,null],d=this.mesh.vHead;for(e=d.next,a=0;a<3;++a)n=e.coords[a],m[a]=n,p[a]=e,h[a]=n,_[a]=e;for(e=d.next;e!==d;e=e.next)for(a=0;a<3;++a)(n=e.coords[a])<m[a]&&(m[a]=n,p[a]=e),n>h[a]&&(h[a]=n,_[a]=e);if(a=0,h[1]-m[1]>h[0]-m[0]&&(a=1),h[2]-m[2]>h[a]-m[a]&&(a=2),m[a]>=h[a])return t[0]=0,t[1]=0,void(t[2]=1);for(r=0,i=p[a],s=_[a],c[0]=i.coords[0]-s.coords[0],c[1]=i.coords[1]-s.coords[1],c[2]=i.coords[2]-s.coords[2],e=d.next;e!==d;e=e.next)l[0]=e.coords[0]-s.coords[0],l[1]=e.coords[1]-s.coords[1],l[2]=e.coords[2]-s.coords[2],u[0]=c[1]*l[2]-c[2]*l[1],u[1]=c[2]*l[0]-c[0]*l[2],u[2]=c[0]*l[1]-c[1]*l[0],(o=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])>r&&(r=o,t[0]=u[0],t[1]=u[1],t[2]=u[2]);r<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(c)]=1)},checkOrientation_:function(){var t,e,i,s,n=this.mesh.fHead,o=this.mesh.vHead;for(t=0,e=n.next;e!==n;e=e.next)if(!((s=e.anEdge).winding<=0))do{t+=(s.Org.s-s.Dst.s)*(s.Org.t+s.Dst.t),s=s.Lnext}while(s!==e.anEdge);if(t<0){for(i=o.next;i!==o;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},projectPolygon_:function(){var t,e,i,s,n,o=this.mesh.vHead,r=[0,0,0],a=!1;for(r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],0===r[0]&&0===r[1]&&0===r[2]&&(this.computeNormal_(r),a=!0),e=this.sUnit,i=this.tUnit,e[s=this.longAxis_(r)]=0,e[(s+1)%3]=1,e[(s+2)%3]=0,i[s]=0,i[(s+1)%3]=0,i[(s+2)%3]=r[s]>0?1:-1,t=o.next;t!==o;t=t.next)t.s=this.dot_(t.coords,e),t.t=this.dot_(t.coords,i);for(a&&this.checkOrientation_(),n=!0,t=o.next;t!==o;t=t.next)n?(this.bmin[0]=this.bmax[0]=t.s,this.bmin[1]=this.bmax[1]=t.t,n=!1):(t.s<this.bmin[0]&&(this.bmin[0]=t.s),t.s>this.bmax[0]&&(this.bmax[0]=t.s),t.t<this.bmin[1]&&(this.bmin[1]=t.t),t.t>this.bmax[1]&&(this.bmax[1]=t.t))},addWinding_:function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},tessellateMonoRegion_:function(t,e){var i,s;for(i=e.anEdge,o(i.Lnext!==i&&i.Lnext.Lnext!==i);n.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;n.vertLeq(i.Org,i.Dst);i=i.Lnext);for(s=i.Lprev;i.Lnext!==s;)if(n.vertLeq(i.Dst,s.Org)){for(;s.Lnext!==i&&(n.edgeGoesLeft(s.Lnext)||n.edgeSign(s.Org,s.Dst,s.Lnext.Dst)<=0);){s=t.connect(s.Lnext,s).Sym}s=s.Lprev}else{for(;s.Lnext!==i&&(n.edgeGoesRight(i.Lprev)||n.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);){i=t.connect(i,i.Lprev).Sym}i=i.Lnext}for(o(s.Lnext!==i);s.Lnext.Lnext!==i;){s=t.connect(s.Lnext,s).Sym}return!0},tessellateInterior_:function(t){var e,i;for(e=t.fHead.next;e!==t.fHead;e=i)if(i=e.next,e.inside&&!this.tessellateMonoRegion_(t,e))return!1;return!0},discardExterior_:function(t){var e,i;for(e=t.fHead.next;e!==t.fHead;e=i)i=e.next,e.inside||t.zapFace(e)},setWindingNumber_:function(t,e,i){var s,n;for(s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?e:-e:i?t.delete(s):s.winding=0},getNeighbourFace_:function(t){return t.Rface&&t.Rface.inside?t.Rface.n:-1},outputPolymesh_:function(t,e,i,n){var r,a,h,m,c,l=0,u=0;for(i>3&&t.mergeConvexFaces(i),r=t.vHead.next;r!==t.vHead;r=r.next)r.n=-1;for(a=t.fHead.next;a!==t.fHead;a=a.next)if(a.n=-1,a.inside){h=a.anEdge,m=0;do{-1===(r=h.Org).n&&(r.n=u,u++),m++,h=h.Lnext}while(h!==a.anEdge);o(m<=i),a.n=l,++l}for(this.elementCount=l,e===s.CONNECTED_POLYGONS&&(l*=2),this.elements=[],this.elements.length=l*i,this.vertexCount=u,this.vertices=[],this.vertices.length=u*n,this.vertexIndices=[],this.vertexIndices.length=u,r=t.vHead.next;r!==t.vHead;r=r.next)if(-1!==r.n){var _=r.n*n;this.vertices[_+0]=r.coords[0],this.vertices[_+1]=r.coords[1],n>2&&(this.vertices[_+2]=r.coords[2]),this.vertexIndices[r.n]=r.idx}var p=0;for(a=t.fHead.next;a!==t.fHead;a=a.next)if(a.inside){h=a.anEdge,m=0;do{r=h.Org,this.elements[p++]=r.n,m++,h=h.Lnext}while(h!==a.anEdge);for(c=m;c<i;++c)this.elements[p++]=-1;if(e===s.CONNECTED_POLYGONS){h=a.anEdge;do{this.elements[p++]=this.getNeighbourFace_(h),h=h.Lnext}while(h!==a.anEdge);for(c=m;c<i;++c)this.elements[p++]=-1}}},outputContours_:function(t,e){var i,s,n,o=0,r=0;for(this.vertexCount=0,this.elementCount=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){n=s=i.anEdge;do{this.vertexCount++,s=s.Lnext}while(s!==n);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*e,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var a=0,h=0,m=0;for(o=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){r=0,n=s=i.anEdge;do{this.vertices[a++]=s.Org.coords[0],this.vertices[a++]=s.Org.coords[1],e>2&&(this.vertices[a++]=s.Org.coords[2]),this.vertexIndices[h++]=s.Org.idx,r++,s=s.Lnext}while(s!==n);this.elements[m++]=o,this.elements[m++]=r,o+=r}},addContour:function(t,e){var i,s;for(null===this.mesh&&(this.mesh=new m),t<2&&(t=2),t>3&&(t=3),i=null,s=0;s<e.length;s+=t)null===i?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=e[s+0],i.Org.coords[1]=e[s+1],i.Org.coords[2]=t>2?e[s+2]:0,i.Org.idx=this.vertexIndexCounter++,i.winding=1,i.Sym.winding=-1},tesselate:function(t,e,i,n,o){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,o&&(this.normal[0]=o[0],this.normal[1]=o[1],this.normal[2]=o[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),f.computeInterior(this);var r=this.mesh;return e===s.BOUNDARY_CONTOURS?this.setWindingNumber_(r,1,!0):this.tessellateInterior_(r),r.check(),e===s.BOUNDARY_CONTOURS?this.outputContours_(r,n):this.outputPolymesh_(r,e,i,n),!0}}},function(t,e,i){t.exports=d;i(2);var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=i(8),m=i(9),c=i(11),l=i(4),u=(i(10),i(3),i(12),i(13),i(15)),_=0;d.TYPE="revolute-joint",d._super=u,d.prototype=n(d._super.prototype);var p={lowerAngle:0,upperAngle:359*r.PI/180,maxMotorTorque:1e4,motorSpeed:0,enableLimit:!1,enableMotor:!1,active:!0};function d(t,e,i,n){if(!(this instanceof d))return new d(t,e,i,n);t=s(t,p),u.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_impulse=h(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new c,this.m_motorMass,this.m_limitState=_}d.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},d.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},d.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},d.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},d.prototype.getReferenceAngle=function(){return this.m_referenceAngle},d.prototype.getJointAngle=function(){var t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},d.prototype.getJointSpeed=function(){var t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},d.prototype.isMotorEnabled=function(){return this.m_enableMotor},d.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},d.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},d.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},d.prototype.getMotorSpeed=function(){return this.m_motorSpeed},d.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},d.prototype.isLimitEnabled=function(){return this.m_enableLimit},d.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},d.prototype.getLowerLimit=function(){return this.m_lowerAngle},d.prototype.getUpperLimit=function(){return this.m_upperAngle},d.prototype.setLimits=function(t,e){t==this.m_lowerAngle&&e==this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t,e){return e?e.set(this.m_impulse.x,this.m_impulse.y).mul(t):a.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},d.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},d.prototype.setBodyA=function(t){d._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},d.prototype.setBodyB=function(t){d._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,h=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,c=l.neo(e),u=l.neo(n);this.m_rA=l.mulVec2(c,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=l.mulVec2(u,a.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=f+y===0;if(this.m_mass.ex.x=p+d+this.m_rA.y*this.m_rA.y*f+this.m_rB.y*this.m_rB.y*y,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*f-this.m_rB.y*this.m_rB.x*y,this.m_mass.ez.x=-this.m_rA.y*f-this.m_rB.y*y,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=p+d+this.m_rA.x*this.m_rA.x*f+this.m_rB.x*this.m_rB.x*y,this.m_mass.ez.y=this.m_rA.x*f+this.m_rB.x*y,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=f+y,this.m_motorMass=f+y,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||v)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==v){var g=n-e-this.m_referenceAngle;r.abs(this.m_upperAngle-this.m_lowerAngle)<2*o.angularSlop?this.m_limitState=3:g<=this.m_lowerAngle?(1!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):g>=this.m_upperAngle?(2!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=_,this.m_impulse.z=0)}else this.m_limitState=_;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var x=a.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(p,x),s-=f*(a.cross(this.m_rA,x)+this.m_motorImpulse+this.m_impulse.z),h.addMul(d,x),m+=y*(a.cross(this.m_rB,x)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=h,this.m_bodyB.c_velocity.w=m},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=this.m_invMassA,m=this.m_invMassB,c=this.m_invIA,l=this.m_invIB,u=c+l===0;if(this.m_enableMotor&&3!=this.m_limitState&&0==u){var p=n-i-this.m_motorSpeed,d=-this.m_motorMass*p,f=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+d,-y,y),i-=c*(d=this.m_motorImpulse-f),n+=l*d}if(this.m_enableLimit&&this.m_limitState!=_&&0==u){var v=a.zero();v.addCombine(1,s,1,a.cross(n,this.m_rB)),v.subCombine(1,e,1,a.cross(i,this.m_rA));var g=n-i;p=h(v.x,v.y,g),d=h.neg(this.m_mass.solve33(p));if(3==this.m_limitState)this.m_impulse.add(d);else if(1==this.m_limitState){if(this.m_impulse.z+d.z<0){var x=a.combine(-1,v,this.m_impulse.z,a.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(x);d.x=b.x,d.y=b.y,d.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.add(d)}else if(2==this.m_limitState){if(this.m_impulse.z+d.z>0){x=a.combine(-1,v,this.m_impulse.z,a.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(x);d.x=b.x,d.y=b.y,d.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.add(d)}var A=a.neo(d.x,d.y);e.subMul(o,A),i-=c*(a.cross(this.m_rA,A)+d.z),s.addMul(m,A),n+=l*(a.cross(this.m_rB,A)+d.z)}else{(p=a.zero()).addCombine(1,s,1,a.cross(n,this.m_rB)),p.subCombine(1,e,1,a.cross(i,this.m_rA));d=this.m_mass.solve22(a.neg(p));this.m_impulse.x+=d.x,this.m_impulse.y+=d.y,e.subMul(o,d),i-=c*a.cross(this.m_rA,d),s.addMul(m,d),n+=l*a.cross(this.m_rB,d)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},d.prototype.solvePositionConstraints=function(t){var e,i=this.m_bodyA.c_position.c,s=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=l.neo(s),u=l.neo(h),p=0,d=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=_&&0==d){var f=h-s-this.m_referenceAngle,y=0;if(3==this.m_limitState){var v=r.clamp(f-this.m_lowerAngle,-o.maxAngularCorrection,o.maxAngularCorrection);y=-this.m_motorMass*v,p=r.abs(v)}else if(1==this.m_limitState){p=-(v=f-this.m_lowerAngle),v=r.clamp(v+o.angularSlop,-o.maxAngularCorrection,0),y=-this.m_motorMass*v}else if(2==this.m_limitState){p=v=f-this.m_upperAngle,v=r.clamp(v-o.angularSlop,0,o.maxAngularCorrection),y=-this.m_motorMass*v}s-=this.m_invIA*y,h+=this.m_invIB*y}c.set(s),u.set(h);var g=l.mulVec2(c,a.sub(this.m_localAnchorA,this.m_localCenterA)),x=l.mulVec2(u,a.sub(this.m_localAnchorB,this.m_localCenterB));(v=a.zero()).addCombine(1,n,1,x),v.subCombine(1,i,1,g),e=v.length();var b=this.m_invMassA,A=this.m_invMassB,w=this.m_invIA,B=this.m_invIB,M=new m;M.ex.x=b+A+w*g.y*g.y+B*x.y*x.y,M.ex.y=-w*g.x*g.y-B*x.x*x.y,M.ey.x=M.ex.y,M.ey.y=b+A+w*g.x*g.x+B*x.x*x.x;var C=a.neg(M.solve(v));return i.subMul(b,C),s-=w*a.cross(g,C),n.addMul(A,C),h+=B*a.cross(x,C),this.m_bodyA.c_position.c.set(i),this.m_bodyA.c_position.a=s,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=h,e<=o.linearSlop&&p<=o.angularSlop}},function(t,e,i){t.exports=d;i(2);var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=i(8),m=i(9),c=i(11),l=i(4),u=(i(10),i(3),i(12),i(13),i(15)),_=0;d.TYPE="prismatic-joint",d._super=u,d.prototype=n(d._super.prototype);var p={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:1e4,motorSpeed:0,active:!0};function d(t,e,i,n,o){if(!(this instanceof d))return new d(t,e,i,n,o);t=s(t,p),u.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.zero(),this.m_localXAxisA=o?e.getLocalVector(o):t.localAxisA||a.neo(1,0),this.m_localXAxisA.normalize(),this.m_localYAxisA=a.cross(1,this.m_localXAxisA),this.m_referenceAngle=r.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=h(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=_,this.m_axis=a.zero(),this.m_perp=a.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new c,this.m_motorMass}d.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},d.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},d.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},d.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},d.prototype.getLocalAxisA=function(){return this.m_localXAxisA},d.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localXAxisA.set(t),this.m_localYAxisA.set(-t.y,t.x)},d.prototype.getReferenceAngle=function(){return this.m_referenceAngle},d.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},d.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=a.sub(e,t),s=this.m_bodyA.getWorldVector(this.m_localXAxisA);return a.dot(i,s)},d.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,i=l.mulVec2(t.m_xf.q,a.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=l.mulVec2(e.m_xf.q,a.sub(this.m_localAnchorB,e.m_sweep.localCenter)),n=a.add(t.m_sweep.c,i),o=a.add(e.m_sweep.c,s),r=a.sub(o,n),h=l.mulVec2(t.m_xf.q,this.m_localXAxisA),m=t.m_linearVelocity,c=e.m_linearVelocity,u=t.m_angularVelocity,_=e.m_angularVelocity;return a.dot(r,a.cross(u,h))+a.dot(h,a.sub(a.addCross(c,_,s),a.addCross(m,u,i)))},d.prototype.isLimitEnabled=function(){return this.m_enableLimit},d.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},d.prototype.getLowerLimit=function(){return this.m_lowerTranslation},d.prototype.getUpperLimit=function(){return this.m_upperTranslation},d.prototype.setLimits=function(t,e){t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},d.prototype.isMotorEnabled=function(){return this.m_enableMotor},d.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},d.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},d.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},d.prototype.getMotorSpeed=function(){return this.m_motorSpeed},d.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t,e){return(e=e||a.zero()).setCombine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},d.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},d.prototype.getLimitState=function(){return this.m_limitState},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,h=this.m_bodyB.c_position.c,m=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,p=l.neo(i),d=l.neo(m),f=l.mulVec2(p,a.sub(this.m_localAnchorA,this.m_localCenterA)),y=l.mulVec2(d,a.sub(this.m_localAnchorB,this.m_localCenterB)),v=a.zero();v.addCombine(1,h,1,y),v.subCombine(1,e,1,f);var g=this.m_invMassA,x=this.m_invMassB,b=this.m_invIA,A=this.m_invIB;this.m_axis=l.mulVec2(p,this.m_localXAxisA),this.m_a1=a.cross(a.add(v,f),this.m_axis),this.m_a2=a.cross(y,this.m_axis),this.m_motorMass=g+x+b*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=l.mulVec2(p,this.m_localYAxisA),this.m_s1=a.cross(a.add(v,f),this.m_perp),this.m_s2=a.cross(y,this.m_perp);a.cross(f,this.m_perp);var w=g+x+b*this.m_s1*this.m_s1+A*this.m_s2*this.m_s2,B=b*this.m_s1+A*this.m_s2,M=b*this.m_s1*this.m_a1+A*this.m_s2*this.m_a2,C=b+A;0==C&&(C=1);var z=b*this.m_a1+A*this.m_a2,I=g+x+b*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2;if(this.m_K.ex.set(w,B,M),this.m_K.ey.set(B,C,z),this.m_K.ez.set(M,z,I),this.m_enableLimit){var S=a.dot(this.m_axis,v);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*o.linearSlop?this.m_limitState=3:S<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):S>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=_,this.m_impulse.z=0)}else this.m_limitState=_,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var L=a.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),P=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,k=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;s.subMul(g,L),n-=b*P,c.addMul(x,L),u+=A*k}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=this.m_invMassA,m=this.m_invMassB,c=this.m_invIA,l=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){var u=a.dot(this.m_axis,a.sub(s,e))+this.m_a2*n-this.m_a1*i,p=this.m_motorMass*(this.m_motorSpeed-u),d=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=r.clamp(this.m_motorImpulse+p,-f,f),p=this.m_motorImpulse-d;var y=a.mul(p,this.m_axis),v=p*this.m_a1,g=p*this.m_a2;e.subMul(o,y),i-=c*v,s.addMul(m,y),n+=l*g}var x=a.zero();if(x.x+=a.dot(this.m_perp,s)+this.m_s2*n,x.x-=a.dot(this.m_perp,e)+this.m_s1*i,x.y=n-i,this.m_enableLimit&&this.m_limitState!=_){var b=0;b+=a.dot(this.m_axis,s)+this.m_a2*n,b-=a.dot(this.m_axis,e)+this.m_a1*i;u=h(x.x,x.y,b);var A=h(this.m_impulse),w=this.m_K.solve33(h.neg(u));this.m_impulse.add(w),1==this.m_limitState?this.m_impulse.z=r.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=r.min(this.m_impulse.z,0));var B=a.combine(-1,x,-(this.m_impulse.z-A.z),a.neo(this.m_K.ez.x,this.m_K.ez.y)),M=a.add(this.m_K.solve22(B),a.neo(A.x,A.y));this.m_impulse.x=M.x,this.m_impulse.y=M.y,w=h.sub(this.m_impulse,A);y=a.combine(w.x,this.m_perp,w.z,this.m_axis),v=w.x*this.m_s1+w.y+w.z*this.m_a1,g=w.x*this.m_s2+w.y+w.z*this.m_a2;e.subMul(o,y),i-=c*v,s.addMul(m,y),n+=l*g}else{w=this.m_K.solve22(a.neg(x));this.m_impulse.x+=w.x,this.m_impulse.y+=w.y;y=a.mul(w.x,this.m_perp),v=w.x*this.m_s1+w.y,g=w.x*this.m_s2+w.y;e.subMul(o,y),i-=c*v,s.addMul(m,y),n+=l*g}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},d.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,u=l.neo(i),_=l.neo(n),p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=l.mulVec2(u,a.sub(this.m_localAnchorA,this.m_localCenterA)),g=l.mulVec2(_,a.sub(this.m_localAnchorB,this.m_localCenterB)),x=a.sub(a.add(s,g),a.add(e,v)),b=l.mulVec2(u,this.m_localXAxisA),A=a.cross(a.add(x,v),b),w=a.cross(g,b),B=l.mulVec2(u,this.m_localYAxisA),M=a.cross(a.add(x,v),B),C=a.cross(g,B),z=h(),I=a.zero();I.x=a.dot(B,x),I.y=n-i-this.m_referenceAngle;var S=r.abs(I.x),L=r.abs(I.y),P=o.linearSlop,k=o.maxLinearCorrection,V=!1,O=0;if(this.m_enableLimit){var T=a.dot(b,x);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P?(O=r.clamp(T,-k,k),S=r.max(S,r.abs(T)),V=!0):T<=this.m_lowerTranslation?(O=r.clamp(T-this.m_lowerTranslation+P,-k,0),S=r.max(S,this.m_lowerTranslation-T),V=!0):T>=this.m_upperTranslation&&(O=r.clamp(T-this.m_upperTranslation-P,0,k),S=r.max(S,T-this.m_upperTranslation),V=!0)}if(V){var E=p+d+f*M*M+y*C*C,F=f*M+y*C,q=f*M*A+y*C*w;0==(N=f+y)&&(N=1);var D=f*A+y*w,R=p+d+f*A*A+y*w*w;(J=new c).ex.set(E,F,q),J.ey.set(F,N,D),J.ez.set(q,D,R);var j=h();j.x=I.x,j.y=I.y,j.z=O,z=J.solve33(h.neg(j))}else{var N,J;E=p+d+f*M*M+y*C*C,F=f*M+y*C;0==(N=f+y)&&(N=1),(J=new m).ex.set(E,F),J.ey.set(F,N);var H=J.solve(a.neg(I));z.x=H.x,z.y=H.y,z.z=0}var U=a.combine(z.x,B,z.z,b),Y=z.x*M+z.y+z.z*A,W=z.x*C+z.y+z.z*w;return e.subMul(p,U),i-=f*Y,s.addMul(d,U),n+=y*W,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=n,S<=o.linearSlop&&L<=o.angularSlop}},,,,function(t,e,i){e.internal={},e.Math=i(1),e.Vec2=i(0),e.Vec3=i(8),e.Mat22=i(9),e.Mat33=i(11),e.Transform=i(3),e.Rot=i(4),e.AABB=i(14),e.Shape=i(16),e.Fixture=i(33),e.Body=i(30),e.Contact=i(17),e.Joint=i(15),e.World=i(34),e.Circle=i(22),e.Edge=i(23),e.Capsule=i(25),e.Polygon=i(19),i(38),e.CompositePolygon=i(26),e.Chain=i(24),e.Box=i(37),i(49),i(50),e.internal.CollidePolygons=i(51),i(52),i(53),e.DistanceJoint=i(54),e.FrictionJoint=i(55),e.GearJoint=i(56),e.MotorJoint=i(57),e.MouseJoint=i(58),e.PrismaticJoint=i(40),e.PulleyJoint=i(59),e.RevoluteJoint=i(39),e.RopeJoint=i(60),e.WeldJoint=i(61),e.WheelJoint=i(62),e.internal.Sweep=i(10),e.internal.stats=i(29),e.internal.Manifold=i(18),e.internal.Distance=i(21),e.internal.TimeOfImpact=i(31),e.internal.ShapeCaster=i(36),e.internal.DynamicTree=i(35),e.internal.Settings=i(5)},function(t,e,i){i(5),i(2);var s=i(1),n=i(14),o=i(35);function r(){this.m_tree=new o,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=r,r.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},r.prototype.testOverlap=function(t,e){var i=this.m_tree.getFatAABB(t),s=this.m_tree.getFatAABB(e);return n.testOverlap(i,s)},r.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},r.prototype.getProxyCount=function(){return this.m_proxyCount},r.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},r.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},r.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},r.prototype.query=function(t,e){this.m_tree.query(t,e)},r.prototype.rayCast=function(t,e,i,s,n){this.m_tree.rayCast(t,e,i,s,n)},r.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},r.prototype.createProxy=function(t,e){var i=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(i),i},r.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},r.prototype.moveProxy=function(t,e,i){this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},r.prototype.touchProxy=function(t){this.bufferMove(t)},r.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},r.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},r.prototype.updatePairs=function(t){for(this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),null!==this.m_queryProxyId){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}},r.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;var e=s.min(t,this.m_queryProxyId),i=s.max(t,this.m_queryProxyId),n=this.m_tree.getUserData(e),o=this.m_tree.getUserData(i);return this.m_callback(n,o),!0}},function(t,e,i){t.exports=function(t){var e=[],i=t.max||1/0,s=t.create,n=t.allocate,o=t.release,r=t.discard,a=0,h=0,m=0,c=0;this.max=function(t){return"number"==typeof t?(i=t,this):i},this.size=function(){return e.length},this.allocate=function(){var t;return e.length>0?t=e.shift():(a++,t="function"==typeof s?s():{}),h++,"function"==typeof n&&n(t),t},this.release=function(t){e.length<i?(m++,"function"==typeof o&&o(t),e.push(t)):(c++,"function"==typeof r&&(t=r(t)))},this.toString=function(){return" +"+a+" >"+h+" <"+m+" -"+c+" ="+e.length+"/"+i}}},function(t,e,i){t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},function(t,e,i){t.exports=u,t.exports.TimeStep=l;var s=i(5),n=i(2),o=i(0),r=i(1),a=(i(30),i(17),i(15),i(31)),h=a.Input,m=a.Output,c=i(21);c.Input,c.Output,c.Proxy,c.Cache;function l(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function u(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}l.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},u.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},u.prototype.addBody=function(t){this.m_bodies.push(t)},u.prototype.addContact=function(t){this.m_contacts.push(t)},u.prototype.addJoint=function(t){this.m_joints.push(t)},u.prototype.solveWorld=function(t){for(var e=this.m_world,i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1;for(var s=e.m_contactList;s;s=s.m_next)s.m_islandFlag=!1;for(var n=e.m_jointList;n;n=n.m_next)n.m_islandFlag=!1;for(var o=this.m_stack,r=e.m_bodyList;r;r=r.m_next)if(!r.m_islandFlag&&0!=r.isAwake()&&0!=r.isActive()&&!r.isStatic()){for(this.clear(),o.push(r),r.m_islandFlag=!0;o.length>0;){i=o.pop();if(this.addBody(i),i.setAwake(!0),!i.isStatic()){for(var a=i.m_contactList;a;a=a.next){var h=a.contact;if(!h.m_islandFlag&&(0!=h.isEnabled()&&0!=h.isTouching())){var m=h.m_fixtureA,c=h.m_fixtureB;if(m.isActive()&&c.isActive()){var l=m.m_isSensor,u=c.m_isSensor;if(!l&&!u)this.addContact(h),h.m_islandFlag=!0,(p=a.other).m_islandFlag||(o.push(p),p.m_islandFlag=!0)}}}for(var _=i.m_jointList;_;_=_.next){var p;if(1!=_.joint.m_islandFlag&&0!=_.joint.m_activeFlag)0!=(p=_.other).isActive()&&(this.addJoint(_.joint),_.joint.m_islandFlag=!0,p.m_islandFlag||(o.push(p),p.m_islandFlag=!0))}}}this.solveIsland(t);for(var d=0;d<this.m_bodies.length;++d){(i=this.m_bodies[d]).isStatic()&&(i.m_islandFlag=!1)}}},u.prototype.solveIsland=function(t){for(var e=this.m_world,i=e.m_gravity,n=e.m_allowSleep,a=t.dt,h=0;h<this.m_bodies.length;++h){var m=this.m_bodies[h],c=o.clone(m.m_sweep.c),l=m.m_sweep.a,u=o.clone(m.m_linearVelocity),_=m.m_angularVelocity;m.m_sweep.c1.set(m.m_sweep.c),m.m_sweep.c0.set(m.m_sweep.c),m.m_sweep.a0=m.m_sweep.a,m.isDynamic()&&(u.addMul(a*m.m_gravityScale,i),u.addMul(a*m.m_invMass,m.m_force),_+=a*m.m_invI*m.m_torque,u.mul(1/(1+a*m.m_linearDamping)),_*=1/(1+a*m.m_angularDamping)),m.c_position.c=c,m.c_position.a=l,m.c_velocity.v=u,m.c_velocity.w=_}for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].initConstraint(t)}for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].initVelocityConstraint(t)}if(t.warmStarting)for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].warmStartConstraint(t)}for(h=0;h<this.m_joints.length;++h){this.m_joints[h].initVelocityConstraints(t)}for(h=0;h<t.velocityIterations;++h){for(var p=0;p<this.m_joints.length;++p){this.m_joints[p].solveVelocityConstraints(t)}for(p=0;p<this.m_contacts.length;++p){this.m_contacts[p].solveVelocityConstraint(t)}}for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].storeConstraintImpulses(t)}for(h=0;h<this.m_bodies.length;++h){m=this.m_bodies[h],c=o.clone(m.c_position.c),l=m.c_position.a,u=o.clone(m.c_velocity.v),_=m.c_velocity.w;var d=o.mul(a,u);if(o.lengthSquared(d)>s.maxTranslationSquared){var f=s.maxTranslation/d.length();u.mul(f)}var y=a*_;if(y*y>s.maxRotationSquared)_*=f=s.maxRotation/r.abs(y);c.addMul(a,u),l+=a*_,m.c_position.c.set(c),m.c_position.a=l,m.c_velocity.v.set(u),m.c_velocity.w=_}var v=!1;for(h=0;h<t.positionIterations;++h){var g=0;for(p=0;p<this.m_contacts.length;++p){var x=this.m_contacts[p].solvePositionConstraint(t);g=r.min(g,x)}var b=g>=-3*s.linearSlop,A=!0;for(p=0;p<this.m_joints.length;++p){var w=this.m_joints[p].solvePositionConstraints(t);A=A&&w}if(b&&A){v=!0;break}}for(h=0;h<this.m_bodies.length;++h){var B=(m=this.m_bodies[h]).c_position.c,M=m.m_sweep.c,C=m.m_sweep.c0,z=m.m_sweep.c1,I=m.c_velocity.v,S=m.m_linearVelocity;m.m_fixedXFlag?(C.x=M.x=z.x,S.x=0):(M.x=B.x,S.x=I.x),m.m_fixedYFlag?(C.y=M.y=z.y,S.y=0):(M.y=B.y,S.y=I.y),m.m_sweep.a=m.c_position.a,m.m_angularVelocity=m.c_velocity.w,m.synchronizeTransform()}if(this.postSolveIsland(),n){var L=1/0,P=s.linearSleepToleranceSqr,k=s.angularSleepToleranceSqr;for(h=0;h<this.m_bodies.length;++h){(m=this.m_bodies[h]).isStatic()||(0==m.m_autoSleepFlag||m.m_angularVelocity*m.m_angularVelocity>k||o.lengthSquared(m.m_linearVelocity)>P?(m.m_sleepTime=0,L=0):(m.m_sleepTime+=a,L=r.min(L,m.m_sleepTime)))}if(L>=s.timeToSleep&&v)for(h=0;h<this.m_bodies.length;++h){(m=this.m_bodies[h]).setAwake(!1)}}},u.prototype.printBodies=function(t){for(var e=0;e<this.m_bodies.length;++e){var i=this.m_bodies[e];n.debug(t,i.c_position.a,i.c_position.c.x,i.c_position.c.y,i.c_velocity.w,i.c_velocity.v.x,i.c_velocity.v.y)}};var _=new l;function p(){this.normalImpulses=[],this.tangentImpulses=[]}u.prototype.solveWorldTOI=function(t){var e=this.m_world;if(e.m_stepComplete){for(var i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1,i.m_sweep.alpha0=0;for(var n=e.m_contactList;n;n=n.m_next)n.m_toiFlag=!1,n.m_islandFlag=!1,n.m_toiCount=0,n.m_toi=1}for(;;){for(var o=null,c=1,n=e.m_contactList;n;n=n.m_next)if(0!=n.isEnabled()&&!(n.m_toiCount>s.maxSubSteps)){var l=1;if(n.m_toiFlag)l=n.m_toi;else{var u=n.getFixtureA(),p=n.getFixtureB();if(!u.isActive()||!p.isActive())continue;if(u.isSensor()||p.isSensor())continue;var d=u.getBody(),f=p.getBody(),y=d.isAwake()&&!d.isStatic(),v=f.isAwake()&&!f.isStatic();if(0==y&&0==v)continue;var g=d.isBullet()||!d.isDynamic()||d.m_fixedXFlag||d.m_fixedYFlag,x=f.isBullet()||!f.isDynamic()||f.m_fixedXFlag||f.m_fixedYFlag;if(0==g&&0==x)continue;var b=d.m_sweep.alpha0;d.m_sweep.alpha0<f.m_sweep.alpha0?(b=f.m_sweep.alpha0,d.m_sweep.advance(b)):f.m_sweep.alpha0<d.m_sweep.alpha0&&(b=d.m_sweep.alpha0,f.m_sweep.advance(b));var A=n.getChildIndexA(),w=n.getChildIndexB(),B=(d.m_sweep,f.m_sweep,new h);B.proxyA.set(u.getShape(),A),B.proxyB.set(p.getShape(),w),B.sweepA.set(d.m_sweep),B.sweepB.set(f.m_sweep),B.tMax=1;var M=new m;a(M,B);var C=M.t;l=M.state==m.e_touching?r.min(b+(1-b)*C,1):1,n.m_toi=l,n.m_toiFlag=!0}l<c&&(o=n,c=l)}if(null==o||1-10*r.EPSILON<c){e.m_stepComplete=!0;break}u=o.getFixtureA(),p=o.getFixtureB(),d=u.getBody(),f=p.getBody();var z=d.m_sweep.clone(),I=f.m_sweep.clone();if(d.advance(c),f.advance(c),o.update(e),o.m_toiFlag=!1,++o.m_toiCount,0!=o.isEnabled()&&0!=o.isTouching()){d.setAwake(!0),f.setAwake(!0),this.clear(),this.addBody(d),this.addBody(f),this.addContact(o),d.m_islandFlag=!0,f.m_islandFlag=!0,o.m_islandFlag=!0;for(var S=[d,f],L=0;L<S.length;++L){if((F=S[L]).isDynamic())for(var P=F.m_contactList;P;P=P.next){var k=P.contact;if(!k.m_islandFlag){var V=P.other;if(!V.isDynamic()||F.isBullet()||V.isBullet()){var O=k.m_fixtureA.m_isSensor,T=k.m_fixtureB.m_isSensor;if(!O&&!T){var E=V.m_sweep.clone();0==V.m_islandFlag&&V.advance(c),k.update(e),0!=k.isEnabled()&&0!=k.isTouching()?(k.m_islandFlag=!0,this.addContact(k),V.m_islandFlag||(V.m_islandFlag=!0,V.isStatic()||V.setAwake(!0),this.addBody(V))):(V.m_sweep.set(E),V.synchronizeTransform())}}}}}_.reset((1-c)*t.dt),_.dtRatio=1,_.positionIterations=20,_.velocityIterations=t.velocityIterations,_.warmStarting=!1,this.solveIslandTOI(_,d,f);for(L=0;L<this.m_bodies.length;++L){var F;if((F=this.m_bodies[L]).m_islandFlag=!1,F.isDynamic()){F.synchronizeFixtures();for(P=F.m_contactList;P;P=P.next)P.contact.m_toiFlag=!1,P.contact.m_islandFlag=!1}}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}else o.setEnabled(!1),d.m_sweep.set(z),f.m_sweep.set(I),d.synchronizeTransform(),f.synchronizeTransform()}},u.prototype.solveIslandTOI=function(t,e,i){this.m_world;for(var n=0;n<this.m_bodies.length;++n){(l=this.m_bodies[n]).c_position.c.set(l.m_sweep.c),l.c_position.a=l.m_sweep.a,l.c_velocity.v.set(l.m_linearVelocity),l.c_velocity.w=l.m_angularVelocity}for(var n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initConstraint(t)}for(n=0;n<t.positionIterations;++n){for(var a=0,h=0;h<this.m_contacts.length;++h){var m=this.m_contacts[h].solvePositionConstraintTOI(t,e,i);a=r.min(a,m)}if(a>=-1.5*s.linearSlop)break}e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,i.m_sweep.c0.set(i.c_position.c),i.m_sweep.a0=i.c_position.a;for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initVelocityConstraint(t)}for(n=0;n<t.velocityIterations;++n)for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].solveVelocityConstraint(t)}var c=t.dt;for(n=0;n<this.m_bodies.length;++n){var l=this.m_bodies[n],u=o.clone(l.c_position.c),_=l.c_position.a,p=o.clone(l.c_velocity.v),d=l.c_velocity.w,f=o.mul(c,p);if(o.dot(f,f)>s.maxTranslationSquared){var y=s.maxTranslation/f.length();p.mul(y)}var v=c*d;if(v*v>s.maxRotationSquared)d*=y=s.maxRotation/r.abs(v);u.addMul(c,p),_+=c*d,l.c_position.c=u,l.c_position.a=_,l.c_velocity.v=p,l.c_velocity.w=d,l.m_sweep.c=u,l.m_linearVelocity=p,l.m_fixedXFlag&&(l.m_sweep.c0.x=l.m_sweep.c.x=l.m_sweep.c1.x,l.m_linearVelocity.x=0),l.m_fixedYFlag&&(l.m_sweep.c0.y=l.m_sweep.c.y=l.m_sweep.c1.y,l.m_linearVelocity.y=0),l.m_sweep.a=_,l.m_angularVelocity=d,l.synchronizeTransform()}this.postSolveIsland()},u.prototype.postSolveIsland=function(){for(var t=new p,e=0;e<this.m_contacts.length;++e){for(var i=this.m_contacts[e],s=0;s<i.v_points.length;++s)t.normalImpulses.push(i.v_points[s].normalImpulse),t.tangentImpulses.push(i.v_points[s].tangentImpulse);this.m_world.postSolve(i,t)}}},function(t,e,i){var s=!1,n=i(2),o=(i(6),i(1),i(3)),r=i(0),a=(i(5),i(16),i(17)),h=i(18),m=i(22),c=new r,l=new r;function u(t,e,i,s,n){t.pointCount=0,c=o.mulVec2(i,e.m_p,c),l=o.mulVec2(n,s.m_p,l);var a=r.distanceSquared(l,c),m=e.m_radius+s.m_radius;a>m*m||(t.type=h.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(s.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex)}a.addType(m.TYPE,m.TYPE,(function(t,e,i,o,r,a,h){s&&n.assert(i.getType()==m.TYPE),s&&n.assert(a.getType()==m.TYPE),u(t,i.getShape(),e,a.getShape(),r)})),e.CollideCircles=u},function(t,e,i){var s,n=!1,o=i(2),r=(i(6),i(1),i(3)),a=i(0),h=(i(4),i(5),i(16),i(17)),m=i(18),c=i(23),l=i(24),u=i(22),_=i(25),p=new a,d=new a,f=new a;function y(t,e,i,s,r,a,h){n&&o.assert(i.getType()==c.TYPE),n&&o.assert(a.getType()==u.TYPE);var m=i.getShape(),l=a.getShape();v(t,m,e,l.m_p,l.m_radius,r)}function v(t,e,i,s,h,c){t.pointCount=0,p=r.mulTVec2(i,r.mulVec2(c,s,p),p);var l=e.m_vertex1,u=e.m_vertex2;d=d.set(u).sub(l);var _=a.dot(d,f.set(p).sub(l)),y=e.m_radius+h;if(_<=0){var v=l;if(f=f.set(p).sub(v),a.dot(f,f)>y*y)return;if(e.m_hasVertex0){var g=e.m_vertex0,x=l,b=d.set(x).sub(g);if(a.dot(b,f.set(x).sub(p))>0)return}return t.type=m.e_circles,t.localNormal.setZero(),t.localPoint.set(v),t.pointCount=1,t.points[0].localPoint.set(s),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=m.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=m.e_vertex)}var A=a.dot(d,a.sub(u,p));if(A<=0){v=u;if(f=f.set(p).sub(v),a.dot(f,f)>y*y)return;if(e.m_hasVertex3){var w=e.m_vertex3,B=u,M=d.set(w).sub(B);if(a.dot(M,f.set(p).sub(B))>0)return}return t.type=m.e_circles,t.localNormal.setZero(),t.localPoint.set(v),t.pointCount=1,t.points[0].localPoint.set(s),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=m.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=m.e_vertex)}var C=a.dot(d,d);n&&o.assert(C>0);v=f.setCombine(A/C,l,_/C,u);if(f=f.set(-v.x,-v.y).add(p),!(a.dot(f,f)>y*y)){var z=d.set(-d.y,d.x);a.dot(z,f.set(p).sub(l))<0&&z.set(-z.x,-z.y),z.normalize(),t.type=m.e_faceA,t.localNormal.set(z),t.localPoint.set(l),t.pointCount=1,t.points[0].localPoint.set(s),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=m.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=m.e_vertex}}h.addType(c.TYPE,u.TYPE,y),h.addType(l.TYPE,u.TYPE,(function(t,e,i,r,a,h,m){n&&o.assert(i.getType()==l.TYPE),n&&o.assert(h.getType()==u.TYPE);var _=i.getShape();s=s||new c,_.getChildEdge(s,r);var p=s,d=h.getShape();v(t,p,e,d.m_p,d.m_radius,a)})),h.addType(_.TYPE,u.TYPE,y)},function(t,e,i){var s=!1,n=i(2),o=(i(1),i(3)),r=i(4),a=i(0),h=(i(14),i(5)),m=i(18),c=i(17),l=(i(16),i(19)),u=i(26);function _(t,e,i,s){for(var n=t.m_count,h=i.m_count,m=t.m_normals,c=t.m_vertices,l=i.m_vertices,u=o.mulTXf(s,e),p=0,d=-1/0,f=0;f<n;++f){for(var y=r.mulVec2(u.q,m[f]),v=o.mulVec2(u,c[f]),g=a.dot(y,v),x=1/0,b=0;b<h;++b){var A=a.dot(y,l[b])-g;A<x&&(x=A)}x>d&&(d=x,p=f)}_._maxSeparation=d,_._bestIndex=p}function p(t,e,i,c,l){t.pointCount=0;var u=e.m_radius+c.m_radius;_(e,i,c,l);var p=_._bestIndex,d=_._maxSeparation;if(!(d>u)){_(c,l,e,i);var f=_._bestIndex,y=_._maxSeparation;if(!(y>u)){var v,g,x,b,A,w;y>d+.1*h.linearSlop?(v=c,g=e,x=l,b=i,A=f,t.type=m.e_faceB,w=1):(v=e,g=c,x=i,b=l,A=p,t.type=m.e_faceA,w=0);var B=[new m.clipVertex,new m.clipVertex];!function(t,e,i,h,c,l){var u=e.m_normals,_=c.m_count,p=c.m_vertices,d=c.m_normals;s&&n.assert(0<=h&&h<e.m_count);for(var f=r.mulT(l.q,r.mulVec2(i.q,u[h])),y=0,v=1/0,g=0;g<_;++g){var x=a.dot(f,d[g]);x<v&&(v=x,y=g)}var b=y,A=b+1<_?b+1:0;t[0].v=o.mulVec2(l,p[b]),t[0].id.cf.indexA=h,t[0].id.cf.indexB=b,t[0].id.cf.typeA=m.e_face,t[0].id.cf.typeB=m.e_vertex,t[1].v=o.mulVec2(l,p[A]),t[1].id.cf.indexA=h,t[1].id.cf.indexB=A,t[1].id.cf.typeA=m.e_face,t[1].id.cf.typeB=m.e_vertex}(B,v,x,A,g,b);var M=v.m_count,C=v.m_vertices,z=A,I=A+1<M?A+1:0,S=C[z],L=C[I],P=a.sub(L,S);P.normalize();var k=a.cross(P,1),V=a.combine(.5,S,.5,L),O=r.mulVec2(x.q,P),T=a.cross(O,1);S=o.mulVec2(x,S),L=o.mulVec2(x,L);var E=a.dot(T,S),F=-a.dot(O,S)+u,q=a.dot(O,L)+u,D=[new m.clipVertex,new m.clipVertex],R=[new m.clipVertex,new m.clipVertex];if(!(m.clipSegmentToLine(D,B,a.neg(O),F,z)<2||m.clipSegmentToLine(R,D,O,q,I)<2)){t.localNormal=k,t.localPoint=V;for(var j=0,N=0;N<R.length;++N){if(a.dot(T,R[N].v)-E<=u){var J=t.points[j];if(J.localPoint.set(o.mulTVec2(b,R[N].v)),J.id=R[N].id,w){var H=J.id.cf,U=H.indexA,Y=H.indexB,W=H.typeA,G=H.typeB;H.indexA=Y,H.indexB=U,H.typeA=G,H.typeB=W}++j}}t.pointCount=j}}}}t.exports=p,c.addType(l.TYPE,l.TYPE,(function(t,e,i,s,n,o,r){p(t,i.getShape(),e,o.getShape(),n)})),c.addType(u.TYPE,l.TYPE,(function(t,e,i,s,n,o,r){p(t,i.getShape().getChildPolygon(s),e,o.getShape(),n)})),c.addType(u.TYPE,u.TYPE,(function(t,e,i,s,n,o,r){p(t,i.getShape().getChildPolygon(s),e,o.getShape().getChildPolygon(r),n)}))},function(t,e,i){i(2);var s=i(1),n=i(3),o=(i(4),i(0)),r=(i(14),i(5),i(18)),a=i(17),h=(i(16),i(22)),m=i(19),c=i(26),l=new o,u=new o,_=new o;function p(t,e,i,a,h){t.pointCount=0,l=n.mulVec2(h,a.m_p,l),l=n.mulTVec2(i,l,l);for(var m=0,c=-1/0,p=e.m_radius+a.m_radius,d=e.m_count,f=e.m_vertices,y=e.m_normals,v=0;v<d;++v){var g=o.dot(y[v],u.set(l).sub(f[v]));if(g>p)return;g>c&&(c=g,m=v)}var x=m,b=x+1<d?x+1:0,A=f[x],w=f[b];if(c<s.EPSILON)return t.pointCount=1,t.type=r.e_faceA,t.localNormal.set(y[m]),t.localPoint.setCombine(.5,A,.5,w),t.points[0].localPoint=a.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex);if(o.dot(u.set(l).sub(A),_.set(w).sub(A))<=0){if(o.distanceSquared(l,A)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,l,-1,A),t.localNormal.normalize(),t.localPoint=A,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else if(o.dot(u.set(l).sub(w),_.set(A).sub(w))<=0){if(o.distanceSquared(l,w)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,l,-1,w),t.localNormal.normalize(),t.localPoint.set(w),t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else{var B=o.mid(A,w,_);if((c=o.dot(l,y[x])-o.dot(B,y[x]))>p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.set(y[x]),t.localPoint.set(B),t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}}a.addType(m.TYPE,h.TYPE,(function(t,e,i,s,n,o,r){p(t,i.getShape(),e,o.getShape(),n)})),a.addType(c.TYPE,h.TYPE,(function(t,e,i,s,n,o,r){p(t,i.getShape().getChildPolygon(s),e,o.getShape(),n)}))},function(t,e,i){i(2),i(6);var s,n=i(1),o=i(3),r=i(0),a=i(4),h=i(5),m=(i(16),i(17)),c=i(18),l=i(23),u=i(24),_=i(19),p=i(25),d=i(26);function f(t,e,i,s,n,o,r){z(t,i.getShape(),e,o.getShape(),n)}function y(t,e,i,s,n,o,r){var a=o.getShape();a.initCollisionData(),z(t,i.getShape(),e,a,n)}function v(t,e,i,s,n,o,r){z(t,i.getShape(),e,o.getShape().getChildPolygon(r),n)}m.addType(l.TYPE,_.TYPE,f),m.addType(l.TYPE,p.TYPE,y),m.addType(p.TYPE,p.TYPE,y),m.addType(u.TYPE,_.TYPE,(function(t,e,i,n,o,r,a){var h=i.getShape();s=s||new l,h.getChildEdge(s,n),z(t,s,e,r.getShape(),o)})),m.addType(u.TYPE,p.TYPE,(function(t,e,i,n,o,r,a){var h=i.getShape();s=s||new l,h.getChildEdge(s,n);var m=r.getShape();m.initCollisionData(),z(t,s,e,m,o)})),m.addType(p.TYPE,_.TYPE,f),m.addType(l.TYPE,d.TYPE,v),m.addType(u.TYPE,d.TYPE,(function(t,e,i,n,o,r,a){var h=i.getShape();s=s||new l,h.getChildEdge(s,n),z(t,s,e,r.getShape().getChildPolygon(a),o)})),m.addType(p.TYPE,d.TYPE,v);var g=-1,x=1,b=2;function A(){this.type,this.index,this.separation}var w=new A,B=new A,M=new function(){this.vertices=[],this.normals=[],this.count=0},C=new function(){this.i1,this.i2,this.v1,this.v2,this.normal=r.zero(),this.sideNormal1=r.zero(),this.sideOffset1,this.sideNormal2=r.zero(),this.sideOffset2};function z(t,e,i,s,m){var l=o.mulTXf(i,m),u=o.mulVec2(l,s.m_centroid),_=e.m_vertex0,p=e.m_vertex1,d=e.m_vertex2,f=e.m_vertex3,y=e.m_hasVertex0,v=e.m_hasVertex3,A=r.sub(d,p);A.normalize();var z,S=r.neo(A.y,-A.x),L=r.dot(S,r.sub(u,p)),P=0,k=0,V=!1,O=!1;if(y){var T=r.sub(p,_);T.normalize();var E=r.neo(T.y,-T.x);V=r.cross(T,A)>=0,P=r.dot(E,u)-r.dot(E,_)}if(v){var F=r.sub(f,d);F.normalize();var q=r.neo(F.y,-F.x);O=r.cross(A,F)>0,k=r.dot(q,u)-r.dot(q,d)}var D=r.zero(),R=r.zero(),j=r.zero();y&&v?V&&O?(z=P>=0||L>=0||k>=0)?(D.set(S),R.set(E),j.set(q)):(D.setMul(-1,S),R.setMul(-1,S),j.setMul(-1,S)):V?(z=P>=0||L>=0&&k>=0)?(D.set(S),R.set(E),j.set(S)):(D.setMul(-1,S),R.setMul(-1,q),j.setMul(-1,S)):O?(z=k>=0||P>=0&&L>=0)?(D.set(S),R.set(S),j.set(q)):(D.setMul(-1,S),R.setMul(-1,S),j.setMul(-1,E)):(z=P>=0&&L>=0&&k>=0)?(D.set(S),R.set(S),j.set(S)):(D.setMul(-1,S),R.setMul(-1,q),j.setMul(-1,E)):y?V?(z=P>=0||L>=0)?(D.set(S),R.set(E),j.setMul(-1,S)):(D.setMul(-1,S),R.set(S),j.setMul(-1,S)):(z=P>=0&&L>=0)?(D.set(S),R.set(S),j.setMul(-1,S)):(D.setMul(-1,S),R.set(S),j.setMul(-1,E)):v?O?(z=L>=0||k>=0)?(D.set(S),R.setMul(-1,S),j.set(q)):(D.setMul(-1,S),R.setMul(-1,S),j.set(S)):(z=L>=0&&k>=0)?(D.set(S),R.setMul(-1,S),j.set(S)):(D.setMul(-1,S),R.setMul(-1,q),j.set(S)):(z=L>=0)?(D.set(S),R.setMul(-1,S),j.setMul(-1,S)):(D.setMul(-1,S),R.set(S),j.set(S)),M.count=s.m_count;for(var N=0;N<s.m_count;++N)M.vertices[N]=o.mulVec2(l,s.m_vertices[N]),M.normals[N]=a.mulVec2(l.q,s.m_normals[N]);var J=e.m_radius+s.m_radius;t.pointCount=0,w.type=x,w.index=z?0:1,w.separation=1/0;for(N=0;N<M.count;++N){(U=r.dot(D,r.sub(M.vertices[N],p)))<w.separation&&(w.separation=U)}if(w.type!=g&&!(w.separation>J)){B.type=g,B.index=-1,B.separation=-1/0;var H=r.neo(-D.y,D.x);for(N=0;N<M.count;++N){var U,Y=r.neg(M.normals[N]),W=r.dot(Y,r.sub(M.vertices[N],p)),G=r.dot(Y,r.sub(M.vertices[N],d));if((U=n.min(W,G))>J){B.type=b,B.index=N,B.separation=U;break}if(r.dot(Y,H)>=0){if(r.dot(r.sub(Y,j),D)<-h.angularSlop)continue}else if(r.dot(r.sub(Y,R),D)<-h.angularSlop)continue;U>B.separation&&(B.type=b,B.index=N,B.separation=U)}if(!(B.type!=g&&B.separation>J)){var K;K=B.type==g?w:B.separation>.98*w.separation+.001?B:w;var Z,X,$=[new c.clipVertex,new c.clipVertex];if(K.type==x){t.type=c.e_faceA;var Q=0,tt=r.dot(D,M.normals[0]);for(N=1;N<M.count;++N){var et=r.dot(D,M.normals[N]);et<tt&&(tt=et,Q=N)}var it=Q,st=it+1<M.count?it+1:0;$[0].v=M.vertices[Z=it],$[0].id.cf.indexA=0,$[0].id.cf.indexB=it,$[0].id.cf.typeA=c.e_face,$[0].id.cf.typeB=c.e_vertex,$[1].v=M.vertices[X=st],$[1].id.cf.indexA=0,$[1].id.cf.indexB=st,$[1].id.cf.typeA=c.e_face,$[1].id.cf.typeB=c.e_vertex,z?(C.i1=0,C.i2=1,C.v1=p,C.v2=d,C.normal.set(S)):(C.i1=1,C.i2=0,C.v1=d,C.v2=p,C.normal.setMul(-1,S))}else t.type=c.e_faceB,$[0].v=p,$[0].id.cf.indexA=0,$[0].id.cf.indexB=K.index,$[0].id.cf.typeA=c.e_vertex,$[0].id.cf.typeB=c.e_face,$[1].v=d,$[1].id.cf.indexA=0,$[1].id.cf.indexB=K.index,$[1].id.cf.typeA=c.e_vertex,$[1].id.cf.typeB=c.e_face,C.i1=K.index,C.i2=C.i1+1<M.count?C.i1+1:0,C.v1=M.vertices[Z=C.i1],C.v2=M.vertices[X=C.i2],C.normal.set(M.normals[C.i1]);C.sideNormal1.set(C.normal.y,-C.normal.x),C.sideNormal2.setMul(-1,C.sideNormal1),C.sideOffset1=r.dot(C.sideNormal1,C.v1),C.sideOffset2=r.dot(C.sideNormal2,C.v2);var nt=[new c.clipVertex,new c.clipVertex],ot=[new c.clipVertex,new c.clipVertex];if(c.clipSegmentToLine(nt,$,C.sideNormal1,C.sideOffset1,C.i1)<h.maxManifoldPoints)I(t,e,s,M,Z,X);else if(c.clipSegmentToLine(ot,nt,C.sideNormal2,C.sideOffset2,C.i2)<h.maxManifoldPoints)I(t,e,s,M,Z,X);else{K.type==x?(t.localNormal=r.clone(C.normal),t.localPoint=r.clone(C.v1)):(t.localNormal=r.clone(s.m_normals[C.i1]),t.localPoint=r.clone(s.m_vertices[C.i1]));var rt=0;for(N=0;N<h.maxManifoldPoints;++N){if(r.dot(C.normal,r.sub(ot[N].v,C.v1))<=J){var at=t.points[rt];K.type==x?(at.localPoint=o.mulT(l,ot[N].v),at.id=ot[N].id):(at.localPoint=ot[N].v,at.id.cf.typeA=ot[N].id.cf.typeB,at.id.cf.typeB=ot[N].id.cf.typeA,at.id.cf.indexA=ot[N].id.cf.indexB,at.id.cf.indexB=ot[N].id.cf.indexA),++rt}}t.pointCount=rt}}}}function I(t,e,i,s,n,o){var a=e.m_radius+i.m_radius,h=a*a,m=e.m_vertex1,l=e.m_vertex2,u=s.vertices[n],_=s.vertices[o],p=r.distanceSquared(m,u),d=r.distanceSquared(m,_),f=r.distanceSquared(l,u),y=r.distanceSquared(l,_),v=1/0,g=-1,x=-1;(p<=h&&(v=p,g=0,x=n),d<=h&&d<v&&(v=d,g=0,x=o),f<=h&&f<v&&(v=f,g=1,x=n),y<=h&&y<v&&(g=1,x=o),g<0)||function(t,e,i,s,n){t.type=c.e_circles,t.localPoint.set(e),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(s),t.points[0].id.cf.indexA=i,t.points[0].id.cf.typeA=c.e_vertex,t.points[0].id.cf.indexB=n,t.points[0].id.cf.typeB=c.e_vertex}(t,0===g?e.m_vertex1:e.m_vertex2,g,i.m_vertices[x],x)}},function(t,e,i){t.exports=l;var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=(i(8),i(9),i(11),i(4)),m=(i(10),i(3),i(12),i(13),i(15));l.TYPE="distance-joint",l._super=m,l.prototype=n(l._super.prototype);var c={frequencyHz:0,dampingRatio:0,active:!0};function l(t,e,i,n,o){if(!(this instanceof l))return new l(t,e,i,n,o);if(i&&n&&"m_type"in n&&"x"in i&&"y"in i){var h=i;i=n,n=h}t=s(t,c),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=l.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||a.zero(),r.isFinite(t.length)?(this.m_length=t.length,this.m_autoLength=!1):(this.m_length=a.distance(e.getWorldPoint(this.m_localAnchorA),i.getWorldPoint(this.m_localAnchorB)),this.m_autoLength=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u=a.ZERO,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}l.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},l.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},l.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},l.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},l.prototype.setLength=function(t){this.m_length=t},l.prototype.getLength=function(){return this.m_length},l.prototype.setFrequency=function(t){this.m_frequencyHz=t},l.prototype.getFrequency=function(){return this.m_frequencyHz},l.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},l.prototype.getDampingRatio=function(){return this.m_dampingRatio},l.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},l.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},l.prototype.getReactionForce=function(t,e){return a.mul(this.m_impulse,this.m_u,e).mul(t)},l.prototype.getReactionTorque=function(t){return 0},l.prototype.setBodyA=function(t){l._super.prototype.setBodyA.call(this,t),this.m_autoLength&&(this.m_length=a.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},l.prototype.setBodyB=function(t){l._super.prototype.setBodyB.call(this,t),this.m_autoLength&&(this.m_length=a.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},l.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,m=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=h.neo(i),p=h.neo(c);this.m_rA=h.mulVec2(_,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(p,a.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=a.sub(a.add(m,this.m_rB),a.add(e,this.m_rA));var d=this.m_u.length();d>o.linearSlop?this.m_u.mul(1/d):this.m_u.set(0,0);var f=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,this.m_frequencyHz>0){var g=d-this.m_length,x=2*r.PI*this.m_frequencyHz,b=2*this.m_mass*this.m_dampingRatio*x,A=this.m_mass*x*x,w=t.dt;this.m_gamma=w*(b+w*A),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=g*w*A*this.m_gamma,v+=this.m_gamma,this.m_mass=0!=v?1/v:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var B=a.mul(this.m_impulse,this.m_u);s.subMul(this.m_invMassA,B),n-=this.m_invIA*a.cross(this.m_rA,B),l.addMul(this.m_invMassB,B),u+=this.m_invIB*a.cross(this.m_rB,B)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=u},l.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=a.add(e,a.cross(i,this.m_rA)),r=a.add(s,a.cross(n,this.m_rB)),h=a.dot(this.m_u,r)-a.dot(this.m_u,o),m=-this.m_mass*(h+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=m;var c=a.mul(m,this.m_u);e.subMul(this.m_invMassA,c),i-=this.m_invIA*a.cross(this.m_rA,c),s.addMul(this.m_invMassB,c),n+=this.m_invIB*a.cross(this.m_rB,c),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(s),this.m_bodyB.c_velocity.w=n},l.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,m=h.neo(i),c=h.neo(n),l=h.mulSub(m,this.m_localAnchorA,this.m_localCenterA),u=h.mulSub(c,this.m_localAnchorB,this.m_localCenterB),_=a.sub(a.add(s,u),a.add(e,l)),p=_.normalize()-this.m_length;p=r.clamp(p,-o.maxLinearCorrection,o.maxLinearCorrection);var d=-this.m_mass*p,f=a.mul(d,_);return e.subMul(this.m_invMassA,f),i-=this.m_invIA*a.cross(l,f),s.addMul(this.m_invMassB,f),n+=this.m_invIB*a.cross(u,f),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=n,r.abs(p)<o.linearSlop}},function(t,e,i){t.exports=l;i(2);var s=i(7),n=i(6),o=(i(5),i(1)),r=i(0),a=(i(8),i(9)),h=(i(11),i(4)),m=(i(10),i(3),i(12),i(13),i(15));l.TYPE="friction-joint",l._super=m,l.prototype=n(l._super.prototype);var c={maxForce:0,maxTorque:0,active:!0};function l(t,e,i,n){if(!(this instanceof l))return new l(t,e,i,n);t=s(t,c),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=l.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||r.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||r.zero(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}l.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},l.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},l.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},l.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},l.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},l.prototype.getMaxForce=function(){return this.m_maxForce},l.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},l.prototype.getMaxTorque=function(){return this.m_maxTorque},l.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},l.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},l.prototype.getReactionForce=function(t,e){return r.mul(t,this.m_linearImpulse,e)},l.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},l.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,c=h.neo(e),l=h.neo(n);this.m_rA=h.mulVec2(c,r.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(l,r.sub(this.m_localAnchorB,this.m_localCenterB));var u=this.m_invMassA,_=this.m_invMassB,p=this.m_invIA,d=this.m_invIB,f=new a;if(f.ex.x=u+_+p*this.m_rA.y*this.m_rA.y+d*this.m_rB.y*this.m_rB.y,f.ex.y=-p*this.m_rA.x*this.m_rA.y-d*this.m_rB.x*this.m_rB.y,f.ey.x=f.ex.y,f.ey.y=u+_+p*this.m_rA.x*this.m_rA.x+d*this.m_rB.x*this.m_rB.x,this.m_linearMass=f.getInverse(),this.m_angularMass=p+d,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var y=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(u,y),s-=p*(r.cross(this.m_rA,y)+this.m_angularImpulse),o.addMul(_,y),m+=d*(r.cross(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=m},l.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,h=this.m_invMassA,m=this.m_invMassB,c=this.m_invIA,l=this.m_invIB,u=t.dt,_=n-i,p=-this.m_angularMass*_,d=this.m_angularImpulse,f=u*this.m_maxTorque;this.m_angularImpulse=o.clamp(this.m_angularImpulse+p,-f,f),i-=c*(p=this.m_angularImpulse-d),n+=l*p;_=r.sub(r.add(s,r.cross(n,this.m_rB)),r.add(e,r.cross(i,this.m_rA))),p=r.neg(a.mulVec2(this.m_linearMass,_)),d=this.m_linearImpulse.clone();this.m_linearImpulse.add(p);f=u*this.m_maxForce;this.m_linearImpulse.lengthSquared()>f*f&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(f)),p=r.sub(this.m_linearImpulse,d),e.subMul(h,p),i-=c*r.cross(this.m_rA,p),s.addMul(m,p),n+=l*r.cross(this.m_rB,p),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},l.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){var s=!1;t.exports=d;var n=i(2),o=i(7),r=i(6),a=i(5),h=i(1),m=i(0),c=(i(8),i(9),i(11),i(4)),l=(i(10),i(3),i(12),i(13),i(15)),u=i(39),_=i(40);d.TYPE="gear-joint",d._super=l,d.prototype=r(d._super.prototype);var p={ratio:1,active:!0};function d(t,e,i,r,a,f){if(!(this instanceof d))return new d(t,e,i,r,a,f);var y,v;t=o(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,s&&n.assert(r.m_type===u.TYPE||r.m_type===_.TYPE),s&&n.assert(a.m_type===u.TYPE||a.m_type===_.TYPE),this.m_joint1=r||t.joint1,this.m_joint2=a||t.joint2,this.m_ratio=h.isFinite(f)?f:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();var g=this.m_bodyA.m_xf,x=this.m_bodyA.m_sweep.a,b=this.m_bodyC.m_xf,A=this.m_bodyC.m_sweep.a;if(this.m_type1===u.TYPE){var w=this.m_joint1;this.m_localAnchorC=w.m_localAnchorA,this.m_localAnchorA=w.m_localAnchorB,this.m_referenceAngleA=w.m_referenceAngle,this.m_localAxisC=m.zero(),y=x-A-this.m_referenceAngleA}else{var B=this.m_joint1;this.m_localAnchorC=B.m_localAnchorA,this.m_localAnchorA=B.m_localAnchorB,this.m_referenceAngleA=B.m_referenceAngle,this.m_localAxisC=B.m_localXAxisA;var M=this.m_localAnchorC,C=c.mulTVec2(b.q,m.add(c.mul(g.q,this.m_localAnchorA),m.sub(g.p,b.p)));y=m.dot(C,this.m_localAxisC)-m.dot(M,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();var z=this.m_bodyB.m_xf,I=this.m_bodyB.m_sweep.a,S=this.m_bodyD.m_xf,L=this.m_bodyD.m_sweep.a;if(this.m_type2===u.TYPE){w=this.m_joint2;this.m_localAnchorD=w.m_localAnchorA,this.m_localAnchorB=w.m_localAnchorB,this.m_referenceAngleB=w.m_referenceAngle,this.m_localAxisD=m.zero(),v=I-L-this.m_referenceAngleB}else{B=this.m_joint2;this.m_localAnchorD=B.m_localAnchorA,this.m_localAnchorB=B.m_localAnchorB,this.m_referenceAngleB=B.m_referenceAngle,this.m_localAxisD=B.m_localXAxisA;var P=this.m_localAnchorD,k=c.mulTVec2(S.q,m.add(c.mul(z.q,this.m_localAnchorB),m.sub(z.p,S.p)));v=m.dot(k,this.m_localAxisD)-m.dot(P,this.m_localAxisD)}this.m_constant=y+this.m_ratio*v,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}d.prototype.getJoint1=function(){return this.m_joint1},d.prototype.getJoint2=function(){return this.m_joint2},d.prototype.setRatio=function(t){s&&n.assert(h.isFinite(t)),this.m_ratio=t},d.prototype.getRatio=function(){return this.m_ratio},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_JvAC).mul(t)},d.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},d.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_position.a,h=this.m_bodyC.c_velocity.v,l=this.m_bodyC.c_velocity.w,_=this.m_bodyD.c_position.a,p=this.m_bodyD.c_velocity.v,d=this.m_bodyD.c_velocity.w,f=c.neo(e),y=c.neo(n),v=c.neo(a),g=c.neo(_);if(this.m_mass=0,this.m_type1==u.TYPE)this.m_JvAC=m.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var x=c.mulVec2(v,this.m_localAxisC),b=c.mulSub(v,this.m_localAnchorC,this.m_lcC),A=c.mulSub(f,this.m_localAnchorA,this.m_lcA);this.m_JvAC=x,this.m_JwC=m.cross(b,x),this.m_JwA=m.cross(A,x),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==u.TYPE)this.m_JvBD=m.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{x=c.mulVec2(g,this.m_localAxisD);var w=c.mulSub(g,this.m_localAnchorD,this.m_lcD),B=c.mulSub(y,this.m_localAnchorB,this.m_lcB);this.m_JvBD=m.mul(this.m_ratio,x),this.m_JwD=this.m_ratio*m.cross(w,x),this.m_JwB=this.m_ratio*m.cross(B,x),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),s+=this.m_iA*this.m_impulse*this.m_JwA,o.addMul(this.m_mB*this.m_impulse,this.m_JvBD),r+=this.m_iB*this.m_impulse*this.m_JwB,h.subMul(this.m_mC*this.m_impulse,this.m_JvAC),l-=this.m_iC*this.m_impulse*this.m_JwC,p.subMul(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.set(o),this.m_bodyB.c_velocity.w=r,this.m_bodyC.c_velocity.v.set(h),this.m_bodyC.c_velocity.w=l,this.m_bodyD.c_velocity.v.set(p),this.m_bodyD.c_velocity.w=d},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=this.m_bodyC.c_velocity.v,r=this.m_bodyC.c_velocity.w,a=this.m_bodyD.c_velocity.v,h=this.m_bodyD.c_velocity.w,c=m.dot(this.m_JvAC,e)-m.dot(this.m_JvAC,o)+m.dot(this.m_JvBD,s)-m.dot(this.m_JvBD,a);c+=this.m_JwA*i-this.m_JwC*r+(this.m_JwB*n-this.m_JwD*h);var l=-this.m_mass*c;this.m_impulse+=l,e.addMul(this.m_mA*l,this.m_JvAC),i+=this.m_iA*l*this.m_JwA,s.addMul(this.m_mB*l,this.m_JvBD),n+=this.m_iB*l*this.m_JwB,o.subMul(this.m_mC*l,this.m_JvAC),r-=this.m_iC*l*this.m_JwC,a.subMul(this.m_mD*l,this.m_JvBD),h-=this.m_iD*l*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(s),this.m_bodyB.c_velocity.w=n,this.m_bodyC.c_velocity.v.set(o),this.m_bodyC.c_velocity.w=r,this.m_bodyD.c_velocity.v.set(a),this.m_bodyD.c_velocity.w=h},d.prototype.solvePositionConstraints=function(t){var e,i,s,n,o,r,h,l,_=this.m_bodyA.c_position.c,p=this.m_bodyA.c_position.a,d=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,y=this.m_bodyC.c_position.c,v=this.m_bodyC.c_position.a,g=this.m_bodyD.c_position.c,x=this.m_bodyD.c_position.a,b=c.neo(p),A=c.neo(f),w=c.neo(v),B=c.neo(x),M=0;if(this.m_type1==u.TYPE)s=m.zero(),o=1,h=1,M+=this.m_iA+this.m_iC,e=p-v-this.m_referenceAngleA;else{var C=c.mulVec2(w,this.m_localAxisC),z=c.mulSub(w,this.m_localAnchorC,this.m_lcC),I=c.mulSub(b,this.m_localAnchorA,this.m_lcA);s=C,h=m.cross(z,C),o=m.cross(I,C),M+=this.m_mC+this.m_mA+this.m_iC*h*h+this.m_iA*o*o;var S=m.sub(this.m_localAnchorC,this.m_lcC),L=c.mulTVec2(w,m.add(I,m.sub(_,y)));e=m.dot(m.sub(L,S),this.m_localAxisC)}if(this.m_type2==u.TYPE)n=m.zero(),r=this.m_ratio,l=this.m_ratio,M+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=f-x-this.m_referenceAngleB;else{C=c.mulVec2(B,this.m_localAxisD);var P=c.mulSub(B,this.m_localAnchorD,this.m_lcD),k=c.mulSub(A,this.m_localAnchorB,this.m_lcB);n=m.mul(this.m_ratio,C),l=this.m_ratio*m.cross(P,C),r=this.m_ratio*m.cross(k,C),M+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*l*l+this.m_iB*r*r;var V=m.sub(this.m_localAnchorD,this.m_lcD),O=c.mulTVec2(B,m.add(k,m.sub(d,g)));i=m.dot(O,this.m_localAxisD)-m.dot(V,this.m_localAxisD)}var T=e+this.m_ratio*i-this.m_constant,E=0;return M>0&&(E=-T/M),_.addMul(this.m_mA*E,s),p+=this.m_iA*E*o,d.addMul(this.m_mB*E,n),f+=this.m_iB*E*r,y.subMul(this.m_mC*E,s),v-=this.m_iC*E*h,g.subMul(this.m_mD*E,n),x-=this.m_iD*E*l,this.m_bodyA.c_position.c.set(_),this.m_bodyA.c_position.a=p,this.m_bodyB.c_position.c.set(d),this.m_bodyB.c_position.a=f,this.m_bodyC.c_position.c.set(y),this.m_bodyC.c_position.a=v,this.m_bodyD.c_position.c.set(g),this.m_bodyD.c_position.a=x,0<a.linearSlop}},function(t,e,i){t.exports=l;i(2);var s=i(7),n=i(6),o=(i(5),i(1)),r=i(0),a=(i(8),i(9)),h=(i(11),i(4)),m=(i(10),i(3),i(12),i(13),i(15));l.TYPE="motor-joint",l._super=m,l.prototype=n(l._super.prototype);var c={maxForce:1,maxTorque:1,correctionFactor:.3,active:!0};function l(t,e,i){if(!(this instanceof l))return new l(t,e,i);t=s(t,c),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=l.TYPE,this.m_linearOffset=t.linearOffset?t.linearOffset:e.getLocalPoint(i.getPosition()),this.m_angularOffset=t.angularOffset?t.angularOffset:i.getAngle()-e.getAngle(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}l.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},l.prototype.getMaxForce=function(){return this.m_maxForce},l.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},l.prototype.getMaxTorque=function(){return this.m_maxTorque},l.prototype.setCorrectionFactor=function(t){this.m_correctionFactor=t},l.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},l.prototype.setLinearOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t},l.prototype.getLinearOffset=function(){return this.m_linearOffset},l.prototype.setAngularOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t},l.prototype.getAngularOffset=function(){return this.m_angularOffset},l.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},l.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},l.prototype.getReactionForce=function(t,e){return r.mul(t,this.m_linearImpulse,e)},l.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},l.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,m=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,u=h.neo(i),_=h.neo(m);this.m_rA=h.mulVec2(u,this.m_linearOffset.clone().sub(this.m_localCenterA)),this.m_rB=h.mulVec2(_,r.neg(this.m_localCenterB));var p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=new a;if(v.ex.x=p+d+f*this.m_rA.y*this.m_rA.y+y*this.m_rB.y*this.m_rB.y,v.ex.y=-f*this.m_rA.x*this.m_rA.y-y*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=p+d+f*this.m_rA.x*this.m_rA.x+y*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=f+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=r.zero(),this.m_linearError.addCombine(1,o,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_angularError=m-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var g=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);s.subMul(p,g),n-=f*(r.cross(this.m_rA,g)+this.m_angularImpulse),c.addMul(d,g),l+=y*(r.cross(this.m_rB,g)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=l},l.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,h=this.m_invMassA,m=this.m_invMassB,c=this.m_invIA,l=this.m_invIB,u=t.dt,_=t.inv_dt,p=n-i+_*this.m_correctionFactor*this.m_angularError,d=-this.m_angularMass*p,f=this.m_angularImpulse,y=u*this.m_maxTorque;this.m_angularImpulse=o.clamp(this.m_angularImpulse+d,-y,y),i-=c*(d=this.m_angularImpulse-f),n+=l*d,(p=r.zero()).addCombine(1,s,1,r.cross(n,this.m_rB)),p.subCombine(1,e,1,r.cross(i,this.m_rA)),p.addMul(_*this.m_correctionFactor,this.m_linearError);d=r.neg(a.mulVec2(this.m_linearMass,p)),f=r.clone(this.m_linearImpulse);this.m_linearImpulse.add(d);y=u*this.m_maxForce;this.m_linearImpulse.clamp(y),d=r.sub(this.m_linearImpulse,f),e.subMul(h,d),i-=c*r.cross(this.m_rA,d),s.addMul(m,d),n+=l*r.cross(this.m_rB,d),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},l.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){var s=!1;t.exports=p;var n=i(2),o=i(7),r=i(6),a=i(1),h=i(0),m=(i(8),i(9)),c=(i(11),i(4)),l=(i(10),i(3)),u=(i(12),i(13),i(15));p.TYPE="mouse-joint",p._super=u,p.prototype=r(p._super.prototype);var _={maxForce:0,frequencyHz:5,dampingRatio:.7,active:!0};function p(t,e,i,r){if(!(this instanceof p))return new p(t,e,i,r);t=o(t,_),u.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=p.TYPE,s&&n.assert(a.isFinite(t.maxForce)&&t.maxForce>=0),s&&n.assert(a.isFinite(t.frequencyHz)&&t.frequencyHz>=0),s&&n.assert(a.isFinite(t.dampingRatio)&&t.dampingRatio>=0),this.m_targetA=r?h.clone(r):t.target||h.zero(),this.m_localAnchorB=t.anchorB?t.anchorB:l.mulTVec2(i.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=h.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=h.zero(),this.m_localCenterB=h.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new m,this.m_C=h.zero()}p.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=t},p.prototype.getTarget=function(){return this.m_targetA},p.prototype.setMaxForce=function(t){this.m_bodyB.setAwake(!0),this.m_maxForce=t},p.getMaxForce=function(){return this.m_maxForce},p.prototype.setFrequency=function(t){this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},p.prototype.getFrequency=function(){return this.m_frequencyHz},p.prototype.setDampingRatio=function(t){this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},p.prototype.getDampingRatio=function(){return this.m_dampingRatio},p.prototype.getAnchorA=function(){return h.clone(this.m_targetA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getLocalAnchorB=function(t){return this.m_localAnchorB},p.prototype.setLocalAnchorB=function(t){return this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},p.prototype.getReactionForce=function(t,e){return h.mul(t,this.m_impulse,e)},p.prototype.getReactionTorque=function(t){return 0*t},p.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},p.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,o=e.c,r=e.a,l=i.v,u=i.w,_=c.neo(r),p=this.m_bodyB.getMass(),d=2*a.PI*this.m_frequencyHz,f=2*p*this.m_dampingRatio*d,y=p*(d*d),v=t.dt;s&&n.assert(f+v*y>a.EPSILON),this.m_gamma=v*(f+v*y),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=v*y*this.m_gamma,this.m_rB=c.mulVec2(_,h.sub(this.m_localAnchorB,this.m_localCenterB));var g=new m;g.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,g.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,g.ey.x=g.ex.y,g.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=g.getInverse(),this.m_C.set(o),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),u*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),l.addMul(this.m_invMassB,this.m_impulse),u+=this.m_invIB*h.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.set(l),i.w=u},p.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,i=h.clone(e.v),s=e.w,n=h.cross(s,this.m_rB);n.add(i),n.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),n.neg();var o=m.mulVec2(this.m_mass,n),r=h.clone(this.m_impulse);this.m_impulse.add(o);var a=t.dt*this.m_maxForce;this.m_impulse.clamp(a),o=h.sub(this.m_impulse,r),i.addMul(this.m_invMassB,o),s+=this.m_invIB*h.cross(this.m_rB,o),e.v.set(i),e.w=s},p.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){var s=!1;t.exports=_;var n=i(2),o=i(7),r=i(6),a=i(5),h=i(1),m=i(0),c=(i(8),i(9),i(11),i(4)),l=(i(10),i(3),i(12),i(13),i(15));_.TYPE="pulley-joint",_.MIN_PULLEY_LENGTH=2,_._super=l,_.prototype=r(_._super.prototype);var u={collideConnected:!0,active:!0};function _(t,e,i,r,a,c,p,d){if(!(this instanceof _))return new _(t,e,i,r,a,c,p,d);t=o(t,u),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_groundAnchorA=r||(t.groundAnchorA||m.neo(-1,1)),this.m_groundAnchorB=a||(t.groundAnchorB||m.neo(1,1)),this.m_localAnchorA=c?e.getLocalPoint(c):t.localAnchorA||m.neo(-1,0),this.m_localAnchorB=p?i.getLocalPoint(p):t.localAnchorB||m.neo(1,0),this.m_lengthA=h.isFinite(t.lengthA)?t.lengthA:m.distance(c,r),this.m_lengthB=h.isFinite(t.lengthB)?t.lengthB:m.distance(p,a),this.m_ratio=h.isFinite(d)?d:t.ratio,s&&n.assert(d>h.EPSILON),this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}_.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},_.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},_.prototype.getLengthA=function(){return this.m_lengthA},_.prototype.getLengthB=function(){return this.m_lengthB},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return m.distance(t,e)},_.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return m.distance(t,e)},_.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_uB).mul(t)},_.prototype.getReactionTorque=function(t){return 0},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,h=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,u=c.neo(i),_=c.neo(r);this.m_rA=c.mulVec2(u,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=c.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=m.sub(m.add(o,this.m_rB),this.m_groundAnchorB);var p=this.m_uA.length(),d=this.m_uB.length();p>10*a.linearSlop?this.m_uA.mul(1/p):this.m_uA.setZero(),d>10*a.linearSlop?this.m_uB.mul(1/d):this.m_uB.setZero();var f=m.cross(this.m_rA,this.m_uA),y=m.cross(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*f*f,g=this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=v+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var x=m.mul(-this.m_impulse,this.m_uA),b=m.mul(-this.m_ratio*this.m_impulse,this.m_uB);s.addMul(this.m_invMassA,x),n+=this.m_invIA*m.cross(this.m_rA,x),h.addMul(this.m_invMassB,b),l+=this.m_invIB*m.cross(this.m_rB,b)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=h,this.m_bodyB.c_velocity.w=l},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=m.add(e,m.cross(i,this.m_rA)),r=m.add(s,m.cross(n,this.m_rB)),a=-m.dot(this.m_uA,o)-this.m_ratio*m.dot(this.m_uB,r),h=-this.m_mass*a;this.m_impulse+=h;var c=m.mul(-h,this.m_uA),l=m.mul(-this.m_ratio*h,this.m_uB);e.addMul(this.m_invMassA,c),i+=this.m_invIA*m.cross(this.m_rA,c),s.addMul(this.m_invMassB,l),n+=this.m_invIB*m.cross(this.m_rB,l),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,o=c.neo(i),r=c.neo(n),l=c.mulVec2(o,m.sub(this.m_localAnchorA,this.m_localCenterA)),u=c.mulVec2(r,m.sub(this.m_localAnchorB,this.m_localCenterB)),_=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),p=m.sub(m.add(s,this.m_rB),this.m_groundAnchorB),d=_.length(),f=p.length();d>10*a.linearSlop?_.mul(1/d):_.setZero(),f>10*a.linearSlop?p.mul(1/f):p.setZero();var y=m.cross(l,_),v=m.cross(u,p),g=this.m_invMassA+this.m_invIA*y*y,x=this.m_invMassB+this.m_invIB*v*v,b=g+this.m_ratio*this.m_ratio*x;b>0&&(b=1/b);var A=this.m_constant-d-this.m_ratio*f,w=h.abs(A),B=-b*A,M=m.mul(-B,_),C=m.mul(-this.m_ratio*B,p);return e.addMul(this.m_invMassA,M),i+=this.m_invIA*m.cross(l,M),s.addMul(this.m_invMassB,C),n+=this.m_invIB*m.cross(u,C),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=n,w<a.linearSlop}},function(t,e,i){t.exports=u;var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=(i(8),i(9),i(11),i(4)),m=(i(10),i(3),i(12),i(13),i(15)),c=0;u.TYPE="rope-joint",u._super=m,u.prototype=n(u._super.prototype);var l={maxLength:0,active:!0};function u(t,e,i,n){if(!(this instanceof u))return new u(t,e,i,n);t=s(t,l),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=u.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.neo(-1,0),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=c,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}u.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},u.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},u.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},u.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},u.prototype.setMaxLength=function(t){this.m_maxLength=t},u.prototype.getMaxLength=function(){return this.m_maxLength},u.prototype.setLength=function(t){this.m_maxLength=t},u.prototype.getLength=function(){return this.m_maxLength},u.prototype.getLimitState=function(){return this.m_state},u.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},u.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},u.prototype.getReactionForce=function(t,e){return a.mul(this.m_impulse,this.m_u,e).mul(t)},u.prototype.getReactionTorque=function(t){return 0},u.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.c,m=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=h.neo(i),p=h.neo(m);this.m_rA=h.mulSub(_,this.m_localAnchorA,this.m_localCenterA),this.m_rB=h.mulSub(p,this.m_localAnchorB,this.m_localCenterB),this.m_u=a.zero(),this.m_u.addCombine(1,r,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();var d=this.m_length-this.m_maxLength;if(this.m_state=d>0?2:c,!(this.m_length>o.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);var f=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,t.warmStarting){this.m_impulse*=t.dtRatio;var g=a.mul(this.m_impulse,this.m_u);s.subMul(this.m_invMassA,g),n-=this.m_invIA*a.cross(this.m_rA,g),l.addMul(this.m_invMassB,g),u+=this.m_invIB*a.cross(this.m_rB,g)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=u},u.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=a.addCross(e,i,this.m_rA),h=a.addCross(s,n,this.m_rB),m=this.m_length-this.m_maxLength,c=a.dot(this.m_u,a.sub(h,o));m<0&&(c+=t.inv_dt*m);var l=-this.m_mass*c,u=this.m_impulse;this.m_impulse=r.min(0,this.m_impulse+l),l=this.m_impulse-u;var _=a.mul(l,this.m_u);e.subMul(this.m_invMassA,_),i-=this.m_invIA*a.cross(this.m_rA,_),s.addMul(this.m_invMassB,_),n+=this.m_invIB*a.cross(this.m_rB,_),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},u.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,m=h.neo(i),c=h.neo(n),l=h.mulSub(m,this.m_localAnchorA,this.m_localCenterA),u=h.mulSub(c,this.m_localAnchorB,this.m_localCenterB),_=a.zero();_.addCombine(1,s,1,u),_.subCombine(1,e,1,l);var p=_.normalize(),d=p-this.m_maxLength;d=r.clamp(d,0,o.maxLinearCorrection);var f=-this.m_mass*d,y=a.mul(f,_);return e.subMul(this.m_invMassA,y),i-=this.m_invIA*a.cross(l,y),s.addMul(this.m_invMassB,y),n+=this.m_invIB*a.cross(u,y),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=n,p-this.m_maxLength<o.linearSlop}},function(t,e,i){t.exports=_;var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=i(8),m=(i(9),i(11)),c=i(4),l=(i(10),i(3),i(12),i(13),i(15));_.TYPE="weld-joint",_._super=l,_.prototype=n(_._super.prototype);var u={frequencyHz:0,dampingRatio:0,active:!0};function _(t,e,i,n){if(!(this instanceof _))return new _(t,e,i,n);t=s(t,u),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=h(),this.m_bias=0,this.m_gamma=0,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new m}_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},_.prototype.getReferenceAngle=function(){return this.m_referenceAngle},_.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},_.prototype.setFrequency=function(t){this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t,e){return(e=e||a.zero()).set(this.m_impulse.x,this.m_impulse.y).mul(t)},_.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},_.prototype.setBodyA=function(t){_._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},_.prototype.setBodyB=function(t){_._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,l=c.neo(e),u=c.neo(n);this.m_rA=c.mulVec2(l,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=c.mulVec2(u,a.sub(this.m_localAnchorB,this.m_localCenterB));var _=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,y=new m;if(y.ex.x=_+p+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*f,y.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*f,y.ez.x=-this.m_rA.y*d-this.m_rB.y*f,y.ex.y=y.ey.x,y.ey.y=_+p+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*f,y.ez.y=this.m_rA.x*d+this.m_rB.x*f,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=d+f,this.m_frequencyHz>0){y.getInverse22(this.m_mass);var v=d+f,g=v>0?1/v:0,x=n-e-this.m_referenceAngle,b=2*r.PI*this.m_frequencyHz,A=2*g*this.m_dampingRatio*b,w=g*b*b,B=t.dt;this.m_gamma=B*(A+B*w),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=x*B*w*this.m_gamma,v+=this.m_gamma,this.m_mass.ez.z=0!=v?1/v:0}else 0==y.ez.z?(y.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(y.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var M=a.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(_,M),s-=d*(a.cross(this.m_rA,M)+this.m_impulse.z),o.addMul(p,M),h+=f*(a.cross(this.m_rB,M)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=h},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,o=this.m_invMassA,r=this.m_invMassB,c=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){var u=n-i,_=-this.m_mass.ez.z*(u+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=_,i-=c*_,n+=l*_,(f=a.zero()).addCombine(1,s,1,a.cross(n,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA));var p=a.neg(m.mulVec2(this.m_mass,f));this.m_impulse.x+=p.x,this.m_impulse.y+=p.y;var d=a.clone(p);e.subMul(o,d),i-=c*a.cross(this.m_rA,d),s.addMul(r,d),n+=l*a.cross(this.m_rB,d)}else{var f;(f=a.zero()).addCombine(1,s,1,a.cross(n,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA));u=n-i;var y=h(f.x,f.y,u),v=h.neg(m.mulVec3(this.m_mass,y));this.m_impulse.add(v);d=a.neo(v.x,v.y);e.subMul(o,d),i-=c*(a.cross(this.m_rA,d)+v.z),s.addMul(r,d),n+=l*(a.cross(this.m_rB,d)+v.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){var e,i,s=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,l=this.m_bodyB.c_position.c,u=this.m_bodyB.c_position.a,_=c.neo(n),p=c.neo(u),d=this.m_invMassA,f=this.m_invMassB,y=this.m_invIA,v=this.m_invIB,g=c.mulVec2(_,a.sub(this.m_localAnchorA,this.m_localCenterA)),x=c.mulVec2(p,a.sub(this.m_localAnchorB,this.m_localCenterB)),b=new m;if(b.ex.x=d+f+g.y*g.y*y+x.y*x.y*v,b.ey.x=-g.y*g.x*y-x.y*x.x*v,b.ez.x=-g.y*y-x.y*v,b.ex.y=b.ey.x,b.ey.y=d+f+g.x*g.x*y+x.x*x.x*v,b.ez.y=g.x*y+x.x*v,b.ex.z=b.ez.x,b.ey.z=b.ez.y,b.ez.z=y+v,this.m_frequencyHz>0){(w=a.zero()).addCombine(1,l,1,x),w.subCombine(1,s,1,g),e=w.length(),i=0;var A=a.neg(b.solve22(w));s.subMul(d,A),n-=y*a.cross(g,A),l.addMul(f,A),u+=v*a.cross(x,A)}else{var w;(w=a.zero()).addCombine(1,l,1,x),w.subCombine(1,s,1,g);var B=u-n-this.m_referenceAngle;e=w.length(),i=r.abs(B);var M=h(w.x,w.y,B),C=h();if(b.ez.z>0)C=h.neg(b.solve33(M));else{var z=a.neg(b.solve22(w));C.set(z.x,z.y,0)}A=a.neo(C.x,C.y);s.subMul(d,A),n-=y*(a.cross(g,A)+C.z),l.addMul(f,A),u+=v*(a.cross(x,A)+C.z)}return this.m_bodyA.c_position.c=s,this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c=l,this.m_bodyB.c_position.a=u,e<=o.linearSlop&&i<=o.angularSlop}},function(t,e,i){t.exports=l;var s=i(7),n=i(6),o=i(5),r=i(1),a=i(0),h=(i(8),i(9),i(11),i(4)),m=(i(10),i(3),i(12),i(13),i(15));l.TYPE="wheel-joint",l._super=m,l.prototype=n(l._super.prototype);var c={enableMotor:!1,maxMotorTorque:1e4,motorSpeed:0,frequencyHz:2,dampingRatio:.7,active:!0};function l(t,e,i,n,o){if(!(this instanceof l))return new l(t,e,i,n,o);t=s(t,c),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=l.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.zero(),this.m_localAxis=o?e.getLocalVector(o):t.localAxisA||a.neo(0,1),this.m_localXAxisA=this.m_localAxis,this.m_localYAxisA=a.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_ax=a.zero(),this.m_ay=a.zero(),this.m_sAx,this.m_sBx,this.m_sAy,this.m_sBy}l.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},l.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},l.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},l.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},l.prototype.getLocalAxisA=function(){return this.m_localXAxisA},l.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAxis.set(t),this.m_localXAxisA.set(t),this.m_localYAxisA.set(-t.y,t.x)},l.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),s=e.getWorldPoint(this.m_localAnchorB),n=a.sub(s,i),o=t.getWorldVector(this.m_localXAxisA);return a.dot(n,o)},l.prototype.getJointLinearSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,i=h.mulVec2(t.m_xf.q,a.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=h.mulVec2(e.m_xf.q,a.sub(this.m_localAnchorB,e.m_sweep.localCenter)),n=a.add(t.m_sweep.c,i),o=a.add(e.m_sweep.c,s),r=a.sub(o,n),m=h.mulVec2(t.m_xf.q,this.m_localXAxisA),c=t.m_linearVelocity,l=e.m_linearVelocity,u=t.m_angularVelocity,_=e.m_angularVelocity;return a.dot(r,a.cross(u,m))+a.dot(m,a.add(l,a.sub(a.cross(_,s),a.add(c,a.cross(u,i)))))},l.prototype.getJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a},l.prototype.getJointAngularSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},l.prototype.isMotorEnabled=function(){return this.m_enableMotor},l.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},l.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},l.prototype.getMotorSpeed=function(){return this.m_motorSpeed},l.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},l.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},l.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},l.prototype.setSpringFrequencyHz=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},l.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},l.prototype.setSpringDampingRatio=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},l.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},l.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},l.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},l.prototype.getReactionForce=function(t,e){return(e=e||a.zero()).setCombine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},l.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},l.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,n=this.m_invIB,o=this.m_bodyA.c_position.c,m=this.m_bodyA.c_position.a,c=this.m_bodyA.c_velocity.v,l=this.m_bodyA.c_velocity.w,u=this.m_bodyB.c_position.c,_=this.m_bodyB.c_position.a,p=this.m_bodyB.c_velocity.v,d=this.m_bodyB.c_velocity.w,f=h.neo(m),y=h.neo(_),v=h.mulVec2(f,a.sub(this.m_localAnchorA,this.m_localCenterA)),g=h.mulVec2(y,a.sub(this.m_localAnchorB,this.m_localCenterB));if((w=a.zero()).addCombine(1,u,1,g),w.subCombine(1,o,1,v),this.m_ay=h.mulVec2(f,this.m_localYAxisA),this.m_sAy=a.cross(a.add(w,v),this.m_ay),this.m_sBy=a.cross(g,this.m_ay),this.m_mass=e+i+s*this.m_sAy*this.m_sAy+n*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=h.mulVec2(f,this.m_localXAxisA),this.m_sAx=a.cross(a.add(w,v),this.m_ax),this.m_sBx=a.cross(g,this.m_ax);var x=e+i+s*this.m_sAx*this.m_sAx+n*this.m_sBx*this.m_sBx;if(x>0){this.m_springMass=1/x;var b=a.dot(w,this.m_ax),A=2*r.PI*this.m_frequencyHz,w=2*this.m_springMass*this.m_dampingRatio*A,B=this.m_springMass*A*A,M=t.dt;this.m_gamma=M*(w+M*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=b*M*B*this.m_gamma,this.m_springMass=x+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=s+n,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var C=a.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),z=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,I=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;c.subMul(this.m_invMassA,C),l-=this.m_invIA*z,p.addMul(this.m_invMassB,C),d+=this.m_invIB*I}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(c),this.m_bodyA.c_velocity.w=l,this.m_bodyB.c_velocity.v.set(p),this.m_bodyB.c_velocity.w=d},l.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,n=this.m_invIB,o=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,m=this.m_bodyB.c_velocity.v,c=this.m_bodyB.c_velocity.w,l=a.dot(this.m_ax,m)-a.dot(this.m_ax,o)+this.m_sBx*c-this.m_sAx*h,u=-this.m_springMass*(l+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=u;var _=a.mul(u,this.m_ax),p=u*this.m_sAx,d=u*this.m_sBx;o.subMul(e,_),h-=s*p,m.addMul(i,_);l=(c+=n*d)-h-this.m_motorSpeed,u=-this.m_motorMass*l;var f=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+u,-y,y),h-=s*(u=this.m_motorImpulse-f),c+=n*u;l=a.dot(this.m_ay,m)-a.dot(this.m_ay,o)+this.m_sBy*c-this.m_sAy*h,u=-this.m_mass*l;this.m_impulse+=u;_=a.mul(u,this.m_ay),p=u*this.m_sAy,d=u*this.m_sBy;o.subMul(e,_),h-=s*p,m.addMul(i,_),c+=n*d,this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.set(m),this.m_bodyB.c_velocity.w=c},l.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,m=h.neo(i),c=h.neo(n),l=h.mulVec2(m,a.sub(this.m_localAnchorA,this.m_localCenterA)),u=h.mulVec2(c,a.sub(this.m_localAnchorB,this.m_localCenterB)),_=a.zero();_.addCombine(1,s,1,u),_.subCombine(1,e,1,l);var p,d=h.mulVec2(m,this.m_localYAxisA),f=a.cross(a.add(_,l),d),y=a.cross(u,d),v=a.dot(_,d),g=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;p=0!=g?-v/g:0;var x=a.mul(p,d),b=p*f,A=p*y;return e.subMul(this.m_invMassA,x),i-=this.m_invIA*b,s.addMul(this.m_invMassB,x),n+=this.m_invIB*A,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=n,r.abs(v)<=o.linearSlop}}]);